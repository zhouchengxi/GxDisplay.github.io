(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d10060c"],{"00ee":function(e,t,o){var n=o("b622"),i=n("toStringTag"),s={};s[i]="z",e.exports="[object z]"===String(s)},"0196":function(e,t,o){const n=o("58b4"),i=o("bbf0");function s(e){this.mode=i.BYTE,"string"===typeof e&&(e=n(e)),this.data=new Uint8Array(e)}s.getBitsLength=function(e){return 8*e},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){for(let t=0,o=this.data.length;t<o;t++)e.put(this.data[t],8)},e.exports=s},"01ac":function(e,t,o){},"025f":function(e,t,o){"use strict";o("ca07")},"0366":function(e,t,o){var n=o("4625"),i=o("59ed"),s=o("40d5"),a=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:s?a(e,t):function(){return e.apply(t,arguments)}}},"0425":function(e,t){const o="[0-9]+",n="[A-Z $%*+\\-./:]+";let i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";i=i.replace(/u/g,"\\u");const s="(?:(?![A-Z0-9 $%*+\\-./:]|"+i+")(?:.|[\r\n]))+";t.KANJI=new RegExp(i,"g"),t.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=new RegExp(s,"g"),t.NUMERIC=new RegExp(o,"g"),t.ALPHANUMERIC=new RegExp(n,"g");const a=new RegExp("^"+i+"$"),r=new RegExp("^"+o+"$"),c=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return a.test(e)},t.testNumeric=function(e){return r.test(e)},t.testAlphanumeric=function(e){return c.test(e)}},"04f8":function(e,t,o){var n=o("2d00"),i=o("d039"),s=o("da84"),a=s.String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!a(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},"06cf":function(e,t,o){var n=o("83ab"),i=o("c65b"),s=o("d1e7"),a=o("5c6c"),r=o("fc6a"),c=o("a04b"),l=o("1a2d"),d=o("0cfb"),u=Object.getOwnPropertyDescriptor;t.f=n?u:function(e,t){if(e=r(e),t=c(t),d)try{return u(e,t)}catch(o){}if(l(e,t))return a(!i(s.f,e,t),e[t])}},"078f":function(e,t,o){},"07fa":function(e,t,o){var n=o("50c4");e.exports=function(e){return n(e.length)}},"0a1e":function(e,t,o){"use strict";o("9f3f")},"0c22":function(e,t,o){},"0cfb":function(e,t,o){var n=o("83ab"),i=o("d039"),s=o("cc12");e.exports=!n&&!i((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},"0d26":function(e,t,o){var n=o("e330"),i=Error,s=n("".replace),a=function(e){return String(i(e).stack)}("zxcasd"),r=/\n\s*at [^:]*:[^\n]*/,c=r.test(a);e.exports=function(e,t){if(c&&"string"==typeof e&&!i.prepareStackTrace)while(t--)e=s(e,r,"");return e}},"0d51":function(e,t){var o=String;e.exports=function(e){try{return o(e)}catch(t){return"Object"}}},"0d6e":function(e,t,o){},"0da0":function(e,t,o){"use strict";o("2235")},"0e4f":function(e,t,o){},"0fef":function(e,t,o){e.exports=o.p+"img/icon-pv.627bc69b.png"},"104f":function(e,t,o){"use strict";o("3ae2")},"10b0":function(e,t,o){"use strict";var n={single_source_shortest_paths:function(e,t,o){var i={},s={};s[t]=0;var a,r,c,l,d,u,p,h,f,m=n.PriorityQueue.make();m.push(t,0);while(!m.empty())for(c in a=m.pop(),r=a.value,l=a.cost,d=e[r]||{},d)d.hasOwnProperty(c)&&(u=d[c],p=l+u,h=s[c],f="undefined"===typeof s[c],(f||h>p)&&(s[c]=p,m.push(c,p),i[c]=r));if("undefined"!==typeof o&&"undefined"===typeof s[o]){var v=["Could not find a path from ",t," to ",o,"."].join("");throw new Error(v)}return i},extract_shortest_path_from_predecessor_list:function(e,t){var o=[],n=t;while(n)o.push(n),e[n],n=e[n];return o.reverse(),o},find_path:function(e,t,o){var i=n.single_source_shortest_paths(e,t,o);return n.extract_shortest_path_from_predecessor_list(i,o)},PriorityQueue:{make:function(e){var t,o=n.PriorityQueue,i={};for(t in e=e||{},o)o.hasOwnProperty(t)&&(i[t]=o[t]);return i.queue=[],i.sorter=e.sorter||o.default_sorter,i},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){var o={value:e,cost:t};this.queue.push(o),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=n},"120d":function(e,t,o){"use strict";o("9942")},"121d":function(e,t,o){e.exports=o.p+"img/default_app_porital.0b07213a.png"},"129c":function(e,t,o){"use strict";o("bea4")},"13d2":function(e,t,o){var n=o("e330"),i=o("d039"),s=o("1626"),a=o("1a2d"),r=o("83ab"),c=o("5e77").CONFIGURABLE,l=o("8925"),d=o("69f3"),u=d.enforce,p=d.get,h=String,f=Object.defineProperty,m=n("".slice),v=n("".replace),b=n([].join),g=r&&!i((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),w=e.exports=function(e,t,o){"Symbol("===m(h(t),0,7)&&(t="["+v(h(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),o&&o.getter&&(t="get "+t),o&&o.setter&&(t="set "+t),(!a(e,"name")||c&&e.name!==t)&&(r?f(e,"name",{value:t,configurable:!0}):e.name=t),g&&o&&a(o,"arity")&&e.length!==o.arity&&f(e,"length",{value:o.arity});try{o&&a(o,"constructor")&&o.constructor?r&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var n=u(e);return a(n,"source")||(n.source=b(y,"string"==typeof t?t:"")),e};Function.prototype.toString=w((function(){return s(this)&&p(this).source||l(this)}),"toString")},"148d":function(e,t,o){"use strict";o("3cc6")},"14d9":function(e,t,o){"use strict";var n=o("23e7"),i=o("7b0b"),s=o("07fa"),a=o("3a34"),r=o("3511"),c=o("d039"),l=c((function(){return 4294967297!==[].push.call({length:4294967296},1)})),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},u=l||!d();n({target:"Array",proto:!0,arity:1,forced:u},{push:function(e){var t=i(this),o=s(t),n=arguments.length;r(o+n);for(var c=0;c<n;c++)t[o]=arguments[c],o++;return a(t,o),o}})},1626:function(e,t,o){var n=o("8ea1"),i=n.all;e.exports=n.IS_HTMLDDA?function(e){return"function"==typeof e||e===i}:function(e){return"function"==typeof e}},"182d":function(e,t,o){var n=o("f8cd"),i=RangeError;e.exports=function(e,t){var o=n(e);if(o%t)throw i("Wrong offset");return o}},"1a2d":function(e,t,o){var n=o("e330"),i=o("7b0b"),s=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return s(i(e),t)}},"1b3b":function(e,t,o){o("6ce5")},"1d02":function(e,t,o){"use strict";var n=o("ebb5"),i=o("a258").findLastIndex,s=n.aTypedArray,a=n.exportTypedArrayMethod;a("findLastIndex",(function(e){return i(s(this),e,arguments.length>1?arguments[1]:void 0)}))},"1d80":function(e,t,o){var n=o("7234"),i=TypeError;e.exports=function(e){if(n(e))throw i("Can't call method on "+e);return e}},"1e04":function(e,t,o){"use strict";o("5d0f")},"1fcf":function(e,t,o){"use strict";o("62e6")},"20a4":function(e,t,o){"use strict";o("8134")},2235:function(e,t,o){},"23cb":function(e,t,o){var n=o("5926"),i=Math.max,s=Math.min;e.exports=function(e,t){var o=n(e);return o<0?i(o+t,0):s(o,t)}},"23e7":function(e,t,o){var n=o("da84"),i=o("06cf").f,s=o("9112"),a=o("cb2d"),r=o("6374"),c=o("e893"),l=o("94ca");e.exports=function(e,t){var o,d,u,p,h,f,m=e.target,v=e.global,b=e.stat;if(d=v?n:b?n[m]||r(m,{}):(n[m]||{}).prototype,d)for(u in t){if(h=t[u],e.dontCallGetSet?(f=i(d,u),p=f&&f.value):p=d[u],o=l(v?u:m+(b?".":"#")+u,e.forced),!o&&void 0!==p){if(typeof h==typeof p)continue;c(h,p)}(e.sham||p&&p.sham)&&s(h,"sham",!0),a(d,u,h,e)}}},"241c":function(e,t,o){var n=o("ca84"),i=o("7839"),s=i.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,s)}},2732:function(e,t,o){const n=o("699e");t.mul=function(e,t){const o=new Uint8Array(e.length+t.length-1);for(let i=0;i<e.length;i++)for(let s=0;s<t.length;s++)o[i+s]^=n.mul(e[i],t[s]);return o},t.mod=function(e,t){let o=new Uint8Array(e);while(o.length-t.length>=0){const e=o[0];for(let s=0;s<t.length;s++)o[s]^=n.mul(t[s],e);let i=0;while(i<o.length&&0===o[i])i++;o=o.slice(i)}return o},t.generateECPolynomial=function(e){let o=new Uint8Array([1]);for(let i=0;i<e;i++)o=t.mul(o,new Uint8Array([1,n.exp(i)]));return o}},"27a3":function(e,t){t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},2834:function(e,t,o){"use strict";var n=o("ebb5"),i=o("e330"),s=o("59ed"),a=o("dfb9"),r=n.aTypedArray,c=n.getTypedArrayConstructor,l=n.exportTypedArrayMethod,d=i(n.TypedArrayPrototype.sort);l("toSorted",(function(e){void 0!==e&&s(e);var t=r(this),o=a(c(t),t);return d(o,e)}))},2949:function(e,t,o){e.exports=o.p+"img/layer_close.b56dde0e.png"},2971:function(e,t,o){"use strict";o("557a")},"2a62":function(e,t,o){"use strict";o("fb40")},"2acc":function(e,t,o){},"2ba4":function(e,t,o){var n=o("40d5"),i=Function.prototype,s=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?a.bind(s):function(){return a.apply(s,arguments)})},"2d00":function(e,t,o){var n,i,s=o("da84"),a=o("342f"),r=s.process,c=s.Deno,l=r&&r.versions||c&&c.version,d=l&&l.v8;d&&(n=d.split("."),i=n[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&a&&(n=a.match(/Edge\/(\d+)/),(!n||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/),n&&(i=+n[1]))),e.exports=i},"2f3a":function(e,t,o){const n=o("bbf0"),i=o("7bf0");function s(e){this.mode=n.KANJI,this.data=e}s.getBitsLength=function(e){return 13*e},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let o=i.toSJIS(this.data[t]);if(o>=33088&&o<=40956)o-=33088;else{if(!(o>=57408&&o<=60351))throw new Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");o-=49472}o=192*(o>>>8&255)+(255&o),e.put(o,13)}},e.exports=s},"32eb":function(e,t,o){"use strict";o("0c22")},"342f":function(e,t){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},"34fc":function(e,t,o){const n=o("7a43"),i=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],s=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case n.L:return i[4*(e-1)+0];case n.M:return i[4*(e-1)+1];case n.Q:return i[4*(e-1)+2];case n.H:return i[4*(e-1)+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case n.L:return s[4*(e-1)+0];case n.M:return s[4*(e-1)+1];case n.Q:return s[4*(e-1)+2];case n.H:return s[4*(e-1)+3];default:return}}},3511:function(e,t){var o=TypeError,n=9007199254740991;e.exports=function(e){if(e>n)throw o("Maximum allowed index exceeded");return e}},3802:function(e,t,o){e.exports=o.p+"img/r_2.2.475c4a67.png"},"38fc":function(e,t,o){e.exports=o.p+"img/icon-like_high.aa9a8323.png"},"3a34":function(e,t,o){"use strict";var n=o("83ab"),i=o("e8b5"),s=TypeError,a=Object.getOwnPropertyDescriptor,r=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=r?function(e,t){if(i(e)&&!a(e,"length").writable)throw s("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},"3a9b":function(e,t,o){var n=o("e330");e.exports=n({}.isPrototypeOf)},"3ae2":function(e,t,o){},"3bbe":function(e,t,o){var n=o("1626"),i=String,s=TypeError;e.exports=function(e){if("object"==typeof e||n(e))return e;throw s("Can't set "+i(e)+" as a prototype")}},"3bf1":function(e,t,o){e.exports=o.p+"img/r_3.1.844ee430.png"},"3c5d":function(e,t,o){"use strict";var n=o("da84"),i=o("c65b"),s=o("ebb5"),a=o("07fa"),r=o("182d"),c=o("7b0b"),l=o("d039"),d=n.RangeError,u=n.Int8Array,p=u&&u.prototype,h=p&&p.set,f=s.aTypedArray,m=s.exportTypedArrayMethod,v=!l((function(){var e=new Uint8ClampedArray(2);return i(h,e,{length:1,0:3},1),3!==e[1]})),b=v&&s.NATIVE_ARRAY_BUFFER_VIEWS&&l((function(){var e=new u(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));m("set",(function(e){f(this);var t=r(arguments.length>1?arguments[1]:void 0,1),o=c(e);if(v)return i(h,this,o,t);var n=this.length,s=a(o),l=0;if(s+t>n)throw d("Wrong length");while(l<s)this[t+l]=o[l++]}),!v||b)},"3cc6":function(e,t,o){},"3d71":function(e,t,o){o("2834")},"3dcb":function(e,t,o){},"3fe0":function(e,t,o){},4006:function(e,t,o){const n=o("45be");function i(e,t){const o=e.a/255,n=t+'="'+e.hex+'"';return o<1?n+" "+t+'-opacity="'+o.toFixed(2).slice(1)+'"':n}function s(e,t,o){let n=e+t;return"undefined"!==typeof o&&(n+=" "+o),n}function a(e,t,o){let n="",i=0,a=!1,r=0;for(let c=0;c<e.length;c++){const l=Math.floor(c%t),d=Math.floor(c/t);l||a||(a=!0),e[c]?(r++,c>0&&l>0&&e[c-1]||(n+=a?s("M",l+o,.5+d+o):s("m",i,0),i=0,a=!1),l+1<t&&e[c+1]||(n+=s("h",r),r=0)):i++}return n}t.render=function(e,t,o){const s=n.getOptions(t),r=e.modules.size,c=e.modules.data,l=r+2*s.margin,d=s.color.light.a?"<path "+i(s.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",u="<path "+i(s.color.dark,"stroke")+' d="'+a(c,r,s.margin)+'"/>',p='viewBox="0 0 '+l+" "+l+'"',h=s.width?'width="'+s.width+'" height="'+s.width+'" ':"",f='<svg xmlns="http://www.w3.org/2000/svg" '+h+p+' shape-rendering="crispEdges">'+d+u+"</svg>\n";return"function"===typeof o&&o(null,f),f}},"40d5":function(e,t,o){var n=o("d039");e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},4146:function(e,t,o){const n=o("45be");function i(e,t,o){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=o,t.width=o,t.style.height=o+"px",t.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}t.render=function(e,t,o){let a=o,r=t;"undefined"!==typeof a||t&&t.getContext||(a=t,t=void 0),t||(r=s()),a=n.getOptions(a);const c=n.getImageWidth(e.modules.size,a),l=r.getContext("2d"),d=l.createImageData(c,c);return n.qrToImageData(d.data,e,a),i(l,r,c),l.putImageData(d,0,0),r},t.renderToDataURL=function(e,o,n){let i=n;"undefined"!==typeof i||o&&o.getContext||(i=o,o=void 0),i||(i={});const s=t.render(e,o,i),a=i.type||"image/png",r=i.rendererOpts||{};return s.toDataURL(a,r.quality)}},4189:function(e,t,o){},"44ad":function(e,t,o){var n=o("e330"),i=o("d039"),s=o("c6b6"),a=Object,r=n("".split);e.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?r(e,""):a(e)}:a},"45b5":function(e,t,o){"use strict";o("7370")},"45be":function(e,t){function o(e){if("number"===typeof e&&(e=e.toString()),"string"!==typeof e)throw new Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+e);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map((function(e){return[e,e]})))),6===t.length&&t.push("F","F");const o=parseInt(t.join(""),16);return{r:o>>24&255,g:o>>16&255,b:o>>8&255,a:255&o,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});const t="undefined"===typeof e.margin||null===e.margin||e.margin<0?4:e.margin,n=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:n,scale:n?4:i,margin:t,color:{dark:o(e.color.dark||"#000000ff"),light:o(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,o){const n=t.getScale(e,o);return Math.floor((e+2*o.margin)*n)},t.qrToImageData=function(e,o,n){const i=o.modules.size,s=o.modules.data,a=t.getScale(i,n),r=Math.floor((i+2*n.margin)*a),c=n.margin*a,l=[n.color.light,n.color.dark];for(let t=0;t<r;t++)for(let o=0;o<r;o++){let d=4*(t*r+o),u=n.color.light;if(t>=c&&o>=c&&t<r-c&&o<r-c){const e=Math.floor((t-c)/a),n=Math.floor((o-c)/a);u=l[s[e*i+n]?1:0]}e[d++]=u.r,e[d++]=u.g,e[d++]=u.b,e[d]=u.a}}},4625:function(e,t,o){var n=o("c6b6"),i=o("e330");e.exports=function(e){if("Function"===n(e))return i(e)}},"485a":function(e,t,o){var n=o("c65b"),i=o("1626"),s=o("861d"),a=TypeError;e.exports=function(e,t){var o,r;if("string"===t&&i(o=e.toString)&&!s(r=n(o,e)))return r;if(i(o=e.valueOf)&&!s(r=n(o,e)))return r;if("string"!==t&&i(o=e.toString)&&!s(r=n(o,e)))return r;throw a("Can't convert object to primitive value")}},"4b11":function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},"4d64":function(e,t,o){var n=o("fc6a"),i=o("23cb"),s=o("07fa"),a=function(e){return function(t,o,a){var r,c=n(t),l=s(c),d=i(a,l);if(e&&o!=o){while(l>d)if(r=c[d++],r!=r)return!0}else for(;l>d;d++)if((e||d in c)&&c[d]===o)return e||d||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},"4db3":function(e,t,o){e.exports=o.p+"img/d2_en.f401bd6d.png"},"4ea1":function(e,t,o){"use strict";var n=o("d429"),i=o("ebb5"),s=o("bcbf"),a=o("5926"),r=o("f495"),c=i.aTypedArray,l=i.getTypedArrayConstructor,d=i.exportTypedArrayMethod,u=!!function(){try{new Int8Array(1)["with"](2,{valueOf:function(){throw 8}})}catch(e){return 8===e}}();d("with",{with:function(e,t){var o=c(this),i=a(e),d=s(o)?r(t):+t;return n(o,l(o),i,d)}}["with"],!u)},5088:function(e,t,o){},"50c4":function(e,t,o){var n=o("5926"),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},"527e":function(e,t,o){"use strict";o("e627")},"52ff":function(e,t,o){},5495:function(e,t,o){},5543:function(e,t,o){"use strict";o("5088")},"557a":function(e,t,o){},"55a0":function(e,t,o){},5692:function(e,t,o){var n=o("c430"),i=o("c6cd");(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.30.2",mode:n?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.30.2/LICENSE",source:"https://github.com/zloirock/core-js"})},"56ef":function(e,t,o){var n=o("d066"),i=o("e330"),s=o("241c"),a=o("74183"),r=o("825a"),c=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=s.f(r(e)),o=a.f;return o?c(t,o(e)):t}},"577e":function(e,t){function o(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}o.prototype.set=function(e,t,o,n){const i=e*this.size+t;this.data[i]=o,n&&(this.reservedBit[i]=!0)},o.prototype.get=function(e,t){return this.data[e*this.size+t]},o.prototype.xor=function(e,t,o){this.data[e*this.size+t]^=o},o.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=o},"577ed":function(e,t,o){var n=o("f5df"),i=String;e.exports=function(e){if("Symbol"===n(e))throw TypeError("Cannot convert a Symbol value to a string");return i(e)}},"58b4":function(e,t,o){"use strict";e.exports=function(e){for(var t=[],o=e.length,n=0;n<o;n++){var i=e.charCodeAt(n);if(i>=55296&&i<=56319&&o>n+1){var s=e.charCodeAt(n+1);s>=56320&&s<=57343&&(i=1024*(i-55296)+s-56320+65536,n+=1)}i<128?t.push(i):i<2048?(t.push(i>>6|192),t.push(63&i|128)):i<55296||i>=57344&&i<65536?(t.push(i>>12|224),t.push(i>>6&63|128),t.push(63&i|128)):i>=65536&&i<=1114111?(t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(63&i|128)):t.push(239,191,189)}return new Uint8Array(t).buffer}},5917:function(e,t,o){},5926:function(e,t,o){var n=o("b42e");e.exports=function(e){var t=+e;return t!==t||0===t?0:n(t)}},"59d0":function(e,t,o){e.exports=o.p+"img/b_8.d9330e4b.png"},"59e9":function(e,t,o){e.exports=o.p+"img/r_4.2.05b0e0c0.png"},"59ed":function(e,t,o){var n=o("1626"),i=o("0d51"),s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not a function")}},"5c26":function(e,t,o){e.exports=o.p+"img/b_1.1.bc999759.png"},"5c6c":function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"5d0f":function(e,t,o){},"5d40":function(e,t,o){e.exports=o.p+"img/r_3.2.d1f11f31.png"},"5dc4":function(e,t,o){e.exports=o.p+"img/r_5.1af9363a.png"},"5e77":function(e,t,o){var n=o("83ab"),i=o("1a2d"),s=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,r=i(s,"name"),c=r&&"something"===function(){}.name,l=r&&(!n||n&&a(s,"name").configurable);e.exports={EXISTS:r,PROPER:c,CONFIGURABLE:l}},"62e6":function(e,t,o){},6374:function(e,t,o){var n=o("da84"),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(o){n[e]=t}return t}},"66a0":function(e,t,o){},"67dd":function(e,t){e.exports=function(){return"function"===typeof Promise&&Promise.prototype&&Promise.prototype.then}},6887:function(e,t,o){},"68ba":function(e,t,o){var n={"./default_app.png":"87d0","./default_app_porital.png":"121d","./transparent.png":"d32e","./webview_control.png":"a93e"};function i(e){var t=s(e);return o(t)}function s(e){if(!o.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=s,e.exports=i,i.id="68ba"},"68c2":function(e,t,o){"use strict";o("7f62")},"699e":function(e,t){const o=new Uint8Array(512),n=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)o[t]=e,n[e]=t,e<<=1,256&e&&(e^=285);for(let t=255;t<512;t++)o[t]=o[t-255]})(),t.log=function(e){if(e<1)throw new Error("log("+e+")");return n[e]},t.exp=function(e){return o[e]},t.mul=function(e,t){return 0===e||0===t?0:o[n[e]+n[t]]}},"69f3":function(e,t,o){var n,i,s,a=o("cdce"),r=o("da84"),c=o("861d"),l=o("9112"),d=o("1a2d"),u=o("c6cd"),p=o("f772"),h=o("d012"),f="Object already initialized",m=r.TypeError,v=r.WeakMap,b=function(e){return s(e)?i(e):n(e,{})},g=function(e){return function(t){var o;if(!c(t)||(o=i(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return o}};if(a||u.state){var y=u.state||(u.state=new v);y.get=y.get,y.has=y.has,y.set=y.set,n=function(e,t){if(y.has(e))throw m(f);return t.facade=e,y.set(e,t),t},i=function(e){return y.get(e)||{}},s=function(e){return y.has(e)}}else{var w=p("state");h[w]=!0,n=function(e,t){if(d(e,w))throw m(f);return t.facade=e,l(e,w,t),t},i=function(e){return d(e,w)?e[w]:{}},s=function(e){return d(e,w)}}e.exports={set:n,get:i,has:s,enforce:b,getterFor:g}},"6a2d":function(e,t,o){},"6b0d":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{const o=e.__vccOpts||e;for(const[n,i]of t)o[n]=i;return o}},"6ce5":function(e,t,o){"use strict";var n=o("df7e"),i=o("ebb5"),s=i.aTypedArray,a=i.exportTypedArrayMethod,r=i.getTypedArrayConstructor;a("toReversed",(function(){return n(s(this),r(this))}))},"6d8c":function(e,t,o){},"6e9c":function(e,t,o){e.exports=o.p+"img/empty_flow.c00afd8a.png"},"6f19":function(e,t,o){var n=o("9112"),i=o("0d26"),s=o("b980"),a=Error.captureStackTrace;e.exports=function(e,t,o,r){s&&(a?a(e,t):n(e,"stack",i(o,r)))}},"703f":function(e,t,o){},7156:function(e,t,o){var n=o("1626"),i=o("861d"),s=o("d2bb");e.exports=function(e,t,o){var a,r;return s&&n(a=t.constructor)&&a!==o&&i(r=a.prototype)&&r!==o.prototype&&s(e,r),e}},7234:function(e,t){e.exports=function(e){return null===e||void 0===e}},7282:function(e,t,o){var n=o("e330"),i=o("59ed");e.exports=function(e,t,o){try{return n(i(Object.getOwnPropertyDescriptor(e,t)[o]))}catch(s){}}},7370:function(e,t,o){},7418:function(e,t,o){},74183:function(e,t){t.f=Object.getOwnPropertySymbols},7839:function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"78c0":function(e,t,o){e.exports=o.p+"img/little.171d2ce4.png"},7903:function(e,t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const o={N1:3,N2:3,N3:40,N4:10};function n(e,o,n){switch(e){case t.Patterns.PATTERN000:return(o+n)%2===0;case t.Patterns.PATTERN001:return o%2===0;case t.Patterns.PATTERN010:return n%3===0;case t.Patterns.PATTERN011:return(o+n)%3===0;case t.Patterns.PATTERN100:return(Math.floor(o/2)+Math.floor(n/3))%2===0;case t.Patterns.PATTERN101:return o*n%2+o*n%3===0;case t.Patterns.PATTERN110:return(o*n%2+o*n%3)%2===0;case t.Patterns.PATTERN111:return(o*n%3+(o+n)%2)%2===0;default:throw new Error("bad maskPattern:"+e)}}t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){const t=e.size;let n=0,i=0,s=0,a=null,r=null;for(let c=0;c<t;c++){i=s=0,a=r=null;for(let l=0;l<t;l++){let t=e.get(c,l);t===a?i++:(i>=5&&(n+=o.N1+(i-5)),a=t,i=1),t=e.get(l,c),t===r?s++:(s>=5&&(n+=o.N1+(s-5)),r=t,s=1)}i>=5&&(n+=o.N1+(i-5)),s>=5&&(n+=o.N1+(s-5))}return n},t.getPenaltyN2=function(e){const t=e.size;let n=0;for(let o=0;o<t-1;o++)for(let i=0;i<t-1;i++){const t=e.get(o,i)+e.get(o,i+1)+e.get(o+1,i)+e.get(o+1,i+1);4!==t&&0!==t||n++}return n*o.N2},t.getPenaltyN3=function(e){const t=e.size;let n=0,i=0,s=0;for(let o=0;o<t;o++){i=s=0;for(let a=0;a<t;a++)i=i<<1&2047|e.get(o,a),a>=10&&(1488===i||93===i)&&n++,s=s<<1&2047|e.get(a,o),a>=10&&(1488===s||93===s)&&n++}return n*o.N3},t.getPenaltyN4=function(e){let t=0;const n=e.data.length;for(let o=0;o<n;o++)t+=e.data[o];const i=Math.abs(Math.ceil(100*t/n/5)-10);return i*o.N4},t.applyMask=function(e,t){const o=t.size;for(let i=0;i<o;i++)for(let s=0;s<o;s++)t.isReserved(s,i)||t.xor(s,i,n(e,s,i))},t.getBestMask=function(e,o){const n=Object.keys(t.Patterns).length;let i=0,s=1/0;for(let a=0;a<n;a++){o(a),t.applyMask(a,e);const n=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(a,e),n<s&&(s=n,i=a)}return i}},"7a43":function(e,t){function o(e){if("string"!==typeof e)throw new Error("Param is not a string");const o=e.toLowerCase();switch(o){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&"undefined"!==typeof e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,n){if(t.isValid(e))return e;try{return o(e)}catch(i){return n}}},"7b0b":function(e,t,o){var n=o("1d80"),i=Object;e.exports=function(e){return i(n(e))}},"7b9b":function(e,t,o){"use strict";o("a26c")},"7ba0":function(e,t){function o(){this.buffer=[],this.length=0}o.prototype={get:function(e){const t=Math.floor(e/8);return 1===(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(let o=0;o<t;o++)this.putBit(1===(e>>>t-o-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=o},"7bb8":function(e,t,o){e.exports=o.p+"img/icon-like.a97b7e1f.png"},"7bf0":function(e,t){let o;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return n[e]},t.getBCHDigit=function(e){let t=0;while(0!==e)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!==typeof e)throw new Error('"toSJISFunc" is not a valid function.');o=e},t.isKanjiModeEnabled=function(){return"undefined"!==typeof o},t.toSJIS=function(e){return o(e)}},"7d4b":function(e,t,o){"use strict";o("a5ec")},"7f62":function(e,t,o){},8134:function(e,t,o){},8145:function(e,t,o){"use strict";o("9e9d")},"825a":function(e,t,o){var n=o("861d"),i=String,s=TypeError;e.exports=function(e){if(n(e))return e;throw s(i(e)+" is not an object")}},"83ab":function(e,t,o){var n=o("d039");e.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"861d":function(e,t,o){var n=o("1626"),i=o("8ea1"),s=i.all;e.exports=i.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:n(e)||e===s}:function(e){return"object"==typeof e?null!==e:n(e)}},"862d":function(e,t,o){"use strict";(function(t,o){e.exports=o()})(0,(function(){function e(e){var n=[];return e.AMapUI&&n.push(t(e.AMapUI)),e.Loca&&n.push(o(e.Loca)),Promise.all(n)}function t(e){return new Promise((function(t,o){var r=[];if(e.plugins)for(var c=0;c<e.plugins.length;c+=1)-1==i.AMapUI.plugins.indexOf(e.plugins[c])&&r.push(e.plugins[c]);if(s.AMapUI===n.failed)o("前次请求 AMapUI 失败");else if(s.AMapUI===n.notload){s.AMapUI=n.loading,i.AMapUI.version=e.version||i.AMapUI.version,c=i.AMapUI.version;var l=document.body||document.head,d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/ui/"+c+"/main.js",d.onerror=function(e){s.AMapUI=n.failed,o("请求 AMapUI 失败")},d.onload=function(){if(s.AMapUI=n.loaded,r.length)window.AMapUI.loadUI(r,(function(){for(var e=0,o=r.length;e<o;e++){var n=r[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}for(t();a.AMapUI.length;)a.AMapUI.splice(0,1)[0]()}));else for(t();a.AMapUI.length;)a.AMapUI.splice(0,1)[0]()},l.appendChild(d)}else s.AMapUI===n.loaded?e.version&&e.version!==i.AMapUI.version?o("不允许多个版本 AMapUI 混用"):r.length?window.AMapUI.loadUI(r,(function(){for(var e=0,o=r.length;e<o;e++){var n=r[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()})):t():e.version&&e.version!==i.AMapUI.version?o("不允许多个版本 AMapUI 混用"):a.AMapUI.push((function(e){e?o(e):r.length?window.AMapUI.loadUI(r,(function(){for(var e=0,o=r.length;e<o;e++){var n=r[e].split("/").slice(-1)[0];window.AMapUI[n]=arguments[e]}t()})):t()}))}))}function o(e){return new Promise((function(t,o){if(s.Loca===n.failed)o("前次请求 Loca 失败");else if(s.Loca===n.notload){s.Loca=n.loading,i.Loca.version=e.version||i.Loca.version;var r=i.Loca.version,c=i.AMap.version.startsWith("2"),l=r.startsWith("2");if(c&&!l||!c&&l)o("JSAPI 与 Loca 版本不对应！！");else{c=i.key,l=document.body||document.head;var d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/loca?v="+r+"&key="+c,d.onerror=function(e){s.Loca=n.failed,o("请求 AMapUI 失败")},d.onload=function(){for(s.Loca=n.loaded,t();a.Loca.length;)a.Loca.splice(0,1)[0]()},l.appendChild(d)}}else s.Loca===n.loaded?e.version&&e.version!==i.Loca.version?o("不允许多个版本 Loca 混用"):t():e.version&&e.version!==i.Loca.version?o("不允许多个版本 Loca 混用"):a.Loca.push((function(e){e?o(e):o()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var n;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(n||(n={}));var i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},a={AMap:[],AMapUI:[],Loca:[]},r=[],c=function(e){"function"==typeof e&&(s.AMap===n.loaded?e(window.AMap):r.push(e))};return{load:function(t){return new Promise((function(o,a){if(s.AMap==n.failed)a("");else if(s.AMap==n.notload){var l=t.key,d=t.version,u=t.plugins;l?(window.AMap&&"lbs.amap.com"!==location.host&&a("禁止多种API加载方式混用"),i.key=l,i.AMap.version=d||i.AMap.version,i.AMap.plugins=u||i.AMap.plugins,s.AMap=n.loading,d=document.body||document.head,window.___onAPILoaded=function(i){if(delete window.___onAPILoaded,i)s.AMap=n.failed,a(i);else for(s.AMap=n.loaded,e(t).then((function(){o(window.AMap)}))["catch"](a);r.length;)r.splice(0,1)[0]()},u=document.createElement("script"),u.type="text/javascript",u.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+i.AMap.version+"&key="+l+"&plugin="+i.AMap.plugins.join(","),u.onerror=function(e){s.AMap=n.failed,a(e)},d.appendChild(u)):a("请填写key")}else if(s.AMap==n.loaded)if(t.key&&t.key!==i.key)a("多个不一致的 key");else if(t.version&&t.version!==i.AMap.version)a("不允许多个版本 JSAPI 混用");else{if(l=[],t.plugins)for(d=0;d<t.plugins.length;d+=1)-1==i.AMap.plugins.indexOf(t.plugins[d])&&l.push(t.plugins[d]);l.length?window.AMap.plugin(l,(function(){e(t).then((function(){o(window.AMap)}))["catch"](a)})):e(t).then((function(){o(window.AMap)}))["catch"](a)}else if(t.key&&t.key!==i.key)a("多个不一致的 key");else if(t.version&&t.version!==i.AMap.version)a("不允许多个版本 JSAPI 混用");else{var p=[];if(t.plugins)for(d=0;d<t.plugins.length;d+=1)-1==i.AMap.plugins.indexOf(t.plugins[d])&&p.push(t.plugins[d]);c((function(){p.length?window.AMap.plugin(p,(function(){e(t).then((function(){o(window.AMap)}))["catch"](a)})):e(t).then((function(){o(window.AMap)}))["catch"](a)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,i={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:n.notload,AMapUI:n.notload,Loca:n.notload},a={AMap:[],AMapUI:[],Loca:[]}}}}))},"872c":function(e,t,o){"use strict";o("c965")},"87d0":function(e,t,o){e.exports=o.p+"img/default_app.6830b5fd.png"},8801:function(e,t,o){"use strict";o("c07f")},8925:function(e,t,o){var n=o("e330"),i=o("1626"),s=o("c6cd"),a=n(Function.toString);i(s.inspectSource)||(s.inspectSource=function(e){return a(e)}),e.exports=s.inspectSource},"8b9c":function(e,t,o){"use strict";o("9389")},"8bad":function(e,t,o){"use strict";o("d994")},"8d23":function(e,t,o){const n=o("2732");function i(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}i.prototype.initialize=function(e){this.degree=e,this.genPoly=n.generateECPolynomial(this.degree)},i.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const o=n.mod(t,this.genPoly),i=this.degree-o.length;if(i>0){const e=new Uint8Array(this.degree);return e.set(o,i),e}return o},e.exports=i},"8ea1":function(e,t){var o="object"==typeof document&&document.all,n="undefined"==typeof o&&void 0!==o;e.exports={all:o,IS_HTMLDDA:n}},"8f6e":function(e,t,o){"use strict";o("5495")},"907a":function(e,t,o){"use strict";var n=o("ebb5"),i=o("07fa"),s=o("5926"),a=n.aTypedArray,r=n.exportTypedArrayMethod;r("at",(function(e){var t=a(this),o=i(t),n=s(e),r=n>=0?n:o+n;return r<0||r>=o?void 0:t[r]}))},"90e3":function(e,t,o){var n=o("e330"),i=0,s=Math.random(),a=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+s,36)}},9112:function(e,t,o){var n=o("83ab"),i=o("9bf2"),s=o("5c6c");e.exports=n?function(e,t,o){return i.f(e,t,s(1,o))}:function(e,t,o){return e[t]=o,e}},"911a":function(e,t,o){"use strict";o("3fe0")},9197:function(e,t,o){"use strict";o("fdfd")},"924f":function(e,t,o){const n=o("7bf0").getSymbolSize,i=7;t.getPositions=function(e){const t=n(e);return[[0,0],[t-i,0],[0,t-i]]}},9389:function(e,t,o){},"94ca":function(e,t,o){var n=o("d039"),i=o("1626"),s=/#|\.prototype\./,a=function(e,t){var o=c[r(e)];return o==d||o!=l&&(i(t)?n(t):!!t)},r=a.normalize=function(e){return String(e).replace(s,".").toLowerCase()},c=a.data={},l=a.NATIVE="N",d=a.POLYFILL="P";e.exports=a},9582:function(e,t,o){const n=o("7bf0"),i=1335,s=21522,a=n.getBCHDigit(i);t.getEncodedBits=function(e,t){const o=e.bit<<3|t;let r=o<<10;while(n.getBCHDigit(r)-a>=0)r^=i<<n.getBCHDigit(r)-a;return(o<<10|r)^s}},"971c":function(e,t,o){"use strict";o("3dcb")},"973f":function(e,t,o){"use strict";o("6a2d")},"979e":function(e,t,o){"use strict";o("b77e")},"986a":function(e,t,o){"use strict";var n=o("ebb5"),i=o("a258").findLast,s=n.aTypedArray,a=n.exportTypedArrayMethod;a("findLast",(function(e){return i(s(this),e,arguments.length>1?arguments[1]:void 0)}))},9942:function(e,t,o){},"9bf2":function(e,t,o){var n=o("83ab"),i=o("0cfb"),s=o("aed9"),a=o("825a"),r=o("a04b"),c=TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor,u="enumerable",p="configurable",h="writable";t.f=n?s?function(e,t,o){if(a(e),t=r(t),a(o),"function"===typeof e&&"prototype"===t&&"value"in o&&h in o&&!o[h]){var n=d(e,t);n&&n[h]&&(e[t]=o.value,o={configurable:p in o?o[p]:n[p],enumerable:u in o?o[u]:n[u],writable:!1})}return l(e,t,o)}:l:function(e,t,o){if(a(e),t=r(t),a(o),i)try{return l(e,t,o)}catch(n){}if("get"in o||"set"in o)throw c("Accessors not supported");return"value"in o&&(e[t]=o.value),e}},"9c12":function(e,t,o){e.exports=o.p+"img/r_2.1.be16ae86.png"},"9d94":function(e,t,o){const n=o("bbf0"),i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function s(e){this.mode=n.ALPHANUMERIC,this.data=e}s.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let o=45*i.indexOf(this.data[t]);o+=i.indexOf(this.data[t+1]),e.put(o,11)}this.data.length%2&&e.put(i.indexOf(this.data[t]),6)},e.exports=s},"9e9d":function(e,t,o){},"9f3f":function(e,t,o){},a04b:function(e,t,o){var n=o("c04e"),i=o("d9b5");e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},a258:function(e,t,o){var n=o("0366"),i=o("44ad"),s=o("7b0b"),a=o("07fa"),r=function(e){var t=1==e;return function(o,r,c){var l,d,u=s(o),p=i(u),h=n(r,c),f=a(p);while(f-- >0)if(l=p[f],d=h(l,f,u),d)switch(e){case 0:return l;case 1:return f}return t?-1:void 0}};e.exports={findLast:r(0),findLastIndex:r(1)}},a26c:function(e,t,o){},a4ac:function(e,t,o){"use strict";o("6d8c")},a507:function(e,t,o){},a5ec:function(e,t,o){},a64c:function(e,t,o){"use strict";o.r(t);var n=o("8bbf"),i=(o("14d9"),o("0613"));const s=!0;function a(e=!0){const t=location.origin+location.pathname,o=t.split("/");return o.pop(),o.join("/")+(e?"/":"")}function r(){const e=a(!1);let t="";const o=e;if(i["b"].state.viewMode.local)t=o;else if(s){const o=e.split("/").pop()||"";t=e.replace("/"+o,"")}else t=o+"/api";return t.indexOf("each_version")>=0&&(t=t.replace("/each_version","")),{previewPath:t,servicePath:o}}var c=function(){return c=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var i in t=arguments[o],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c.apply(this,arguments)};function l(e,t,o,n){function i(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,s){function a(e){try{c(n.next(e))}catch(t){s(t)}}function r(e){try{c(n["throw"](e))}catch(t){s(t)}}function c(e){e.done?o(e.value):i(e.value).then(a,r)}c((n=n.apply(e,t||[])).next())}))}function d(e,t){var o,n,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function r(e){return function(t){return c([e,t])}}function c(r){if(o)throw new TypeError("Generator is already executing.");while(s&&(s=0,r[0]&&(a=0)),a)try{if(o=1,n&&(i=2&r[0]?n["return"]:r[0]?n["throw"]||((i=n["return"])&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,n=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(c){r=[6,c],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}}Object.create;function u(e,t,o){if(o||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}Object.create;var p="3.4.1";function h(e,t){return new Promise((function(o){return setTimeout(o,e,t)}))}function f(e,t){void 0===t&&(t=1/0);var o=window.requestIdleCallback;return o?new Promise((function(e){return o.call(window,(function(){return e()}),{timeout:t})})):h(Math.min(e,t))}function m(e){return!!e&&"function"===typeof e.then}function v(e,t){try{var o=e();m(o)?o.then((function(e){return t(!0,e)}),(function(e){return t(!1,e)})):t(!0,o)}catch(n){t(!1,n)}}function b(e,t,o){return void 0===o&&(o=16),l(this,void 0,void 0,(function(){var n,i,s;return d(this,(function(a){switch(a.label){case 0:n=Date.now(),i=0,a.label=1;case 1:return i<e.length?(t(e[i],i),s=Date.now(),s>=n+o?(n=s,[4,h(0)]):[3,3]):[3,4];case 2:a.sent(),a.label=3;case 3:return++i,[3,1];case 4:return[2]}}))}))}function g(e){e.then(void 0,(function(){}))}function y(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var o=[0,0,0,0];return o[3]+=e[3]+t[3],o[2]+=o[3]>>>16,o[3]&=65535,o[2]+=e[2]+t[2],o[1]+=o[2]>>>16,o[2]&=65535,o[1]+=e[1]+t[1],o[0]+=o[1]>>>16,o[1]&=65535,o[0]+=e[0]+t[0],o[0]&=65535,[o[0]<<16|o[1],o[2]<<16|o[3]]}function w(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var o=[0,0,0,0];return o[3]+=e[3]*t[3],o[2]+=o[3]>>>16,o[3]&=65535,o[2]+=e[2]*t[3],o[1]+=o[2]>>>16,o[2]&=65535,o[2]+=e[3]*t[2],o[1]+=o[2]>>>16,o[2]&=65535,o[1]+=e[1]*t[3],o[0]+=o[1]>>>16,o[1]&=65535,o[1]+=e[2]*t[2],o[0]+=o[1]>>>16,o[1]&=65535,o[1]+=e[3]*t[1],o[0]+=o[1]>>>16,o[1]&=65535,o[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],o[0]&=65535,[o[0]<<16|o[1],o[2]<<16|o[3]]}function x(e,t){return t%=64,32===t?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function S(e,t){return t%=64,0===t?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function I(e,t){return[e[0]^t[0],e[1]^t[1]]}function k(e){return e=I(e,[0,e[0]>>>1]),e=w(e,[4283543511,3981806797]),e=I(e,[0,e[0]>>>1]),e=w(e,[3301882366,444984403]),e=I(e,[0,e[0]>>>1]),e}function O(e,t){e=e||"",t=t||0;var o,n=e.length%16,i=e.length-n,s=[0,t],a=[0,t],r=[0,0],c=[0,0],l=[2277735313,289559509],d=[1291169091,658871167];for(o=0;o<i;o+=16)r=[255&e.charCodeAt(o+4)|(255&e.charCodeAt(o+5))<<8|(255&e.charCodeAt(o+6))<<16|(255&e.charCodeAt(o+7))<<24,255&e.charCodeAt(o)|(255&e.charCodeAt(o+1))<<8|(255&e.charCodeAt(o+2))<<16|(255&e.charCodeAt(o+3))<<24],c=[255&e.charCodeAt(o+12)|(255&e.charCodeAt(o+13))<<8|(255&e.charCodeAt(o+14))<<16|(255&e.charCodeAt(o+15))<<24,255&e.charCodeAt(o+8)|(255&e.charCodeAt(o+9))<<8|(255&e.charCodeAt(o+10))<<16|(255&e.charCodeAt(o+11))<<24],r=w(r,l),r=x(r,31),r=w(r,d),s=I(s,r),s=x(s,27),s=y(s,a),s=y(w(s,[0,5]),[0,1390208809]),c=w(c,d),c=x(c,33),c=w(c,l),a=I(a,c),a=x(a,31),a=y(a,s),a=y(w(a,[0,5]),[0,944331445]);switch(r=[0,0],c=[0,0],n){case 15:c=I(c,S([0,e.charCodeAt(o+14)],48));case 14:c=I(c,S([0,e.charCodeAt(o+13)],40));case 13:c=I(c,S([0,e.charCodeAt(o+12)],32));case 12:c=I(c,S([0,e.charCodeAt(o+11)],24));case 11:c=I(c,S([0,e.charCodeAt(o+10)],16));case 10:c=I(c,S([0,e.charCodeAt(o+9)],8));case 9:c=I(c,[0,e.charCodeAt(o+8)]),c=w(c,d),c=x(c,33),c=w(c,l),a=I(a,c);case 8:r=I(r,S([0,e.charCodeAt(o+7)],56));case 7:r=I(r,S([0,e.charCodeAt(o+6)],48));case 6:r=I(r,S([0,e.charCodeAt(o+5)],40));case 5:r=I(r,S([0,e.charCodeAt(o+4)],32));case 4:r=I(r,S([0,e.charCodeAt(o+3)],24));case 3:r=I(r,S([0,e.charCodeAt(o+2)],16));case 2:r=I(r,S([0,e.charCodeAt(o+1)],8));case 1:r=I(r,[0,e.charCodeAt(o)]),r=w(r,l),r=x(r,31),r=w(r,d),s=I(s,r)}return s=I(s,[0,e.length]),a=I(a,[0,e.length]),s=y(s,a),a=y(a,s),s=k(s),a=k(a),s=y(s,a),a=y(a,s),("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)+("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)}function j(e){var t;return c({name:e.name,message:e.message,stack:null===(t=e.stack)||void 0===t?void 0:t.split("\n")},e)}function C(e,t){for(var o=0,n=e.length;o<n;++o)if(e[o]===t)return!0;return!1}function E(e,t){return!C(e,t)}function T(e){return parseInt(e)}function P(e){return parseFloat(e)}function _(e,t){return"number"===typeof e&&isNaN(e)?t:e}function A(e){return e.reduce((function(e,t){return e+(t?1:0)}),0)}function M(e,t){if(void 0===t&&(t=1),Math.abs(t)>=1)return Math.round(e/t)*t;var o=1/t;return Math.round(e*o)/o}function H(e){for(var t,o,n="Unexpected syntax '".concat(e,"'"),i=/^\s*([a-z-]*)(.*)$/i.exec(e),s=i[1]||void 0,a={},r=/([.:#][\w-]+|\[.+?\])/gi,c=function(e,t){a[e]=a[e]||[],a[e].push(t)};;){var l=r.exec(i[2]);if(!l)break;var d=l[0];switch(d[0]){case".":c("class",d.slice(1));break;case"#":c("id",d.slice(1));break;case"[":var u=/^\[([\w-]+)([~|^$*]?=("(.*?)"|([\w-]+)))?(\s+[is])?\]$/.exec(d);if(!u)throw new Error(n);c(u[1],null!==(o=null!==(t=u[4])&&void 0!==t?t:u[5])&&void 0!==o?o:"");break;default:throw new Error(n)}}return[s,a]}function z(e){return e&&"object"===typeof e&&"message"in e?e:{message:e}}function L(e){return"function"!==typeof e}function D(e,t){var o=new Promise((function(o){var n=Date.now();v(e.bind(null,t),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=Date.now()-n;if(!e[0])return o((function(){return{error:z(e[1]),duration:i}}));var s=e[1];if(L(s))return o((function(){return{value:s,duration:i}}));o((function(){return new Promise((function(e){var t=Date.now();v(s,(function(){for(var o=[],n=0;n<arguments.length;n++)o[n]=arguments[n];var s=i+Date.now()-t;if(!o[0])return e({error:z(o[1]),duration:s});e({value:o[1],duration:s})}))}))}))}))}));return g(o),function(){return o.then((function(e){return e()}))}}function B(e,t,o){var n=Object.keys(e).filter((function(e){return E(o,e)})),i=Array(n.length);return b(n,(function(o,n){i[n]=D(e[o],t)})),function(){return l(this,void 0,void 0,(function(){var e,t,o,s,a,r,c;return d(this,(function(l){switch(l.label){case 0:for(e={},t=0,o=n;t<o.length;t++)s=o[t],e[s]=void 0;a=Array(n.length),r=function(){var t;return d(this,(function(o){switch(o.label){case 0:return t=!0,[4,b(n,(function(o,n){if(!a[n])if(i[n]){var s=i[n]().then((function(t){return e[o]=t}));g(s),a[n]=s}else t=!1}))];case 1:return o.sent(),t?[2,"break"]:[4,h(1)];case 2:return o.sent(),[2]}}))},l.label=1;case 1:return[5,r()];case 2:if(c=l.sent(),"break"===c)return[3,4];l.label=3;case 3:return[3,1];case 4:return[4,Promise.all(a)];case 5:return l.sent(),[2,e]}}))}))}}function N(){var e=window,t=navigator;return A(["MSCSSMatrix"in e,"msSetImmediate"in e,"msIndexedDB"in e,"msMaxTouchPoints"in t,"msPointerEnabled"in t])>=4}function V(){var e=window,t=navigator;return A(["msWriteProfilerMark"in e,"MSStream"in e,"msLaunchUri"in t,"msSaveBlob"in t])>=3&&!N()}function R(){var e=window,t=navigator;return A(["webkitPersistentStorage"in t,"webkitTemporaryStorage"in t,0===t.vendor.indexOf("Google"),"webkitResolveLocalFileSystemURL"in e,"BatteryManager"in e,"webkitMediaStream"in e,"webkitSpeechGrammar"in e])>=5}function F(){var e=window,t=navigator;return A(["ApplePayError"in e,"CSSPrimitiveValue"in e,"Counter"in e,0===t.vendor.indexOf("Apple"),"getStorageUpdates"in t,"WebKitMediaKeys"in e])>=4}function G(){var e=window;return A(["safari"in e,!("DeviceMotionEvent"in e),!("ongestureend"in e),!("standalone"in navigator)])>=3}function W(){var e,t,o=window;return A(["buildID"in navigator,"MozAppearance"in(null!==(t=null===(e=document.documentElement)||void 0===e?void 0:e.style)&&void 0!==t?t:{}),"onmozfullscreenchange"in o,"mozInnerScreenX"in o,"CSSMozDocumentRule"in o,"CanvasCaptureMediaStream"in o])>=4}function $(){var e=window;return A([!("MediaSettingsRange"in e),"RTCEncodedAudioFrame"in e,""+e.Intl==="[object Intl]",""+e.Reflect==="[object Reflect]"])>=3}function U(){var e=window;return A(["DOMRectList"in e,"RTCPeerConnectionIceEvent"in e,"SVGGeometryElement"in e,"ontransitioncancel"in e])>=3}function X(){if("iPad"===navigator.platform)return!0;var e=screen,t=e.width/e.height;return A(["MediaSource"in window,!!Element.prototype.webkitRequestFullscreen,t>.65&&t<1.53])>=2}function Y(){var e=document;return e.fullscreenElement||e.msFullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||null}function Z(){var e=document;return(e.exitFullscreen||e.msExitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen).call(e)}function q(){var e=R(),t=W();if(!e&&!t)return!1;var o=window;return A(["onorientationchange"in o,"orientation"in o,e&&!("SharedWorker"in o),t&&/android/i.test(navigator.appVersion)])>=2}function K(){var e=window,t=e.OfflineAudioContext||e.webkitOfflineAudioContext;if(!t)return-2;if(J())return-1;var o=4500,n=5e3,i=new t(1,n,44100),s=i.createOscillator();s.type="triangle",s.frequency.value=1e4;var a=i.createDynamicsCompressor();a.threshold.value=-50,a.knee.value=40,a.ratio.value=12,a.attack.value=0,a.release.value=.25,s.connect(a),a.connect(i.destination),s.start(0);var r=Q(i),c=r[0],l=r[1],d=c.then((function(e){return ee(e.getChannelData(0).subarray(o))}),(function(e){if("timeout"===e.name||"suspended"===e.name)return-3;throw e}));return g(d),function(){return l(),d}}function J(){return F()&&!G()&&!U()}function Q(e){var t=3,o=500,n=500,i=5e3,s=function(){},a=new Promise((function(a,r){var c=!1,l=0,d=0;e.oncomplete=function(e){return a(e.renderedBuffer)};var u=function(){setTimeout((function(){return r(te("timeout"))}),Math.min(n,d+i-Date.now()))},p=function(){try{var n=e.startRendering();switch(m(n)&&g(n),e.state){case"running":d=Date.now(),c&&u();break;case"suspended":document.hidden||l++,c&&l>=t?r(te("suspended")):setTimeout(p,o);break}}catch(i){r(i)}};p(),s=function(){c||(c=!0,d>0&&u())}}));return[a,s]}function ee(e){for(var t=0,o=0;o<e.length;++o)t+=Math.abs(e[o]);return t}function te(e){var t=new Error(e);return t.name=e,t}function oe(e,t,o){var n,i,s;return void 0===o&&(o=50),l(this,void 0,void 0,(function(){var a,r;return d(this,(function(c){switch(c.label){case 0:a=document,c.label=1;case 1:return a.body?[3,3]:[4,h(o)];case 2:return c.sent(),[3,1];case 3:r=a.createElement("iframe"),c.label=4;case 4:return c.trys.push([4,,10,11]),[4,new Promise((function(e,o){var n=!1,i=function(){n=!0,e()},s=function(e){n=!0,o(e)};r.onload=i,r.onerror=s;var c=r.style;c.setProperty("display","block","important"),c.position="absolute",c.top="0",c.left="0",c.visibility="hidden",t&&"srcdoc"in r?r.srcdoc=t:r.src="about:blank",a.body.appendChild(r);var l=function(){var e,t;n||("complete"===(null===(t=null===(e=r.contentWindow)||void 0===e?void 0:e.document)||void 0===t?void 0:t.readyState)?i():setTimeout(l,10))};l()}))];case 5:c.sent(),c.label=6;case 6:return(null===(i=null===(n=r.contentWindow)||void 0===n?void 0:n.document)||void 0===i?void 0:i.body)?[3,8]:[4,h(o)];case 7:return c.sent(),[3,6];case 8:return[4,e(r,r.contentWindow)];case 9:return[2,c.sent()];case 10:return null===(s=r.parentNode)||void 0===s||s.removeChild(r),[7];case 11:return[2]}}))}))}function ne(e){for(var t=H(e),o=t[0],n=t[1],i=document.createElement(null!==o&&void 0!==o?o:"div"),s=0,a=Object.keys(n);s<a.length;s++){var r=a[s],c=n[r].join(" ");"style"===r?ie(i.style,c):i.setAttribute(r,c)}return i}function ie(e,t){for(var o=0,n=t.split(";");o<n.length;o++){var i=n[o],s=/^\s*([\w-]+)\s*:\s*(.+?)(\s*!([\w-]+))?\s*$/.exec(i);if(s){var a=s[1],r=s[2],c=s[4];e.setProperty(a,r,c||"")}}}var se="mmMwWLliI0O&1",ae="48px",re=["monospace","sans-serif","serif"],ce=["sans-serif-thin","ARNO PRO","Agency FB","Arabic Typesetting","Arial Unicode MS","AvantGarde Bk BT","BankGothic Md BT","Batang","Bitstream Vera Sans Mono","Calibri","Century","Century Gothic","Clarendon","EUROSTILE","Franklin Gothic","Futura Bk BT","Futura Md BT","GOTHAM","Gill Sans","HELV","Haettenschweiler","Helvetica Neue","Humanst521 BT","Leelawadee","Letter Gothic","Levenim MT","Lucida Bright","Lucida Sans","Menlo","MS Mincho","MS Outlook","MS Reference Specialty","MS UI Gothic","MT Extra","MYRIAD PRO","Marlett","Meiryo UI","Microsoft Uighur","Minion Pro","Monotype Corsiva","PMingLiU","Pristina","SCRIPTINA","Segoe UI Light","Serifa","SimHei","Small Fonts","Staccato222 BT","TRAJAN PRO","Univers CE 55 Medium","Vrinda","ZWAdobeF"];function le(){return oe((function(e,t){var o=t.document,n=o.body;n.style.fontSize=ae;var i=o.createElement("div"),s={},a={},r=function(e){var t=o.createElement("span"),n=t.style;return n.position="absolute",n.top="0",n.left="0",n.fontFamily=e,t.textContent=se,i.appendChild(t),t},c=function(e,t){return r("'".concat(e,"',").concat(t))},l=function(){return re.map(r)},d=function(){for(var e={},t=function(t){e[t]=re.map((function(e){return c(t,e)}))},o=0,n=ce;o<n.length;o++){var i=n[o];t(i)}return e},u=function(e){return re.some((function(t,o){return e[o].offsetWidth!==s[t]||e[o].offsetHeight!==a[t]}))},p=l(),h=d();n.appendChild(i);for(var f=0;f<re.length;f++)s[re[f]]=p[f].offsetWidth,a[re[f]]=p[f].offsetHeight;return ce.filter((function(e){return u(h[e])}))}))}function de(){var e=navigator.plugins;if(e){for(var t=[],o=0;o<e.length;++o){var n=e[o];if(n){for(var i=[],s=0;s<n.length;++s){var a=n[s];i.push({type:a.type,suffixes:a.suffixes})}t.push({name:n.name,description:n.description,mimeTypes:i})}}return t}}function ue(){var e,t,o=!1,n=pe(),i=n[0],s=n[1];if(he(i,s)){o=fe(s),me(i,s);var a=be(i),r=be(i);a!==r?e=t="unstable":(t=a,ve(i,s),e=be(i))}else e=t="";return{winding:o,geometry:e,text:t}}function pe(){var e=document.createElement("canvas");return e.width=1,e.height=1,[e,e.getContext("2d")]}function he(e,t){return!(!t||!e.toDataURL)}function fe(e){return e.rect(0,0,10,10),e.rect(2,2,6,6),!e.isPointInPath(5,5,"evenodd")}function me(e,t){e.width=240,e.height=60,t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(100,1,62,20),t.fillStyle="#069",t.font='11pt "Times New Roman"';var o="Cwm fjordbank gly ".concat(String.fromCharCode(55357,56835));t.fillText(o,2,15),t.fillStyle="rgba(102, 204, 0, 0.2)",t.font="18pt Arial",t.fillText(o,4,45)}function ve(e,t){e.width=122,e.height=110,t.globalCompositeOperation="multiply";for(var o=0,n=[["#f2f",40,40],["#2ff",80,40],["#ff2",60,80]];o<n.length;o++){var i=n[o],s=i[0],a=i[1],r=i[2];t.fillStyle=s,t.beginPath(),t.arc(a,r,40,0,2*Math.PI,!0),t.closePath(),t.fill()}t.fillStyle="#f9c",t.arc(60,60,60,0,2*Math.PI,!0),t.arc(60,60,20,0,2*Math.PI,!0),t.fill("evenodd")}function be(e){return e.toDataURL()}function ge(){var e,t=navigator,o=0;void 0!==t.maxTouchPoints?o=T(t.maxTouchPoints):void 0!==t.msMaxTouchPoints&&(o=t.msMaxTouchPoints);try{document.createEvent("TouchEvent"),e=!0}catch(i){e=!1}var n="ontouchstart"in window;return{maxTouchPoints:o,touchEvent:e,touchStart:n}}function ye(){return navigator.oscpu}function we(){var e=navigator,t=[],o=e.language||e.userLanguage||e.browserLanguage||e.systemLanguage;if(void 0!==o&&t.push([o]),Array.isArray(e.languages))R()&&$()||t.push(e.languages);else if("string"===typeof e.languages){var n=e.languages;n&&t.push(n.split(","))}return t}function xe(){return window.screen.colorDepth}function Se(){return _(P(navigator.deviceMemory),void 0)}function Ie(){var e=screen,t=function(e){return _(T(e),null)},o=[t(e.width),t(e.height)];return o.sort().reverse(),o}var ke,Oe,je=2500,Ce=10;function Ee(){if(void 0===Oe){var e=function(){var t=_e();Ae(t)?Oe=setTimeout(e,je):(ke=t,Oe=void 0)};e()}}function Te(){var e=this;return Ee(),function(){return l(e,void 0,void 0,(function(){var e;return d(this,(function(t){switch(t.label){case 0:return e=_e(),Ae(e)?ke?[2,u([],ke,!0)]:Y()?[4,Z()]:[3,2]:[3,2];case 1:t.sent(),e=_e(),t.label=2;case 2:return Ae(e)||(ke=e),[2,e]}}))}))}}function Pe(){var e=this,t=Te();return function(){return l(e,void 0,void 0,(function(){var e,o;return d(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return e=n.sent(),o=function(e){return null===e?null:M(e,Ce)},[2,[o(e[0]),o(e[1]),o(e[2]),o(e[3])]]}}))}))}}function _e(){var e=screen;return[_(P(e.availTop),null),_(P(e.width)-P(e.availWidth)-_(P(e.availLeft),0),null),_(P(e.height)-P(e.availHeight)-_(P(e.availTop),0),null),_(P(e.availLeft),null)]}function Ae(e){for(var t=0;t<4;++t)if(e[t])return!1;return!0}function Me(){return _(T(navigator.hardwareConcurrency),void 0)}function He(){var e,t=null===(e=window.Intl)||void 0===e?void 0:e.DateTimeFormat;if(t){var o=(new t).resolvedOptions().timeZone;if(o)return o}var n=-ze();return"UTC".concat(n>=0?"+":"").concat(Math.abs(n))}function ze(){var e=(new Date).getFullYear();return Math.max(P(new Date(e,0,1).getTimezoneOffset()),P(new Date(e,6,1).getTimezoneOffset()))}function Le(){try{return!!window.sessionStorage}catch(e){return!0}}function De(){try{return!!window.localStorage}catch(e){return!0}}function Be(){if(!N()&&!V())try{return!!window.indexedDB}catch(e){return!0}}function Ne(){return!!window.openDatabase}function Ve(){return navigator.cpuClass}function Re(){var e=navigator.platform;return"MacIntel"===e&&F()&&!G()?X()?"iPad":"iPhone":e}function Fe(){return navigator.vendor||""}function Ge(){for(var e=[],t=0,o=["chrome","safari","__crWeb","__gCrWeb","yandex","__yb","__ybro","__firefox__","__edgeTrackingPreventionStatistics","webkit","oprt","samsungAr","ucweb","UCShellJava","puffinDevice"];t<o.length;t++){var n=o[t],i=window[n];i&&"object"===typeof i&&e.push(n)}return e.sort()}function We(){var e=document;try{e.cookie="cookietest=1; SameSite=Strict;";var t=-1!==e.cookie.indexOf("cookietest=");return e.cookie="cookietest=1; SameSite=Strict; expires=Thu, 01-Jan-1970 00:00:01 GMT",t}catch(o){return!1}}function $e(){var e=atob;return{abpIndo:["#Iklan-Melayang","#Kolom-Iklan-728","#SidebarIklan-wrapper",e("YVt0aXRsZT0iN25hZ2EgcG9rZXIiIGld"),'[title="ALIENBOLA" i]'],abpvn:["#quangcaomb",e("Lmlvc0Fkc2lvc0Fkcy1sYXlvdXQ="),".quangcao",e("W2hyZWZePSJodHRwczovL3I4OC52bi8iXQ=="),e("W2hyZWZePSJodHRwczovL3piZXQudm4vIl0=")],adBlockFinland:[".mainostila",e("LnNwb25zb3JpdA=="),".ylamainos",e("YVtocmVmKj0iL2NsaWNrdGhyZ2guYXNwPyJd"),e("YVtocmVmXj0iaHR0cHM6Ly9hcHAucmVhZHBlYWsuY29tL2FkcyJd")],adBlockPersian:["#navbar_notice_50",".kadr",'TABLE[width="140px"]',"#divAgahi",e("I2FkMl9pbmxpbmU=")],adBlockWarningRemoval:["#adblock-honeypot",".adblocker-root",".wp_adblock_detect",e("LmhlYWRlci1ibG9ja2VkLWFk"),e("I2FkX2Jsb2NrZXI=")],adGuardAnnoyances:['amp-embed[type="zen"]',".hs-sosyal","#cookieconsentdiv",'div[class^="app_gdpr"]',".as-oil"],adGuardBase:[".BetterJsPopOverlay",e("I2FkXzMwMFgyNTA="),e("I2Jhbm5lcmZsb2F0MjI="),e("I2FkLWJhbm5lcg=="),e("I2NhbXBhaWduLWJhbm5lcg==")],adGuardChinese:[e("LlppX2FkX2FfSA=="),e("YVtocmVmKj0iL29kMDA1LmNvbSJd"),e("YVtocmVmKj0iLmh0aGJldDM0LmNvbSJd"),".qq_nr_lad","#widget-quan"],adGuardFrench:[e("I2Jsb2NrLXZpZXdzLWFkcy1zaWRlYmFyLWJsb2NrLWJsb2Nr"),"#pavePub",e("LmFkLWRlc2t0b3AtcmVjdGFuZ2xl"),".mobile_adhesion",".widgetadv"],adGuardGerman:[e("LmJhbm5lcml0ZW13ZXJidW5nX2hlYWRfMQ=="),e("LmJveHN0YXJ0d2VyYnVuZw=="),e("LndlcmJ1bmcz"),e("YVtocmVmXj0iaHR0cDovL3d3dy5laXMuZGUvaW5kZXgucGh0bWw/cmVmaWQ9Il0="),e("YVtocmVmXj0iaHR0cHM6Ly93d3cudGlwaWNvLmNvbS8/YWZmaWxpYXRlSWQ9Il0=")],adGuardJapanese:["#kauli_yad_1",e("YVtocmVmXj0iaHR0cDovL2FkMi50cmFmZmljZ2F0ZS5uZXQvIl0="),e("Ll9wb3BJbl9pbmZpbml0ZV9hZA=="),e("LmFkZ29vZ2xl"),e("LmFkX3JlZ3VsYXIz")],adGuardMobile:[e("YW1wLWF1dG8tYWRz"),e("LmFtcF9hZA=="),'amp-embed[type="24smi"]',"#mgid_iframe1",e("I2FkX2ludmlld19hcmVh")],adGuardRussian:[e("YVtocmVmXj0iaHR0cHM6Ly9hZC5sZXRtZWFkcy5jb20vIl0="),e("LnJlY2xhbWE="),'div[id^="smi2adblock"]',e("ZGl2W2lkXj0iQWRGb3hfYmFubmVyXyJd"),e("I2FkX3NxdWFyZQ==")],adGuardSocial:[e("YVtocmVmXj0iLy93d3cuc3R1bWJsZXVwb24uY29tL3N1Ym1pdD91cmw9Il0="),e("YVtocmVmXj0iLy90ZWxlZ3JhbS5tZS9zaGFyZS91cmw/Il0="),".etsy-tweet","#inlineShare",".popup-social"],adGuardSpanishPortuguese:["#barraPublicidade","#Publicidade","#publiEspecial","#queTooltip",e("W2hyZWZePSJodHRwOi8vYWRzLmdsaXNwYS5jb20vIl0=")],adGuardTrackingProtection:["#qoo-counter",e("YVtocmVmXj0iaHR0cDovL2NsaWNrLmhvdGxvZy5ydS8iXQ=="),e("YVtocmVmXj0iaHR0cDovL2hpdGNvdW50ZXIucnUvdG9wL3N0YXQucGhwIl0="),e("YVtocmVmXj0iaHR0cDovL3RvcC5tYWlsLnJ1L2p1bXAiXQ=="),"#top100counter"],adGuardTurkish:["#backkapat",e("I3Jla2xhbWk="),e("YVtocmVmXj0iaHR0cDovL2Fkc2Vydi5vbnRlay5jb20udHIvIl0="),e("YVtocmVmXj0iaHR0cDovL2l6bGVuemkuY29tL2NhbXBhaWduLyJd"),e("YVtocmVmXj0iaHR0cDovL3d3dy5pbnN0YWxsYWRzLm5ldC8iXQ==")],bulgarian:[e("dGQjZnJlZW5ldF90YWJsZV9hZHM="),"#ea_intext_div",".lapni-pop-over","#xenium_hot_offers",e("I25ld0Fk")],easyList:[e("I0FEX0NPTlRST0xfMjg="),e("LnNlY29uZC1wb3N0LWFkcy13cmFwcGVy"),".universalboxADVBOX03",e("LmFkdmVydGlzZW1lbnQtNzI4eDkw"),e("LnNxdWFyZV9hZHM=")],easyListChina:[e("YVtocmVmKj0iLndlbnNpeHVldGFuZy5jb20vIl0="),e("LmFwcGd1aWRlLXdyYXBbb25jbGljayo9ImJjZWJvcy5jb20iXQ=="),e("LmZyb250cGFnZUFkdk0="),"#taotaole","#aafoot.top_box"],easyListCookie:["#AdaCompliance.app-notice",".text-center.rgpd",".panel--cookie",".js-cookies-andromeda",".elxtr-consent"],easyListCzechSlovak:["#onlajny-stickers",e("I3Jla2xhbW5pLWJveA=="),e("LnJla2xhbWEtbWVnYWJvYXJk"),".sklik",e("W2lkXj0ic2tsaWtSZWtsYW1hIl0=")],easyListDutch:[e("I2FkdmVydGVudGll"),e("I3ZpcEFkbWFya3RCYW5uZXJCbG9jaw=="),".adstekst",e("YVtocmVmXj0iaHR0cHM6Ly94bHR1YmUubmwvY2xpY2svIl0="),"#semilo-lrectangle"],easyListGermany:[e("I0FkX1dpbjJkYXk="),e("I3dlcmJ1bmdzYm94MzAw"),e("YVtocmVmXj0iaHR0cDovL3d3dy5yb3RsaWNodGthcnRlaS5jb20vP3NjPSJd"),e("I3dlcmJ1bmdfd2lkZXNreXNjcmFwZXJfc2NyZWVu"),e("YVtocmVmXj0iaHR0cDovL2xhbmRpbmcucGFya3BsYXR6a2FydGVpLmNvbS8/YWc9Il0=")],easyListItaly:[e("LmJveF9hZHZfYW5udW5jaQ=="),".sb-box-pubbliredazionale",e("YVtocmVmXj0iaHR0cDovL2FmZmlsaWF6aW9uaWFkcy5zbmFpLml0LyJd"),e("YVtocmVmXj0iaHR0cHM6Ly9hZHNlcnZlci5odG1sLml0LyJd"),e("YVtocmVmXj0iaHR0cHM6Ly9hZmZpbGlhemlvbmlhZHMuc25haS5pdC8iXQ==")],easyListLithuania:[e("LnJla2xhbW9zX3RhcnBhcw=="),e("LnJla2xhbW9zX251b3JvZG9z"),e("aW1nW2FsdD0iUmVrbGFtaW5pcyBza3lkZWxpcyJd"),e("aW1nW2FsdD0iRGVkaWt1b3RpLmx0IHNlcnZlcmlhaSJd"),e("aW1nW2FsdD0iSG9zdGluZ2FzIFNlcnZlcmlhaS5sdCJd")],estonian:[e("QVtocmVmKj0iaHR0cDovL3BheTRyZXN1bHRzMjQuZXUiXQ==")],fanboyAnnoyances:["#feedback-tab","#taboola-below-article",".feedburnerFeedBlock",".widget-feedburner-counter",'[title="Subscribe to our blog"]'],fanboyAntiFacebook:[".util-bar-module-firefly-visible"],fanboyEnhancedTrackers:[".open.pushModal","#issuem-leaky-paywall-articles-zero-remaining-nag","#sovrn_container",'div[class$="-hide"][zoompage-fontsize][style="display: block;"]',".BlockNag__Card"],fanboySocial:[".td-tags-and-social-wrapper-box",".twitterContainer",".youtube-social",'a[title^="Like us on Facebook"]','img[alt^="Share on Digg"]'],frellwitSwedish:[e("YVtocmVmKj0iY2FzaW5vcHJvLnNlIl1bdGFyZ2V0PSJfYmxhbmsiXQ=="),e("YVtocmVmKj0iZG9rdG9yLXNlLm9uZWxpbmsubWUiXQ=="),"article.category-samarbete",e("ZGl2LmhvbGlkQWRz"),"ul.adsmodern"],greekAdBlock:[e("QVtocmVmKj0iYWRtYW4ub3RlbmV0LmdyL2NsaWNrPyJd"),e("QVtocmVmKj0iaHR0cDovL2F4aWFiYW5uZXJzLmV4b2R1cy5nci8iXQ=="),e("QVtocmVmKj0iaHR0cDovL2ludGVyYWN0aXZlLmZvcnRobmV0LmdyL2NsaWNrPyJd"),"DIV.agores300","TABLE.advright"],hungarian:["#cemp_doboz",".optimonk-iframe-container",e("LmFkX19tYWlu"),e("W2NsYXNzKj0iR29vZ2xlQWRzIl0="),"#hirdetesek_box"],iDontCareAboutCookies:['.alert-info[data-block-track*="CookieNotice"]',".ModuleTemplateCookieIndicator",".o--cookies--container",".cookie-msg-info-container","#cookies-policy-sticky"],icelandicAbp:[e("QVtocmVmXj0iL2ZyYW1ld29yay9yZXNvdXJjZXMvZm9ybXMvYWRzLmFzcHgiXQ==")],latvian:[e("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiAxMjBweDsgaGVpZ2h0OiA0MHB4OyBvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjogcmVsYXRpdmU7Il0="),e("YVtocmVmPSJodHRwOi8vd3d3LnNhbGlkemluaS5sdi8iXVtzdHlsZT0iZGlzcGxheTogYmxvY2s7IHdpZHRoOiA4OHB4OyBoZWlnaHQ6IDMxcHg7IG92ZXJmbG93OiBoaWRkZW47IHBvc2l0aW9uOiByZWxhdGl2ZTsiXQ==")],listKr:[e("YVtocmVmKj0iLy9hZC5wbGFuYnBsdXMuY28ua3IvIl0="),e("I2xpdmVyZUFkV3JhcHBlcg=="),e("YVtocmVmKj0iLy9hZHYuaW1hZHJlcC5jby5rci8iXQ=="),e("aW5zLmZhc3R2aWV3LWFk"),".revenue_unit_item.dable"],listeAr:[e("LmdlbWluaUxCMUFk"),".right-and-left-sponsers",e("YVtocmVmKj0iLmFmbGFtLmluZm8iXQ=="),e("YVtocmVmKj0iYm9vcmFxLm9yZyJd"),e("YVtocmVmKj0iZHViaXp6bGUuY29tL2FyLz91dG1fc291cmNlPSJd")],listeFr:[e("YVtocmVmXj0iaHR0cDovL3Byb21vLnZhZG9yLmNvbS8iXQ=="),e("I2FkY29udGFpbmVyX3JlY2hlcmNoZQ=="),e("YVtocmVmKj0id2Vib3JhbWEuZnIvZmNnaS1iaW4vIl0="),".site-pub-interstitiel",'div[id^="crt-"][data-criteo-id]'],officialPolish:["#ceneo-placeholder-ceneo-12",e("W2hyZWZePSJodHRwczovL2FmZi5zZW5kaHViLnBsLyJd"),e("YVtocmVmXj0iaHR0cDovL2Fkdm1hbmFnZXIudGVjaGZ1bi5wbC9yZWRpcmVjdC8iXQ=="),e("YVtocmVmXj0iaHR0cDovL3d3dy50cml6ZXIucGwvP3V0bV9zb3VyY2UiXQ=="),e("ZGl2I3NrYXBpZWNfYWQ=")],ro:[e("YVtocmVmXj0iLy9hZmZ0cmsuYWx0ZXgucm8vQ291bnRlci9DbGljayJd"),'a[href^="/magazin/"]',e("YVtocmVmXj0iaHR0cHM6Ly9ibGFja2ZyaWRheXNhbGVzLnJvL3Ryay9zaG9wLyJd"),e("YVtocmVmXj0iaHR0cHM6Ly9ldmVudC4ycGVyZm9ybWFudC5jb20vZXZlbnRzL2NsaWNrIl0="),e("YVtocmVmXj0iaHR0cHM6Ly9sLnByb2ZpdHNoYXJlLnJvLyJd")],ruAd:[e("YVtocmVmKj0iLy9mZWJyYXJlLnJ1LyJd"),e("YVtocmVmKj0iLy91dGltZy5ydS8iXQ=="),e("YVtocmVmKj0iOi8vY2hpa2lkaWtpLnJ1Il0="),"#pgeldiz",".yandex-rtb-block"],thaiAds:["a[href*=macau-uta-popup]",e("I2Fkcy1nb29nbGUtbWlkZGxlX3JlY3RhbmdsZS1ncm91cA=="),e("LmFkczMwMHM="),".bumq",".img-kosana"],webAnnoyancesUltralist:["#mod-social-share-2","#social-tools",e("LmN0cGwtZnVsbGJhbm5lcg=="),".zergnet-recommend",".yt.btn-link.btn-md.btn"]}}function Ue(e){var t=void 0===e?{}:e,o=t.debug;return l(this,void 0,void 0,(function(){var e,t,n,i,s,a;return d(this,(function(r){switch(r.label){case 0:return Xe()?(e=$e(),t=Object.keys(e),n=(a=[]).concat.apply(a,t.map((function(t){return e[t]}))),[4,Ye(n)]):[2,void 0];case 1:return i=r.sent(),o&&qe(e,i),s=t.filter((function(t){var o=e[t],n=A(o.map((function(e){return i[e]})));return n>.6*o.length})),s.sort(),[2,s]}}))}))}function Xe(){return F()||q()}function Ye(e){var t;return l(this,void 0,void 0,(function(){var o,n,i,s,a,r,c;return d(this,(function(l){switch(l.label){case 0:for(o=document,n=o.createElement("div"),i=new Array(e.length),s={},Ze(n),c=0;c<e.length;++c)a=ne(e[c]),r=o.createElement("div"),Ze(r),r.appendChild(a),n.appendChild(r),i[c]=a;l.label=1;case 1:return o.body?[3,3]:[4,h(50)];case 2:return l.sent(),[3,1];case 3:o.body.appendChild(n);try{for(c=0;c<e.length;++c)i[c].offsetParent||(s[e[c]]=!0)}finally{null===(t=n.parentNode)||void 0===t||t.removeChild(n)}return[2,s]}}))}))}function Ze(e){e.style.setProperty("display","block","important")}function qe(e,t){for(var o=0,n=Object.keys(e);o<n.length;o++){var i=n[o];"\n".concat(i,":");for(var s=0,a=e[i];s<a.length;s++){var r=a[s];"\n  ".concat(t[r]?"🚫":"➡️"," ").concat(r)}}}function Ke(){for(var e=0,t=["rec2020","p3","srgb"];e<t.length;e++){var o=t[e];if(matchMedia("(color-gamut: ".concat(o,")")).matches)return o}}function Je(){return!!Qe("inverted")||!Qe("none")&&void 0}function Qe(e){return matchMedia("(inverted-colors: ".concat(e,")")).matches}function et(){return!!tt("active")||!tt("none")&&void 0}function tt(e){return matchMedia("(forced-colors: ".concat(e,")")).matches}var ot=100;function nt(){if(matchMedia("(min-monochrome: 0)").matches){for(var e=0;e<=ot;++e)if(matchMedia("(max-monochrome: ".concat(e,")")).matches)return e;throw new Error("Too high value")}}function it(){return st("no-preference")?0:st("high")||st("more")?1:st("low")||st("less")?-1:st("forced")?10:void 0}function st(e){return matchMedia("(prefers-contrast: ".concat(e,")")).matches}function at(){return!!rt("reduce")||!rt("no-preference")&&void 0}function rt(e){return matchMedia("(prefers-reduced-motion: ".concat(e,")")).matches}function ct(){return!!lt("high")||!lt("standard")&&void 0}function lt(e){return matchMedia("(dynamic-range: ".concat(e,")")).matches}var dt=Math,ut=function(){return 0};function pt(){var e=dt.acos||ut,t=dt.acosh||ut,o=dt.asin||ut,n=dt.asinh||ut,i=dt.atanh||ut,s=dt.atan||ut,a=dt.sin||ut,r=dt.sinh||ut,c=dt.cos||ut,l=dt.cosh||ut,d=dt.tan||ut,u=dt.tanh||ut,p=dt.exp||ut,h=dt.expm1||ut,f=dt.log1p||ut,m=function(e){return dt.pow(dt.PI,e)},v=function(e){return dt.log(e+dt.sqrt(e*e-1))},b=function(e){return dt.log(e+dt.sqrt(e*e+1))},g=function(e){return dt.log((1+e)/(1-e))/2},y=function(e){return dt.exp(e)-1/dt.exp(e)/2},w=function(e){return(dt.exp(e)+1/dt.exp(e))/2},x=function(e){return dt.exp(e)-1},S=function(e){return(dt.exp(2*e)-1)/(dt.exp(2*e)+1)},I=function(e){return dt.log(1+e)};return{acos:e(.12312423423423424),acosh:t(1e308),acoshPf:v(1e154),asin:o(.12312423423423424),asinh:n(1),asinhPf:b(1),atanh:i(.5),atanhPf:g(.5),atan:s(.5),sin:a(-1e300),sinh:r(1),sinhPf:y(1),cos:c(10.000000000123),cosh:l(1),coshPf:w(1),tan:d(-1e300),tanh:u(1),tanhPf:S(1),exp:p(1),expm1:h(1),expm1Pf:x(1),log1p:f(10),log1pPf:I(10),powPI:m(-100)}}var ht="mmMwWLliI0fiflO&1",ft={default:[],apple:[{font:"-apple-system-body"}],serif:[{fontFamily:"serif"}],sans:[{fontFamily:"sans-serif"}],mono:[{fontFamily:"monospace"}],min:[{fontSize:"1px"}],system:[{fontFamily:"system-ui"}]};function mt(){return vt((function(e,t){for(var o={},n={},i=0,s=Object.keys(ft);i<s.length;i++){var a=s[i],r=ft[a],c=r[0],l=void 0===c?{}:c,d=r[1],u=void 0===d?ht:d,p=e.createElement("span");p.textContent=u,p.style.whiteSpace="nowrap";for(var h=0,f=Object.keys(l);h<f.length;h++){var m=f[h],v=l[m];void 0!==v&&(p.style[m]=v)}o[a]=p,t.appendChild(e.createElement("br")),t.appendChild(p)}for(var b=0,g=Object.keys(ft);b<g.length;b++){a=g[b];n[a]=o[a].getBoundingClientRect().width}return n}))}function vt(e,t){return void 0===t&&(t=4e3),oe((function(o,n){var i=n.document,s=i.body,a=s.style;a.width="".concat(t,"px"),a.webkitTextSizeAdjust=a.textSizeAdjust="none",R()?s.style.zoom="".concat(1/n.devicePixelRatio):F()&&(s.style.zoom="reset");var r=i.createElement("div");return r.textContent=u([],Array(t/20<<0),!0).map((function(){return"word"})).join(" "),s.appendChild(r),e(i,s)}),'<!doctype html><html><head><meta name="viewport" content="width=device-width, initial-scale=1">')}function bt(){var e,t=document.createElement("canvas"),o=null!==(e=t.getContext("webgl"))&&void 0!==e?e:t.getContext("experimental-webgl");if(o&&"getExtension"in o){var n=o.getExtension("WEBGL_debug_renderer_info");if(n)return{vendor:(o.getParameter(n.UNMASKED_VENDOR_WEBGL)||"").toString(),renderer:(o.getParameter(n.UNMASKED_RENDERER_WEBGL)||"").toString()}}}function gt(){return navigator.pdfViewerEnabled}function yt(){var e=new Float32Array(1),t=new Uint8Array(e.buffer);return e[0]=1/0,e[0]=e[0]-e[0],t[3]}var wt={fonts:le,domBlockers:Ue,fontPreferences:mt,audio:K,screenFrame:Pe,osCpu:ye,languages:we,colorDepth:xe,deviceMemory:Se,screenResolution:Ie,hardwareConcurrency:Me,timezone:He,sessionStorage:Le,localStorage:De,indexedDB:Be,openDatabase:Ne,cpuClass:Ve,platform:Re,plugins:de,canvas:ue,touchSupport:ge,vendor:Fe,vendorFlavors:Ge,cookiesEnabled:We,colorGamut:Ke,invertedColors:Je,forcedColors:et,monochrome:nt,contrast:it,reducedMotion:at,hdr:ct,math:pt,videoCard:bt,pdfViewerEnabled:gt,architecture:yt};function xt(e){return B(wt,e,[])}var St="$ if upgrade to Pro: https://fpjs.dev/pro";function It(e){var t=kt(e),o=Ot(t);return{score:t,comment:St.replace(/\$/g,"".concat(o))}}function kt(e){if(q())return.4;if(F())return G()?.5:.3;var t=e.platform.value||"";return/^Win/.test(t)?.6:/^Mac/.test(t)?.5:.7}function Ot(e){return M(.99+.01*e,1e-4)}function jt(e){for(var t="",o=0,n=Object.keys(e).sort();o<n.length;o++){var i=n[o],s=e[i],a=s.error?"error":JSON.stringify(s.value);t+="".concat(t?"|":"").concat(i.replace(/([:|\\])/g,"\\$1"),":").concat(a)}return t}function Ct(e){return JSON.stringify(e,(function(e,t){return t instanceof Error?j(t):t}),2)}function Et(e){return O(jt(e))}function Tt(e){var t,o=It(e);return{get visitorId(){return void 0===t&&(t=Et(this.components)),t},set visitorId(e){t=e},confidence:o,components:e,version:p}}function Pt(e){return void 0===e&&(e=50),f(e,2*e)}function _t(e,t){Date.now();return{get:function(o){return l(this,void 0,void 0,(function(){var n,i;return d(this,(function(s){switch(s.label){case 0:return Date.now(),[4,e()];case 1:return n=s.sent(),i=Tt(n),t||null===o||void 0===o||o.debug,[2,i]}}))}))}}}function At(){if(!(window.__fpjs_d_m||Math.random()>=.001))try{var e=new XMLHttpRequest;e.open("get","https://m1.openfpcdn.io/fingerprintjs/v".concat(p,"/npm-monitoring"),!0),e.send()}catch(t){}}function Mt(e){var t=void 0===e?{}:e,o=t.delayFallback,n=t.debug,i=t.monitoring,s=void 0===i||i;return l(this,void 0,void 0,(function(){var e;return d(this,(function(t){switch(t.label){case 0:return s&&At(),[4,Pt(o)];case 1:return t.sent(),e=xt({debug:n}),[2,_t(e,n)]}}))}))}var Ht,zt,Lt,Dt,Bt,Nt,Vt,Rt,Ft,Gt,Wt,$t,Ut,Xt,Yt,Zt,qt,Kt,Jt,Qt,eo,to,oo,no,io,so,ao,ro,co,lo,uo,po,ho,fo,mo,vo,bo,go,yo={load:Mt,hashComponents:Et,componentsToDebugString:Ct};function wo(e){const t=ho[e],o=(window.funcLimits||[]).indexOf(t)>=0;let n=!1;switch(t){case 1:n=!!window.shareConfig.https;break;case 2:n=!!window.creatorCheckFlowPath;break;case 3:n=!0;break;case 4:n=!0;break;case 5:n=!!window.creatorLiveDetail;break;default:break}return n&&!o}(function(e){e[e["NoOpening"]=0]="NoOpening",e[e["Asteroid"]=1]="Asteroid",e[e["HorizontalCruise"]=2]="HorizontalCruise",e[e["AsteroidCruise"]=3]="AsteroidCruise",e[e["CrystalBall"]=4]="CrystalBall",e[e["AsteroidZoom"]=5]="AsteroidZoom"})(Ht||(Ht={})),function(e){e[e["closeCruising"]=0]="closeCruising",e[e["globalCruising"]=1]="globalCruising",e[e["customizeCruising"]=2]="customizeCruising"}(zt||(zt={})),function(e){e[e["None"]=0]="None",e[e["Sun"]=1]="Sun",e[e["Rain"]=2]="Rain",e[e["Snow"]=3]="Snow",e[e["Custom"]=4]="Custom",e[e["RedPackage"]=5]="RedPackage",e[e["GoldIngot"]=6]="GoldIngot",e[e["Love"]=7]="Love"}(Lt||(Lt={})),function(e){e[e["Small"]=0]="Small",e[e["Mid"]=1]="Mid",e[e["Big"]=2]="Big"}(Dt||(Dt={})),function(e){e[e["TopLeft"]=0]="TopLeft",e[e["BottomLeft"]=1]="BottomLeft",e[e["BottomRight"]=2]="BottomRight",e[e["TopRight"]=3]="TopRight",e[e["Left"]=4]="Left",e[e["Bottom"]=5]="Bottom",e[e["Right"]=6]="Right",e[e["Top"]=7]="Top",e[e["PT_LeftTop"]=8]="PT_LeftTop",e[e["PT_LeftBottom"]=9]="PT_LeftBottom",e[e["PT_RightTop"]=10]="PT_RightTop",e[e["PT_RightBottom"]=11]="PT_RightBottom"}(Bt||(Bt={})),function(e){e[e["NoBlend"]=0]="NoBlend",e[e["CrossBlend"]=1]="CrossBlend",e[e["ZoomBlend"]=2]="ZoomBlend",e[e["BlackOut"]=3]="BlackOut",e[e["WhiteOut"]=4]="WhiteOut",e[e["LeftToRight"]=5]="LeftToRight",e[e["RightToLeft"]=6]="RightToLeft",e[e["DiagonalBlend"]=7]="DiagonalBlend",e[e["CircleOpen"]=8]="CircleOpen",e[e["HorizontalOpen"]=9]="HorizontalOpen",e[e["VerticalOpen"]=10]="VerticalOpen",e[e["EllipticZoom"]=11]="EllipticZoom",e[e["StepForward"]=12]="StepForward"}(Nt||(Nt={})),function(e){e[e["DisplayMode_ClickShow"]=0]="DisplayMode_ClickShow",e[e["DisplayMode_AlwaysShow"]=1]="DisplayMode_AlwaysShow",e[e["DisplayMode_HoverShow"]=2]="DisplayMode_HoverShow",e[e["DisappearMode_NeverShowByUser"]=3]="DisappearMode_NeverShowByUser"}(Vt||(Vt={})),function(e){e[e["DisappearMode_ClickHidden"]=0]="DisappearMode_ClickHidden",e[e["DisappearMode_Never"]=1]="DisappearMode_Never",e[e["DisappearMode_OutFocusHidden"]=2]="DisappearMode_OutFocusHidden",e[e["DisappearMode_NeverHiddenByUser"]=3]="DisappearMode_NeverHiddenByUser"}(Rt||(Rt={})),function(e){e[e["Icon"]=0]="Icon",e[e["ActiveArea"]=1]="ActiveArea",e[e["Timer"]=2]="Timer",e[e["Switch"]=3]="Switch",e[e["Slider"]=4]="Slider",e[e["Dial"]=5]="Dial",e[e["Input"]=6]="Input"}(Ft||(Ft={})),function(e){e[e["Top_Direction"]=0]="Top_Direction",e[e["Bottom_Direction"]=1]="Bottom_Direction",e[e["Left_Direction"]=2]="Left_Direction",e[e["Right_Direction"]=3]="Right_Direction",e[e["Center_Direction"]=4]="Center_Direction"}(Gt||(Gt={})),function(e){e[e["LeftTop"]=0]="LeftTop",e[e["CenterTop"]=1]="CenterTop",e[e["RightTop"]=2]="RightTop",e[e["LefCenter"]=3]="LefCenter",e[e["Center"]=4]="Center",e[e["RightCenter"]=5]="RightCenter",e[e["LeftBottom"]=6]="LeftBottom",e[e["CenterBottom"]=7]="CenterBottom",e[e["RightBottom"]=8]="RightBottom"}(Wt||(Wt={})),function(e){e[e["SceneProgress"]=0]="SceneProgress",e[e["SceneAudioProgress"]=1]="SceneAudioProgress"}($t||($t={})),function(e){e[e["Horizontal_Mode"]=0]="Horizontal_Mode",e[e["Vertical_Mode"]=1]="Vertical_Mode"}(Ut||(Ut={})),function(e){e[e["ModelOriginalCenter"]=0]="ModelOriginalCenter",e[e["ModelActualCenter"]=1]="ModelActualCenter"}(Xt||(Xt={})),function(e){e[e["NoEffect"]=0]="NoEffect",e[e["Runninglamp"]=1]="Runninglamp",e[e["Upanddown"]=2]="Upanddown"}(Yt||(Yt={})),function(e){e[e["InfiniteLoop"]=0]="InfiniteLoop",e[e["FixedLoopIndex"]=1]="FixedLoopIndex"}(Zt||(Zt={})),function(e){e[e["StaticModel"]=0]="StaticModel",e[e["SkeletonModel"]=1]="SkeletonModel"}(qt||(qt={})),function(e){e[e["SceneType_2DNormal"]=0]="SceneType_2DNormal",e[e["SceneType_3DNormal"]=1]="SceneType_3DNormal",e[e["SceneType_VR"]=2]="SceneType_VR"}(Kt||(Kt={})),function(e){e[e["List"]=0]="List",e[e["Turntable"]=1]="Turntable"}(Jt||(Jt={})),function(e){e[e["DoubleRowTextShow"]=0]="DoubleRowTextShow",e[e["DoubleRowImageShow"]=1]="DoubleRowImageShow",e[e["SignalRowShow"]=2]="SignalRowShow",e[e["GroupSingleRowShow"]=3]="GroupSingleRowShow",e[e["GroupDoubleRowShow"]=4]="GroupDoubleRowShow"}(Qt||(Qt={})),function(e){e[e["FirstScene3d"]=0]="FirstScene3d",e[e["FirstScene"]=1]="FirstScene"}(eo||(eo={})),function(e){e[e["HotPotEnum_Label"]=2]="HotPotEnum_Label",e[e["HotPotEnum_Image"]=3]="HotPotEnum_Image",e[e["HotPotEnum_Video"]=4]="HotPotEnum_Video",e[e["HotPotEnum_Audio"]=5]="HotPotEnum_Audio",e[e["HotPotEnum_SceneSwitch"]=6]="HotPotEnum_SceneSwitch",e[e["HotPotEnum_ImageList"]=7]="HotPotEnum_ImageList",e[e["HotPotEnum_ImageTxt"]=8]="HotPotEnum_ImageTxt",e[e["HotPotEnum_Model"]=9]="HotPotEnum_Model",e[e["HotPotEnum_HyperLink"]=10]="HotPotEnum_HyperLink",e[e["HotPotEnum_Ring"]=20]="HotPotEnum_Ring",e[e["HotPotEnum_Live"]=21]="HotPotEnum_Live",e[e["HotPotEnum_App"]=23]="HotPotEnum_App",e[e["HotPotEnum_AudioImageTxt"]=52]="HotPotEnum_AudioImageTxt",e[e["HotPotEnum_CutOutVideo"]=54]="HotPotEnum_CutOutVideo"}(to||(to={})),function(e){e[e["sceneList"]=1]="sceneList",e[e["globalMusic"]=2]="globalMusic",e[e["fullScreen"]=3]="fullScreen",e[e["introduction"]=4]="introduction",e[e["sceneMusic"]=5]="sceneMusic",e[e["vrMode"]=6]="vrMode",e[e["gyro"]=7]="gyro",e[e["thumb"]=8]="thumb",e[e["views"]=9]="views",e[e["say"]=10]="say",e[e["share"]=11]="share",e[e["telephone"]=12]="telephone",e[e["logo"]=13]="logo",e[e["globalHotpot"]=20]="globalHotpot",e[e["globalSelector"]=21]="globalSelector",e[e["ClearScreen"]=22]="ClearScreen",e[e["goBack"]=23]="goBack",e[e["Compass"]=24]="Compass",e[e["DrawerAssembly"]=25]="DrawerAssembly"}(oo||(oo={})),function(e){e[e["PartsEnum_Label"]=2]="PartsEnum_Label",e[e["PartsEnum_Image"]=3]="PartsEnum_Image",e[e["PartsEnum_Video"]=4]="PartsEnum_Video",e[e["PartsEnum_SceneSwitch"]=6]="PartsEnum_SceneSwitch",e[e["PartsEnum_ImageList"]=7]="PartsEnum_ImageList",e[e["PartsEnum_Model"]=9]="PartsEnum_Model",e[e["PartsEnum_GIF"]=11]="PartsEnum_GIF",e[e["PartsEnum_Ring"]=20]="PartsEnum_Ring",e[e["PartsEnum_Live"]=22]="PartsEnum_Live",e[e["PartsEnum_App"]=23]="PartsEnum_App",e[e["PatrtsEnum_CutOutVideo"]=51]="PatrtsEnum_CutOutVideo",e[e["PartsEnum_Number"]=53]="PartsEnum_Number",e[e["PartsEnum_InputField"]=55]="PartsEnum_InputField",e[e["PartsEnum_Web"]=56]="PartsEnum_Web"}(no||(no={})),function(e){e[e["ImageType_2D"]=0]="ImageType_2D",e[e["ImageType_3D"]=1]="ImageType_3D",e[e["ImageType_VR"]=2]="ImageType_VR"}(io||(io={})),function(e){e[e["VideoType_2DNormal"]=0]="VideoType_2DNormal",e[e["VideoType_3DNormal"]=1]="VideoType_3DNormal",e[e["VideoType_VR"]=2]="VideoType_VR"}(so||(so={})),function(e){e[e["ShowStyle_Icon"]=0]="ShowStyle_Icon",e[e["ShowStyle_Label"]=1]="ShowStyle_Label",e[e["ShowStyle_Bubble"]=2]="ShowStyle_Bubble",e[e["ShowStyle_Polygon"]=3]="ShowStyle_Polygon"}(ao||(ao={})),function(e){e[e["And"]=1]="And",e[e["Or"]=2]="Or"}(ro||(ro={})),function(e){e[e["Open"]=1]="Open",e[e["Close"]=2]="Close"}(co||(co={})),function(e){e[e["Click"]=0]="Click",e[e["On"]=1]="On",e[e["Off"]=2]="Off",e[e["TimeOut"]=3]="TimeOut",e[e["Gear"]=4]="Gear"}(lo||(lo={})),function(e){e[e["BubbleStyle_Bubble"]=0]="BubbleStyle_Bubble",e[e["BubbleStyle_Dialog"]=1]="BubbleStyle_Dialog",e[e["BubbleStyle_Label"]=2]="BubbleStyle_Label",e[e["BubbleStyle_Custom"]=3]="BubbleStyle_Custom"}(uo||(uo={})),function(e){e[e["LivePanoramic"]=0]="LivePanoramic",e[e["Live2D"]=1]="Live2D"}(po||(po={})),function(e){e[e["Share"]=1]="Share",e[e["Flow"]=2]="Flow",e[e["Statistics"]=3]="Statistics",e[e["Talk"]=4]="Talk",e[e["Live"]=5]="Live"}(ho||(ho={})),function(e){e[e["NONE"]=0]="NONE",e[e["GENERAL"]=1]="GENERAL",e[e["REDUCE"]=2]="REDUCE"}(fo||(fo={})),function(e){e[e["normal"]=0]="normal",e[e["limit180"]=1]="limit180"}(mo||(mo={})),function(e){e[e["Horizontal"]=0]="Horizontal",e[e["Vertical"]=1]="Vertical"}(vo||(vo={})),function(e){e[e["SwitchAngle"]=0]="SwitchAngle",e[e["RollAngle"]=1]="RollAngle"}(bo||(bo={})),function(e){e[e["X_AXIS"]=0]="X_AXIS",e[e["Y_AXIS"]=1]="Y_AXIS"}(go||(go={}));var xo=o("ad1c"),So=o("2c17"),Io=o("0213");function ko(e){return new Promise((t,o)=>{So["b"].post(Io["a"].flowStatus(),e).then(e=>{t(e.data)}).catch(e=>{o(e)})})}function Oo(e){return new Promise((t,o)=>{So["b"].post(Io["a"].materialStatisticsData(),e).then(e=>{t(e.data)}).catch(e=>{o(e)})})}var jo=o("2d40");function Co(e,t=!0){const o=i["b"].state.mappings.icon;if(!o)return e;const n=(i["b"].state.proInfo.enableRelativePath||i["b"].state.viewMode.local)&&t;return o.mapping[e]?(n?o.pathPrefix+"/":"")+o.mapping[e]:""}function Eo(e,t=!0){const o=i["b"].state.mappings.model;if(!o)return e;const n=i["b"].state.proInfo.enableRelativePath&&t;return o.mapping[e]?(n?o.pathPrefix+"/":"")+o.mapping[e]:""}var To=o("477c");function Po(e,t){return Mo(e)>=Mo(t)}function _o(e,t){return Mo(e)<Mo(t)}function Ao(e,t,o){return Mo(e)>=Mo(t)&&Mo(e)<Mo(o)}function Mo(e){if(!e)return"";const t=e.split("."),o=["","0","00","000","0000"],n=o.reverse();for(let i=0;i<t.length;i++){const e=t[i].length;t[i]=n[e]+t[i]}return t.join("")}function Ho(e){if(!e)return;let t=e;const o=t.match(/id=\d+/);if(o&&o[0]&&(t=t.replace(o[0],o[0]+"&animation=0")),t)if(Object(To["d"])())window.location.href=t;else{const e=document.createElement("a");e.setAttribute("href",t),e.setAttribute("target","_blank"),e.click()}}function zo(e,t){const o=Object.assign({},{},t),n=(e,t)=>{for(const o in e)if(void 0!=t[o]){const i=t[o],s=e[o],a="[object Object]"===Object.prototype.toString.call(s),r="[object Object]"===Object.prototype.toString.call(i);a&&r&&n(s,i)}else t[o]=e[o]};return n(e,o),o}function Lo(e,t){const o={x:0,y:0},n=e.x/t.x,i=e.y/t.y;return n>=i?(o.x=t.x,o.y=e.y*t.x/e.x):(o.y=t.y,o.x=e.x*t.y/e.y),o}function Do(e){let t={};const o="[object Object]"===Object.prototype.toString.call(e);if(o)for(const n in e){const o=e[n],i="[object Object]"===Object.prototype.toString.call(o);t[n]=i?Do(o):o}else t=e;return t}function Bo(e,t="YYYY-MM-DD hh:mm:ss"){if(!e)return"";const o=new Date(e),n=o.getFullYear().toString(),i=(o.getMonth()+1).toString().padStart(2,"0"),s=o.getDate().toString().padStart(2,"0"),a=o.getHours().toString().padStart(2,"0"),r=o.getMinutes().toString().padStart(2,"0"),c=o.getSeconds().toString().padStart(2,"0"),l=[],d=[];return t.indexOf("YYYY")>=0&&l.push(n),t.indexOf("MM")>=0&&l.push(i),t.indexOf("DD")>=0&&l.push(s),t.indexOf("hh")>=0&&d.push(a),t.indexOf("mm")>=0&&d.push(r),t.indexOf("ss")>=0&&d.push(c),l.join("-")+" "+d.join(":")}function No(e,t=500){let o=null;return function(...n){const i=null;o&&clearTimeout(o),o=setTimeout((function(){e.apply(i,n)}),t)}}function Vo(e,t){var o;if(e.classList.contains(t))return e;let n=e.parentElement||null;if(null!==(o=n)&&void 0!==o&&o.classList.contains("my--event"))return null;while(n&&!n.classList.contains(t))n=n.parentElement;return n}function Ro(e,t){const o=t.x,n=t.y;let i=e.x,s=e.y;const a=Math.max(e.y/n,1),r=Math.max(e.x/o,1);return(r>1||a>1)&&(r>=a?(i=o,s=o*e.y/e.x):(i=n*e.x/e.y,s=n)),{x:i,y:s}}function Fo(e,t){const o=Math.PI/180;return{x:e.x*Math.cos(t*o)-e.y*Math.sin(t*o),y:e.y*Math.cos(t*o)+e.x*Math.sin(t*o)}}async function Go(){const e=window.krpanoJS.version,t=a();let o="";return i["b"].state.proInfo.sid&&(o=await Uo(i["b"].state.proInfo.sid)),`<krpano version="${e}">\n      <include url="${t+"skin/vtourskin.xml"}"/>\n      ${o}\n    </krpano>`}async function Wo(e){const t=await $o(e);i["b"].state.krp.call(`loadxml(${t}, null, KEEPIMAGE, NOBLEND, js(window.myKrp.onscenexmlcomplete()))`)}async function $o(e){const t=await Uo(e),o=i["b"].state.krp.get("xml").content,n=Jo(o),s=null===n||void 0===n?void 0:n.getElementsByTagName("krpano")[0],a=Jo(t),r=null===a||void 0===a?void 0:a.getElementsByTagName("scene")[0];s.appendChild(r);let c="";return n&&(c=(new XMLSerializer).serializeToString(n)),c}async function Uo(e){const t=i["b"].state.skyBoxSceneGroup.sceneList.find(t=>2!==t.scenetype&&t.id===e);if(!t)return"";const o=Po(i["b"].state.proInfo.version,"5.9.0");let n="";i["b"].state.mappings&&i["b"].state.mappings.icon?t.src=Co(t.fileName):t.src=t.sphereurl||t.fileUrl||t.iconUrl,t.src.indexOf("%$previewPath%/")>=0&&(t.src=t.src.replace("%$previewPath%/","")),void 0!==t.renderMode&&(t.is2dRender="SceneType_2DNormal"===t.renderMode),void 0!==t.isShowScene?t.isHiddenSetting=!!o&&!t.isShowScene:t.isHiddenSetting=!1,n+=await Xo(t.id,t.scenetype,t.sort);const s=i["b"].state.proInfo.xmlIds||[];return s.includes(t.id)||(s.push(t.id),i["b"].commit(jo["n"],{xmlIds:s})),n}async function Xo(e,t,o){let n="";const s=i["b"].state.mappings.icon;let a="";if(a=s?s.pathPrefix.replace("npt",""):i["b"].state.proInfo.baseurl,!i["b"].state.proInfo.enableRelativePath){const e=r().previewPath+"/";a=e+a}return 0===t?n=await Yo(a,e,o):1===t?n=await Zo(e):3===t&&(n=await qo(e)),n}async function Yo(e,t,o){var n;const s=i["b"].state.skyBoxSceneGroup.sceneList.find(e=>e.id===t),a=s.multires||"";let r=s._url_||"%s/l%l/%v/l%l_%s_%v_%h";const c=a?a.split(","):[];!s._url_&&c.length>4&&(r="%s/l%l/%0v/l%l_%s_%0v_%0h");const l=`\n    <preview url="${e}panos/scene_${o}.tiles/preview.jpg"/>\n    <image>\n      <cube multires="${a}" url="${e}panos/scene_${o}.tiles/${r}.jpg"/>\n    </image>\n  `,d=!!a||!/&/.test(s.src);let u=s.src;d||(u=await Qo(u));const p=(null===(n=c.filter(e=>e.indexOf("x")>=0))||void 0===n?void 0:n.length)||0;let h=s._url_||"l%l/%v/l%l_%v_%h";if(!s._url_&&a&&s.is2dRender){const t=await en(`${e}panos2/scene_${o}.tiles/l1/1/l1_1_1.jpg`);(!t||p>3)&&(h="l%l/%0v/l%l_%0v_%0h")}const f=`\n    <image hfov="1.0">\n      ${a?`<flat url="${e}panos2/scene_${o}.tiles/${h}.jpg" multires="${a}" />`:s.is2dRender?`<flat url="${u}"/>`:`<sphere url="${u}"/>`}\n    </image>\n  `,m=s.is2dRender?f:l,v=!s.isHiddenSetting;return`<scene type="${s.is2dRender?"image2d":"image3d"}" name="scene_scene_${t}" sceneid="${t}" title="scene_${t}" thumburl="${e}panos/scene_${t}.tiles/thumb.jpg">\n    ${v?m:await Ko()}\n  </scene>`}async function Zo(e){const t=i["b"].state.skyBoxSceneGroup.sceneList.find(t=>t.id===e),o=!t.isHiddenSetting,n=`\n    <image hfov="${t.is2dRender?"1":"360"}">\n      <sphere url="plugin:video"/>\n    </image>\n  `;return`<scene type="${t.is2dRender?"video2d":"video3d"}" name="scene_scene_${e}" sceneid="${e}" title="scene_${e}">\n    ${o?n:Ko()}\n  </scene>`}async function qo(e){const t=i["b"].state.skyBoxSceneGroup.sceneList.find(t=>t.id===e),o=`\n    <image hfov="${t.is2dRender?"1.0":"360"}">\n      <sphere url="${t.iconUrl}"/>\n    </image>\n  `,n=!t.isHiddenSetting;return`<scene type="image3d" name="scene_scene_${e}" sceneid="${e}" title="scene_${e}" thumburl="${t.iconUrl}">\n    ${n?o:Ko()}\n  </scene>`}async function Ko(){return'<preview type="grid(cube,16,16,512,0x2E2E2E,0x2E2E2E,0x2E2E2E);"/><image><cube url="" /></image>'}function Jo(e){let t=null;if(window.DOMParser){const o=new DOMParser;t=o.parseFromString(e,"text/xml")}return t}async function Qo(e){return fetch(e).then(async e=>{const t=e.body,o=new Response(t),n=await o.blob();return URL.createObjectURL(n)})}async function en(e){try{return await Object(xo["b"])(e),!0}catch(t){return window.console.log(t),!1}}function tn(e){const t={target:"creatorContainer",xml:null,html5:"auto",mobilescale:1,webglsettings:{preserveDrawingBuffer:!0,depth:!0},bgColor:"#fff",bgAlpha:0,initvars:{prevPath:a(!1)},passQueryParameters:!0,onready:t=>{window.krpElement=t,i["b"].commit(jo["d"],t),i["b"].state.viewMode.debug||t.set("showerrors",!1),t.set("display.autofullscreen",!1),i["b"].commit(jo["e"],{key:"isLoadedKrp",status:!0}),t.call(`loadxml(${e})`)}},o=document.getElementById("creatorContainer");o&&embedpano(t)}var on=tn;o("f8c9");const nn=()=>{const e=Object(n["ref"])(1),t=Object(n["ref"])(1),o=(e,t)=>{const o=i["b"].state.sceneInfo.size.width,n=i["b"].state.sceneInfo.size.height,s=t/n,a=e/o;let r=e,c=t;return a>=s?r=t*o/n:c=e*n/n,{width:Math.round(r),height:Math.round(c)}},s=()=>{const n=i["b"].state.sceneInfo.is2dRender,s=i["b"].state.sceneInfo.size.width,a=o(window.innerWidth,window.innerHeight);n?(e.value=Math.round(a.width/s*100)/100,t.value=n?1/Math.round(a.width/8.7):1):(t.value=1,e.value=1)};return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e&&s()}),{scaleWH:e,scaleZoom:t}},{scaleWH:sn,scaleZoom:an}=nn(),rn=(e,t=!1,o="0x")=>{const n=["a","b","c","d","e","f"],i=o=>{const i=Math.round(e[o]*(t?255:1)),s=Math.floor(i/16),a=i%16;return(s>=10?n[s-10]:s)+""+(a>=10?n[a-10]:a)};return o+i("x")+i("y")+i("z")};function cn(e){const t={"font-family":e.font.family,"font-size":e.font.size+"px",color:e.font.color,"line-height":e.font.lineheight+"px","font-weight":e.font.bolid?"bold":"normal","font-style":e.font.italic?"italic":"normal","text-decoration":e.font.underline?"underline":"none","text-align":e.font.align,"letter-spacing":e.font.wordspace+"px","word-break":"break-all","transform-origin":"center","-webkit-font-smoothing":"antialiased","transition-timing-function":"linear"};return 1===e.effect?(t["white-space"]="nowrap",t["transform"]=`translateX(${e.rect.x}px)`):2===e.effect&&(t["transform"]=`translateY(${e.rect.y}px)`),t}const ln=e=>Math.round(e/.75);function dn(e,t){return`rgba(${e.x}, ${e.y}, ${e.z}, ${t})`}function un(e){let t="";for(const o in e)if(Object.hasOwnProperty.call(e,o)){const n=e[o];t+=`${o}:${n};`}return t}const pn=e=>e?e.replace(/\n|\n\r/g,"<br/>"):"",hn=e=>e?e.replace(/\n|\n\r/g,""):"",fn=e=>e?e.replace(/,/g,"，"):"",mn=(e,t,o)=>{const n=e.content,{family:i,align:s,bolid:a,rowspace:r,wordspace:c,underline:l,italic:d}=e.content.font,u=n.font.size,p=t?u:1.2*ln(u),h=a?"bold":"normal",f=d?"italic":"normal",m=l?"underline":"none",v=t?r:1.2*ln(r*u/50),b=v/2+p,g=t?c/u*18:1.2*ln(c/u*12),y=dn(n.font.color,e.fixed.opacity);let w=`\n    width: 100%;\n    font-size: ${p}px;\n    font-weight: ${h};\n    color: ${y};\n    font-family: ${i};\n    font-style: ${f};\n    text-align: ${s};\n    letter-spacing: ${g}px;\n    text-decoration: ${m};\n    word-break: break-all;\n    transform-origin: center;\n    -webkit-font-smoothing: antialiased;\n    transition-timing-function: linear;\n  `;return o.y>Math.round(b)&&(w+=`line-height: ${b}px;`),w},vn=e=>{let t="";const o=e.split("");return o.forEach(e=>{" "!==e?(t+="[span]"+e,"[/span]"!==t.substr(-7)&&(t+="[/span]")):t+=" ",/\n|(\r\n)/.test(e)&&(t+="<br/>")}),t},bn=(e,t)=>{const o={x:0,y:0},n=document.createElement("div"),i=e.replace(/,/g,"，");return n.innerHTML=i.substr(0,i.length-1)+`<span style="letter-spacing: 0;">${i.substr(-1)}</span>`,n.style.cssText="display: inline-block;white-space: nowrap;position: absolute;left: 0;top: 0;z-index: -1;opacity: 0;"+t.join(""),document.body.appendChild(n),o.x=n.offsetWidth+4,o.y=n.offsetHeight+4,document.body.removeChild(n),o},gn=(e,{scaleWH:t,is2dRender:o})=>{const n=o=>{const n=document.createElement("div");n.style.width=o.size.x*t.value+"px";const s=document.createElement("p");s.style.cssText=un(i(o.font));const a=fn(o.title||o.txt);return 1===e.textEffect?s.innerHTML=a.replace(/\n|\r\n/g,""):s.innerHTML=pn(a),n.appendChild(s),n.innerHTML},i=t=>{const n=Math.round(t.size||12);let i=1.2*ln(n);o&&(i=n);let s=1.2*ln(t.wordspace/n*12);o&&(s=t.wordspace/n*18);let a=1.2*ln(t.rowspace*n/50)+i;o&&(a=t.rowspace+i);const r={"font-family":t.textFont||"YouYuan","font-size":i+"px","line-height":a+"px","font-weight":t.bolid?"bold":"normal","font-style":t.italic?"italic":"normal","text-decoration":t.underline?"underline":"none","text-align":t.align,"letter-spacing":s+"px","word-break":"break-all",color:dn(t.color,1),"transform-origin":"center","-webkit-font-smoothing":"antialiased",width:"100%","transition-timing-function":"linear"};return 1===e.textEffect?(r["white-space"]="nowrap",r["transform"]=`translateX(${t.showRect.x}px)`):2===e.textEffect&&(r["transform"]=`translateY(${t.showRect.y}px)`),-1!==e.textEffect?r["margin-top"]=-1*Math.round(a-i)*.5+"px":r["background"]=t.backgroundColor,r};return{html:n(e),style:i(e.font)}},yn=(e,t)=>{const o=document.createElement("div");o.innerHTML=e,o.style.cssText=`position:absolute;opacity: 0;width: ${t}px`,document.body.appendChild(o);const n={x:o.offsetWidth,y:o.offsetHeight};return document.body.removeChild(o),n},wn=e=>{const t=i["b"].state.sceneInfo.is2dRender,o=gn(e,{scaleWH:sn,is2dRender:t}),n=yn(o.html,e.size.x);return n};function xn(e){const t=[],o=e.split("");while(o.length){let e=o.shift();" "===e?e="&nbsp;":"\t"===e&&(e="&nbsp;",o.unshift(" "),o.unshift(" "),o.unshift(" ")),"\n"===e?t.push("<br>"):e&&t.push(e)}return t.join("")}const Sn={NoBlend:"BLEND(0.01, easeInCubic)",CrossBlend:"BLEND(1.0, easeInCubic)",BlackOut:"COLORBLEND(1.0, 0x000000, easeOutSine)",WhiteOut:"LIGHTBLEND(1.0, 0xFFFFFF, 2.0, linear)",ZoomBlend:"ZOOMBLEND(1.0, 2.0, easeInOutSine)",RightToLeft:"SLIDEBLEND(1.0, 0.0, 0.2, linear)",LeftToRight:"SLIDEBLEND(1.0, 180.0, 0.2, linear)",ToptoBottom:"SLIDEBLEND(1.0, 90.0, 0.01, linear)",BottomtoTop:"SLIDEBLEND(1.0, 270.0, 0.01, linear)",DiagonalBlend:"SLIDEBLEND(1.0, 135.0, 0.4, linear)",CircleOpen:"OPENBLEND(1.0, 0.0, 0.2, 0.0, linear)",VerticalOpen:"OPENBLEND(1.0, -1.0, 0.3, 0.0, linear)",HorizontalOpen:"OPENBLEND(1.0, 1.0, 0.1, 0.0, linear)",EllipticZoom:"OPENBLEND(1.0, -0.5, 0.3, 0.8, linear)",Step_forward:"BLEND(0.5)"},In={1:"left",2:"right",132:"center"},kn=e=>{if(!i["b"].state.mappings.icon)return e;if(e.gifImageInfos.forEach(e=>{e.gifPath=Co(e.gifPath),e.gifImgInfo.imgPath=Co(e.gifImgInfo.imgPath)}),e.allBackgroundAudio&&(e.allBackgroundAudio.fileUrl=Co(e.allBackgroundAudio.filePath)),e.allBackgroundAudios.forEach(e=>{e.fileUrl=Co(e.filePath)}),e.hotspotTriggerEffect&&(e.hotspotTriggerEffect.iconMovePath=Co(e.hotspotTriggerEffect.iconMovePath),e.hotspotTriggerEffect.audioMovePath=Co(e.hotspotTriggerEffect.audioMovePath),e.hotspotTriggerEffect.audioClickPath=Co(e.hotspotTriggerEffect.audioClickPath)),e.category&&e.category.forEach(e=>{e.icon=Co(e.icon),e.subCategory.forEach(e=>{e.icon=Co(e.icon)})}),e.sceneList.forEach(e=>{e.iconUrl=Co(e.iconPath)}),e.navigationOption&&e.navigationOption.selectors.length&&e.navigationOption.selectors.forEach(e=>{e.hotPots.forEach(e=>{e.attribute.appearance.fileUrl=Co(e.attribute.appearance.appearanceImage)})}),e.uiGlobalInfo){const t=e.uiGlobalInfo instanceof Array,o=t?e.uiGlobalInfo.find(e=>"PC"===e.platType):e.uiGlobalInfo;e.uiGlobalInfo=On(o||{})}else e.uiGlobalInfo=[];if(e.weChatshare)for(const t in e.weChatshare){const o=e.weChatshare[t];/.(png|jpeg|jpg|gif|webp)/i.test(o)&&(e.weChatshare[t]=Co(o))}return e};function On(e){const t=e=>{for(const o in e){const n=e[o],i=Object.prototype.toString.call(n);if("[object Object]"===i)if(n.iconPath){const e=n.iconPathSwitch,t=n.iconPath;n.iconPath=Co(e)||Co(t),n.iconPathSwitch=Co(t)}else t(n)}},o=e=>{e.imageHotPot&&(e.imageHotPot.fileUrl=Co(e.imageHotPot.imageName)),e.videoImageHotPot&&(e.videoImageHotPot.fileUrl=Co(e.videoImageHotPot.videoName),e.videoImageHotPot.iconUrl=Co(e.videoImageHotPot.snappath)),e.audioHotPot&&(e.audioHotPot.fileUrl=Co(e.audioHotPot.audioName)),e.imageListHotPot&&(e.imageListHotPot.fileUrl=e.imageListHotPot.imagePaths.map(e=>Co(e))),e.modelHotPot&&(e.modelHotPot.fileUrl=Co(e.modelHotPot.modelPath),e.modelHotPot.mtlPath=Eo(e.modelHotPot.modelPath)),e.imageTxtHotPot&&(e.imageTxtHotPot.fileUrl=Co(e.imageTxtHotPot.imagePath)),e.ringHotspot&&(e.ringHotspot.imagesPath=e.ringHotspot.imagesPath.map(e=>Co(e))),e.cutOutVideoHotpot&&e.cutOutVideoHotpot.videoImageHotsPot&&(e.cutOutVideoHotpot.videoImageHotsPot.fileUrl=Co(e.cutOutVideoHotpot.videoImageHotsPot.videoName),e.cutOutVideoHotpot.videoImageHotsPot.iconUrl=Co(e.cutOutVideoHotpot.videoImageHotsPot.snappath),e.cutOutVideoHotpot.videoImageHotsPot.autoPlay=!0)},n=e=>{e.map(e=>{e.hotpot&&o(e.hotpot),e.iconInfo&&t(e)})},i=e=>{e.audios&&e.audios.forEach(e=>{e.fileUrl=Co(e.filePath)})};for(const s in e){const o=e[s];if("globalHotpot"===s?n(o):(t(o),i(o)),("thumb"===s||"DrawerAssembly"===s)&&o.iconInfo){const e=o.iconInfo.iconPath;o.iconInfo.iconPath=o.iconInfo.iconPathSwitch,o.iconInfo.iconPathSwitch=e}}return e}var jn=kn;const Cn=(e,t)=>{if(!i["b"].state.mappings.icon)return t;switch(e){case"HotPotEnum_Image":t.imageHotPot.fileUrl=Co(t.imageHotPot.imageName,!0);break;case"HotPotEnum_Video":t.videoImageHotPot.fileUrl=Co(t.videoImageHotPot.videoName),t.videoImageHotPot.iconUrl=Co(t.videoImageHotPot.snappath);break;case"HotPotEnum_Audio":t.audioHotPot.fileUrl=Co(t.audioHotPot.audioName);break;case"HotPotEnum_ImageList":t.imageListHotPot.fileUrl=t.imageListHotPot.imagePaths.map(e=>Co(e));break;case"HotPotEnum_ImageTxt":t.imageTxtHotPot.fileUrl=Co(t.imageTxtHotPot.imagePath);break;case"HotPotEnum_Model":t.modelHotPot.fileUrl=Co(t.modelHotPot.modelPath),t.modelHotPot.mtlPath=Eo(t.modelHotPot.modelPath),t.modelHotPot.modelViewerBgImagePath=Co(t.modelHotPot.modelViewerBgImagePath);break;case"HotPotEnum_Ring":t.ringHotspot.imagesPath=t.ringHotspot.imagesPath.map(e=>Co(e));break;case"HotPotEnum_Live":t.liveHotspot.liveCoverPath=Co(t.liveHotspot.liveCoverPath);break;case"HotPotEnum_AudioImageTxt":t.audioImageTxtHotspot.fileUrl=Co(t.audioImageTxtHotspot.audioName),t.audioImageTxtHotspot.imageTxtHotPot.imagePath=Co(t.audioImageTxtHotspot.imageTxtHotPot.imagePath);break;case"HotPotEnum_CutOutVideo":t.videoCutOutHotspot&&t.videoCutOutHotspot.videoImageHotsPot&&(t.videoCutOutHotspot.videoImageHotsPot.fileUrl=Co(t.videoCutOutHotspot.videoImageHotsPot.videoName),t.videoCutOutHotspot.videoImageHotsPot.iconUrl=Co(t.videoCutOutHotspot.videoImageHotsPot.snappath));break;default:break}return t};var En=Cn;function Tn(e){return{x:e?e.x:0,y:e?-1*e.y:0}}function Pn(e,t){i["b"].state.prefixDefine.is2dRender&&Po(i["b"].state.proInfo.version,"6.3.0")&&_o(i["b"].state.proInfo.version,"6.4.0")&&t.height>t.width&&(e.x*=t.height/1080/(t.width/1920));const o=250,n=250*t.height/t.width,s=n/o,a={x:(e.x+1)/2*o,y:n-(e.y+1)/2*n};return{x:a.x/o-.5,y:(a.y/n-.5)*s}}function _n(e,t){const o=250,n=250*t.height/t.width,i=n/o,s={x:0,y:0};return s.x=(e.x+.5)*o,s.y=(e.y/i+.5)*n,{x:Number((s.x/o*2-1).toFixed(2)),y:Number(((s.y-n)/n*-2-1).toFixed(2))}}function An(e){return e}function Mn(e){return-1*e}function Hn(e,t){window.console.log(e,t);let o=t[0],n=0;for(let i=1;i<=t.length;i++){const s=t[i%t.length],a=(s.y-o.y)/(s.x-o.x),r=o.x<=e.x&&e.x<s.x,c=s.x<=e.x&&e.x<o.x,l=e.y<a*(e.x-o.x)+o.y;(r||c)&&l&&n++,o=s}return n%2!==0}function zn(e,t){const o={...e};t.rightTop.x<t.leftTop.x&&t.rightTop.x<0&&(t.rightTop.x+=360,t.rightBottom.x+=360,o.x>=-180&&o.x<0&&(o.x+=360));const n=[t.leftTop,t.rightTop,t.rightBottom,t.leftBottom];return Hn(o,n)}function Ln(e){let t=0;try{t=e.toString().split(".")[1].length}catch(o){t=0}return t}function Dn(e,t){const o=Math.max(Ln(e),Ln(t)),n=Math.pow(10,o);return(e*n+t*n)/n}function Bn(e,t){return Dn(e,-t)}function Nn(e,t){const o=Ln(e)+Ln(t),n=Number(e.toString().replace(".","")),i=Number(t.toString().replace(".",""));return n*i/Math.pow(10,o)}function Vn(e,t){if(0===t)return e;const o=Ln(t)-Ln(e),n=Number(e.toString().replace(".","")),i=Number(t.toString().replace(".",""));return Nn(n/i,Math.pow(10,o))}const Rn=(e,t,o)=>Math.max(t,Math.min(o,e));function Fn(e){const t=new Array(16),o=e.x,n=e.y,i=e.z,s=e.w;return t[0]=1-n*n*2-i*i*2,t[1]=o*n*2+s*i*2,t[2]=o*i*2-s*n*2,t[3]=0,t[4]=o*n*2-s*i*2,t[5]=1-o*o*2-i*i*2,t[6]=n*i*2+s*o*2,t[7]=0,t[8]=o*i*2+s*n*2,t[9]=n*i*2-s*o*2,t[10]=1-o*o*2-n*n*2,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gn(e,t){const o={x:0,y:0,z:0},n=e[0],i=e[4],s=e[8],a=e[1],r=e[5],c=e[9],l=e[2],d=e[6],u=e[10];switch(t){case"XYZ":o.y=Math.asin(Rn(s,-1,1)),Math.abs(s)<.99999?(o.x=Math.atan2(-c,u),o.z=Math.atan2(-i,n)):(o.x=Math.atan2(d,r),o.z=0);break;case"YXZ":o.x=Math.asin(-Rn(c,-1,1)),Math.abs(c)<.99999?(o.y=Math.atan2(s,u),o.z=Math.atan2(a,r)):(o.y=Math.atan2(-l,n),o.z=0);break;case"ZXY":o.x=Math.asin(Rn(d,-1,1)),Math.abs(d)<.99999?(o.y=Math.atan2(-l,u),o.z=Math.atan2(-i,r)):(o.y=0,o.z=Math.atan2(a,n));break;case"ZYX":o.y=Math.asin(-Rn(l,-1,1)),Math.abs(l)<.99999?(o.x=Math.atan2(d,u),o.z=Math.atan2(a,n)):(o.x=0,o.z=Math.atan2(-i,r));break;case"YZX":o.z=Math.asin(Rn(a,-1,1)),Math.abs(a)<.99999?(o.x=Math.atan2(-c,r),o.y=Math.atan2(-l,n)):(o.x=0,o.y=Math.atan2(s,u));break;case"XZY":o.z=Math.asin(-Rn(i,-1,1)),Math.abs(i)<.99999?(o.x=Math.atan2(d,r),o.y=Math.atan2(s,n)):(o.x=Math.atan2(-c,u),o.y=0);break;default:break}return o}const Wn=e=>{const t={x:e.data1,y:e.data2,z:e.data3,w:e.data4},o=Fn(t),n=Gn(o,"YXZ"),i=Math.round(n.x/(Math.PI/180)),s=Math.round(n.y/(Math.PI/180)),a=Math.round(n.z/(Math.PI/180));return{rx:i>=0?i:i+360,ry:s>=0?s:s+360,rz:a>=0?a:a+360}},$n=(...e)=>{const t=new window.THREE.Matrix4,o=Math.PI/180;e.forEach(e=>{const n=new window.THREE.Euler;n.set(e.rx*o,e.ry*o,e.rz*o,"ZXY");const i=new window.THREE.Matrix4;i.makeRotationFromEuler(n),t.multiply(i)});const n=new window.THREE.Euler;return n.setFromRotationMatrix(t,"ZXY"),{rx:n.x/o,ry:n.y/o,rz:n.z/o}};function Un(e,t){const o=0,n=Math.atan((e.y-t.y)/(e.x-t.x));let i=180*(n-o)/Math.PI;return e.x<t.x&&(i+=180),i}const Xn=(e,t,o)=>{let n=0;switch(o){case 1:n=Dn(e,t);break;case 2:n=Bn(e,t);break;case 3:n=Nn(e,t);break;case 4:n=Vn(e,t);break;case 5:n=t;break;case 6:n=t?0:1;break;default:n=e;break}const i=[5,6].indexOf(o)>=0,s=Math.ceil(n)===n;return s||i?n:parseFloat(n.toFixed(5))};function Yn(e){if("[object Array]"!==Object.prototype.toString.call(e))return[];const t=[];return e.forEach(e=>{t.push(Zn(e))}),t}function Zn(e){const t=e[Kn(e.variableType)];return{id:e.variableId,name:e.variableName,type:e.variableType,value:t,backupValue:t,remark:e.variableRemarks,statisticsProperity:e.statisticsProperity}}const qn=[{key:"variableValueInt",type:1},{key:"variableValueFloat",type:2},{key:"variableValueBool",type:3},{key:"variableValueLong",type:4}];function Kn(e){const t=qn.find(t=>t.type===e);return(null===t||void 0===t?void 0:t.key)||""}function Jn(e,t){const o=i["b"].state.prefixDefine.gifImageInfos.find(e=>e.gifPath===t),n=o?o.gifImgInfo:e||{};return{imgPath:n.imgPath||"",imgWidth:n.imgWidth||0,imgHeight:n.imgHeight||0,gifWidth:n.gifWidth||0,gifHeight:n.gifHeight||0,delayTime:Number(n.delayTime)||10,replenishNum:n.replenishNum||0,frameNum:n.frameNum}}function Qn(e){return{rx:e?-1*e.x:0,ry:e?e.y:0,rz:e?-1*e.z:0}}function ei(e,t=!1){var o,n,s,a,r,c,l,d;let u;const p=null!==(o=null===(n=i["b"].state.prefixDefine.sceneSize)||void 0===n?void 0:n.width)&&void 0!==o?o:null===(s=i["b"].state.sceneInfo.size)||void 0===s?void 0:s.width,h=null!==(a=null===(r=i["b"].state.prefixDefine.sceneSize)||void 0===r?void 0:r.height)&&void 0!==a?a:null===(c=i["b"].state.sceneInfo.size)||void 0===c?void 0:c.height,f=null!==(l=i["b"].state.prefixDefine.is2dRender)&&void 0!==l?l:null===(d=i["b"].state.sceneInfo)||void 0===d?void 0:d.is2dRender;return u=f?t?_n(e,{width:p,height:h}):Pn(e,{width:p,height:h}):Tn(e),u}function ti(e){if(!e||!e.length)return[];const t=[];return e.forEach(e=>{const o=i["b"].state.skyBoxSceneGroup.animations[e];if(!o)return;const n=JSON.parse(JSON.stringify(o));n.frames=[],n._inited=!1,o.frames=o.frames.sort((e,t)=>e.timePoint-t.timePoint);const s=o.frames.filter(e=>0===e.type);s.forEach((e,t)=>{var o;const i=ei({x:e.data1,y:e.data2});n.frames.push({ath:i.x,atv:i.y,radius:e.data3,start:Number((null===(o=s[t-1])||void 0===o?void 0:o.timePoint)||0),end:Number(e.timePoint),type:0,index:t})});const a=o.frames.filter(e=>1===e.type);a.forEach((e,t)=>{var o;const i=Wn(e);n.frames.push({rx:-1*i.rx,ry:i.ry,rz:-1*i.rz,start:Number((null===(o=a[t-1])||void 0===o?void 0:o.timePoint)||0),end:Number(e.timePoint),type:1,index:t})});const r=o.frames.filter(e=>2===e.type);r.forEach((e,t)=>{var o;n.frames.push({value:e.data1,start:Number((null===(o=r[t-1])||void 0===o?void 0:o.timePoint)||0),end:Number(e.timePoint),type:2,index:t})});const c=o.frames.filter(e=>3===e.type);c.forEach((e,t)=>{var o;n.frames.push({value:e.data5,start:Number((null===(o=c[t-1])||void 0===o?void 0:o.timePoint)||0),end:Number(e.timePoint),type:3,index:t})});const l=o.frames.filter(e=>4===e.type);l.forEach((e,t)=>{var o;n.frames.push({value:e.data1,start:Number((null===(o=l[t-1])||void 0===o?void 0:o.timePoint)||0),end:Number(e.timePoint),type:4,index:t})}),t.push(n)}),t}async function oi(e){return await new Promise(t=>{Object(xo["d"])({id:e}).then(e=>{var o;1===e.resCode&&t(null!==(o=e.resData&&e.resData.live)&&void 0!==o?o:{})})})}function ni(e={}){return{initial:{path:"",gifInfo:null},move:{enablePath:e.iconMove||!1,path:e.iconMovePath||"",gifInfo:Jn(null,e.iconMovePath),enableScale:e.scaleMove||!1,scale:e.mutipleMove||1,enableAudio:e.audioMove||!1,audio:e.audioMovePath||""},down:{enablePath:e.iconClick||!1,path:e.iconClickPath||"",gifInfo:Jn(null,e.iconClickPath),enableScale:e.scaleClick||!1,scale:e.mutipleClick||1,enableAudio:e.audioClick||!1,audio:e.audioClickPath||""}}}function ii(e={}){const t={};return Object.keys(e).map(o=>{const n=e[o];t[o]="object"===typeof n?{isActive:n.isActive,id:n.variableId,assignId:n.variableIdAssignment,operationType:n.operationType,constant:Zn(n.constantVariable)}:n}),t}function si(e){const t=Object(To["d"])()?"mobile":"pc",o={fontSize:14,labelSize:{x:50,y:50},iconPos:{x:0,y:0},displayAlign:1,platformType:"",scale:100};if(!e)return o;const n=e.filter(e=>e.platformType.toLocaleLowerCase()===t);return n&&n[0]||o}function ai(e,t){const o=[];return t.forEach(t=>{const n=t.triggerValue?t.triggerValue.intValue.value:0,i=t.triggerTarget?t.triggerTarget.intValue.value:0;o.push({targetId:t.targetId,parentId:e,triggerValue:n,triggerTarget:i,animationId:t.curAnimationId,isConnectSelf:t.isConnectSelf,targetPoint:t.targetPoint})}),o}const ri={image:a()+o("e8f8")},ci=e=>{if(!i["b"].state.mappings.icon)return e;const t=e.attribute.hotPotType;if(e.attribute.appearance)for(const o in e.attribute.appearance){const t=e.attribute.appearance[o];"appearanceImage"===o&&(e.attribute.appearance.fileUrl=Co(t,!0)||ri.image,/.(fbx|obj)/i.test(t)&&(e.attribute.appearance.mtlPath=Eo(t)))}return e.bubbleImgName=Co(e.bubbleImgName,!0),e.hotspotTriggerEffect&&(e.hotspotTriggerEffect.iconMovePath=Co(e.hotspotTriggerEffect.iconMovePath),e.hotspotTriggerEffect.audioMovePath=Co(e.hotspotTriggerEffect.audioMovePath),e.hotspotTriggerEffect.audioClickPath=Co(e.hotspotTriggerEffect.audioClickPath)),e.platformInfo.forEach(e=>{En(t,e)}),e.animationPath&&(e.animationPath=e.animationPath.map(e=>Co(e,!1))),e};var li=ci;const di=e=>{const t=[];return e.forEach(e=>{var o,n,i,s,a,r,c,l,d;const u={id:e.id||0,name:e.name,type:Number(ro[e.type]),status:!1,isTrigger:!1,nextSceneId:(null===(o=e.result)||void 0===o?void 0:o.targetId)||0,hotPots:[],clearRecords:e.clearRecords,animationId:null!==(n=null===(i=e.result)||void 0===i?void 0:i.curAnimationId)&&void 0!==n?n:-1,gear:null!==(s=null===(a=e.result)||void 0===a||null===(r=a.triggerTarget)||void 0===r||null===(c=r.intValue)||void 0===c?void 0:c.value)&&void 0!==s?s:0,targetPoint:null!==(l=null===(d=e.result)||void 0===d?void 0:d.targetPoint)&&void 0!==l?l:-1};e.conditionObjects.forEach(e=>{u.hotPots.push({id:e||0,status:!1})}),t.push(u)}),t},ui=(e={})=>({enable:e.enable||!1,triggerId:e.conditionObj||0,triggerMode:co[e.type]||0}),pi=(e={})=>{var t,o,n;let i=e.type;return"string"===typeof i&&(i=void 0!=lo[e.type]?lo[e.type]:1),{enable:e.enable||!1,triggerId:e.conditionObj||0,triggerMode:i,gear:null!==(t=null===(o=e.triggerValue)||void 0===o||null===(n=o.intValue)||void 0===n?void 0:n.value)&&void 0!==t?t:0}},hi=e=>{if(!i["b"].state.mappings.icon)return e;const t=e.attribute.hotPotType;return e.platformInfo.forEach(e=>{switch(t){case"PartsEnum_Image":case"PartsEnum_GIF":e.imageHotPot.fileUrl=Co(e.imageHotPot.imageName)||ri.image;break;case"PartsEnum_Video":e.videoImageHotPot.fileUrl=Co(e.videoImageHotPot.videoName),e.videoImageHotPot.iconUrl=Co(e.videoImageHotPot.snappath);break;case"PartsEnum_Audio":e.audioHotPot.fileUrl=Co(e.audioHotPot.audioName);break;case"PartsEnum_ImageList":e.imageListHotPot.fileUrl=e.imageListHotPot.imagePaths.map(e=>Co(e));break;case"PartsEnum_Model":e.modelHotPot.fileUrl=Co(e.modelHotPot.modelPath),e.modelHotPot.modelShotScreen=Co(e.modelHotPot.modelShotScreen),e.modelHotPot.mtlPath=Eo(e.modelHotPot.modelPath),e.modelHotPot.modelViewerBgImagePath=Co(e.modelHotPot.modelViewerBgImagePath);break;case"PatrtsEnum_CutOutVideo":e.videoCutOutHotspot&&(e.videoCutOutHotspot.videoImageHotsPot.fileUrl=Co(e.videoCutOutHotspot.videoImageHotsPot.videoName),e.videoCutOutHotspot.videoImageHotsPot.iconUrl=Co(e.videoCutOutHotspot.videoImageHotsPot.snappath));break;case"PartsEnum_Live":e.liveHotspot.liveCoverPath=Co(e.liveHotspot.liveCoverPath);break;case"PartsEnum_Number":e.numberHotspot&&(e.numberHotspot.numberBackPath=Co(e.numberHotspot.numberBackPath));break;default:break}}),e.animationPath&&(e.animationPath=e.animationPath.map(e=>Co(e,!1))),e};var fi=hi;function mi(e=[]){const t=[];return e.forEach(e=>{53===e.attribute.hotPotType&&(e.attribute.hotPotType="PartsEnum_Number");const o=vi(fi(e));t.push(o)}),t}function vi(e){var t,o,n,s,a,r,c,l,d,u,p;const h=e.platformInfo.find(e=>e.platformType.toLocaleLowerCase()===(i["b"].state.device.mobile?"mobile":"pc")),f=Number(no[e.attribute.hotPotType]),m=null!==(t=null===(o=i["b"].state.skyBoxSceneGroup)||void 0===o||null===(n=o.platformInfo)||void 0===n?void 0:n.radius)&&void 0!==t?t:0,v=Po(i["b"].state.proInfo.version,"5.9.0"),b={id:e.hotPotID,type:f,rotate:Qn(h.eulerAngle),position:ei(h.iconPos),startTime:Number(e.startTime),endTime:Number(e.endTime),platformType:h.platformType,isShow:!v||(null===(s=e.isShow)||void 0===s||s),opacity:v&&null!==(a=e.opacity)&&void 0!==a?a:1,scale:v&&null!==(r=e.scale)&&void 0!==r?r:1,radius:v&&null!==(c=h.posR)&&void 0!==c?c:m,isAllowDrag:null!==(l=h.isAllowDrag)&&void 0!==l&&l,isAllowScale:null!==(d=h.isAllowScale)&&void 0!==d&&d,animationInfos:e.animationPath?ti(e.animationPath):null,statisticsProperity:e.statisticsProperity,propertyControl:ii(e.propertyControl)};b.zorder=100-b.radius;const g=null!==(u=i["b"].state.prefixDefine.is2dRender)&&void 0!==u?u:null===(p=i["b"].state.sceneInfo)||void 0===p?void 0:p.is2dRender;return g&&void 0!==e.renderOrder&&(b.zorder=e.renderOrder),b.content=bi(h,f),i["b"].state.device.iphone&&9===b.type&&(b.position.x=Math.round(b.position.x),b.position.y=Math.round(b.position.y)),b}function bi(e,t){if(!e)return{};let o=null;switch(t){case 2:o=gi(e.labelHotPot||{});break;case 3:case 11:o=yi(e.imageHotPot||{});break;case 4:o=wi(e.videoImageHotPot||{});break;case 7:o=xi(e.imageListHotPot||{});break;case 9:o=Oi(e.modelHotPot||{});break;case 22:o=Si(e.liveHotspot||{});break;case 23:o=Ii(e.appHotspot||{});break;case 51:o=ki(e.videoCutOutHotspot||{});break;case 53:o=ji(e);break;case 55:o=Ci(e.inputComponent||{});break;case 56:o=Ei(e.webElement);break;default:break}return o}function gi(e){let t=-1;const o=Po(i["b"].state.proInfo.version,"5.9.0");return o&&(t=Number(Yt[e.textEffect]),0===t&&(t=-1)),{title:e.title,padding:e.borderSpace,fontFamily:e.textFont,fontSize:e.charSize||12,fontColor:e.fontColor,wordSpace:e.wordSpace,rowSpace:e.rowSpace,bolid:e.bolid,italic:e.italic,underline:e.underline,textAlignment:In[e.textAlignment],bgcolor:e.backgroundColor,bgalpha:o?e.backgroundOpacity:0,showSize:e.showRect,texteffect:t}}function yi(e){const t=e.loopMode?Number(Zt[e.loopMode]):0,o={imageName:e.imageName,imageType:io[e.imageType],imagePath:e.fileUrl||e.imagePath||ri.image,showSize:{x:e.showSize.x,y:e.showSize.y},loopTime:1===t?e.loopNumbers:0};return o.gifInfo=Jn(e.gifInfo,o.imagePath),o}function wi(e){var t,o;const n=Po(i["b"].state.proInfo.version,"6.3.0"),s=n?(null!==(t=e.volumeLevel)&&void 0!==t?t:100)/100:1;return{videoName:e.videoName,videoType:so[e.videoType],videoPath:e.fileUrl,videoPoster:e.iconUrl,volume:s,showSize:e.showRect,autoplay:e.autoPlay,replay:e.autoReplay,isPauseMedia:!!i["b"].state.device.iphone||e.isPauseMedia,startTime:(Number(e.startTime)||0)/1e3,vaEnable:null!==(o=e.vaEnable)&&void 0!==o&&o,vaUid:e.videoUid}}function xi(e){let t=[];const o=Po(i["b"].state.proInfo.version,"5.9.0");o&&e.fileUrl.length?t=e.fileUrl:e.imagePaths.length&&(t=e.imagePaths),t=t.map(e=>e||ri.image),t.length||t.push(ri.image);const n=[];return t.forEach(e=>{const t=Jn(null,e);n.push(t)}),{imagePaths:t,imageType:io[e.imageType],autoplay:!e.isAutoPlay,interval:e.autoInterVal||.2,showSize:e.showSize,gifInfos:n}}function Si(e){const t={liveName:e.liveName,livePath:e.liveAddress,livePoster:e.liveCoverPath,showSize:e.showRect,isPauseMedia:e.isPauseMedia};return t.gifInfo=Jn(e.gifInfo,t.livePoster),wo("Live")&&(t.liveId=e.liveId),t}function Ii(e){const t=Number(vo[e.appDisplayDirection]),n=1===t?"default_app_porital.png":"default_app.png";return{imagePath:a()+o("68ba")("./"+n),showSize:{x:e.showRect.x,y:e.showRect.y}}}function ki(e){const t=e.threshold||0;return{alphaColor:e.cutOutColor,threshold:t+(t?.05:0),smoothing:e.threshold&&e.smoothness||0,...wi(e.videoImageHotsPot)}}function Oi(e){function t(e){return isNaN(e)||e<=0?1:e||1}const o={modelPath:e.fileUrl,modelMtlPath:e.mtlPath||"",scaleSize:t(e.scaleSize),isAutoRotation:e.isAutoRotation,rotationAnimationType:e.rotationAnimationType,rotateOriginType:Xt[e.rotationType],showSize:{x:e.showRect.x/2||0,y:e.showRect.y/2||0},openInModelViewer:!0,animation:{type:0,loop:!1,reverse:!1,speed:1}};o.isAutoRotation||(o.rotateOriginType=0);const n=Po(i["b"].state.proInfo.version,"6.0.0");n&&(o.animation={type:qt[e.type]||0,loop:e.isLoop,reverse:e.isReverse,speed:e.speedRate||1});const s=Po(i["b"].state.proInfo.version,"6.0.1");var a;s&&(o.openInModelViewer=null===(a=e.openInModelViewer)||void 0===a||a);const r=Po(i["b"].state.proInfo.version,"6.2.1");return r&&(o.modelViewerBgColor=e.modelViewerBgColor||{x:0,y:0,z:0,w:0},o.modelViewerBgColor.x=Math.floor(o.modelViewerBgColor.x*(o.modelViewerBgColor.w/255)),o.modelViewerBgColor.y=Math.floor(o.modelViewerBgColor.y*(o.modelViewerBgColor.w/255)),o.modelViewerBgColor.z=Math.floor(o.modelViewerBgColor.z*(o.modelViewerBgColor.w/255)),o.modelViewerBgImagePath=e.modelViewerBgImagePath||""),o}function ji(e){const t=e.numberHotspot||{},o=Jn(t.gifInfo,t.numberBackPath),n=t.loopMode?Number(Zt[t.loopMode]):0;return{...Ai(e),imagePath:t.numberBackPath,gifInfo:o,loopTime:1===n?t.loopNumbers:0,showSize:t.showSize}}function Ci(e){return{title:e.inputTitle,padding:e.borderSpace,fontFamily:e.fontFamily,fontSize:e.charSize||12,fontColor:e.fontColor,wordSpace:e.wordSpace,bolid:e.isBoild,italic:e.isItalic,underline:e.isUnderline,textAlignment:In[e.textAlignment],inputSize:e.inputRect,titlePos:e.titlePos,inputColor:{x:255,y:255,z:255,w:255},inputBorderColor:e.inputFrameColor,inputBackgroundColor:e.inputBackgroundColor,inputBackgroundOpacity:e.inputBackgroundOpacity,enableStatistics:e.countInputHistory}}function Ei(e){return{poster:e.thumpnail,path:e.url,showSize:e.size}}var Ti=o("e524");function Pi(e=[]){const t=[];return e.forEach(e=>{52===e.attribute.hotPotType&&(e.attribute.hotPotType="HotPotEnum_AudioImageTxt");const o=_i(li(e));Gi(o)&&t.push(o)}),t}function _i(e){var t,o,n,s,a,r,c,l,d,u,p,h,f;const m=e.platformInfo.find(e=>e.platformType.toLocaleLowerCase()===(i["b"].state.device.mobile?"mobile":"pc")),v=Number(to[e.attribute.hotPotType]),b=null!==(t=null===(o=i["b"].state.skyBoxSceneGroup)||void 0===o||null===(n=o.platformInfo)||void 0===n?void 0:n.radius)&&void 0!==t?t:0,g=Po(i["b"].state.proInfo.version,"5.9.0"),y={id:e.hotPotID,type:v,name:e.name,showName:e.showName,fontStyle:Ai(m),rotate:Qn(m.eulerAngle),position:ei(m.iconPos),startTime:Number(e.startTime),endTime:Number(e.endTime),displayAlign:5===v?2:m.displayAlign,displayMode:Vt[e.displayMode],disappearMode:Rt[e.disappearMode],platformType:m.platformType,conditionTrigger:ui(e.conditionTrigger),follow:null,isEnableGlobalTriEffect:e.isSetGlobalTrigger,hotspotTriEffect:ni(e.hotspotTriggerEffect),isShow:!g||(null===(s=e.isShow)||void 0===s||s),opacity:g&&null!==(a=e.opacity)&&void 0!==a?a:1,scale:g&&null!==(r=e.scale)&&void 0!==r?r:1,radius:g&&null!==(c=m.posR)&&void 0!==c?c:b,isAllowDrag:null!==(l=m.isAllowDrag)&&void 0!==l&&l,animationInfos:e.animationPath?ti(e.animationPath):null,closeAnyWhere:null===(d=m.closeAnyWhere)||void 0===d||d,showStyle:ao[null!==(u=e.showStyle)&&void 0!==u?u:"ShowStyle_Icon"],statisticsProperity:e.statisticsProperity,propertyControl:ii(e.propertyControl),destorted:!(null!==(p=e.isLineFaceToCamera)&&void 0!==p&&p)};y.iconData=Mi(e,y.showStyle,y.radius),2===y.showStyle&&(y.fontStyle.fontAlign="center"),y.zorder=100-y.radius;const w=null!==(h=i["b"].state.prefixDefine.is2dRender)&&void 0!==h?h:null===(f=i["b"].state.sceneInfo)||void 0===f?void 0:f.is2dRender;return w&&void 0!==e.renderOrder&&(y.zorder=e.renderOrder),y.follow=Ri(m.hotspotFollow||e.hotspotFollow,y.position),y.content=Hi(m,v),Po(i["b"].state.proInfo.version,"6.1.1")&&(y.forceProperty=Fi(v,m,e.forceProperty)),10===v&&1===y.content.type&&(y.displayAlign=2),y}function Ai(e){const t={fontFamily:"Youyuan",fontSize:e.fontSize,fontColor:{x:255,y:255,z:255},fontAlign:"center",italic:!1,bold:!1,underline:!1,wordSpace:0,backgroundColor:{x:0,y:0,z:0},backgroundAlpha:.6,round:5,showSize:{x:0,y:0}},o={};return e&&e.titleFont&&e.titleFont.size&&(o.fontFamily=e.titleFont.family,o.fontSize=e.fontSize||e.titleFont.size,o.fontColor=e.titleFont.color,o.fontAlign=e.titleFont.fontAlign,o.bold=e.titleFont.bold||!1,o.italic=e.titleFont.italic||!1,o.underline=e.titleFont.underline||!1,o.wordSpace=e.titleFont.workSpacing||0,o.showSize={},o.showSize.x=e.titleBgSize.x||0,o.showSize.y=e.titleBgSize.y||0,o.backgroundColor=e.titleBgColor,void 0!==e.titleBgOpacity&&(o.backgroundAlpha=e.titleBgOpacity)),zo(t,o)}function Mi(e,t,o){const n=e.platformInfo.find(e=>e.platformType.toLocaleLowerCase()===(i["b"].state.device.mobile?"mobile":"pc"));let s=null;const a=e.attribute.appearance,r=e.polygonStyle||null;let c=[];switch(r&&(c=r.contorlPointsWorldCoordinates.map(e=>ei(e))),t){case 0:s={iconPath:a.fileUrl,mtlPath:a.mtlPath,modelScale:n.iconModelScale||1,isModelIcon:/\.(obj|fbx)$/i.test(a.fileUrl),gifInfo:Jn(a.gifInfo,a.fileUrl),showSize:n.labelSize},(isNaN(s.modelScale)||s.modelScale<=0)&&(s.modelScale=.1);break;case 1:s={linePos:Bt[e.linePos],lineColor:e.lineColor,lineLength:e.lineLength||10,showSize:{x:5,y:5}};break;case 2:s={iconPath:e.bubbleImgName,type:uo[e.bubbleStyle],gifInfo:Jn(null,e.bubbleImgName),showSize:e.bubbleSize};break;case 3:s={points:c,titlePos:ei(r.titlePosCoordinates)||{},titleRadius:r.titlePosCoordinates.z||o,contentPos:ei(r.contentPosCoordinates)||{},contentRadius:r.contentPosCoordinates.z||o,borderColor:r.borderColor,borderOpacity:r.borderOpacity,backColor:r.backColor,backOpacity:r.opacity};break;default:break}return s}function Hi(e,t){if(!e)return{};let o={};switch(t){case 2:o=gi(e.labelHotPot);break;case 3:o=yi(e.imageHotPot);break;case 4:o=wi(e.videoImageHotPot),o.autoplay=!0;break;case 5:o=Ni(e.audioHotPot);break;case 6:o=Bi(e.sceneSwitchHotPot||e.sceneSwitchHOtpot);break;case 7:o=xi(e.imageListHotPot);break;case 8:o=zi(e.imageTxtHotPot);break;case 9:o=Oi(e.modelHotPot);break;case 10:o=Li(e.hyperlinkHotspot);break;case 20:o=Di(e.ringHotspot);break;case 21:o=Si(e.liveHotspot);break;case 23:o=Ii(e.appHotspot);break;case 52:o=Vi(e.audioImageTxtHotspot);break;case 54:o=ki(e.cutOutVideoHotpot||e.videoCutOutHotspot),o.autoplay=!0;break;default:break}return o}function zi(e){const t=e.displayType?0:1,o=Po(i["b"].state.proInfo.version,"5.7.0"),n=e.fileUrl||e.imagePath||ri.image,s={imageTxtMode:o?Ut[e.imageTxtMode]:t,title:e.txt,fontFamily:e.textFont,fontSize:e.charSize||12,fontColor:e.fontColor,wordSpace:e.wordSpace,rowSpace:e.rowSpace,bolid:e.bolid,italic:e.italic,underline:e.underline,textAlignment:In[e.textAlignment],imageType:io[e.imageType],imagePath:n,loopTime:0,showSize:e.showRect};return s.gifInfo=Jn(e.gifInfo,s.imagePath),s}function Li(e){const t=2===e.openType;let o=e.hyperlink;return t&&Object(Ti["c"])("botid")&&(o=`https://www.coze.cn/store/agent/${Object(Ti["c"])("botid")}?bot_id=true`),{path:o,type:e.openType,showSize:e.size||{x:.8*window.innerWidth,y:.8*window.innerHeight}}}function Di(e){return e.imagesPath.length||e.imagesPath.push(ri.image),{isAutoPlay:e.isAutoPlay,rotateType:1,playSpeed:e.playSpeed,paths:e.imagesPath,showSize:e.showSize}}function Bi(e){const t=null!==e&&void 0!==e&&e.isUseGlobalSwitch?i["b"].state.prefixDefine.switchEffect.key:null===e||void 0===e?void 0:e.switchIndex;return{nextSceneId:null===e||void 0===e?void 0:e.nextScene,startTime:null===e||void 0===e?void 0:e.startTime,switchKey:t,switchIndex:Sn[t]}}function Ni(e){var t;const o=Po(i["b"].state.proInfo.version,"6.3.0"),n=o?(null!==(t=e.volumeLevel)&&void 0!==t?t:100)/100:1;return{audioName:e.audioName,audioPath:e.fileUrl,volume:n,isPauseMedia:e.isPauseMedia,replay:e.loopTime<=0,showSize:{x:0,y:0}}}function Vi(e){return{...Ni(e),...zi(e.imageTxtHotPot)}}function Ri(e,t){let o=[];return e&&(o=(null===e||void 0===e?void 0:e.contorlPoint.map(e=>({time:Number(e.time)/1e3,position:ei(e.position)})))||[],o=o.sort((e,t)=>e.time-t.time)),{enable:!!e&&e.isEnable,position:t,points:o}}function Fi(e,t,o){let n=null;return n=3===e?null===t||void 0===t?void 0:t.imageHotPot.forceProperty:o,n||(n={forcePlayTime:0,forcePlayType:2}),n}function Gi(e){return 3!==e.showStyle||e.iconData.points.length>0}const Wi=function(e,t=""){let o=e.slice(0);const n=Po(t,"5.8.0");n&&(o=o.filter(e=>(e.applySceneIds||[]).length));const s=Po(i["b"].state.proInfo.version,"6.3.0");return o.map(e=>{var t;const o=s?(null!==(t=e.volumeLevel)&&void 0!==t?t:100)/100:1;return{applySceneIds:e.applySceneIds||[],applyRange:$i(e),displayName:e.displayName,name:e.fileName,path:e.fileUrl||e.filePath,loop:-1===e.loopTime,volume:o}})};function $i(e){if(!e)return[];const t=[];return e.Picture&&t.push("00"),e.Video&&t.push("10"),e.Picture2d&&t.push("01"),e.Video2d&&t.push("11"),t}const Ui=(e,t)=>{let o=[];var n,i;e?o=(null===(n=t.uiGlobalInfo)||void 0===n||null===(i=n.globalMusic)||void 0===i?void 0:i.audios)||[]:o=t.allBackgroundAudios&&t.allBackgroundAudios.length?t.allBackgroundAudios:[t.allBackGroundAudio||{}];return o},Xi=(e,t)=>{const o={introduction:{description:"",pos:""},phone:""};if(e){var n,i;const e=null===(n=t.uiGlobalInfo)||void 0===n?void 0:n.introduction;e&&(o.introduction.description=e.projectIntroduction,o.introduction.pos=e.projectPos);const s=null===(i=t.uiGlobalInfo)||void 0===i?void 0:i.telephone;s&&(o.phone=s.telephoneNumber)}return o},Yi=(e,t)=>{var o;const n={Enable:t.navigationOption.Enable,hasCategory:t.navigationOption.hasCategory,showcategoryIcon:t.navigationOption.showcategoryIcon,showStyle:t.navigationOption.showStyle};if(e&&null!==(o=t.uiGlobalInfo)&&void 0!==o&&o.sceneList){var i;const e=null===(i=t.uiGlobalInfo)||void 0===i?void 0:i.sceneList;n.Enable=1,n.hasCategory=Number(e.isExpand),n.showcategoryIcon=Number(Qt[e.showType]),n.showStyle=Number(Jt[e.showStyle])}return n},Zi=(e,t,o)=>{for(const n in e){const i=e[n];"[object Object]"===Object.prototype.toString.call(i)&&(i.iconInfo&&("fullScreen"===n&&o.showUiEdit&&o.fullscreenIconPath&&(i.iconInfo.iconPath=t.iconFullScreen),"globalMusic"===n&&o.showUiEdit&&o.uiGloMusicOpenedPath&&(i.iconInfo.iconPath=t.iconMusicGlobalClose,i.iconInfo.iconPathSwitch=t.iconMusicGlobalOpen),"sceneMusic"===n&&o.showUiEdit&&o.uiMusicClosedPath&&(i.iconInfo.iconPath=t.iconMusicSceneClose,i.iconInfo.iconPathSwitch=t.iconMusicSceneOpen),"gyro"===n&&o.showUiEdit&&o.gyroscopeOpenedPath&&(i.iconInfo.iconPath=t.iconGyroClose,i.iconInfo.iconPathSwitch=t.iconGyroOpen),"logo"===n&&o.showLogo&&o.logoPath&&(i.iconInfo.iconPath=t.logoSrc),"introduction"===n&&o.showUiEdit&&o.uiInfoPath&&(i.iconInfo.iconPath=t.iconProInfo),"share"===n&&o.showUiEdit&&o.shareIconPath&&(i.iconInfo.iconPath=t.iconShare),"sceneList"===n&&o.showUiEdit&&o.scenesPath&&(i.iconInfo.iconPath=o.scenesPath),"telephone"===n&&o.showUiEdit&&o.contractPath&&(i.iconInfo.iconPath=o.contractPath),"telephone"===n&&o.showContact&&(i.iconInfo.iconPath=t.iconLink,t.phone&&(i.iconInfo.telephoneNumber=t.phone)),"vrMode"===n&&o.showUiEdit&&o.vrIconPath&&(i.iconInfo.iconPath=t.iconVr),"thumb"===n&&o.showUiEdit&&(i.iconInfo.iconPath=t.iconLike,i.iconInfo.iconPathSwitch=t.iconLiked)))}},qi=e=>{const t=e.projVersion&&e.projVersion.version,o=Po(t,"6.1.0"),n=Ui(o,e),i=Xi(o,e),s=Yi(o,e),a=function(t){e.weChatshare&&Zi(e.uiGlobalInfo,t,e.weChatshare)};return{globalAudios:n,shareInfos:i,sceneListInfo:s,updateUiGlobalIconPath:a}};var Ki=qi;const Ji=e=>i["b"].state.mappings.icon?(e.skinSet[0]&&(e.skinSet[0].audioHotPot&&(e.skinSet[0].audioHotPot.fileUrl=Co(e.skinSet[0].audioHotPot.audioName)),e.skinSet[0].userDefineFilePath&&(e.skinSet[0].userDefineFilePath=Co(e.skinSet[0].userDefineFilePath))),e):e;var Qi=Ji;const es=e=>{if(!i["b"].state.mappings.icon)return e;if(e.imagePath&&(e.fileUrl=Co(e.imagePath)),e.videoComponent&&(e.videoComponent.videoPath=Co(e.videoComponent.videoPath)),e.surroundComponent&&(e.surroundComponent.imageList=e.surroundComponent.imageList.map(e=>Co(e))),e.imglistComponent&&(e.imglistComponent.imageList=e.imglistComponent.imageList.map(e=>Co(e))),e.hotspot){const t=e.hotspot.attribute.hotPotType;En(t,e.hotspot)}return e};var ts=es;function os(e,t){const o=[];return t.forEach(t=>{const n=ns(e,ts(t));o.push(n)}),o}function ns(e,t){var o,n,s,a,r,c,l,d,u;const p=null!==(o=null===(n=i["b"].state.skyBoxSceneGroup)||void 0===n||null===(s=n.platformInfo)||void 0===s?void 0:s.radius)&&void 0!==o?o:0,h=Po(i["b"].state.proInfo.version,"5.9.0"),f={pid:e,id:t.id,type:t.type,imagePath:t.fileUrl||t.imagePath,hotspot:null,jumpSceneId:null!==(a=t.jumpSceneId)&&void 0!==a?a:0,jumpSceneStartTime:null!==(r=t.jumpSceneStartTime)&&void 0!==r?r:0,position:t.position,rotateAngle:t.rotateAngle||0,size:t.size,statistics:t.statistics,statisticsProperity:t.statisticsProperity,zIndex:t.zValue,isShow:!h||(null===(c=t.itemShow)||void 0===c||c),scale:h&&null!==(l=t.itemScale)&&void 0!==l?l:1,opacity:h&&null!==(d=t.opacity)&&void 0!==d?d:1,radius:h&&null!==(u=t.radius)&&void 0!==u?u:p};if(f.content=is(t),t.hotspot){const e=Number(to[t.hotspot.attribute.hotPotType]);f.hotspot||(f.hotspot={}),f.hotspot.id=t.hotspot.hotPotID,f.hotspot.type=e,f.hotspot.content=Hi(t.hotspot,e)}return f.size&&f.size.x&&(f.size.x=Math.round(f.size.x*f.scale),f.size.y=Math.round(f.size.y*f.scale)),f.content&&f.content.fontSize&&(f.content.fontSize*=f.scale,f.content.rowSpace*=f.scale,f.content.wordSpace*=f.scale),f}function is(e){if(!e)return{};let t=null;switch(e.type){case 0:case 1:case 2:case 3:t=ss(e);break;case 4:t=as(e);break;case 5:case 6:t=cs(e);break;case 8:t=ls(e);break;case 9:t=rs(e);break;case 10:t=ds(e);break;case 12:t=us(e);break;default:break}return t}function ss(e){let t=-1;const o=Po(i["b"].state.proInfo.version,"5.9.0");return o&&(t=Number(Yt[e.textComponent.textEffect]),0===t&&(t=-1)),{title:e.content,fontFamily:e.font.fontFamily,fontSize:e.font.fontSize||12,fontColor:e.font.fontColor,wordSpace:e.font.workSpacing,rowSpace:e.font.lineHeight,bold:e.font.bold,italic:e.font.italic,underline:e.font.underline,textAlignment:In[e.font.alignment],bgcolor:o?e.fillColor:{x:255,y:255,z:255,w:0},texteffect:t}}function as(e){const t=e.fileUrl||e.imagePath;return{imagePath:t,gifInfo:Jn(e.gifInfo,t)}}function rs(e){let t=0;e.gifComponent&&(t=e.gifComponent.loopMode?Number(Zt[e.gifComponent.loopMode]):0);let o=0;1===t&&(o=e.gifComponent.loopNumbers);const n=as(e);return{...n,loopTime:o}}function cs(e){return{title:e.content,bgcolor:e.fillColor,textAlignment:In[e.font.alignment],bold:e.font.bold,fontFamily:e.font.fontFamily,fontSize:e.font.fontSize||12,fontColor:e.font.fontColor,wordSpace:e.font.workSpacing,rowSpace:e.font.lineHeight,italic:e.font.italic,underline:e.font.underline}}function ls(e){let t=[];e.imglistComponent&&(t=e.imglistComponent.imageList||[]);const o=[];return t.forEach(e=>{const t=Jn(null,e);o.push(t)}),{imagePaths:t,imageSum:t.length,autoplay:!1,interval:.2,gifInfos:o}}function ds(e){var t;const o=i["b"].state.device&&i["b"].state.device.iphone,n=Po(i["b"].state.proInfo.version,"6.3.0"),s=n?(null!==(t=e.videoComponent.volumeLevel)&&void 0!==t?t:100)/100:1;return{videoName:e.videoComponent.videoName,videoType:so[e.videoComponent.videoType],videoPath:e.videoComponent.videoPath,videoPoster:e.fileUrl,volume:s,autoplay:e.videoComponent.videoPlayOnbegin,replay:e.videoComponent.videoAutoReplay,isPauseMedia:e.videoComponent.videoPauseOther,startTime:(Number(e.videoComponent.videoStartTime)||0)/1e3,audiobuffer:o&&e.videoComponent.audiobuffer||""}}function us(e){let t=[];return e.surroundComponent&&(t=e.surroundComponent.imageList||[]),{imagePaths:t,imageSum:t.length,autoplay:e.surroundComponent.surroundAutoPlay||!1,interval:Math.ceil(1e3/(e.surroundComponent.surroundSpeed||24))}}const ps=function(e){const t=Qi(e),o={id:t.id,title:t.sceneName,type:t.scenetype,bgAudio:t.skinSet?hs(t.skinSet[0].audioHotPot):null,skin:t.skinSet?fs(t.skinSet[0]):null,standTable:!!t.standTable,expand:!!t.expand,components:[],statisticsProperity:t.statisticsProperity};return o.components=os(t.id,t.components),ms(o.components),o};function hs(e){var t;const o=e;return o.volume=(null!==(t=o.volumeLevel)&&void 0!==t?t:100)/100,o}function fs(e){return{showSize:{x:e.width,y:e.height},opacity:e.opacity,backColor:e.color,backImg:e.userDefineFilePath}}function ms(e){const t=(e,t)=>{var o,n;const s=(null===(o=i["b"].state.skyBoxSceneGroup)||void 0===o||null===(n=o.mediaIdTypeList)||void 0===n?void 0:n.findIndex(t=>t.id===e))>=0;var a,r;s||(null===(a=i["b"].state.skyBoxSceneGroup)||void 0===a||null===(r=a.mediaIdTypeList)||void 0===r||r.push({id:e,type:t}))};e.forEach(e=>{10===e.type&&t(e.id,e.type),e.hotspot&&[4,5,6].indexOf(e.hotspot.type)>=0&&t(e.hotspot.id,e.hotspot.type)})}var vs=ps;const bs=function(e){var t,o,n,s;const a=jn(e);i["b"].commit(jo["k"],{gifImageInfos:a.gifImageInfos||[]});const r={key:a.sceneSwitchEffect.effect||"",action:Sn[a.sceneSwitchEffect.effect]||""};i["b"].commit(jo["k"],{switchEffect:r}),a.weChatshare||(a.weChatshare={});const c=ys(a.weChatshare);let l=ws(a.uiGlobalInfo),d=[];Po(i["b"].state.proInfo.version,"6.3.4")&&As(l)&&(d=Hs(l,Ms(l)),l=zs(l,Ms(l)));const u=xs(a.scenecruising),p=Ss(a.otherSettingInfo),h=Is(a.category,a.navigationOption,l,d),f=ks(a.openingAnimation),m=Os(a.globalHotpot),v=js(a.navigationOption),b=di(a.conditioners||[]),g=Es(a),y=(null===(t=a.uiGlobalInfo)||void 0===t?void 0:t.componentParts)||[],w=!!((null===(o=a.uiGlobalInfo)||void 0===o?void 0:o.waterMarkElementId)>0&&y.length);a.uiGlobalInfo&&a.uiGlobalInfo.waterMarkElementId>0&&y.forEach((e,t)=>{e.hotPotID===a.uiGlobalInfo.waterMarkElementId&&y.splice(t,1)});const x={mainSceneId:a.firstSceneID,version:null===(n=a.projVersion)||void 0===n?void 0:n.version,platformInfo:gs(a.platformInfo),animations:a.animations||[],noticeInfo:Cs(null===(s=a.uiGlobalInfo)||void 0===s?void 0:s.noticeInfo),switchEffect:r,hotspotTriEffect:ni(a.hotspotTriggerEffect),isShowSceneTitle:!!a.otherSettingInfo&&a.otherSettingInfo.showSceneNameWhilePreview,globalMusics:[],hotspots:[],mediaIdTypeList:[],sceneList:a.sceneList,statistics:g,conditioners:b,scenecruising:u,weChatShare:c,uiIcons:l,existDrawerIcon:As(l),drawerUiIcons:d,navigation:h,otherSettingInfo:p,startAnimation:f,globalHotspot:m,globalSelector:v,glVariables:Yn(a.variableGlobal),globalParts:mi(y),templateInfo:Ps(a.modelReduceInfo,a.modelType),sceneGroups:a.sceneGroups||[],waterMark:w};x.hotspots=Ts(x);const{globalAudios:S,shareInfos:I,updateUiGlobalIconPath:k}=Ki(a);if(S.length&&(x.globalMusics=Wi(S,a.projVersion&&a.projVersion.version)),I&&(I.introduction.description&&(x.weChatShare.description=I.introduction.description),I.phone&&(x.weChatShare.phone=I.phone)),x.templateInfo&&2===x.templateInfo.type){const e=[...new Set(x.templateInfo.firstLevelIds.concat(x.templateInfo.secondLevelIds))];x.uiIcons.forEach(t=>{t.enable=!(1===t.iconInfo.type||e.includes(t.iconInfo.id))})}return k(x.weChatShare),2===x.templateInfo.type&&(x.navigation.list=_s(a.sceneGroups,a.sceneList)),x};function gs(e){const t=e.find(e=>e.platformType.toLocaleLowerCase()===(i["b"].state.device.mobile?"mobile":"pc"));return{radius:t.zValue,size:t.size}}function ys(e){const t=r();function n(e={}){return{title:(Object(To["d"])()?"":"Nibiru Creator ")+e.titleName,description:e.projectIntroduction,icon:/.(png|jpeg|jpg|gif|webp)/i.test(e.thumbnail)?e.thumbnail:"",proType:e.projecType,linkId:e.affiliation,initSceneAsMain:e.initSceneAsMain,animationKey:Sn[e.animationType],showContact:!!e.showContact,showLogo:!!e.showLogo,showDiyUI:!!e.showUiEdit,showLaunch:!!e.showLaunch,showStatistics:!!e.showThumpBrowse&&!!window.creatorReportPath,phone:e.mobolePhone,remark:e.remark,launchPath:s(e.launchPath,"launchPath",e.showLaunch),logoSrc:s(e.logoPath,"logoSrc",e.showLogo),iconLogoPos:e.logoPosition,iconProInfo:s(e.uiInfoPath,"iconProInfo",e.showUiEdit),iconMusicGlobalOpen:s(e.uiGloMusicOpenedPath,"iconMusicGlobalOpen",e.showUiEdit),iconMusicGlobalClose:s(e.uiGloMusicClosedPath,"iconMusicGlobalClose",e.showUiEdit),iconMusicSceneOpen:s(e.uiMusicOpenedPath,"iconMusicSceneOpen",e.showUiEdit),iconMusicSceneClose:s(e.uiMusicClosedPath,"iconMusicSceneClose",e.showUiEdit),iconGyroOpen:s(e.gyroscopeOpenedPath,"iconGyroOpen",e.showUiEdit),iconGyroClose:s(e.gyroscopeClosedPath,"iconGyroClose",e.showUiEdit),iconVr:s(e.vrIconPath,"iconVr",e.showUiEdit),iconFullScreen:s(e.fullscreenIconPath,"iconFullScreen",e.showUiEdit),iconShare:s(e.shareIconPath,"iconShare",e.showUiEdit),iconSceneList:s(e.scenesPath,"iconSceneList",e.showUiEdit),iconLink:s(e.contractPath,"iconLink",e.showContact),iconClose:s(e["closePath"],"iconClose",e.showUiEdit),defClose:!e["closePath"]||!e.showUiEdit,iconPlay:s(e.playPath,"iconPlay",e.showUiEdit),iconLike:a()+o("7bb8"),iconLiked:a()+o("38fc"),iconPv:a()+o("0fef"),starticon:s(e.StartPath,"iconstart",e.showStart),onlyOnMobile:e.onlyOnMobile||!1}}function s(e,o,n){return(/^(http(s)?|files)/.test(e)||i["b"].state.proInfo.enableRelativePath)&&n?e:t[o]||""}function r(){return{iconProInfo:a()+o("d636"),iconMusicGlobalOpen:a()+o("9c12"),iconMusicGlobalClose:a()+o("3802"),iconMusicSceneOpen:a()+o("3bf1"),iconMusicSceneClose:a()+o("5d40"),iconGyroOpen:a()+o("eb85"),iconGyroClose:a()+o("59e9"),iconVr:a()+o("5dc4"),iconFullScreen:a()+o("fefc"),iconShare:a()+o("d8d3"),iconSceneList:a()+o("5c26"),iconLink:a()+o("59d0"),iconClose:a()+o("2949"),iconPlay:a()+o("c61e"),iconstart:""}}return n(e)}function ws(e){const t=Po(i["b"].state.proInfo.version,"6.1.0"),o=[],n=e=>{const t=to[e.hotPotType];t&&(e.type=t,e.content=Hi(e,Number(t)))},s=(e,t)=>{e.forEach(e=>{const o=Object.keys(e)||[];o.indexOf("iconInfo")>=0&&(e.iconInfo.type||(e.iconInfo.type=oo[t],e.displayMode=Vt[e.displayMode]||0,"globalHotpot"===t&&e.hotpot?(n(e.hotpot),e.hotpot.id=e.iconInfo.id,i["b"].state.device.mobile&&(e.displayMode=0),10===e.hotpot.type&&(e.displayAlign=0)):"globalSelector"===t&&(e.displayAlign=Bt[e.selector.showPos],e.selector=vs(e.selector))),r(e))})},a=e=>{for(const t in e){const o=e[t];if("globalHotpot"===t||"globalSelector"===t){s(o,t);continue}const n=Object.keys(o)||[];n.indexOf("iconInfo")<0||(o.iconInfo.type=oo[t],r(o))}},r=e=>{const t=e.iconInfo||{},n=i["b"].state.device.mobile?"Mobile":"PC",s=t.platInfo.find(e=>e.platType===n);t.position=s?s.position:{x:0,y:0},o.push(e)};return t&&e&&a(e),o}function xs(e){var t;return{enable:null===(t=null===e||void 0===e?void 0:e.useCruising)||void 0===t||t,time:(null===e||void 0===e?void 0:e.cruisingTime)||60}}function Ss(e={}){var t,o;return{enableSceneName:null===(t=e.showSceneNameWhilePreview)||void 0===t||t,enableAirpose:null!==(o=e.isAerialPhotographyMode)&&void 0!==o&&o}}function Is(e,t,o,n){let s=o.find(e=>1===e.iconInfo.type);s||(s=n.find(e=>1===e.iconInfo.type));const a=Po(i["b"].state.proInfo.version,"6.1.0");let r=t.showStyle,c=t.showcategoryIcon,l=t.hasCategory,d=!!t.Enable;return a&&s&&(r=Jt[s.showStyle],c=Qt[s.showType],l=s.isExpand,d=!0),{list:e,showStyle:r,showType:c,expand:l,enable:d}}function ks(e){const t=Po(i["b"].state.proInfo.version,"6.1.0"),o=t?"FirstScene":"FirstScene3d";return{animationType:Ht[e],animationTiming:eo[o]}}function Os(e){if(!e)return{isEnable:!1};const t=Number(to[e.hotPotType]);return{id:0,type:to[e.hotPotType],content:Hi(e,t),isEnable:!!e.useHotPot,iconPath:e.iconPath,iconPos:Bt[e.iconPos]}}function js(e){const t=e.selectors&&e.selectors[0];if(!t)return{isEnable:!1};const o=t.hotPots&&t.hotPots[0];return o?{id:0,content:vs(t),isEnable:!0,isExpand:!!t.expand,iconPath:o.attribute.appearance.fileUrl||""}:{isEnable:!1}}function Cs(e){return e?(e.bgColor=dn(e.bgColor,e.bgOpacity),e.fontColor=dn(e.fontColor,1),Reflect.deleteProperty(e,"bgOpacity"),e):{}}function Es(e){var t,o;return{enable:null!==(t=null===(o=e.dataBuryintPoint)||void 0===o?void 0:o.webEnable)&&void 0!==t&&t&&!!window.creatorReportPath,localProId:e.localProjectId||0,lastModifyTime:e.lastModifyTime||0}}function Ts(e){const t=[];return e.globalHotspot.isEnable&&(t.push(e.globalHotspot),e.mediaIdTypeList.push({id:e.globalHotspot.id,type:e.globalHotspot.type})),e.globalSelector.isEnable&&e.globalSelector.content.components.forEach(o=>{o.hotspot&&(t.push(o.hotspot),e.mediaIdTypeList.push({id:o.hotspot.id,type:o.hotspot.type}))}),e.uiIcons.length&&e.uiIcons.forEach(o=>{const n=o.iconInfo.type;20===n&&o.hotpot?(t.push(o.hotpot),e.mediaIdTypeList.push({id:o.hotpot.id,type:o.hotpot.type})):21===n&&o.selector.components.forEach(o=>{o.hotspot&&(t.push(o.hotspot),e.mediaIdTypeList.push({id:o.hotspot.id,type:o.hotspot.type}))})}),t}function Ps(e,t){const o=fo[t];return{firstLevelIds:(null===e||void 0===e?void 0:e.areaFirstInclude)||[],secondLevelIds:(null===e||void 0===e?void 0:e.areaSecondInclude)||[],type:o}}function _s(e,t){if(!e)return[];const o=[];return e.forEach(e=>{const n={icon:"",id:e.id,name:e.groupName,subCategory:[]};e.sceneIds.forEach(o=>{const i=t.find(e=>e.id===o);if(i){const t=i.fileName.split(".").shift();n.subCategory.push({hyperlink:"",icon:i.iconUrl,id:o,layout:0,linkType:0,name:t,parentId:e.id,sceneId:o,shoptype:0})}}),o.push(n)}),o}function As(e){return e.filter(e=>25===e.iconInfo.type).length}function Ms(e){return e.filter(e=>25===e.iconInfo.type)[0].iconInstanceIdList.map(e=>e.iconInstanceId)}function Hs(e,t){const o=[];return t.forEach(t=>{e.forEach(e=>{e.iconInfo.id===t&&o.push(e)})}),o}function zs(e,t){return e.filter(e=>!t.includes(e.iconInfo.id))}var Ls=bs,Ds=function(e){return{all:e=e||new Map,on:function(t,o){var n=e.get(t);n&&n.push(o)||e.set(t,[o])},off:function(t,o){var n=e.get(t);n&&n.splice(n.indexOf(o)>>>0,1)},emit:function(t,o){(e.get(t)||[]).slice().map((function(e){e(o)})),(e.get("*")||[]).slice().map((function(e){e(t,o)}))}}};const Bs=Ds();var Ns=Bs;const Vs="scene::delete",Rs="scene::before-delete",Fs="scene::change",Gs="part::toggle",Ws="trigger::toggle",$s="hotspotIcon::toggle",Us="hotspotIcon::action",Xs="part::action",Ys="triggerIcon::action",Zs="condition::action",qs="condition::update:hotspot",Ks="condition::update:trigger",Js="condition::clear",Qs="scenelist::toggleExpand",ea="proMusic::togglePlay",ta="sceneMusic::togglePlay",oa="fullscreen::toggle",na="intro::toggle",ia="vr::toggle",sa="gyro::toggle",aa="like::toggle",ra="pure::toggle:status",ca="talk::toggle",la="toggle::talkstatus",da="shield::talk",ua="toggle::talkvisible",pa="clear::talkList",ha="get::position",fa="share::toggle",ma="contact::toggle",va="proDetail::toggle",ba="layer::toggle",ga="layer::hide",ya="layer::toggle:visiblestatus",wa="video::event:trigger",xa="hotspotTriMusic::trigger",Sa="viewer::toggle:visible",Ia="viewer::toggle:status",ka="layer::play:complete",Oa="selector::layer::toggle",ja="selector::layer::hide",Ca="hide::css3d::hotspot",Ea="TOGGLE_LAYER_AUDIO",Ta="HIDE_LAYER_AUDIO",Pa="SHOW_EVENT_SELECTOR",_a="STOP::RESUME::PROMUSIC",Aa="STOP::RESUME::SCENEMUSIC",Ma="OPERATION_ARITHMETIC",Ha="OPERATION_LOGIC",za="OPERATION_RANDOM",La="OPERATION_VARIABLE",Da="ACTION_SCENE_PROPERTY",Ba="UPDATE_VARIABLE_EMITTER",Na="UPDATE_VIDEO_PLAYBACKRATE",Va="UPDATE_VIDEO_PROGRESS",Ra="UPDATE_VIDEO_FORWARD",Fa="GLOBAL_PART_ACTION",Ga="UPDATE_GLOBAL_NUMBER",Wa="TOGGLE_QUIT_CLEARSCREEN",$a="TOGGLE_VIDEOSCENE_PLAY",Ua="SET_VIDEOSCENE_TIME",Xa="RESET_SCENE_STATUS",Ya="TOGGLE_DRAWER_EXPAND",Za="CALLBACK_PRELOAD_SELECTOR";function qa(){let e=[];const t=e=>{try{const t=e.getAttribute("src");t&&e.play()}catch(t){e.play()}},o=e=>{try{const t=e.getAttribute("src");t&&e.pause()}catch(t){e.pause()}},s=t=>e.find(e=>e.key===t),a=t=>{const o=t.type+"_"+t.id,n=S(t.type);e=e.filter(e=>e.key!==o);const i={pid:t.pid||t.id,id:t.id,key:o,el:t.instance,level:n,type:t.type,status:!1,isPauseMedia:"part_video"!==t.type&&t.isPauseMedia,isMutex:[2,3,4].includes(n),isClose:2===n||4===n||"selector_bg_audio"===t.type,isPaused:!0,isAllPauseStatus:!1,isEventSelector:t.isEventSelector||!1,isEnded:!1};e.push(i)},r=(t,o,n)=>{const i=n&&n.isHide,s=n&&n.isShow;e.forEach(e=>{const n=e.type+"_"+t;if(e.key===n&&o!==e.isPaused){if(e["isPaused"]=o,o)3!==e.level||i||m(e),3===e.level&&i&&f(e.key),e.status=!1;else{if(e.isEnded&&(e.isEnded=!1),e.isMutex&&u(n),"hotspot_video"===e.type||"selector_hotspot_video"===e.type)return void(s&&h(n));h(n)}[3].includes(e.level)&&Ns.emit(ya,{id:e.id,status:!o})}})},c=t=>{e.forEach(e=>{const o=e.type+"_"+t;e.key===o&&e.isClose&&m(e)})},l=(t,o,n)=>{const i=e.find(e=>e.key===e.type+"_"+t);i&&(i[o]=n)},d=(n,i)=>{const s=e.find(e=>e.key===e.type+"_"+n);s&&s.el&&(i?(t(s.el),s.isPaused=!1):(o(s.el),s.isPaused=!0))},u=t=>{const n=s(t);n&&n.isMutex&&("selector_video"!==n.type&&4!==n.level||n.isPauseMedia||m(n),e.forEach(e=>{if(e.isMutex&&e.el&&!e.isPaused&&e.key!==n.key){if("selector_video"===n.type||4===n.level){if("selector_bg_audio"===e.type)return;o(e.el),e.isPaused=!0}else o(e.el),e.isPaused=!0;2===n.level&&("selector_hotspot_audio"!==e.type&&"selector_video"!==e.type||!e.isPauseMedia||f(e.key))}}))},p=(e,t)=>{"global_audio"===e.type?Ns.emit(_a,t):"scene_audio"===e.type&&Ns.emit(Aa,t)},h=t=>{const n=s(t);n&&n.level&&n.isPauseMedia&&e.forEach(e=>{e.level<=n.level&&e.key!==n.key&&e&&e.el&&!e.isPaused&&(o(e.el),e.isPaused=!0,e.status=!0,p(e,!1))})},f=o=>{const n=[1],i=s(o);i&&i.level&&i.isPauseMedia&&e.forEach(e=>{if(e.level<=i.level&&n.includes(e.level)&&e.key!==i.key&&e.status&&e&&e.el&&e.isPaused&&!e.isEnded){const n=b(o);n||(t(e.el),e.isPaused=!1,e.status=!1,p(e,!0))}})},m=o=>{const n=e.find(e=>"selector_bg_audio"===e.type&&e.pid===o.pid&&e.key!==o.key);if("selector_bg_audio"!==o.type&&n&&n.el&&n.isPaused&&!n.isEnded&&(t(n.el),n.isPaused=!1),3===o.level||4===o.level){if(o.isEventSelector)return;if(n&&n.isPauseMedia)return;f(o.key)}else b(o)||f(o.key)},v=t=>e.some(e=>e.pid===t&&!e.isPaused),b=t=>e.some(e=>e.level>=t.level&&e.key!==t.key&&!e.isPaused&&e.isPauseMedia),g=(t=!1)=>e.some(e=>t?!e.isPaused&&e.isPauseMedia:!e.isPaused),y=()=>{e.forEach(e=>{!e||!e.el||e.isPaused||e.isAllPauseStatus||e.isEnded||(o(e.el),e.isPaused=!0,e.isAllPauseStatus=!0,p(e,!1))})},w=()=>{e.forEach(e=>{e&&e.el&&e.isPaused&&e.isAllPauseStatus&&(t(e.el),e.isPaused=!1,e.isAllPauseStatus=!1,p(e,!0))})},x=()=>{const t=["global_audio","scene_audio","effect_audio"];e.forEach(e=>{e&&e.el&&!e.isPaused&&"global_audio"!==e.type&&(o(e.el),e.isPaused=!0)}),e=e.filter(e=>t.includes(e.type))},S=e=>{let t=1;switch(e){case"global_audio":case"scene_audio":case"part_video":t=1;break;case"hotspot_video":case"hotspot_audio":t=2;break;case"selector_bg_audio":case"selector_video":t=3;break;case"selector_hotspot_video":case"selector_hotspot_audio":t=4;break;case"effect_audio":t=5;break;default:t=1;break}return t},I=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});return Object(n["watch"])(()=>I.value,e=>{e||x()}),{updateMedia:a,updateMediaPause:r,updateMediaStatus:l,updateMediaClose:c,toggleMedia:d,isHasSeMediaPlaying:v,pauseAllMedia:y,resumeAllMedia:w,isHasMediaPlaying:g}}const{updateMedia:Ka,updateMediaPause:Ja,updateMediaStatus:Qa,updateMediaClose:er,toggleMedia:tr,isHasSeMediaPlaying:or,pauseAllMedia:nr,resumeAllMedia:ir,isHasMediaPlaying:sr}=qa();function ar(){let e=!0,t=window.myKrp;t||(t=window.myKrp={}),t.onxmlcomplete=()=>{i["b"].state.lifecycle.isLoadedXml||i["b"].commit(jo["e"],{key:"isLoadedXml",status:!0})},t.onscenexmlcomplete=()=>{i["b"].commit(jo["e"],{key:"isLoadedSceneXml",status:!0})},t.onscenestart=()=>{i["b"].commit(jo["e"],{key:"scenestatus",status:0})},t.onscenecomplete=()=>{i["b"].state.lifecycle.isLoadedScene||i["b"].state.lifecycle.scenestatus<0||(t._startload=!1,i["b"].commit(jo["e"],{key:"scenestatus",status:1}),i["b"].commit(jo["e"],{key:"isLoadedScene",status:!0}),(e||!i["b"].state.myswitch.effect&&!i["b"].state.skyBoxSceneGroup.switchEffect)&&t.onblendcomplete(),e=!1)},t.onscenedelete=()=>{i["b"].commit(jo["e"],{key:"isLoadedScene",status:!1}),i["b"].commit(jo["e"],{key:"isLoadedSceneXml",status:!1}),i["b"].commit(jo["e"],{key:"isBlendScene",status:!1}),-1!==i["b"].state.lifecycle.scenestatus&&(i["b"].commit(jo["e"],{key:"scenestatus",status:-1}),Ns.emit(Vs))},t.onanimationcomplete=()=>{i["b"].commit(jo["e"],{key:"isLoadedAnimation",status:!0})},t.onblendcomplete=()=>{i["b"].commit(jo["e"],{key:"isBlendScene",status:!0})},t.onhidecss3dhotspot=e=>{Ns.emit(Ca,e)},rr(),cr(),lr()}function rr(){const e=()=>{window.addEventListener("wheel",e=>{Ns.emit("change::wheel",{status:e.deltaY<=0})},!1)},t=()=>{const e=window.Hammer,t=new e(document.body);t.get("pinch").set({enable:!0}),t.get("pan").set({enable:!0}),t.on("pinchmove",(function(e){Ns.emit("change::pinch",{scale:e.scale,double:e.pointers.length>=2})})),t.on("panend pinchend",(function(e){Ns.emit("change::pinch",{scale:e.scale,ended:!0,double:e.pointers.length>=2})}))},o=()=>{window.addEventListener("touchstart",e=>{i["b"].commit(jo["x"],{doubleFinger:e.touches.length>=2})}),window.addEventListener("touchend",e=>{i["b"].commit(jo["x"],{doubleFinger:e.touches.length>=2})})};i["b"].state.device.mobile?(t(),o()):e()}function cr(){const e=e=>{const t=e.target;if(t){const e=!!Vo(t,"creatorContainer");i["b"].commit(jo["j"],{key:"popup",value:!e})}},t=()=>{document.removeEventListener("mousemove",e,!1),document.addEventListener("mousemove",e,!1),document.removeEventListener("touchstart",e,!1),document.addEventListener("touchstart",e,!1)};t()}function lr(){document.addEventListener("visibilitychange",()=>{document.hidden?nr():ir(),i["b"].commit(jo["j"],{key:"hidden",value:document.hidden})})}var dr=ar;async function ur(){const e=i["b"].state.nplData.find(e=>"pro"===e.key);if(!e||!e.path)return;const t=await Object(xo["b"])(e.path);if(t){const e=br(t);if(!e)return!1;await mr(t),await fr(t),hr(t),dr(),Go().then(e=>{on(e)})}return!0}function pr(e){var t;let o=e.skyBoxSceneGroup.firstSceneID||0;const n=e.sceneList.filter(e=>e.id&&2!==e.sceneType),s=(null===(t=e.skyBoxSceneGroup.weChatshare)||void 0===t?void 0:t.initSceneAsMain)||!1;if(s){const e=n.find(e=>e.id===o);!e&&n.length>=1&&(o=n[0].id)}else{const e=n.find(e=>e.sort===i["b"].state.proInfo.sort);null!==e&&void 0!==e&&e.id&&(o=null===e||void 0===e?void 0:e.id)}return o}function hr(e){var t,o,n,s,a;const r=pr(e),c=(null===(t=e.skyBoxSceneGroup)||void 0===t||null===(o=t.projVersion)||void 0===o?void 0:o.version)||e.version||e.versionNo;let l="";e.xmlPath?l=e.xmlPath.split("vtours").shift():e.tourJsonPath&&(l=e.tourJsonPath.split("npl").shift()),/regular\d+/.test(l)&&(l=l.replace("regular","cdn")),i["b"].commit(jo["n"],{version:c,firstEnterUrl:location.href,firstId:e.firstSceneID,sid:r,baseurl:l,size:(null===(n=e.material)||void 0===n?void 0:n.fileSize)||0,name:(null===(s=e.material)||void 0===s?void 0:s.nameZh)||"",devName:(null===(a=e.material)||void 0===a?void 0:a.remark)||"",channelId:e.merchantUid||0}),e.skyBoxSceneGroup.animations||(e.skyBoxSceneGroup.animations=e.animations||[]),e.skyBoxSceneGroup.sceneList=e.sceneList.filter(e=>e.id);const d=Ls(e.skyBoxSceneGroup);document.title=d.weChatShare.title||"Nibiru Creator",d.weChatShare.title&&!i["b"].state.proInfo.name&&i["b"].commit(jo["n"],{name:d.weChatShare.title}),i["b"].commit(jo["u"],{...d}),i["b"].commit(jo["e"],{key:"isLoadedDefine",status:!0})}async function fr(e){if(e.mappingPath){const t=await Object(xo["b"])(e.mappingPath);i["b"].commit(jo["f"],{icon:t})}if(e.mappingObjPath){const t=await Object(xo["b"])(e.mappingObjPath);i["b"].commit(jo["f"],{model:t})}}async function mr(e){if(e.tourJsonPath){const t=await Object(xo["b"])(e.tourJsonPath);let o=null;e.tourFlatJsonPath&&(o=await Object(xo["b"])(e.tourFlatJsonPath));const n=e.sceneList||[];for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const o=t[e],i=n.find(t=>t.id===Number(e));i&&(i.multires=o["multires"],i._url_=o["url"]?o["url"].replace(/\.\w+/,""):"")}for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const t=o[e],i=n.find(t=>t.id===Number(e));i&&(i.multires=t["multires"],i._url_=t["url"]?t["url"].replace(/\.\w+/,""):"")}}else if(e.xmlPath){const t=await Object(xo["b"])(e.xmlPath),o=(new DOMParser).parseFromString(t,"text/xml");vr(e.sceneList,o)}}function vr(e,t){const o=Array.prototype.slice.call(t.getElementsByTagName("scene"));o.forEach(t=>{const o=t.getAttribute("sceneid"),n=t.getElementsByTagName("cube")[0],i=t.getElementsByTagName("image")[0],s=t.getElementsByTagName("plugin")[0],a=e.find(e=>e.id===Number(o));if(a){if(i){a.is2dRender="1.0"===i.getAttribute("hfov");const e=i.getElementsByTagName("sphere")[0];if(e){const t=e.getAttribute("url"),o="plugin:video"===t;a.sphereurl=o?s.getAttribute("videourl"):t}}n&&(a.multires=n.getAttribute("multires"))}})}function br(e){var t;let o=!0;if(null!==(t=e.material)&&void 0!==t&&t.auditStatus){var n;const t=[-10,4];i["b"].state.viewMode.preview&&t.push(2),o=t.indexOf(null===(n=e.material)||void 0===n?void 0:n.auditStatus)>=0}return o}var gr=ur;const yr=["src"];function wr(e,t,o,i,s,a){return i.dataUrl?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,src:i.dataUrl},null,8,yr)):Object(n["createCommentVNode"])("",!0)}var xr=o("d055"),Sr=o.n(xr);const Ir=[0,1,2,3,4,5,6,7],kr=40,Or=["image/png","image/jpeg","image/webp"],jr=["low","medium","quartile","high","L","M","Q","H"];var Cr={props:{toSJISFunc:Function,margin:Number,scale:Number,width:Number,height:Number,version:{type:Number,validator:e=>e===parseInt(String(e),10)&&e>1&&e<=kr},errorCorrectionLevel:{type:String,validator:e=>jr.includes(e)},maskPattern:{type:Number,validator:e=>Ir.includes(e)},quality:{type:Number,validator:e=>e===parseFloat(String(e))&&e>=0&&e<=1},type:{type:String,validator:e=>Or.includes(e)},color:{type:Object,default:()=>({dark:"#000000",light:"#FFFFFF"}),validator(e){return["dark","light"].every(t=>["string","undefined"].includes(typeof e[t]))}},value:{type:String,required:!0,validator(e){if("string"===typeof e)return!0}}},setup(e){const t=Object(n["ref"])("");return Object(n["watchEffect"])(()=>{const o=Object.assign(e,null==e.quality||{renderOptions:{quality:e.quality}});Sr.a.toDataURL(e.value,o).then(e=>{t.value=e}).catch(e=>{})}),{dataUrl:t}}},Er=o("6b0d"),Tr=o.n(Er);const Pr=Tr()(Cr,[["render",wr]]);var _r=Pr,Ar=_r;const Mr=e=>(Object(n["pushScopeId"])("data-v-1cd26214"),e=e(),Object(n["popScopeId"])(),e),Hr={class:"mobile-play-container"},zr=Mr(()=>Object(n["createElementVNode"])("div",{class:"background"},null,-1)),Lr={class:"prompt"},Dr=Mr(()=>Object(n["createElementVNode"])("div",{class:"prompt-top"},"该全景仅支持手机访问，请扫描二维码浏览",-1)),Br={key:0,class:"prompt-bottom"},Nr={class:"prompt-image"};var Vr=Object(n["defineComponent"])({__name:"mobile_play",setup(e){const t=Object(n["computed"])(()=>window.location.href);return(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Hr,[zr,Object(n["createElementVNode"])("div",Lr,[Dr,t.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Br,[Object(n["createElementVNode"])("div",Nr,[Object(n["createVNode"])(Object(n["unref"])(Ar),{value:t.value,color:{dark:"#707070",light:"#f8f8f9"},width:140},null,8,["value"])])])):Object(n["createCommentVNode"])("",!0)])]))}});o("1e04");const Rr=Tr()(Vr,[["__scopeId","data-v-1cd26214"]]);var Fr=Rr,Gr=o("fd82");const Wr=e=>(Object(n["pushScopeId"])("data-v-4d1cc623"),e=e(),Object(n["popScopeId"])(),e),$r={class:"check__space"},Ur={key:0,class:"check__error"},Xr={class:"tips__inner"},Yr=["src"],Zr={class:"text"},qr={key:0,class:"text"},Kr=Wr(()=>Object(n["createElementVNode"])("br",null,null,-1)),Jr=Wr(()=>Object(n["createElementVNode"])("br",null,null,-1));var Qr=Object(n["defineComponent"])({__name:"index",emits:["pass"],setup(e,{emit:t}){const s=Object(n["ref"])(!0),c=Object(n["ref"])("");function l(){return new Promise(e=>{yo.load().then(e=>e.get()).then(t=>{const o=t.visitorId||"";e(o)})})}async function d(e){const t={materialId:i["b"].state.proInfo.pid};e&&(t.identity=e);const o=await ko(t);if(-10===o.resCode)b.value=1;else if(528===o.resCode)b.value=3;else if(1===o.resCode){const e=o.resData||{};u(t,e)}o.resData&&(c.value=o.resData.name||"")}function u(e,t){const o=e=>{i["b"].commit(jo["v"],{...e.Statistics})};t.Statistics?o(t):Oo(e).then(e=>{1===e.resCode&&o(e.resData||{})})}async function p(){const e=window.location.href.indexOf("each_version")>=0,t="../files/material/",o=i["b"].state.viewMode.local?"files":(e?"../":"")+t,n=!i["b"].state.viewMode.local&&i["b"].state.viewMode.preview,s=i["b"].state.viewMode.admin||n?"guideM.json":"guide.json",a=i["b"].state.viewMode.local?"":i["b"].state.proInfo.pid,r=o+a+"/"+s+"?time="+Date.now(),c=await Object(xo["b"])(r);void 0==c.enableRelativePath&&(c.enableRelativePath=!0),c.enableRelativePath&&h(c.useCdn),i["b"].commit(jo["n"],{enableRelativePath:c.enableRelativePath});const l=[-10,4];i["b"].state.viewMode.preview&&l.push(2);const d=void 0==c.auditStatus||l.indexOf(c.auditStatus)>=0;if(c["allList"]&&d||(b.value=1),d){f(c);const e=await gr();if(!e)return void(b.value=1);if(!m())return void(b.value=5);Object(Gr["a"])()}}function h(e=!1){let t=r().previewPath,o=document.querySelector("head base");if(!o){o=document.createElement("base");const e=document.querySelector("head");e&&e.appendChild(o)}"sandbox.inibiru.com"===location.host?t="http://sandbox.inibiru.com/creator":e&&i["b"].state.publicConfig.cdnUrl&&(t=i["b"].state.publicConfig.cdnUrl),o.href=t+"/";const n=document.querySelector('head link[rel="icon"]');if(n){const e=a()+n.getAttribute("href");n.setAttribute("href",e)}}function f(e){const t=[];for(const o in e){const n=e[o];"allList"===o?t.push({key:"pro",path:n}):/^[1-9]\d*_scene$/.test(o)&&t.push({id:parseInt(o),key:"scene",path:n})}i["b"].commit(jo["i"],t)}function m(){const e=i["b"].state.skyBoxSceneGroup.weChatShare;return s.value=!e.onlyOnMobile||Object(To["d"])(),s.value}function v(){const e=[{code:1,message:"抱歉，页面出错了~",path:a()+o("e24d"),remark:"链接404了"},{code:2,message:"抱歉，服务器出错了~",path:a()+o("e24d"),remark:"服务器出错了"},{code:3,message:"作品过于火爆，流量不足啦，请联系开发者",path:a()+o("6e9c"),remark:"流量空了"},{code:4,message:"暂时无法访问",path:a()+o("e24d"),remark:"链接不合法"},{code:5,message:"",path:"",remark:"环境不匹配"}],t=Object(n["ref"])(0),i=Object(n["computed"])(()=>e[t.value-1].path),s=Object(n["computed"])(()=>e[t.value-1].message);return{errorCode:t,errorCover:i,errorMessage:s}}const{errorCode:b,errorCover:g,errorMessage:y}=v();function w(){const e=()=>{const e=Object(Ti["c"])("scr");if(e){const t=new window.JSEncrypt;t.setPublicKey("-----BEGIN PUBLIC KEY-----\n        MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCzF3dokD0STzopdks7ex22cyeB\n        +CD3fSdRbJkNt1oKE1zW1ksh8IQ/xP/Ccxa0s5UNOTaMYv+13HV9EEjH6hS/AVXS\n        IYAai2Ml1GJMLH0kb/InJCLIC2NzDH6onNVNzUgENFN0imgAAhbWsXeAdv3cZ3j0\n        PDAmiV+XXkpvQL3qOwIDAQABmT5SketlQ3c7tucI+QIDAQAB\n        -----END PUBLIC KEY-----");const o=t.decryptByPublic(e);if(o){const e=Object(Ti["c"])("id",o);let t=Object(Ti["b"])(location.search,["scr","id"]);"?"===t.charAt(0)?t+="&id="+e:t+="?id="+e,i["b"].commit(jo["n"],{pid:e}),history.replaceState(null,"",t)}else b.value=4}};return{checkDecryptPass:e}}const{checkDecryptPass:x}=w();function S(){const e=async()=>{if(!i["b"].state.viewMode.offline){const e=await l();i["b"].commit(jo["v"],{identity:e});const t=i["b"].state.proInfo.pid&&wo("Flow");t&&await d(e)}};return{checkFlowPass:e}}const{checkFlowPass:I}=S(),k=async()=>{x(),b.value||await I(),b.value||await p(),window.console.log("项目错误码",b.value),t("pass",b.value?-1:1)};return k(),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createElementVNode"])("div",$r,[Object(n["unref"])(b)&&Object(n["unref"])(g)?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ur,[Object(n["createElementVNode"])("div",Xr,[Object(n["createElementVNode"])("img",{src:Object(n["unref"])(g),alt:""},null,8,Yr),Object(n["createElementVNode"])("span",Zr,Object(n["toDisplayString"])(Object(n["unref"])(y)),1),3===Object(n["unref"])(b)?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",qr,[Kr,Jr,Object(n["createTextVNode"])(Object(n["toDisplayString"])(c.value),1)])):Object(n["createCommentVNode"])("",!0)])])):Object(n["createCommentVNode"])("",!0)]),5===Object(n["unref"])(b)?(Object(n["openBlock"])(),Object(n["createBlock"])(Fr,{key:0})):Object(n["createCommentVNode"])("",!0)],64))}});o("bf0b");const ec=Tr()(Qr,[["__scopeId","data-v-4d1cc623"]]);var tc=ec,oc=o("47e2");const nc={class:"cm__progress"},ic={class:"progress--percent"},sc={class:"progress--container"};var ac=Object(n["defineComponent"])({__name:"progress",props:{percent:Number},setup(e){const t=e;return(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",nc,[Object(n["createElementVNode"])("div",ic,Object(n["toDisplayString"])(t.percent)+"%",1),Object(n["createElementVNode"])("div",sc,[Object(n["createElementVNode"])("div",{class:"progress--inner",style:Object(n["normalizeStyle"])({width:t.percent+"%"})},null,4)])]))}});o("da5f");const rc=Tr()(ac,[["__scopeId","data-v-1362e860"]]);var cc=rc;const lc=Ds(),dc={pro:{matId:0,localProjectId:"",name:"",proId:"",devName:"",lastModifyTime:0,versionNo:"",startTime:"",endTime:"",browser:0},projectEvent:{matId:0,localProjectId:"",proId:"",objectId:0,objectName:""},projectVariable:[]};function uc(e){if(dc.pro.startTime)if(dc.pro.proId=dc.pro.proId?dc.pro.proId:String(Date.now()+""+(Math.floor(9e3*Math.random())+1e3)),dc.pro.matId=i["b"].state.proInfo.pid,dc.pro.localProjectId=i["b"].state.skyBoxSceneGroup.statistics.localProId,dc.pro.name=i["b"].state.proInfo.name,dc.pro.devName=i["b"].state.proInfo.devName,dc.pro.lastModifyTime=Number(i["b"].state.skyBoxSceneGroup.statistics.lastModifyTime),dc.pro.versionNo=i["b"].state.proInfo.version,dc.pro.endTime=Bo(Date.now()),dc.pro.browser=Object(To["a"])(),e){fc();let e=[];const t={type:"ProjectView",data:dc.pro};e=[t,...dc.projectVariable];const o=new FormData;o.append("data",JSON.stringify(e)),o.append("playerVersionNo",window.codeVersion||""),navigator.sendBeacon(window.creatorReportPath,o)}else vc("pro")}function pc(e,t){const o=i["b"].state.device.mobile,n="component"===e||"parentComponent"===e?0:o?2:1;t.statisticsProperity&&t.statisticsProperity.needStatistics[n]&&(dc.projectEvent.matId=dc.pro.matId,dc.projectEvent.localProjectId=dc.pro.localProjectId,dc.projectEvent.proId=dc.pro.proId,dc.projectEvent.objectId=t.statisticsProperity.id,dc.projectEvent.objectName=t.statisticsProperity.statisticsName,dc.pro.endTime=Bo(Date.now()),vc("projectEvent"))}function hc(){fc(),0!==dc.projectVariable.length&&(dc.pro.endTime=Bo(Date.now()),vc("projectVariable"))}function fc(){const e=i["b"].state.device.mobile,t=e?2:1;dc.projectVariable=[];let o=[];const n=i["b"].state.skyBoxSceneGroup.sceneList||[];n.forEach(e=>{e.variables&&e.variables.length>0&&(o=[...o,...e.variables])});const s=[...o,...i["b"].state.skyBoxSceneGroup.glVariables];s.forEach(e=>{e.statisticsProperity&&e.statisticsProperity.needStatistics[t]&&dc.projectVariable.push({type:"ProjectVariable",data:{matId:dc.pro.matId,proId:dc.pro.proId,localProjectId:dc.pro.localProjectId,variableId:e.id,variableName:e.name,variableValue:Number(e.value).toString()}})})}function mc(e,t=!1){const o=i["b"].state.sceneInfo.title;if(!dc.pro.proId||!e.enableStatistics)return;const n={type:"ProjectInput",data:{proId:dc.pro.proId,localProjectId:dc.pro.localProjectId,devName:dc.pro.devName,sceneId:i["b"].state.sceneInfo.id,sceneName:o?o.split(".").shift():"",inputTitle:e.label,inputContent:e.value,matId:dc.pro.matId}},s=new FormData;s.append("data",JSON.stringify([n])),s.append("playerVersionNo",window.codeVersion||""),t?navigator.sendBeacon(window.creatorReportPath,s):Object(xo["f"])(s).then(e=>{e&&1===e.resCode&&window.console.log("成功")})}function vc(e){let t="",o=[];const n={type:"ProjectView",data:dc["pro"]};switch(e){case"pro":t="ProjectView",o=[{type:t,data:dc[e]}];break;case"projectEvent":t="ProjectEvent",o=[n,{type:t,data:dc[e]}];break;case"projectVariable":t="ProjectVariable",o=[n,...dc.projectVariable];break}const i=new FormData;i.append("data",JSON.stringify(o)),i.append("playerVersionNo",window.codeVersion||""),Object(xo["f"])(i).then(e=>{e.resCode})}lc.on("update",({key:e,value:t})=>{const o=e.split(".");if(o.length>1){let e=o.shift(),n={};while(e&&o.length>=1)n=dc[e],e=o.shift();n[e]=t}else dc[e]=t}),lc.on("action",async({key:e,data:t,isUnload:o=!1})=>{const n=window.creatorReportPath&&wo("Statistics");if(n&&i["b"].state.skyBoxSceneGroup.statistics.enable)switch(dc.pro.localProjectId||(dc.pro.localProjectId=i["b"].state.skyBoxSceneGroup.statistics.localProId),e){case"pro":uc(o);break;case"variable":hc();break;case"hotspot":pc(e,t);break;case"trigger":pc(e,t);break;case"selector":pc(e,t);break;case"part":pc(e,t);break;case"component":pc(e,t);break;case"parentComponent":pc(e,t);break;case"changeScene":pc(e,t);break;case"formInput":mc(t);break}});var bc=lc;const gc={key:0,class:"launch__inner"},yc=["src"],wc={class:"m_title"},xc={class:"v_title"},Sc={class:"desc"},Ic={key:1,class:"launch__inner"},kc={class:"diy__bg"},Oc=["src"],jc={key:2,class:"cover__bg"},Cc={class:"progress-space"},Ec=Object(n["createElementVNode"])("div",{class:"s_logo"},null,-1),Tc={class:"s_info"};var Pc=Object(n["defineComponent"])({__name:"index",setup(e){function t(){const e=Object(n["ref"])(""),t=Object(n["ref"])(!1),o=Object(n["ref"])(!1),s=Object(n["ref"])(!1),a=!1,c=window.location.href.indexOf("each_version")>=0,l=i["b"].state.viewMode.local?"files":(c?"../":"")+"files/material/",d=!i["b"].state.viewMode.local&&i["b"].state.viewMode.preview,u=i["b"].state.viewMode.admin||d?"startM.json":"start.json",p=i["b"].state.viewMode.local?"":i["b"].state.proInfo.pid,h=l+p+"/"+u+"?time="+Date.now();return Object(xo["b"])(h).then(n=>{n&&(o.value=!0,s.value=!0,n.weChatshare&&(e.value=(a?r().previewPath+"/":"")+n.weChatshare.launchPath||"",t.value=!!n.weChatshare.showLaunch))}).catch(s=>{window.console.log(s),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedDefine,n=>{if(n){const n=i["b"].state.skyBoxSceneGroup.weChatShare||{};e.value=n.launchPath,t.value=!!n.launchPath,o.value=!0}})}),{launchPath:e,isDiyMode:t,isLoadedFetch:o}}const{launchPath:s,isDiyMode:c,isLoadedFetch:l}=t();function d(){const{locale:e}=Object(oc["b"])(),t=Object(n["computed"])(()=>a()+o("b167"));function i(){const e="RYNibiruCreator2021",t=t=>window.CryptoJS.AES.encrypt(t,e).toString(),o=t=>window.CryptoJS.AES.decrypt(t,e).toString(window.CryptoJS.enc.Utf8);return{encrypt:t,decrypt:o}}const{decrypt:s}=i(),r={mTitle:s("U2FsdGVkX19nQaEGLv/0HO88bSrwfrDbuphFVqCA73w="),sTitle:s("U2FsdGVkX1+Gc/oG+DULUZxJv6GY+yWglzgf+BYslWU="),desc:s("zh"===e.value?"U2FsdGVkX1/GjjF1zVPeGSuyYE1e9urM9tXwcR8tE0wsCY4BBGrfEUYsY5ng15JZ":"U2FsdGVkX1/Q8pydt0TClXDtqFkvvEYjsD76fR3Ldg3M1kZ/lHF1b3lpGK9a4jNV"),original:s("U2FsdGVkX18ajKtiu95QP+MgNFG+c1N70DxIn0SXK68CHMbvh4FYiVyMuOYRVoIU")};return{logoSrc:t,launchData:r}}const{logoSrc:u,launchData:p}=d();function h(){let e=0;const t=Object(n["ref"])(0);let o=1.2;const s=()=>{window.clearInterval(e),e=window.setInterval(()=>{95!==t.value?(t.value+=Math.ceil(3*o),o=Math.max(.1,o-.05)):clearInterval(e)},100)};return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,n=>{n&&t.value<100&&(clearInterval(e),t.value=100,o=1.2,m())}),Ns.on("hide::launch",()=>{clearInterval(e)}),s(),{percent:t}}const{percent:f}=h();function m(){bc.emit("update",{key:"pro.startTime",value:Bo(Date.now())}),bc.emit("action",{key:"pro"})}return(e,t)=>Object(n["unref"])(l)?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:Object(n["normalizeClass"])(["launch-page__wrap",{normal:Object(n["unref"])(l)&&!Object(n["unref"])(c)}])},[Object(n["unref"])(c)?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",gc,[Object(n["createElementVNode"])("img",{class:"logo",src:Object(n["unref"])(u),alt:""},null,8,yc),Object(n["createElementVNode"])("h2",wc,[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(Object(n["unref"])(p).mTitle),1)]),Object(n["createElementVNode"])("h3",xc,[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(Object(n["unref"])(p).sTitle),1)]),Object(n["createElementVNode"])("p",Sc,Object(n["toDisplayString"])(Object(n["unref"])(p).desc),1)])),Object(n["unref"])(c)?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ic,[Object(n["createElementVNode"])("div",kc,[Object(n["createElementVNode"])("img",{src:Object(n["unref"])(s),alt:""},null,8,Oc)])])):Object(n["createCommentVNode"])("",!0),Object(n["unref"])(c)?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",jc)),Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["diy__footer",{normal:!Object(n["unref"])(c)}])},[Object(n["createElementVNode"])("div",Cc,[Object(n["createVNode"])(cc,{percent:Object(n["unref"])(f)},null,8,["percent"])]),Object(n["unref"])(c)?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Ec,Object(n["createElementVNode"])("div",Tc,[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(Object(n["unref"])(p).original),1)])],64)):Object(n["createCommentVNode"])("",!0)],2)],2)),[[n["vShow"],Object(n["unref"])(f)>0&&Object(n["unref"])(f)<100]]):Object(n["createCommentVNode"])("",!0)}});o("979e");const _c=Pc;var Ac=_c;const Mc=e=>i["b"].state.mappings.icon?(e.fileUrl=Co(e.fileName),e.skyImagehot&&(e.skyImagehot.imageHotPot.fileUrl=Co(e.skyImagehot.imageHotPot.imageName)),e.groundImagehot&&(e.groundImagehot.imageHotPot.fileUrl=Co(e.groundImagehot.imageHotPot.imageName)),e.subtitle&&(e.subtitle.subtitlePath=Co(e.subtitle.subtitlePath)),e.sceneEffect&&(e.sceneEffect.effectIconPath=Co(e.sceneEffect.effectIconPath)),e.backGroundAudio&&(e.backGroundAudio.fileUrl=Co(e.backGroundAudio.filePath)),e.iconUrl=Co(e.iconPath),e.videoSnapshotPath=Co(e.videoSnapshotPath),e.liveScene&&(e.liveScene.liveCoverPath=Co(e.liveScene.liveCoverPath)),e):e;var Hc=Mc;const zc=e=>i["b"].state.mappings.icon?(e.iconTrigger&&(e.iconTrigger.iconPath=Co(e.iconTrigger.iconPath)||ri.image,e.iconTrigger.modelCapturePath=Co(e.iconTrigger.modelCapturePath),e.iconTrigger.triggerEffect&&(e.iconTrigger.triggerEffect.iconMovePath=Co(e.iconTrigger.triggerEffect.iconMovePath),e.iconTrigger.triggerEffect.iconClickPath=Co(e.iconTrigger.triggerEffect.iconClickPath),e.iconTrigger.triggerEffect.audioMovePath=Co(e.iconTrigger.triggerEffect.audioMovePath),e.iconTrigger.triggerEffect.audioClickPath=Co(e.iconTrigger.triggerEffect.audioClickPath))),e.activeAreaTrigger&&(e.activeAreaTrigger.iconInfo.iconPath=Co(e.activeAreaTrigger.iconInfo.iconPath)||ri.image,e.activeAreaTrigger.iconInfo.modelCapturePath=Co(e.activeAreaTrigger.iconInfo.modelCapturePath)),e.timerTrigger&&(e.timerTrigger.iconPath=Co(e.timerTrigger.iconPath)),e.switchTrigger&&(e.switchTrigger.openIconPath=Co(e.switchTrigger.openIconPath),e.switchTrigger.closeIconPath=Co(e.switchTrigger.closeIconPath)),e.sliderTrigger&&(e.sliderTrigger.iconPath=Co(e.sliderTrigger.iconPath),e.sliderTrigger.bgIconPath=Co(e.sliderTrigger.bgIconPath),e.sliderTrigger.handleIconPath=Co(e.sliderTrigger.handleIconPath)),e.dialTrigger&&(e.dialTrigger.bgIconPath=Co(e.dialTrigger.bgIconPath),e.dialTrigger.handleIconPath=Co(e.dialTrigger.handleIconPath)),e.animationPath&&(e.animationPath=e.animationPath.map(e=>Co(e,!1))),e):e;var Lc=zc;function Dc(e=[],t,o){const n=[];return e.forEach(e=>{const t=Bc(Lc(e));n.push(t)}),Rc(n,t,o),n}function Bc(e){var t,o,n,s,a,r,c,l,d,u;const p=null!==(t=null===(o=i["b"].state.skyBoxSceneGroup)||void 0===o||null===(n=o.platformInfo)||void 0===n?void 0:n.radius)&&void 0!==t?t:0,h=Po(i["b"].state.proInfo.version,"5.9.0"),f={id:e.id,type:Number(Ft[e.type]),name:e.title.name,showName:e.title.isShow,fontStyle:Nc(e.title.font),rotate:Qn(e.eulerAngle),position:ei(e.scenePos),startTime:Number(e.startTime),endTime:Number(e.endTime),relations:ai(e.id,e.relation),conditionTrigger:pi(e.triggerConditionSetting),isShow:!h||(null===(s=e.isShow)||void 0===s||s),opacity:h&&null!==(a=e.opacity)&&void 0!==a?a:1,scale:h&&null!==(r=e.scale)&&void 0!==r?r:1,radius:h&&null!==(c=e.posR)&&void 0!==c?c:p,signalGear:null!==(l=e.signalGear)&&void 0!==l&&l,animationInfos:e.animationPath?ti(e.animationPath):null,statisticsProperity:e.statisticsProperity,propertyControl:ii(e.propertyControl)};f.zorder=100-f.radius;const m=null!==(d=i["b"].state.prefixDefine.is2dRender)&&void 0!==d?d:null===(u=i["b"].state.sceneInfo)||void 0===u?void 0:u.is2dRender;return m&&void 0!==e.renderOrder&&(f.zorder=e.renderOrder),f.iconData=Vc(e,f.type),0===f.type&&(f.hotspotTriEffect=ni(e.iconTrigger.triggerEffect)),f}function Nc(e){const t={fontFamily:"Youyuan",fontSize:e.size,fontColor:{x:255,y:255,z:255},fontAlign:"center",italic:!1,bold:!1,underline:!1,wordSpace:0,backgroundColor:{x:0,y:0,z:0},backgroundAlpha:.6,round:5,showSize:{x:0,y:0}},o={};return e&&(o.fontFamily=e.family,o.fontSize=e.size,o.fontColor=e.color,o.bold=e.bold||!1,o.italic=e.italic||!1,o.underline=e.underline||!1,o.wordSpace=e.workSpacing||0),zo(t,o)}function Vc(e,t){var o;let n,i,s=null;switch(t){case 0:i=e.iconTrigger||{},s={iconPath:i.iconPath,mtlPath:i.modelCapturePath,modelScale:i.modelScale>0?i.modelScale:1,isModelIcon:/\.(obj|fbx)$/i.test(i.iconPath),gifInfo:Jn(i.gifInfo,i.iconPath),showSize:i.size,triggerMode:null!==(o=Vt[i.triggerPlayMode])&&void 0!==o?o:0};break;case 1:n=e.activeAreaTrigger||{},i=e.activeAreaTrigger.iconInfo||{},s={iconPath:i.iconPath,mtlPath:i.modelCapturePath,modelScale:i.modelScale>0?i.modelScale:1,isModelIcon:/\.(obj|fbx)$/i.test(i.iconPath),gifInfo:Jn(i.gifInfo,i.iconPath),showSize:i.size,activearea:{position:ei(n.areaPos),vecPos:{leftTop:ei(n.leftTopPos),rightTop:ei(n.rightTopPos),rightBottom:ei(n.rightBottomPos),leftBottom:ei(n.leftBottomPos)},isReturn:n.isReturn,isAutoTrigger:n.isAutoTrigger,special:!1},allowModelViewer:n.allowModelViewer};break;case 2:n=e.timerTrigger||{},s={iconPath:n.iconPath,gifInfo:Jn(n.gifInfo,n.iconPath),showSize:n.size,isShowTime:n.isShowTime,direction:Gt[n.timeDirection],font:{size:n.timeFont.size,color:n.timeFont.color},time:n.time/1e3,isRelationOther:!1,isCountDown:n.isCountDown};break;case 3:n=e.switchTrigger||{},s={openIcon:{iconPath:n.openIconPath,gifInfo:Jn(n.gifInfo,n.openIconPath)},closeIcon:{iconPath:n.closeIconPath,gifInfo:Jn(n.gifInfo,n.closeIconPath)},showSize:n.size,status:!1};break;case 4:n=e.sliderTrigger||{},s={handleIcon:{iconPath:n.handleIconPath,gifInfo:Jn(n.gifInfo,n.handleIconPath),showSize:n.handleSize},cycleIcon:{iconPath:n.bgIconPath,gifInfo:Jn(n.gifInfo,n.bgIconPath),showSize:n.bgSize},initValue:0,maxValue:n.maxValue};break;case 5:n=e.dialTrigger||{},s={handleIcon:{iconPath:n.handleIconPath,gifInfo:Jn(n.gifInfo,n.handleIconPath),showSize:n.handleSize},cycleIcon:{iconPath:n.bgIconPath,gifInfo:Jn(n.gifInfo,n.bgIconPath),showSize:n.bgSize},initValue:0,maxValue:n.maxValue};break;case 6:n=e.inputTrigger||{},s={inputValue:n.inputValue};break;default:break}return s}function Rc(e,t,o){const n=e.filter(e=>2===e.type);n.forEach(n=>{let i=[];e.forEach(e=>{if(e.id!==n.id){const t=e.relations.map(e=>e.targetId);i.push(...t)}}),i=Array.from(new Set(i));const s=t.map(e=>e.nextSceneId);let a=[];o.forEach(e=>{const t=e.lines.map(e=>e.targetId);a.push(...t)}),a=Array.from(new Set(a)),n.iconData.isRelationOther=[...i,...s,...a].indexOf(n.id)>=0})}const Fc=function(e){const t=[];return e.forEach(e=>{e&&t.push(Gc(e))}),t},Gc=function(e){var t,o,n,s,a,r;const c=si(e.platformInfo),l=null!==(t=e.posR)&&void 0!==t?t:0;let d=100-l;const u=null!==(o=i["b"].state.prefixDefine.is2dRender)&&void 0!==o?o:null===(n=i["b"].state.sceneInfo)||void 0===n?void 0:n.is2dRender;return u&&void 0!==e.renderOrder&&(d=e.renderOrder),{id:e.id,name:e.name,sceneId:e.sceneId,position:ei(c.position),rotate:Qn(c.eulerAngle),displayAlign:c.displayAlign||1,labelSize:e.labelSize,showName:!!e.showName,startTime:Number(e.startTime),triggerTime:Number(e.triggerTime),startIndex:e.startIndex[0],endIndex:e.endIndex[0],nextSceneId:e.nextSceneIds[0],isEvent:null!==(s=e.isEndEvent)&&void 0!==s&&s,radius:l,opacity:null!==(a=e.opacity)&&void 0!==a?a:1,scale:null!==(r=e.scale)&&void 0!==r?r:1,zorder:d}},Wc=function(e){var t,o,n,s,a,r,c;const l=Hc(e),d=$c(l.platformInfos);l.sceneEffect&&(5===l.sceneEffect.sceneEffectType&&(l.sceneEffect.sceneEffectType="RedPacket"),6===l.sceneEffect.sceneEffectType&&(l.sceneEffect.sceneEffectType="GoldIngot"),7===l.sceneEffect.sceneEffectType&&(l.sceneEffect.sceneEffectType="Love"));const u=Number(mo[l.vrType]),p=Po(i["b"].state.proInfo.version,"6.3.0"),h=p?(null!==(t=l.volumeLevel)&&void 0!==t?t:100)/100:1,f={id:l.id,title:l.sceneName,titleStyle:l.scenePlayTitle,type:l.scenetype,sort:l.sort,is2dRender:!Kt[l.renderMode],hlookat:1===u?-90:An(l.majorViewAngle)||0,vlookat:Mn(l.majorViewAngleY)||0,fov:d.fov,src:l.fileUrl||"",iconUrl:l.iconUrl||"",size:Uc(l.scenetype,l.video,l.liveScene),platformType:d.platformType,parts:[],triggers:[],hotspots:[],conditioners:di(l.conditioner||[]),subtitle:Xc(l.subtitle),events:Fc(l.events||[]),music:Qc(l.backGroundAudio),isDefaultEnableGyro:Kt[l.renderMode]&&!!d.gyroScope||!1,skyShadeHot:Yc(l.skyImagehot),groundShadeHot:Yc(l.groundImagehot),cutStartTime:Number(l.cutStartTime),cutEndTime:Number(l.cutEndTime),poster:l.videoSnapshotPath||l.iconUrl,volume:h,replayVideo:l.replayVedio||0,enableProgress:!!l.isSliderShown,playbackrate:1,startForward:0,duration:l.video?(l.totalTime||l.video.duration)/1e3:0,curSceneCruising:{mode:l.curSceneCruising?zt[l.curSceneCruising.curCruisingType]:1,time:l.curSceneCruising?l.curSceneCruising.cruisingTime:60},effect:{type:l.sceneEffect?Lt[l.sceneEffect.sceneEffectType]:0,iconPath:l.sceneEffect&&l.sceneEffect.effectIconPath,size:l.sceneEffect?Dt[l.sceneEffect.showSceneEffect]:0,sunPos:l.sceneEffect&&l.sceneEffect.sunPos&&{ath:An(l.sceneEffect.sunPos.x||0),atv:Mn(l.sceneEffect.sunPos.y||0)}},isHiddenSetting:!1,isHideFlowSceneName:null!==(o=l.isHideFlowSceneName)&&void 0!==o&&o,statisticsProperity:l.statisticsProperity,variables:Yn(l.variableScene),randomItems:qc(null!==(n=l.randomInstances)&&void 0!==n?n:[]),operationItems:qc(null!==(s=l.operationItems)&&void 0!==s?s:[]),logicItems:qc(null!==(a=l.logicItems)&&void 0!==a?a:[]),variItems:qc(null!==(r=l.variableInstances)&&void 0!==r?r:[]),propertyControl:Jc(null!==(c=l.sceneInteractItems)&&void 0!==c?c:[]),initItems:Kc(l.initItem),renderOrderList:l.renderPriorityOrder||[],vrType:u};if(i["b"].commit(jo["k"],{is2dRender:f.is2dRender,sceneSize:f.size}),3!==f.type&&(f.parts=mi(l.componentParts),f.hotspots=Pi(l.hotPots),f.triggers=Dc(l.triggers,f.conditioners,f.logicItems)),_o(i["b"].state.proInfo.version,"6.3.0")){if(2!==f.type&&f.is2dRender){let e=[];e=e.concat(f.hotspots,f.parts,f.triggers),e=e.sort((e,t)=>e.id-t.id),e.map((e,t)=>{e.zorder=t+1})}}else f.renderOrderList.length&&f.is2dRender&&(tl(f.parts,f.renderOrderList),tl(f.hotspots,f.renderOrderList),tl(f.triggers,f.renderOrderList));var m,v;Po(i["b"].state.proInfo.version,"5.9.0")&&(f.isHiddenSetting=!(null===(m=l.isShowScene)||void 0===m||m));(f.subtitle.follow&&!f.music.path&&(f.subtitle.follow=0),3===f.type&&(f.liveScene=Zc(l.liveScene)),1===f.type&&f.isHiddenSetting&&(f.poster="",f.src="",f.enableProgress=!1,f.replayVideo=!1),Po(i["b"].state.proInfo.version,"6.1.1"))&&(f.isLockViewAngle=null!==(v=l.isLockViewAngle)&&void 0!==v&&v);const b=el({fov:d.fov});f.fov=b.fov,f.fovmax=b.fovmax,f.fovmin=b.fovmin;const g=Po(i["b"].state.proInfo.version,"6.3.2")&&1===u;return f.hlookatMax=g?0:180,f.hlookatMin=-180,f.vlookatMax=g?89:90,f.vlookatMin=g?-89:-90,f};function $c(e){const t=i["b"].state.device.mobile?"mobile":"pc",o={fov:75,z:18,platformType:"pc"};return e.find(e=>e.platformType.toLocaleLowerCase()===t)||o}function Uc(e,t,o){const n={width:0,height:0};if(3===e){const e=o.liveSize||{x:1920,h:960};n.width=e.x,n.height=e.y}else n.width=t.width,n.height=t.height;return n}function Xc(e){return e?{path:e.subtitlePath||"",offset:e.offset,font:{family:e.font.family,size:e.font.size||14,color:dn(e.font.color,e.font.color.w/255),weight:e.font.bold?"700":"none",style:e.font.italic?"italic":"none",decoration:e.font.underline?"underline":"none",letterSpacing:e.font.workSpacing,lineSpacing:e.font.lineSpacing,background:dn(e.backgroundColor,e.backgroundColor.w/255),alignMode:e.font.fontAlign},pos:Wt[e.alignment],follow:$t[e.followType]||0,textEffect:e.textEffect?Yt[e.textEffect]:-1,showRect:e.showRect||{}}:{}}function Yc(e){return e?{path:e.imageHotPot.fileUrl,size:e.imageHotPot.showSize,rotate:{rx:0,ry:0,rz:0}}:{}}function Zc(e){const t=Object(n["reactive"])({liveId:e.liveId,liveName:e.liveName,liveStreamPath:e.liveSourceAddress,livePath:e.liveWatchAddress,liveType:po[e.liveType],livePoster:e.liveCoverPath,showRect:e.showRect});return wo("Live")&&oi(t.liveId).then(e=>{t.liveName=e.name||t.liveName,t.liveStreamPath=e.flowUrl||t.liveStreamPath,t.livePath=e.viewUrl||t.livePath}),t}function qc(e){return e.map(e=>{e.lines&&e.lines.length&&(e.lines=ai(e.itemId||0,e.lines))}),e}function Kc(e={}){const t={lines:[],id:e.itemId||0};return e&&e.lines&&e.lines.length&&(t.lines=ai(e.itemId||0,e.lines)),t}function Jc(e){const t=[];return e.forEach(e=>{const o={id:e.itemId,sid:e.sceneId,properties:{fov:{isActive:e.fovEnable,varId:e.fovVariableId,operType:e.fovOperationType},angleX:{isActive:e.viewAngleXEnable,varId:e.viewAngleXVariableId,operType:e.viewAngleXOperationType},angleY:{isActive:e.viewAngleYEnable,varId:e.viewAngleYVariableId,operType:e.viewAngleYOperationType},backrate:{isActive:e.videoPlaySpeedEnable,varId:e.videoPlaySpeedVariableId},forward:{isActive:e.videoProgressOffsetEnable,varId:e.videoProgressOffsetVariableId},seek:{isActive:e.videoProgressEnable,value:Number(e.videoProgress)/1e3},move:{isActive:e.moveTotalEnable,type:bo[e.moveType]||0,direction:go[e.moveDirection]||0,rotateTimeType:Number(e.useMoveCostTimeStaticValue),rotateTimeVarId:e.moveCostTimeVariableId||0,rotateTimeValue:e.moveCostTimeStaticValue||0,rotateOperType:e.moveOperationType,rotateVarId:e.moveVariableId}}};t.push(o)}),t}function Qc(e={}){var t;const o=Po(i["b"].state.proInfo.version,"6.3.0"),n=o?(null!==(t=e.volumeLevel)&&void 0!==t?t:100)/100:1;return{path:e.fileUrl||e.filePath||"",loop:-1===e.loopTime||!1,volume:n}}function el(e){const t=i["b"].state.device.mobile;let o=e.fov,n=179,s=1;const a=Po(i["b"].state.proInfo.version,"6.3.5"),r=Po(i["b"].state.proInfo.version,"6.3.0");return r&&(n=120,s=t?80:60),a?o=e.fov:r&&(o=t?100:75),{fov:o,fovmax:n,fovmin:s}}function tl(e,t){e.forEach(e=>{const o=t.indexOf(e.id);o>=0&&(e.zorder=100-o)})}var ol=Wc;function nl(e){return new Promise(t=>{const o=i["b"].state.nplData.find(t=>"scene"===t.key&&t.id===e);if(null!==o&&void 0!==o&&o.path){const n=al(e);if(n){const o=sl(e);t(o)}else Object(xo["b"])(o.path).then(o=>{il(e,o),t(!0)}).catch(()=>{t(!1)})}else t(!1)})}const il=(e,t)=>{const o=ol(t.worksScene);i["b"].commit(jo["q"],o),i["b"].commit(jo["r"],o),rl();const n=i["b"].state.proInfo.sceneIds||[];n.push(e),i["b"].commit(jo["n"],{sid:e,sceneIds:n})},sl=e=>{const t=i["b"].state.skyBoxSceneGroup.sceneList.find(t=>t.id===e);return!!t&&(i["b"].commit(jo["k"],{is2dRender:null,sceneSize:null}),i["b"].commit(jo["q"],t),i["b"].commit(jo["n"],{sid:e}),!0)};function al(e){const t=i["b"].state.proInfo.sceneIds||[];return t.find(t=>t===e)}function rl(){function e(e){const t=i["b"].state.nplData.find(t=>"scene"===t.key&&t.id===e),o=al(e);!o&&t&&Object(xo["b"])(t.path).then(e=>{const t=vs(e.worksScene);i["b"].commit(jo["r"],t),Ns.emit(Za)})}function t(){const t=i["b"].state.sceneInfo.hotspots.map(e=>6===e.type?e.content.nextSceneId:-1),o=i["b"].state.sceneInfo.events.map(e=>e.nextSceneId),n=[...o,...t],s=i["b"].state.skyBoxSceneGroup.sceneList.filter(e=>2===e.scenetype&&n.indexOf(e.id)>=0);s.forEach(t=>{e(t.id)})}t()}var cl=nl;async function ll(e){if(!dl(e))return;await fl(),i["b"].state.sceneInfo&&i["b"].state.sceneInfo.id&&i["b"].state.lifecycle.scenestatus>-1&&(pl(),Ns.emit(Rs));const t=await cl(e);if(!t)return;if(i["b"].state.sceneInfo.disposeStatus=!1,!ul(e))return void await Wo(e);const o="scene_scene_"+e,n=i["b"].state.krp.get("view");n.fovmin=n._fovmin,i["b"].state.krp.call(`loadscene(${o}, null, MERGE, ${i["b"].state.myswitch.switchEffect})`)}function dl(e){const t=i["b"].state.skyBoxSceneGroup.sceneList||[];return t.find(t=>e>0&&t.id===e)}function ul(e){return(i["b"].state.proInfo.xmlIds||[]).find(t=>t===e)}function pl(){i["b"].state.sceneInfo&&(i["b"].state.sceneInfo.disposeStatus=!0)}function hl(){let e=void 0,t=void 0,o=0;const n=async()=>new Promise(n=>{if("Step_forward"===i["b"].state.myswitch.switchKey&&i["b"].state.myswitch.hotspotId){const o=i["b"].state.sceneInfo.hotspots.find(e=>e.id===i["b"].state.myswitch.hotspotId),n=i["b"].state.krp.get("view");e=o?o.position.x:n.hlookat,t=o?o.position.y:n.vlookat}else e=void 0,t=void 0;if(void 0!==e&&void 0!==t){const s=i["b"].state.krp.get("view");s._fovmin=s.fovmin,s.fovmin=35;const a=1;i["b"].state.krp.call(`tween(view.hlookat|view.vlookat|view.fov, ${e}|${t}|35.0, 0.8 / ${a}, easeinoutquint)`),clearTimeout(o),o=window.setTimeout(()=>{n(1)},830*a)}else n(1)}),s=n=>{if(void 0!==e&&void 0!==t){const e=i["b"].state.krp.get("view");clearTimeout(o),o=window.setTimeout(()=>{e.fovmin=e._fovmin,i["b"].state.krp.call(`loadscene(${n}, null, MERGE, ${i["b"].state.myswitch.switchEffect})`)},850)}else i["b"].state.krp.call(`loadscene(${n}, null, MERGE, ${i["b"].state.myswitch.switchEffect})`)};return{updateActiveHotPos:n,actionStepForward:s}}const{updateActiveHotPos:fl}=hl();var ml=ll;function vl(){const e=Object(n["ref"])([]),t=t=>e.value.find(e=>e.key===t),o=(o,n,i=!1)=>{t(n)||e.value.push({cid:o,key:n,rendered:!1,visible:!1,issync:i})},i=(e,o)=>{const n=t(e);n&&(n.rendered=o)},s=()=>{e.value.forEach(e=>{e.rendered=!1}),e.value=[]},a=e=>{const o=t(e);return!!o&&o.rendered},r=Object(n["computed"])(()=>!!e.value.length&&e.value.every(e=>!e.issync||e.rendered)),c=(e,o)=>{const n=t(e);n&&(n.visible=o||!n.visible)},l=e=>{const o=t(e);return!!o&&o.visible};return{initCmStatus:o,updateCmRenderStatus:i,getCmRenderStatus:a,checkSyncRenderStatus:r,updateCmVisibleStatus:c,getCmVisibleStatus:l,removeAllCmStatus:s}}const{initCmStatus:bl,updateCmRenderStatus:gl,getCmRenderStatus:yl,checkSyncRenderStatus:wl,updateCmVisibleStatus:xl,getCmVisibleStatus:Sl,removeAllCmStatus:Il}=vl();class kl{constructor(e){this.options=e||{},this.childrens=[],this.count={loaded:0,show:0},this.events={},this.hoverKeys={},this.fixed={position:{x:e.fixed.position.x,y:e.fixed.position.y,z:e.fixed.depth},rotate:{rx:e.fixed.rotate.rx,ry:e.fixed.rotate.ry,rz:e.fixed.rotate.rz},scale:e.fixed.scale,opacity:e.fixed.opacity}}get getFixedData(){return this.fixed}push(e){this.childrens.push(e)}parentloaded(){this.count&&(this.count.loaded++,this.count.loaded===this.childrens.length&&this.events&&this.events.loaded&&this.events.loaded())}parentclick(){this.events&&this.events.click&&this.events.click()}parentover(e){if(!this.hoverKeys)return;this.hoverKeys[e]=!0;const t=Object.values(this.hoverKeys).some(e=>e);t&&this.events&&this.events.over&&this.events.over()}parentout(e){if(!this.hoverKeys)return;this.hoverKeys[e]=!1;const t=Object.values(this.hoverKeys).some(e=>e);t||this.events&&this.events.out&&this.events.out()}parentdown(){this.events&&this.events.down&&this.events.down()}parentup(){this.events&&this.events.up&&this.events.up()}parentdragmove(e){this.translate(e.x,e.y,0)}parentdragend(e){this.events&&this.events.dragend&&this.events.dragend(e)}show(e){if(!this.count)return;const t=e||this.childrens.map(e=>e.key);this.count.show=0,this.childrens.map(e=>{t.indexOf(e.key)>=0&&(this.count&&this.count.show++,e.updateVisible(!0))}),this.count.show===t.length&&this.events&&this.events.show&&this.events.show()}hide(e){if(!this.count)return;const t=e||this.childrens.map(e=>e.key);this.childrens.map(e=>{t.indexOf(e.key)>=0&&(this.count&&this.count.show--,e.updateVisible(!1))}),this.count.show<=0&&this.events&&this.events.hide&&this.events.hide()}translate(e,t,o){const n=72*o;this.fixed&&(this.fixed.position.x=e,this.fixed.position.y=t,this.fixed.position.z=n),this.childrens.map(o=>{o.updateTranslate(e,t,n)})}rotate(e,t,o){this.fixed&&(this.fixed.rotate.rx=e,this.fixed.rotate.ry=t,this.fixed.rotate.rz=o),this.childrens.map(n=>{n.updateRotate(e,t,o)})}scale(e){this.fixed&&(e<=0&&(e=this.fixed.scale),this.fixed.scale=e),this.childrens.map(t=>{t.updateScale(e)})}multiplyscale(e,t){this.childrens.map(o=>{o.multiplyscale(e,t)})}opacity(e){this.fixed&&(this.fixed.opacity=e),this.childrens.map(t=>{t.updateOpacity(e)})}visible(e,t){const o=t||this.childrens.map(e=>e.key);this.childrens.map(t=>{e?o.indexOf(t.key)>=0&&t.updateVisible(!0):t.updateVisible(!1)})}destroy(){this.hide(),this.childrens=[],this.count&&(this.count.loaded=0,this.count.show=0,delete this.count.loaded,delete this.count.show,this.count=null),this.options=null,this.events=null,this.hoverKeys=null}}var Ol=kl;class jl{constructor(e,t,o={}){this.krpano=e,this.name=t,this.opt=o,this.init()}init(){this.add()}add(){var e;this.krpano.call("addhotspot("+this.name+")"),this.opt&&this.setAttr("hotspot["+this.name+"]"),null!==(e=this.opt.points)&&void 0!==e&&e.length&&this.opt.points.map((e,t)=>{this.krpano.set(`hotspot[${this.name}].point[${t}].ath`,e.x),this.krpano.set(`hotspot[${this.name}].point[${t}].atv`,e.y)})}setAttr(e){for(const t in this.opt)this.krpano.set(e+"."+t,this.opt[t])}}var Cl=jl;class El{constructor(e){this.options=e||{},this.fixed=Do(e.fixed),this.scaleSize={hover:1,wheel:1}}onloaded(){this.options&&this.options.events&&this.options.events.loaded&&this.options.events.loaded()}onover(){this.options&&this.options.events&&this.options.events.over&&this.options.events.over(this.options.key)}onout(){this.options&&this.options.events&&this.options.events.out&&this.options.events.out(this.options.key)}ondown(){this.options&&this.options.events&&this.options.events.down&&this.options.events.down()}onup(){this.options&&this.options.events&&this.options.events.up&&this.options.events.up()}onclick(){this.options&&this.options.events&&this.options.events.click&&this.options.events.click()}updateInstance(e){this.el=e}updateVisible(e){this.el&&this.options&&this.options.fixed&&(this.el.visible=e)}updateTranslate(e,t,o){this.el&&(this.el.ath=e,this.el.atv=t,o&&(this.el.depth=o))}updateRotate(e,t,o){this.fixed&&(this.fixed.rotate.rx=e,this.fixed.rotate.ry=t,this.fixed.rotate.rz=o),this.uscale()}updateSelfRotate(e,t,o){this.fixed&&(this.fixed.rotate._rx=e,this.fixed.rotate._ry=t,this.fixed.rotate._rz=o),this.uscale()}uscale(){if(!this.fixed)return;const e={rx:this.fixed.rotate.rx,ry:this.fixed.rotate.ry,rz:this.fixed.rotate.rz},t={rx:this.fixed.rotate._rx||0,ry:this.fixed.rotate._ry||0,rz:this.fixed.rotate._rz||0},o=$n(t,e);this.el&&(this.el.rx=o.rx,this.el.ry=o.ry,i["b"].state.sceneInfo.is2dRender||!this.el.distorted?this.el.rotate=o.rz:this.el.rz=o.rz)}multiplyscale(e,t){this.scaleSize&&(this.scaleSize[e]=t)}updateScale(e){if(this.el&&this.options){const t=this.scaleSize&&this.scaleSize.hover,o=this.scaleSize&&this.scaleSize.wheel,n=(t||1)*(o||1);this.el.scale=e*n*sn.value*an.value,this.options.fixed.offset.x&&(this.el.ox=this.options.fixed.offset.x*this.el.scale),this.options.fixed.offset.y&&(this.el.oy=this.options.fixed.offset.y*this.el.scale)}}updateOpacity(e){this.el&&(this.el.alpha=e)}destroy(){this.el&&(this.el.destroy(),this.options&&i["b"].state.krp.call(`removehotspot(${this.options.key})`),this.options=null,this.fixed=null,this.scaleSize=null)}}var Tl=El;const Pl=function(e={},t=!1){return{loaded:(...t)=>{e.loaded&&e.loaded(...t),this.parentloaded&&this.parentloaded()},click:()=>{e.click&&e.click(),t||this.parentclick&&this.parentclick()},over:t=>{e.over&&e.over(),this.parentover&&this.parentover(t)},out:t=>{e.out&&e.out(),this.parentout&&this.parentout(t)},down:()=>{e.down&&e.down(),this.parentdown&&this.parentdown()},up:()=>{e.up&&e.up(),this.parentup&&this.parentup()}}},_l=()=>({fixed:{position:{x:0,y:0},offset:{x:0,y:0},translate:{x:0,y:0,z:0},rotate:{rx:0,ry:0,rz:0},scale:1,opacity:1,depth:72*i["b"].state.skyBoxSceneGroup.platformInfo.radius,visible:!1,zorder:1,edge:"center"},other:{handcursor:!1,enabled:!0,renderer:"webgl",destorted:!0},content:{crop:"",onovercrop:"",size:{x:0,y:0}},expand:{drag:!1,scale:!1}}),Al=(e={},t={})=>({loaded:()=>{e.loaded&&e.loaded(),t.loaded&&t.loaded()},show:()=>{e.show&&e.show(),t.show&&t.show()},hide:()=>{e.hide&&e.hide(),t.hide&&t.hide()},click:()=>{e.click&&e.click(),t.click&&t.click()},over:()=>{e.over&&e.over()},out:()=>{e.out&&e.out()},down:()=>{e.down&&e.down(),t.down&&t.down()},up:()=>{e.up&&e.up(),t.up&&t.up()},dragend:t=>{e.dragend&&e.dragend(t)},trigger:t=>{e.trigger&&e.trigger(t)}});class Ml extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.aniInfo={croptimer:0,ratio:1},1===this.options.content.type&&(this.aniInfo.ratio=.5),this.create(this.setConfig())}setConfig(){let e=i["b"].state.sceneInfo.is2dRender;const t=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth,o=sn.value*an.value*this.options.fixed.scale;e&&(this.options.fixed.rotate.rx||this.options.fixed.rotate.ry)&&(e=!1);const n={type:"image",kid:this.options.id,renderer:this.options.other.renderer,ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,url:this.checkCropAnimation()?this.options.content.gifInfo.imgPath:this.options.content.path,ox:this.options.fixed.offset.x*o,oy:this.options.fixed.offset.y*o,oref:1,rotationorder:"ZXY",rx:this.options.fixed.rotate.rx,ry:this.options.fixed.rotate.ry,rz:this.options.fixed.rotate.rz,rotate:e?this.options.fixed.rotate.rz:0,tx:this.options.fixed.translate.x,ty:this.options.fixed.translate.y,tz:this.options.fixed.translate.z,edge:this.options.fixed.edge,alpha:this.options.fixed.opacity,width:this.options.content.size.x,height:this.options.content.size.y,stereo:1===this.options.content.type?"SBS":"",crop:this.options.content.crop,onovercrop:this.options.content.onovercrop,handcursor:this.options.other.handcursor,mipmapping:!0,capture:!1,scale:o,depth:t,zoom:e,distorted:this.options.other.destorted&&!e,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),this.checkCropAnimation()&&(this.el.crop="0|0|"+this.options.content.gifInfo.gifWidth*this.aniInfo.ratio+"|"+this.options.content.gifInfo.gifHeight),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return n}create(e){new Cl(i["b"].state.krp,this.options.key,e)}get getInfos(){const e=1===this.options.content.type?2:1;return{imagewidth:this.el.imagewidth*e,imageheight:this.el.imageheight,wrapwidth:this.options.content.size.x,wrapheight:this.options.content.size.y}}saveInstanceToParent(){this.updateInstance(this.el)}checkCropAnimation(){return this.options.content.gifInfo&&this.options.content.gifInfo.imgPath}startCropAnimation(){if(!this.checkCropAnimation())return;this.stopCropAnimation();const e=this.options.content.gifInfo.imgHeight/this.options.content.gifInfo.gifHeight,t=this.options.content.gifInfo.imgWidth/this.options.content.gifInfo.gifWidth,o={x:this.options.content.gifInfo.gifWidth,y:this.options.content.gifInfo.gifHeight},n=Math.max(this.options.content.gifInfo.delayTime,40);let i=0,s=0;const a=()=>{const n=s>e?s%e:0,i=Math.floor(s/t);this.el&&(this.el.crop=`${n*o.x}|${i*o.y}|${o.x*this.aniInfo.ratio}|${o.y}`)};a();const r=this.options.content.gifInfo.frameNum+this.options.content.gifInfo.replenishNum;this.aniInfo.croptimer=window.setInterval(()=>{this.el&&this.options&&this.options.content?(s===this.options.content.gifInfo.frameNum-1&&(i++,this.options.events&&this.options.events.complete&&this.options.events.complete()),this.options.content.loopTime>0&&i>=this.options.content.loopTime?clearInterval(this.aniInfo.croptimer):(s===r-1?s=0:s++,a())):clearInterval(this.aniInfo.croptimer)},n)}stopCropAnimation(){this.el&&(clearInterval(this.aniInfo.croptimer),this.checkCropAnimation()?this.el.crop=`0|0|${this.options.content.gifInfo.gifWidth}|${this.options.content.gifInfo.gifHeight}`:this.el.crop=this.options.content.crop||"")}updateTexture(e){this.el&&(this.stopCropAnimation(),this.el.url=e,this.startCropAnimation())}updateSize(e,t){this.el&&(this.el.width=e,this.el.height=t)}updateOffset(e,t){this.el&&(void 0!=e&&(this.options.fixed.offset.x=e),void 0!=t&&(this.options.fixed.offset.y=t),this.el.ox=this.options.fixed.offset.x*this.el.scale,this.el.oy=this.options.fixed.offset.y*this.el.scale)}updateStereo(e){this.el&&(this.el.stereo=e)}updateGifInfo(e){this.options.content.gifInfo=e}destroy(){super.destroy(),this.el&&(this.el=null)}}var Hl=Ml;class zl extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.initImgComponent(e),e.exclose&&this.initCloseComponent(e),this.cid=e.id,this._events=t||{},this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initImgComponent(e){this.el=new Hl({id:e.id,key:e.key,fixed:e.fixed,other:e.other,content:e.content,events:{...Pl.bind(this)(),complete:()=>{this._events&&this._events.oncomplete&&this._events.oncomplete()}}}),super.push(this.el)}initCloseComponent(e){const t=zo(e.fixed,{offset:{x:e.content.size.x/2,y:-1*e.content.size.y/2},opacity:1}),o=new Hl({key:"sclose_"+e.id,fixed:t,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({click:()=>{this._events&&this._events.onclose&&this._events.onclose()}})});super.push(o)}onshow(){this.el&&this.el.startCropAnimation()}onhide(){this.el&&this.el.stopCropAnimation()}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this._events=null}}var Ll=zl;class Dl extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.create(this.setConfig())}setConfig(){const e=i["b"].state.sceneInfo.is2dRender,t=sn.value*an.value*this.options.fixed.scale,o=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth;let n="";this.options.content.alphaColor&&(n=`${this.options.content.alphaColor}|${this.options.content.threshold}|${this.options.content.smoothing}`);const s={key:this.options.key,type:"image",renderer:this.options.other.renderer,panovideo:!1,ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,url:"%$prevPath%/plugins/videoplayer.js",posterurl:this.options.content.poster||"",videourl:this.options.content.path||"",autoplay:this.options.content.autoplay||!1,volume:this.options.content.volume,html5preload:"none",isshow:this.options.other.isShow,ox:this.options.fixed.offset.x*t,oy:this.options.fixed.offset.y*t,oref:1,rotationorder:"ZXY",rx:this.options.fixed.rotate.rx,ry:this.options.fixed.rotate.ry,rz:this.options.fixed.rotate.rz,rotate:e?this.options.fixed.rotate.rz:0,tx:this.options.fixed.translate.x,ty:this.options.fixed.translate.y,tz:this.options.fixed.translate.z,chromakey:n,edge:this.options.fixed.edge,alpha:this.options.fixed.opacity,width:this.options.content.size.x,height:this.options.content.size.y,stereo:1===this.options.content.type?"SBS":"",handcursor:this.options.other.handcursor,capture:!1,scale:t,depth:o,zoom:e,distorted:!e,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,externaldom:this.options.content.externaldom,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this),onvideoplay:()=>{this.options.events.onplay&&this.options.events.onplay()},onvideopaused:()=>{this.options.events.onpause&&this.options.events.onpause()},onvideowaiting:()=>{this.options.events.onwaiting&&this.options.events.onwaiting(this.el.iswaiting)},onvideocomplete:()=>{this.options.events.oncomplete&&this.options.events.oncomplete()}};return s}create(e){new Cl(i["b"].state.krp,this.options.key,e)}saveInstanceToParent(){this.updateInstance(this.el)}play(){this.el&&this.el.play()}pause(){this.el&&this.el.pause()}seek(e){this.el&&this.el.seek(e)}destroy(){super.destroy(),this.el&&(this.el=null)}}var Bl=Dl;function Nl(){const e=Object(n["computed"])(()=>i["b"].state.privateInfo.onlineCount||{}),t=Object(n["computed"])(()=>e.value.enable&&e.value.iscomponent),o=Object(n["computed"])(()=>e.value.fetch.count);return{isEnablePriOnlinecount:t,fetchOnlineCountPath:o}}function Vl(){const e=Object(n["computed"])(()=>i["b"].state.privateInfo.sceneTitle||{}),t=Object(n["computed"])(()=>e.value.enable);return{isEnablePriScenetitle:t}}function Rl(){const e=Object(n["computed"])(()=>i["b"].state.privateInfo.menuNav||{}),t=Object(n["computed"])(()=>e.value.enable),o=Object(n["computed"])(()=>i["b"].state.proInfo.id+"_"+i["b"].state.sceneInfo.id||""),s=Object(n["computed"])(()=>e.value.excludes||[]),a=()=>{const t=e.value.mainSceneIds||[];let o=0;return t.forEach(e=>{const t=e.split("_"),n=Number(t.shift());n===i["b"].state.proInfo.id&&(o=Number(t.pop()))}),o},r=()=>{const e=i["b"].state.viewedIds[i["b"].state.viewedIds.length-2];if(e){const t=i["b"].state.viewedIds.slice(0,Math.max(i["b"].state.viewedIds.length-2,0));i["b"].commit(jo["z"],t),Ns.emit(Fs,{sceneId:e})}},c=e=>{const t=i["b"].state.skyBoxSceneGroup.sceneList.find(t=>t.sort===e);t&&t.id&&Ns.emit(Fs,{sceneId:t.id})},l=()=>{const e=a();Ns.emit(Fs,{sceneId:e||i["b"].state.proInfo.firstid})};return{isEnablePriMenu:t,proSceneId:o,excludeProSceneList:s,onBackMainSceneHandle:l,onBackPrevSceneHandle:r,onChangeSceneHandle:c}}function Fl(){const e=Object(n["computed"])(()=>i["b"].state.privateInfo.comment||{}),t=Object(n["computed"])(()=>e.value.enable);return{isEnablePriComment:t}}function Gl(){const e=new Map;async function t(t){if(!a.value)return t;const n=e.get(t);if(n&&!o(t))return n.path;const s={pid:i["b"].state.proInfo.pid,key:t},r=await Object(xo["c"])(s),c=(null===r||void 0===r?void 0:r.resData)||{};return c.playUrl&&e.set(t,{path:c.playUrl,updateTime:Date.now()}),c.playUrl||""}function o(t){const o=e.get(t),n=Date.now()-((null===o||void 0===o?void 0:o.updateTime)||0);return!!o&&n>=54e5}const s=Object(n["computed"])(()=>i["b"].state.privateInfo.hyvideo||{}),a=Object(n["computed"])(()=>s.value.enable);return{isEnablePriHYVideo:a,getVideoResPath:t,isExpiresVideo:o}}const{isEnablePriOnlinecount:Wl,fetchOnlineCountPath:$l}=Nl(),{isEnablePriScenetitle:Ul}=Vl(),{isEnablePriMenu:Xl,proSceneId:Yl,excludeProSceneList:Zl,onBackMainSceneHandle:ql,onBackPrevSceneHandle:Kl,onChangeSceneHandle:Jl}=Rl(),{isEnablePriComment:Ql}=Fl(),{isEnablePriHYVideo:ed,isExpiresVideo:td,getVideoResPath:od}=Gl();function nd(){return new Promise((e,t)=>{const o=i["b"].state.publicConfig.va||{};So["b"].get(o.host+"/ctool/ms/getVoucher.do").then(t=>{e(t.data)}).catch(e=>{t(e)})})}function id(e){return new Promise((t,o)=>{const n=i["b"].state.publicConfig.va||{};So["b"].post(n.host+"/pc/ad/getDetail.do",e).then(e=>{t(e.data)}).catch(e=>{o(e)})})}class sd extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.play=null,this.wait=null,this.options=e||{},this.videoInfo={isseekcomplete:!1,visible:!1,paused:!0,waiting:!1},this.videoDom=null,i["b"].state.device.iphone&&(this.videoDom=this.createVideoDom()),this.initVideoComponent(e),this.initPlayBtnComponent(e),this.initLoadBtnComponent(e),this.initCloseComponent(e),this.cid=e.id,this._events=t||{},this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initVideoComponent(e){e.content.alphaColor&&"object"===typeof e.content.alphaColor&&(e.content.alphaColor=rn(e.content.alphaColor)),e.content.externaldom=this.videoDom,this.el=new Bl({id:e.id,key:e.key,fixed:e.fixed,other:Object.assign({},e.other,{renderer:e.content.isVa?"css3d":"webgl",isShow:e.isShow}),content:e.content,events:{...Pl.bind(this)({click:this.pausevideo.bind(this),loaded:()=>{var t;od(e.content.path).then(t=>{const o=t!==e.content.path;o&&this.el&&this.el.el&&this.el.el.playvideo(t,"",!0,0)}),null!==(t=this.el)&&void 0!==t&&t.el&&this.options.content.isVa&&setTimeout(this.initVaServiceSpace.bind(this),100)}}),onplay:this.onplayhandle.bind(this),onpause:this.onpausehandle.bind(this),oncomplete:this.oncompletehandle.bind(this),onwaiting:this.onwaitinghandle.bind(this)}}),super.push(this.el)}initPlayBtnComponent(e){const t=zo(e.fixed,{});if("top"===e.fixed.edge){const o=e.fixed.offset?e.fixed.offset.y:0;t.offset.y=o+(e.content.size.y-50)/2}this.play=new Hl({key:"svideo_btn_"+e.id,fixed:t,other:Object.assign({},e.other,{renderer:e.content.isVa?"css3d":"webgl"}),content:{path:"%$prevPath%/skin/assets/play.png",size:{x:50,y:50}},events:Pl.bind(this)({click:this.playvideo.bind(this,!0)})}),super.push(this.play)}initCloseComponent(e){if(!e.exclose||e.content.isVa)return;const t=zo(e.fixed,{offset:{x:e.content.size.x/2,y:-1*e.content.size.y/2},opacity:1}),o=new Hl({key:"sclose_"+e.id,fixed:t,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({click:()=>{this._events.onclose&&this._events.onclose()}})});super.push(o)}initCss3dCloseComponent(){if(!this.options.exclose)return;const e=document.createElement("span");e.className="css3d-close";const t=i["b"].state.device.mobile?"ontouchend":"onclick";e.setAttribute(t,`myKrp.onhidecss3dhotspot(${this.options.id})`),this.el&&this.el.el&&this.el.el.sprite&&this.el.el.sprite.appendChild(e)}initLoadBtnComponent(e){const t=zo(e.fixed,{});if("top"===e.fixed.edge){const o=e.fixed.offset?e.fixed.offset.y:0;t.offset.y=o}t.visible=!1,this.wait=new Hl({key:"svideo_btn_waiting_"+e.id,fixed:t,other:Object.assign({},e.other,{renderer:e.content.isVa?"css3d":"webgl"}),content:{path:"%$prevPath%/skin/assets/loading.png",size:{x:50,y:50},gifInfo:{imgPath:"%$prevPath%/skin/assets/loading.png",imgWidth:1200,imgHeight:1200,gifWidth:200,gifHeight:200,delayTime:30,replenishNum:6,frameNum:30}},events:Pl.bind(this)({click:this.playvideo.bind(this,!0)})}),super.push(this.wait)}createVideoDom(){const e=document.createElement("video");return e.setAttribute("crossOrigin","anonymous"),e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline",""),e.setAttribute("x5-video-player-type","h5"),e.style.cssText="\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      left: 0;\n      top: 0;\n      opacity: 1;\n      object-fit: fill;\n      background-color: #000;\n      transform: translateZ(0);\n      transform-origin: 0 0;",e}async initVaServiceSpace(){if(this.options.content.vaUid){const e=await this.getVaServiceVideoPath();this.el&&(this.el.el.playvideo(e,"",!this.options.content.autoplay,0),await this.initVaServiceComponent(),this.initCss3dCloseComponent())}}async getVaServiceVideoPath(){const e=i["b"].state.publicConfig.va&&i["b"].state.publicConfig.va.host;if(!this.options.content.vaUid||!e)return this.options.content.path;const t=await id({uid:this.options.content.vaUid});let o=this.options.content.path;if(t&&1===t.resCode){var n;const e=(null===(n=t.resData)||void 0===n?void 0:n.row)||{};o=e.fileUrl}return o}async initVaServiceComponent(){var e;const t=null===(e=this.el)||void 0===e?void 0:e.el.sprite;if(!t)return;const o=t.getElementsByTagName("video")[0],n=i["b"].state.publicConfig.va||{},s=n.host;if(!s)return;const a=s+"/ctool/ms/allProcessedData.do",r=s+"/ctool/ms/webClientLog.do",c=s+"/ctool/ms/videoPlayData.do",l=await nd();l&&1===l.resCode&&(this.virtualAdsHandler=new window.VirtualAdsHandler,this.virtualAdsHandler.setRequestHeader("cus-auth",l.resData.token),this.virtualAdsHandler.setAllProcessDataUrl(a),this.virtualAdsHandler.setLogInfoUrl(r),this.virtualAdsHandler.setMonitorUrl(c),this.virtualAdsHandler.setDisableCache(!0),this.virtualAdsHandler.prepare("test client id",Number(n.pId),this.options.content.vaUid,this.options.content.name||"nibiru",o,t,e=>{},e=>{},()=>{},()=>{},e=>{}),window.console.log("实例化虚拟广告组件"))}destroyVaServiceComponent(){this.virtualAdsHandler&&(this.virtualAdsHandler=null)}getShowCmKeys(){const e=[this.options.key];return this.el&&this.videoInfo.paused&&e.push("svideo_btn_"+this.cid),this.el&&this.videoInfo.waiting&&e.push("svideo_btn_waiting_"+this.cid),this.options.exclose&&!this.options.content.isVa&&e.push("sclose_"+this.cid),e}show(){super.show(this.getShowCmKeys())}visible(e){super.visible(e,this.getShowCmKeys())}onshow(){const e=this.options.isShow?this.options.content.autoplay:!this.videoInfo.ended;e&&this.playvideo(!1,!0),this.videoInfo.visible=!0}onhide(){this.pausevideo(),this.el&&this.options.content.reset&&(this.el.seek(0),this.videoInfo.isseekcomplete=!1),this.videoInfo.visible=!1}playvideo(e=!1,t=!1){this.el&&(td(this.options.content.path)?od(this.options.content.path).then(o=>{this.el&&this.el.el&&(this.el.el.playvideo(o,"",!1,0),this._events.onplay&&this._events.onplay(e,t))}):(this.el.play(),this._events.onplay&&this._events.onplay(e,t)))}pausevideo(){this.el&&(this.el.pause(),this._events.onpause&&this._events.onpause())}onplayhandle(){this.videoInfo.paused=!1,this.play&&this.videoInfo.visible&&this.play.updateVisible(!1),this.videoInfo.ended&&(this.videoInfo.ended=!1),this.options.content.startTime>0&&!this.videoInfo.isseekcomplete&&(this.el&&this.el.seek(this.options.content.startTime),this.videoInfo.isseekcomplete=!0)}onpausehandle(){this.videoInfo.paused=!0,this.play&&this.videoInfo.visible&&this.play.updateVisible(!0)}oncompletehandle(){this.videoInfo.isseekcomplete=!1,this._events.oncomplete&&this._events.oncomplete(),this.options.content.replay?this.playvideo():this.videoInfo.ended=!0}onwaitinghandle(e){var t;(this.videoInfo.waiting=e,this.wait&&this.videoInfo.visible&&this.wait.updateVisible(e),this.wait)&&(e?this.wait.startCropAnimation():null===(t=this.wait)||void 0===t||t.stopCropAnimation())}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.play&&(this.play.destroy(),this.play=null),this.videoDom&&(this.videoDom=null),this.destroyVaServiceComponent()}}var ad=sd;class rd extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.imagesInfo={key:e.key,content:e.content,count:e.content.paths.length,current:0,timer:0,oy:0},this.el=null,this.sLeftImg=null,this.sRightImg=null,this.options=e||{},this.initImgComponent(e),e.content.autoplay||this.initBtnsComponent(e),e.exclose&&this.initCloseComponent(e),this.cid=e.id,this._events=t||{},this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initImgComponent(e){this.el=new Hl({id:e.id,key:e.key,fixed:e.fixed,other:e.other,content:{path:e.content.paths[0],type:e.content.type,gifInfo:e.content.gifInfos[0],size:e.content.size},events:Pl.bind(this)({loaded:()=>{requestAnimationFrame(this.updateImgShowsize.bind(this))}})}),super.push(this.el)}getImageTexture(){const e=this.imagesInfo.content.paths[this.imagesInfo.current],t=this.imagesInfo.content.gifInfos[this.imagesInfo.current];return t.imgPath||e}initBtnsComponent(e){const t={x:40,y:40},o=zo(e.fixed,{offset:{x:-1*e.content.size.x/2+(t.x/2+10)}});"top"===e.fixed.edge&&(o.offset.y=this.options.content.size.y/2),this.sLeftImg=new Hl({id:e.id,key:"simages_left_"+e.id,fixed:o,content:{path:"%$prevPath%/skin/assets/arrow.png",size:t,crop:"0|80|40|40",onovercrop:"0|120|40|40"},other:{handcursor:!0,enabled:!0},events:Pl.bind(this)({click:()=>{this.prev(),this._events.onprev&&this._events.onprev()}})});const n=zo(e.fixed,{offset:{x:e.content.size.x/2-(t.x/2+10)}});"top"===e.fixed.edge&&(n.offset.y=this.options.content.size.y/2),this.sRightImg=new Hl({id:e.id,key:"simages_right_"+e.id,fixed:n,other:{handcursor:!0,enabled:!0},content:{path:"%$prevPath%/skin/assets/arrow.png",size:t,crop:"0|0|40|40",onovercrop:"0|40|40|40"},events:Pl.bind(this)({click:()=>{this.next(),this._events.onnext&&this._events.onnext()}})}),super.push(this.sLeftImg),super.push(this.sRightImg)}initCloseComponent(e){const t=zo(e.fixed,{offset:{x:e.content.size.x/2,y:-1*e.content.size.y/2},opacity:1}),o=new Hl({key:"sclose_"+e.id,fixed:t,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({click:()=>{this._events.onclose&&this._events.onclose()}})});super.push(o)}getShowCmKeys(){const e=[this.imagesInfo.key];return this.options.content.autoplay||(0===this.imagesInfo.current&&this.imagesInfo.count>1&&e.push("simages_right_"+this.cid),this.imagesInfo.current===this.imagesInfo.count-1&&this.imagesInfo.count>1&&e.push("simages_left_"+this.cid)),this.options.exclose&&e.push("sclose_"+this.cid),e}show(){super.show(this.getShowCmKeys())}visible(e){super.visible(e,this.getShowCmKeys())}prev(){this.imagesInfo.current--,-1===this.imagesInfo.current&&(this.imagesInfo.current=this.imagesInfo.count-1),this.updateTexture()}next(){this.imagesInfo.current++,this.imagesInfo.current===this.imagesInfo.count&&(this.imagesInfo.current=0),this.updateTexture()}auto(){clearTimeout(this.imagesInfo.timer),this.imagesInfo.timer=window.setTimeout(()=>{this.next(),this.auto()},1e3*this.imagesInfo.content.interval)}updateTexture(){if(!this.el)return;const e=this.imagesInfo.content.paths[this.imagesInfo.current],t=this.imagesInfo.content.gifInfos[this.imagesInfo.current],o=t.imgPath||e;this.el.updateGifInfo(t.imgPath?t:null),this.el.updateTexture(o),this.imagesInfo.status&&this.updateBtnVisible()}updateBtnVisible(){this.imagesInfo.count<=1||(this.sLeftImg&&this.sLeftImg.updateVisible(0!==this.imagesInfo.current),this.sRightImg&&this.sRightImg.updateVisible(this.imagesInfo.current!==this.imagesInfo.count-1))}updateBtnOffset(e){const t={x:40,y:40},o=t.x/2+10;if(this.sLeftImg){const n={x:-1*e.x/2+o,y:0};"top"===this.options.fixed.edge&&(n.y=this.imagesInfo.oy+(this.options.content.size.y-t.y)/2),this.sLeftImg.updateOffset(n.x,n.y)}if(this.sRightImg){const n={x:e.x/2-o,y:0};"top"===this.options.fixed.edge&&(n.y=this.imagesInfo.oy+(this.options.content.size.y-t.y)/2),this.sRightImg.updateOffset(n.x,n.y)}}updateImgShowsize(){if(!this.el)return;const e=this.el.getInfos,t=Lo({x:e.imagewidth,y:e.imageheight},{x:e.wrapwidth,y:e.wrapheight});if(this.el.updateSize(t.x,t.y),"top"===this.options.fixed.edge){var o;if(!this.imagesInfo.oy)this.imagesInfo.oy=(null===(o=this.options.fixed.offset)||void 0===o?void 0:o.y)||0;const e=this.imagesInfo.oy+(this.options.content.size.y-t.y)/2;this.el.updateOffset(0,e)}this.updateBtnOffset(t)}initStatus(){this.imagesInfo.status=!0,this.options.content.autoplay?this.auto():this.options.content.reset||this.updateBtnVisible(),this.el&&(this.el.stopCropAnimation(),this.el.startCropAnimation())}resetStatus(){clearTimeout(this.imagesInfo.timer),this.el&&this.el.stopCropAnimation(),this.options.content.reset&&(this.imagesInfo.status=!1,this.imagesInfo.current=0,this.updateTexture())}onshow(){this.initStatus()}onhide(){this.resetStatus()}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.sLeftImg&&(this.sLeftImg.destroy(),this.sLeftImg=null),this.sRightImg&&(this.sRightImg.destroy(),this.sRightImg=null)}}var cd=rd;class ld extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.create(this.setConfig())}setConfig(){const e=i["b"].state.sceneInfo.is2dRender,t=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth,o=e?1:this.options.fixed.scale,n={type:"image",renderer:"css3d",ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,url:"%$prevPath%/skin/assets/transparent.png",ox:this.options.fixed.offset.x*o,oy:this.options.fixed.offset.y*o,oref:1,rotationorder:"ZXY",rx:this.options.fixed.rotate.rx,ry:this.options.fixed.rotate.ry,rz:this.options.fixed.rotate.rz,rotate:e?this.options.fixed.rotate.rz:0,tx:this.options.fixed.translate.x,ty:this.options.fixed.translate.y,tz:this.options.fixed.translate.z,edge:this.options.fixed.edge,width:this.options.content.size.x,height:this.options.content.size.y,handcursor:this.options.other.handcursor,capture:!1,scale:sn.value*an.value*this.options.fixed.scale,depth:t,zoom:e,distorted:!e,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),this.addHtmlStrToSprite(),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return n}create(e){new Cl(i["b"].state.krp,this.options.key,e)}getHtmlStrByCss3d(){let e=`<iframe\n      width="100%"\n      height="100%"\n      frameborder="0"\n      allow="microphone *; camera *; autoplay; fullscreen"\n      style="opacity: ${this.options.fixed.opacity}"\n      src="${this.options.content.path}"></iframe>`;return this.options.content.control&&(e+='<div class="webview__mask hide"></div>'),e}addHtmlStrToSprite(){if(!this.el||!this.el.sprite)return;const e=document.createElement("div");if(e.className="my--event",e.style.cssText="\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      border: 0;\n    ",this.options.exclose){const t=document.createElement("span");t.className="css3d-close";const o=i["b"].state.device.mobile?"ontouchend":"onclick";t.setAttribute(o,`myKrp.onhidecss3dhotspot(${this.options.id})`),e.appendChild(t)}e.innerHTML+=this.getHtmlStrByCss3d(),this.el.registercontentsize(this.options.content.size.x,this.options.content.size.y),this.el.sprite.appendChild(e)}updateControlMode(){if(!this.el||!this.el.sprite)return;const e=this.el.sprite.querySelector(".webview__mask");if(e){const t=e.classList.contains("hide");t?e.classList.remove("hide"):e.classList.add("hide")}}saveInstanceToParent(){this.updateInstance(this.el)}destroy(){super.destroy(),this.el&&(this.el=null)}}var dd=ld;class ud extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.poster=null,this.control=null,this.isInitial=!1,this.options=e||{},this.serverPath="",this.initPosterComponent(e),this.initWebviewComponent(e),e.content.control&&this.initControlComponent(e),e.exclose&&this.initCloseComponent(e),this.cid=e.id,this._events=t,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initPosterComponent(e){let t=e.content.poster;const o=zo(e.fixed,{});t||(t="%$prevPath%/skin/assets/black.jpeg",o.opacity*=.5),window.console.log("初始化直播封面",t),this.poster=new Hl({id:e.id,key:"sposter_"+e.id,fixed:o,other:e.other,content:{path:t,gifInfo:e.content.gifInfo,size:e.content.size},events:Pl.bind(this)({click:this.updateControlMode.bind(this)})}),super.push(this.poster)}initPlayComponent(e){const t=new Hl({id:e.id,key:"splay_"+e.id,fixed:e.fixed,other:e.other,content:{path:"%$prevPath%/skin/assets/play.png",size:{x:50,y:50}},events:Pl.bind(this)({click:()=>{this.isInitial=!0,this.poster&&(t.updateVisible(!1),this.poster.updateVisible(!1)),this.initWebviewComponent(e),e.content.control&&this.initControlComponent(e)}})});super.push(t)}initWebviewComponent(e){this.el=new dd({id:e.id,key:"swebview_"+e.id,fixed:e.fixed,other:e.other,expand:e.expand,content:{path:e.content.path,size:e.content.size,control:e.content.control},exclose:e.exclose,events:Pl.bind(this)()}),super.push(this.el)}initControlComponent(e){const t=zo(e.fixed,{offset:{y:-1*e.content.size.y/2},visible:!0});this.control=new Hl({key:"scontrol_"+e.id,fixed:t,other:e.other,content:{path:"%$prevPath%/skin/assets/webview_control.png",size:{x:50,y:50}},events:Pl.bind(this)({click:this.updateControlMode.bind(this)})}),super.push(this.control)}initCloseComponent(e){const t=zo(e.fixed,{offset:{x:e.content.size.x/2,y:-1*e.content.size.y/2},opacity:1}),o=new Hl({key:"sclose_"+e.id,fixed:t,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({click:()=>{this._events.onclose&&this._events.onclose()}})});super.push(o)}async getLiveInfoFromServer(e){const t=await oi(e.liveId);t&&t.viewUrl?this.serverPath=t.viewUrl:this.serverPath=e.path}hidePoster(){this.el&&this.poster&&(this.poster.stopCropAnimation(),this.poster.destroy(),this.poster=null)}showIframe(e){const t=e.querySelector(".my--event"),o=t.querySelector("iframe"),n=this.options.content.path===this.serverPath;if(o)n||(o.src=this.serverPath);else{const e=document.createElement("iframe");e.style.width="100%",e.style.height="100%",e.frameBorder="0",e.style.opacity=this.options.fixed.opacity,t.appendChild(e),e.onload=()=>{this.hidePoster()},e.src=this.serverPath}}hideIframe(e){const t=e.querySelector(".my--event"),o=e.querySelector("iframe");t&&o&&t.removeChild(o)}updateControlMode(){this.el&&this.el.updateControlMode()}async onshow(){this.poster&&this.poster.startCropAnimation(),this.el&&this.el.el.sprite&&(this.serverPath||await this.getLiveInfoFromServer(this.options.content),this.showIframe(this.el.el.sprite))}onhide(){var e;this.poster&&this.poster.stopCropAnimation(),this.el&&null!==(e=this.el.el)&&void 0!==e&&e.sprite&&this.hideIframe(this.el.el.sprite)}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.poster&&(this.poster.destroy(),this.poster=null)}}var pd=ud;const hd=({txtDom:e,width:t})=>{const o=parseInt(t);let n=0,i=0;const s=()=>{e.style.transitionDuration="0s",e.style.transform=`translateX(${o}px) translateZ(0)`,requestAnimationFrame(()=>{r(i,o,-1*n)})},a=()=>{const t=o-e._end,s=-1*n;e.style.transitionDuration="0s",e.style.transform=`translateX(${t}px) translateZ(0)`,requestAnimationFrame(()=>{r(i,t,s)})},r=(t,o,n)=>{const i=-2;let a=o;cancelAnimationFrame(e._updateTimer);let r=0;const c=()=>{if(a<=n)return cancelAnimationFrame(e._updateTimer),void s();a=Math.round(a+i),e.style.transform=`translate3d(${a}px, 0, 0)`},l=()=>{const t=Date.now(),o=t-r;o>=1e3/30&&(r=t,c()),e._updateTimer=requestAnimationFrame(l)};l()},c=()=>{e._end||(e._end=0),requestAnimationFrame(()=>{n=e.scrollWidth,i=Math.ceil((o+n-e._end)/60),setTimeout(a,50)})},l=()=>{if(d(),e){const t=e.parentNode.getBoundingClientRect().left,n=e.getBoundingClientRect().left;e._end=t+o-n}},d=()=>{e._end=0,cancelAnimationFrame(e._updateTimer),e.style.transform="translate3d(0px, 0, 0)",e.removeEventListener("transitionend",s,!1)};return{start:c,stop:l,reset:d}},fd=({txtDom:e,height:t,lineHeight:o=0})=>{const n=parseInt(t);e.style.marginLeft="auto",e.style.marginRight="auto";let i=0,s=0;const a=()=>{e.style.transitionDuration="0s",e.style.transform=`translate3d(0, ${n-o/2}px, 0)`,requestAnimationFrame(()=>{c(s,n-o/2,-1*i)})},r=()=>{e.style.transitionDuration="0s",e.style.transform=`translated3(0, ${n-o/2-e._end}px, 0)`,requestAnimationFrame(()=>{c(s,n-o/2-e._end,-1*i)})},c=(t,o,n)=>{const i=-.6;let s=o;cancelAnimationFrame(e._updateTimer);let r=0;const c=()=>{if(s<=n)return cancelAnimationFrame(e._updateTimer),void a();s=Math.round(s+i),e.style.transform=`translate3d(0, ${s}px, 0)`},l=()=>{const t=Date.now(),o=t-r;o>=1e3/30&&(r=t,c()),e._updateTimer=requestAnimationFrame(l)};l()},l=()=>{e._end||(e._end=0),requestAnimationFrame(()=>{i=e.scrollHeight-o/2,s=Math.ceil((n+i-e._end)/18),setTimeout(r,50)})},d=()=>{if(u(),e){const t=e.parentNode.getBoundingClientRect().top,o=e.getBoundingClientRect().top;e._end=t+n-o}},u=()=>{e._end=0,cancelAnimationFrame(e._updateTimer)};return{start:l,stop:d,reset:u}},md=({txtWrap:e,rotateAngle:t})=>{if(!e)return null;const o=window.Hammer;let n=0,i=0;const s=new o(e),a=t&&t%90===0&&t%180!==0;return s.get("pan").set({direction:a?o.DIRECTION_HORIZONTAL:o.DIRECTION_VERTICAL}),s.on("panmove",(function(t){e&&(e.scrollTop=n+-1*(a?t.deltaX:t.deltaY),i=e.scrollTop)})),s.on("panend",(function(){n=i})),s};class vd extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.textEl=null,this.effectAction=null,this.create(this.setConfig())}setConfig(){const e=i["b"].state.sceneInfo.is2dRender,t=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth,o=this.getHtmlStrByCss3d(),n=this.options.content.size.x,s=this.options.content.size.y,a=e?1:this.options.fixed.scale,r={type:"image",renderer:"css3d",ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,url:"%$prevPath%/skin/assets/transparent.png",ox:this.options.fixed.offset.x*a,oy:this.options.fixed.offset.y*a,oref:1,rotationorder:"ZXY",rx:this.options.fixed.rotate.rx,ry:this.options.fixed.rotate.ry,rz:this.options.fixed.rotate.rz,rotate:e?this.options.fixed.rotate.rz:0,tx:this.options.fixed.translate.x,ty:this.options.fixed.translate.y,tz:this.options.fixed.translate.z,edge:this.options.fixed.edge,accuracy:0,width:this.options.content.size.x,height:this.options.content.size.y,handcursor:this.options.other.handcursor,capture:!1,scale:sn.value*an.value*this.options.fixed.scale,depth:t,zoom:e,distorted:!e,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),this.addHtmlStrToSprite(o.html,n,s),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return r}create(e){new Cl(i["b"].state.krp,this.options.key,e)}getHtmlStrByCss3d(){const e=this.initTextStyleConfig()||{},t=cn(e),o=un(t);let n=this.getFormatText(this.options.content.title);1===this.options.content.effect&&(n=n.replace(/<br>/g,"&nbsp;"));const i=`\n      width: 100%;\n      height: 100%;\n      display: ${1===this.options.content.effect?"flex":"block"};\n      align-items: ${1===this.options.content.effect?"center":"flex-start"};\n      background-color: ${e.bgColor};\n      overflow: hidden;\n      opacity: ${this.options.fixed.opacity}"\n    `;return{html:`<div class="scrollText__wrap" data-roll="can-roll" style="${i}">\n      <p style="${o}">${n}</p>\n    </div>`}}addHtmlStrToSprite(e,t,o){if(!this.el||!this.el.sprite)return;const n=document.createElement("div");n.className="my--event",n.style.cssText="\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      border: 0;\n    ",n.innerHTML=this.getLastSelectorHtml(e),this.el.registercontentsize(t,o),this.el.sprite.appendChild(n)}getLastSelectorHtml(e){if(!this.options.exclose)return e;const t=document.createElement("div"),o=document.createElement("span");o.className="css3d-close";const n=i["b"].state.device.mobile?"ontouchend":"onclick";return o.setAttribute(n,`myKrp.onhidecss3dhotspot(${this.options.id})`),t.appendChild(o),t.innerHTML+=e,t.innerHTML}initTextStyleConfig(){const e=this.options.content.font.size;let t=Math.round(1.2*ln(e));i["b"].state.sceneInfo.is2dRender&&(t=e);let o=1.2*ln(this.options.content.font.wordspace/e*12);i["b"].state.sceneInfo.is2dRender&&(o=this.options.content.font.wordspace/e*18);let n=1.2*ln(this.options.content.font.rowspace*e/50)+t;i["b"].state.sceneInfo.is2dRender&&(n=this.options.content.font.rowspace+t);let s="";this.options.content.font.color&&(s=dn(this.options.content.font.color,1));let a="";return this.options.content.background&&(a=dn(this.options.content.background.color,this.options.content.background.opacity)),{font:{family:this.options.content.font.family,size:t,color:s,lineheight:n,wordspace:o,bolid:this.options.content.font.bolid,italic:this.options.content.font.italic,underline:this.options.content.font.underline,align:this.options.content.font.align},rect:this.options.content.size,bgColor:a,effect:this.options.content.effect}}saveInstanceToParent(){this.updateInstance(this.el)}initTextNode(){this.el&&this.el.sprite&&(this.textEl=this.el.sprite.querySelector(".scrollText__wrap p"))}getFormatText(e){const t=[],o=e.split("");while(o.length){let e=o.shift();" "===e?e="&nbsp;":"\t"===e&&(e="&nbsp;",o.unshift(" "),o.unshift(" "),o.unshift(" ")),"\n"===e?t.push("<br>"):e&&t.push(e)}return t.join("")}startAnimation(){this.textEl||this.initTextNode(),1===this.options.content.effect?this.effectAction=hd({txtDom:this.textEl,width:this.options.content.size.x}):2===this.options.content.effect&&(this.effectAction=fd({txtDom:this.textEl,height:this.options.content.size.y})),this.effectAction&&this.effectAction.start()}stopAnimation(){this.textEl&&this.effectAction&&this.effectAction.stop()}resetAnimation(){this.textEl&&this.effectAction&&this.effectAction.reset()}updateText(e){if(!this.el||!this.el.sprite)return;const t=this.el.sprite.querySelector("p");t.innerText=e}destroy(){super.destroy(),this.el&&(this.el.sprite&&(this.el.sprite.removeChild(this.textEl),this.el.sprite=null),this.el=null,this.textEl=null)}}var bd=vd;class gd extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.create(this.setConfig())}setConfig(){var e;const{fixed:t,content:o}=this.options,n=i["b"].state.sceneInfo.is2dRender,s=this.getKrpFormatStr(o,n),a=wn(o),r=o.font.underline?"[u]"+s+"[/u]":s,c=mn(this.options,n,a);let l="",d=0;o.background&&(l=rn(o.background.color),d=o.background.opacity*t.opacity);const u=sn.value*an.value*t.scale,p=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth,h=a.y>0?null:o.size.y,f={type:"text",html:r,css:c,ath:t.position.x,atv:t.position.y,ox:t.offset.x*u,oy:t.offset.y*u,oref:1,rotationorder:"ZXY",rx:t.rotate.rx,ry:t.rotate.ry,rz:t.rotate.rz,rotate:n?t.rotate.rz:0,tx:t.translate.x,ty:t.translate.y,tz:t.translate.z,width:a.x,height:o.isTrigger||!o.title?o.size.y:h,crop:o.crop,onovercrop:o.onovercrop,handcursor:!1,capture:!1,scale:u,depth:p,zoom:n,distorted:!n,edge:t.edge,vcenter:!0,padding:o.font.padding?o.font.padding:"2",mipmapping:!0,oversampling:2,bg:2!==t.showStyle,bgcolor:l,bgroundedge:(null===(e=o.background)||void 0===e?void 0:e.round)||0,bgalpha:d,bgborder:0,enabled:this.options.other.enabled,visible:t.visible,zorder:t.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return f}getKrpFormatStr(e,t){const o=e.size.x||0,n=t?e.font.wordspace/e.font.size*18:1.2*ln(e.font.wordspace/e.font.size*12),s=this.options.content.font.size;let a=1.2*ln(s);i["b"].state.sceneInfo.is2dRender&&(a=s);const r=[];let c=0;const l=e.title.split("");while(l.length){let t=l.shift();" "===t?t="&nbsp;":"\t"===t&&(t="&nbsp;",l.unshift(" "),l.unshift(" "),l.unshift(" "));const i=this.getStrNaturalWidth(t,`${a}px ${e.font.family}`);(c+n+i>o||"\n"===t)&&(r.push("[br]"),c=0),"\n"!==t&&(c+=i,r.push(`[span]${t}[/span]`),c+n<=o&&(c+=n))}return r.join("")}getStrNaturalWidth(e,t,o=0){let n=document.querySelector(".calcChar");return n||(n=document.createElement("span"),n.className="calcChar",n.style.position="absolute",n.style.visibility="hidden",n.style.whiteSpace="nowrap",n.style.letterSpacing=o+"px",document.body.appendChild(n)),n.style.font=t||"16px Arial",n.innerHTML=e||"&nbsp;",n.getBoundingClientRect().width}create(e){new Cl(i["b"].state.krp,this.options.key,e)}saveInstanceToParent(){this.updateInstance(this.el)}updateText(e){this.el&&(this.el.html=vn(e))}destroy(){super.destroy(),this.el&&(this.el=null)}}var yd=gd;class wd extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.initTextComponent(e),this.cid=e.id,this.options=e||{},this._events=t,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initTextComponent(e){const t={id:e.id,key:e.key,fixed:e.fixed,other:e.other,content:e.content,exclose:e.exclose,events:Pl.bind(this)()};t.content.effect>0?this.el=new bd(t):(this.el=new yd(t),e.exclose&&this.initCloseComponent(e)),super.push(this.el)}initCloseComponent(e){const t=wn(e.content),o=-1*(e.content.effect>0?e.content.size.y/2:(t.y+9)/2),n=zo(e.fixed,{offset:{x:e.content.size.x/2,y:o},opacity:1}),i=new Hl({key:"sclose_"+e.id,fixed:n,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({click:()=>{this._events&&this._events.onclose&&this._events.onclose()}})});super.push(i)}onshow(){this.el&&this.el instanceof bd&&this.el.startAnimation()}onhide(){this.el&&this.el instanceof bd&&(this.options.content.reset?this.el.resetAnimation():this.el.stopAnimation())}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this._events=null}}var xd=wd;class Sd{constructor(e){this.options=e||{},this.scaleSize={hover:1,wheel:1}}onover(){this.options&&this.options.events&&this.options.events.over&&this.options.events.over(this.options.key)}onout(){this.options&&this.options.events&&this.options.events.out&&this.options.events.out(this.options.key)}ondown(){this.options&&this.options.events&&this.options.events.down&&this.options.events.down()}onup(){this.options&&this.options.events&&this.options.events.up&&this.options.events.up()}onclick(){window.console.log("模型点击了"),this.options&&this.options.events&&this.options.events.click&&this.options.events.click()}updateVisible(e){i["b"].state.modelplugin&&this.options&&(e?i["b"].state.modelplugin.show(this.options.key):i["b"].state.modelplugin.hide(this.options.key))}updateTranslate(e,t,o){i["b"].state.modelplugin&&this.options&&i["b"].state.modelplugin.upos(this.options.key,{x:e,y:t,z:o})}multiplyscale(e,t){this.scaleSize[e]=t}updateScale(e){if(!i["b"].state.modelplugin||!this.options)return;const t=(this.scaleSize.hover||1)*(this.scaleSize.wheel||1),o=e*t*sn.value*an.value;i["b"].state.modelplugin.uscale(this.options.key,o)}updateRotate(e,t,o){i["b"].state.modelplugin&&this.options&&i["b"].state.modelplugin.urotate(this.options.key,{rx:e,ry:t,rz:o})}updateOpacity(e){i["b"].state.modelplugin&&this.options&&i["b"].state.modelplugin.ualpha(this.options.key,e)}destroy(){this.options=null}}var Id=Sd;o("907a"),o("986a"),o("1d02"),o("3c5d"),o("1b3b"),o("3d71"),o("c6e3");const kd=()=>{const{initRender:e,initBuild:t,restoreThree:o,Three:i}=Od(),{watchViewChangeEvent:s,registerMouseEvent:a,restoreKrpano:r}=jd({Three:i},{restoreThree:o}),{isPass:c}=Cd(),l=[],d=()=>{Ed._three||(Ed._three=i),e(),r(),s(),a(),t(),r()};Object(n["watch"])(()=>c.value,e=>{e&&(d(),l.forEach(e=>{Ed.load(e)}))});const{add:u,show:p,hide:h,upos:f,uscale:m,ualpha:v,urotate:b,arotatey:g,playani:y,destroy:w}=Td({isPass:c,delayLoads:l});return{add:u,show:p,hide:h,upos:f,uscale:m,ualpha:v,urotate:b,arotatey:g,playani:y,destroy:w}};function Od(){const e=i["b"].state.krp.get("global"),t={renderer:null,scene:null,camera:null,stereocamera:null,raycaster:null},o=()=>{t.renderer=new window.THREE.WebGLRenderer({canvas:e.webGL.canvas,context:e.webGL.context}),t.renderer.autoClear=!1,t.renderer.setPixelRatio(1)},n=()=>{t.scene=new window.THREE.Scene},s=()=>{t.camera=new window.THREE.Camera;const e=window;e.aaa=t.camera},a=()=>{t.stereocamera=new window.THREE.Camera},r=()=>{t.raycaster=new window.THREE.Raycaster},c=()=>{const e=new window.THREE.AmbientLight(16777215,1.2),o=new window.THREE.PointLight(16777215,.1),n=new window.THREE.DirectionalLight(16777215,.1);t.scene.add(e),t.camera.add(o),t.scene.add(n),t.scene.add(t.camera)},l=()=>{const o=e.webGL.context;o.enable(o.DEPTH_TEST),o.depthFunc(o.LEQUAL),o.enable(o.CULL_FACE),o.cullFace(o.BACK),o.clearDepth(1),o.clear(o.DEPTH_BUFFER_BIT),t.renderer.state.reset()},d=()=>{n(),s(),a(),r(),c()};return{initRender:o,initBuild:d,restoreThree:l,Three:t}}function jd({Three:e},{restoreThree:t}){const o=i["b"].state.krp.get("global"),n=i["b"].state.krp.get("device"),s=Math.PI/180,a={panoview:null,euler:new window.THREE.Euler,projectMatrix:new Float32Array(16),depthbuffer_scale:1.0001,depthbuffer_offset:-.2},r=()=>{o.set("events[__threejs__].keep",!0),o.set("events[__threejs__].onviewchanged",c),o.view.continuousupdates=!0},c=()=>{const n=o.webGL.context,i=o.webVR&&o.webVR.enabled?o.webVR:null;let r=n.drawingBufferWidth;const c=n.drawingBufferHeight;if(t(),a.panoview=o.view.getState(a.panoview),a.euler.set(-1*a.panoview.v*s,(a.panoview.h-90)*s,a.panoview.r*s,"YXZ"),e.camera.quaternion.setFromEuler(a.euler),l(r,c,a.panoview.z,0,a.panoview.yf),d(e.camera),o.display.stereo){r*=.5;const t=.05,n=Number(o.display.stereooverlap);e.stereocamera.quaternion.copy(e.camera.quaternion),e.stereocamera.updateMatrixWorld(!0);let s=-.03;l(r,c,a.panoview.z,n,a.panoview.yf),i&&(s=i.eyetranslt(1),i.prjmatrix(1,a.projectMatrix),a.projectMatrix[10]=a.depthbuffer_scale,a.projectMatrix[14]=a.depthbuffer_offset),a.projectMatrix[12]=a.projectMatrix[0]*-s*t,d(e.stereocamera),e.renderer.setViewport(0,0,r,c),e.renderer.render(e.scene,e.stereocamera),s=.03,a.projectMatrix[8]=-n,i&&(s=i.eyetranslt(2),i.prjmatrix(2,a.projectMatrix),a.projectMatrix[10]=a.depthbuffer_scale,a.projectMatrix[14]=a.depthbuffer_offset),a.projectMatrix[12]=a.projectMatrix[0]*-s*t,d(e.stereocamera),e.renderer.setViewport(r,0,r,c),e.renderer.render(e.scene,e.stereocamera)}else e.renderer.setViewport(0,0,r,c),e.renderer.render(e.scene,e.camera);u(),Ed.updateAnimation()},l=(e,t,o,i,s)=>{const r=a.projectMatrix,c=n.pixelratio,l=c/(.5*e),d=c/(.5*t);r[0]=o*l,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-o*d,r[6]=0,r[7]=0,r[8]=i,r[9]=-s*d,r[10]=a.depthbuffer_scale,r[11]=1,r[12]=0,r[13]=0,r[14]=a.depthbuffer_offset,r[15]=1},d=e=>{const t=a.projectMatrix;e.projectionMatrix.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])},u=()=>{const e=o.webGL.context;e.disable(e.DEPTH_TEST),e.cullFace(e.FRONT),e.frontFace(e.CCW),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.activeTexture(e.TEXTURE0),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_ALIGNMENT,4),o.webGL.restoreProgram()},p=()=>{n.browser.events.mouse&&(o.control.layer.addEventListener("mousedown",f.bindDown,!1),window.addEventListener("mouseup",f.bindDown,!1),o.control.layer.addEventListener("mousemove",f.bindMove,!1)),n.browser.events.touch&&(o.control.layer.addEventListener(n.browser.events.touchstart,f.bindDown,!1),o.control.layer.addEventListener(n.browser.events.touchend,f.bindDown,!1))},h={enter(e){e.status.hovering=!0,e.status.loaded&&e.model.visible&&e.events.onover&&e.events.onover(),f.moveModel=e},leave(e){e.status.hovering=!1,e.status.loaded&&e.events.onout&&e.events.onout(),f.moveModel=null},down(e){o.mouse.down=!0,e.status.pressing=!0,e.status.loaded&&e.model.visible&&(f.downDuration=Date.now(),e.events.ondown&&e.events.ondown()),f.downModel=e},up(e){o.mouse.down=!1,e.status.pressing=!1,e.status.loaded&&e.model.visible&&(e.events.onup&&e.events.onup(),f.downModel&&e.key===f.downModel.key&&Date.now()-f.downDuration<=500&&e.events.onclick&&e.events.onclick()),f.downModel=null}},f={downModel:null,moveModel:null,downDuration:0,getGroupModel(e){let t=e.parent;while(t&&t.parent&&"Scene"!==t.parent.type)t=t.parent;return t},getHitModel(t,o){const n=i["b"].state.krp.get("global");let s=t/n.area.pixelwidth*2-1;const a=o/n.area.pixelheight*2-1;n.display.stereo&&(s+=(s<0?1:-1)*(1-Number(n.display.stereooverlap))*.5),e.raycaster.ray.direction.set(s,-a,1).unproject(e.camera).normalize();const r=e.raycaster.intersectObjects(e.scene.children,!0);let c=null;for(let e=0;e<r.length;e++){c=r[e].object;const t=f.getGroupModel(c);if(t)return Ed.getActiveModelConfig(t._name)}return null},bindDown(e){let t="";["mousedown","touchstart"].indexOf(e.type)>=0?t="ondown":["mouseup","touchend"].indexOf(e.type)>=0&&(t="onup");const n=Vo(e.target,"creatorContainer"),i="onup"===t&&!n;if(i)return void(f.downModel&&h.up(f.downModel));const s=o.control.getMousePos(e.changedTouches?e.changedTouches[0]:e);s.x/=o.stagescale,s.y/=o.stagescale;const a=f.getHitModel(s.x,s.y);a?"ondown"===t?(h.down(a),e.stopPropagation(),e.preventDefault()):"onup"===t&&f.downModel&&h.up(a||f.downModel):f.downModel&&h.up(f.downModel)},bindMove(){if(o.mouse.down)return;const e=f.getHitModel(o.mouse.x,o.mouse.y);if(e){const t=f.moveModel&&f.moveModel.key===e.key;t||h.enter(e)}else f.moveModel&&h.leave(f.moveModel)}};return{watchViewChangeEvent:r,registerMouseEvent:p,restoreKrpano:u,renderFrame:c}}function Cd(){const e=Object(n["ref"])(!1),t=["cdn/MTLLoader.js","cdn/OBJLoader.js","cdn/TGALoader.js","cdn/FBXLoader.js","cdn/inflate.min.js","cdn/OrbitControls.js"];window.THREE||t.unshift("cdn/three.js");const o=()=>{const n=t.shift();if(!n)return void(e.value=!0);const i=document.createElement("script");i.src=a()+n,document.body.appendChild(i),i.onload=()=>{o()}};return o(),{isPass:e}}const Ed={_three:null,_list:[],_radius:72,_rate:10,_delayList:[],saveModelConfigData(e,t){const o=this._list.findIndex(t=>t.key===e.key);o<0?this._list.push({key:e.key,events:t,options:Do(e),rotatetimer:0,cscale:0,mixers:null,matrix:null,model:null,groupsize:null,status:{loaded:!1,hovering:!1,pressing:!1}}):(this._list[o].key=e.key,this._list[o].options=Do(e),this._list[o].events=t,this._list[o].status.loaded=!1,this._list[o].status.hovering=!1,this._list[o].status.pressing=!1)},isExistCloneModel(e){window.modelCaches||(window.modelCaches=[]);const t=window.modelCaches.find(t=>t.key===e);return t||window.modelCaches.push({key:e,model:null}),t},delayRenderModel(e,t){const o=this._delayList.find(t=>t.cmkey===e);o?o.loaded=!1:this._delayList.push({cmkey:e,geoPath:t,loaded:!1})},getActiveModelConfig(e){return this._list.find(t=>t.key===e)},load({options:e,events:t}){this.saveModelConfigData(e,t);const o=this._list.find(t=>t.key===e.key);if(o&&o.model)return o.model._name=e.key,void this.initConfig(o.model,!0);const n=this.isExistCloneModel(e.content.geoPath);n?(this.delayRenderModel(e.key,e.content.geoPath),this.clone(e.key,e.content.geoPath)):/.fbx$/i.test(e.content.geoPath)?this.loadfbx(e.content,e.key):/.obj$/i.test(e.content.geoPath)&&this.loadobj(e.content,e.key)},loadfbx(e,t){if(!window.THREE.FBXLoader)return;const o=new window.THREE.FBXLoader;o.load(e.geoPath,e=>{e._name=t,this.initConfig(e)})},loadobj(e,t){if(!window.THREE.OBJLoader||!window.THREE.MTLLoader)return;const o=this.splitPath(e.geoPath),n=new window.THREE.MTLLoader,i=new window.THREE.OBJLoader;e.mtlPath?(n.setPath(o.path),n.load(o.mtlName,e=>{e.preload(),i.setMaterials(e),i.setPath(o.path),i.load(o.geoName,e=>{e._name=t,this.initConfig(e)})})):(i.setPath(o.path),i.load(o.geoName,e=>{e._name=t,this.initConfig(e)}))},clone(e,t){const o=window.modelCaches.find(e=>e.key===t);if(!o||!o.model)return;const n=this.getCloneModel(o.model,t);n.scale.set(1,1,1),n.position.set(0,0,0),n._name=e,n._clone=!0,this.initConfig(n)},loadDelayModel(e){this._delayList.forEach(t=>{t.geoPath===e&&this.clone(t.cmkey,e)})},splitPath(e){let t="",o="",n="";const i=/\w+.obj$/,s=e.match(i);if(s&&s[0]){const i=s[0];t=r().previewPath+"/"+e.replace(s[0],""),o=i,n=i.replace(/.obj/,".mtl")}return{path:t,geoName:o,mtlName:n}},initConfig(e,t=!1){const o=this.getActiveModelConfig(e._name);if(o){if(!t){this.addModelToCaches(o.options.content.geoPath,e);const t=new window.THREE.Group,n=new window.THREE.Group;o.model=n,this.repairModel(e,e._clone),this.setRotateOrigin(e),o.groupsize=this.calcGroupSize(e,o.options),this.hide(o.key),t.add(e),n.add(t),n._name=e._name,this._three.scene.add(n),this.initSkeletonAnimation(e,o.key)}requestAnimationFrame(()=>{o.events.onloaded&&o.events.onloaded(o.groupsize),o.status.loaded=!0})}},repairModel(e,t=!1){e.traverse(e=>{e.material&&t&&(e.material.length?e.material=e.material.map((function(e){return e.clone()})):e.material=e.material.clone()),e.material&&e.material.transparent&&(e.material.alphaMap=null,e.material.alphaTest=.15,e.material.depthTest=!0,e.material.side=window.THREE.DoubleSide)})},initSkeletonAnimation(e,t){const o=this.getModelByKey(t);if(!o)return;const n=e.animations&&e.animations[0];if(n){const t=o.options.content.animation,i=new window.THREE.AnimationMixer(e),s=i.clipAction(n);t.loop||(s.setLoop(window.THREE.LoopRepeat,1),s.clampWhenFinished=!0),t.reverse&&(s.timeScale=-1),o.mixers={el:i,action:s,clock:new window.THREE.Clock,speed:t.speed||1}}},playSkeAnimation(e){const t=this.getModelByKey(e);t&&t.mixers&&t.mixers.action.play()},pauseSkeAnimation(e){const t=this.getModelByKey(e);t&&t.mixers&&(t.mixers.action.paused=!0)},updateAnimation(){this._list.map((function(e){e.mixers&&e.mixers.el&&e.mixers.el.update(e.mixers.clock.getDelta()*e.mixers.speed)}))},calcGroupSize(e,t){const o=72*t.content.scaleSize,n=(new window.THREE.Box3).expandByObject(e),i=new window.THREE.Vector3(0,0,0),s=n.getSize(i),a=s.x*o/2,r=s.y*o/2,c=s.z*o/2;return{boxSize:{x:a,y:r,z:c}}},addModelToCaches(e,t){const o=window.modelCaches.find(t=>t.key===e);o&&!o.model&&(o.model=t,this.loadDelayModel(e))},getCloneModel(e,t){if(/.obj$/i.test(t))return e.clone();if(/.fbx$/i.test(t)){const t=this.staticCloneModel(e);return t.animations=e.animations,t}},staticCloneModel(e){const t=new Map,o=new Map,n=e.clone();return this.parallelTraverse(e,n,(e,n)=>{t.set(n,e),o.set(e,n)}),n.traverse(e=>{if(!e.isSkinnedMesh)return;const n=e,i=t.get(e),s=i.skeleton.bones;n.skeleton=i.skeleton.clone(),n.bindMatrix.copy(i.bindMatrix),n.skeleton.bones=s.map(e=>o.get(e)),n.bind(n.skeleton,n.bindMatrix)}),n},parallelTraverse(e,t,o){o(e,t);for(let n=0;n<e.children.length;n++)this.parallelTraverse(e.children[n],t.children[n],o)},setRotateOrigin(e){const t=this._list.find(t=>t.key===e._name);if(!t)return;const o=t.options.content;if(o.rotateOrigin)return;const n=(new window.THREE.Box3).setFromObject(e),i=n.getCenter(new window.THREE.Vector3);e.position.x+=e.position.x-i.x,e.position.y+=e.position.y-i.y,e.position.z+=e.position.z-i.z},autoRotate(e,t){const o=this.getModelByKey(e);if(!o||!o.model)return;const n=o.model.children[0];if(!n)return;o.model._auto=!0,o.model._autodegf=t,cancelAnimationFrame(o.rotatetimer);const i=()=>{n.rotateY(t),o.rotatetimer=requestAnimationFrame(i)};i()},getModelByKey(e){return this._list.find(t=>t.key===e)},updatePos(e,t){const o=this.getModelByKey(e);if(!o||!o.model)return;const n=Math.PI/180;o.options.fixed.position.x=t.x,o.options.fixed.position.y=t.y,t.z&&(o.options.fixed.depth=t.z);const i=o.options.fixed.position.x,s=o.options.fixed.position.y,a=o.options.fixed.depth,r=a/this._rate,c=r*Math.cos(s*n)*Math.cos((180-i)*n),l=r*Math.sin(s*n),d=r*Math.cos(s*n)*Math.sin((180-i)*n);o.model.position.set(c,l,d),this.updateRotate(e,{...o.options.fixed.rotate})},updatePosMatrix(e){const t=this._list.find(t=>t.key===e);if(!t||!t.model)return;const o=Math.PI/180,n=t.options.fixed.position.x,i=t.options.fixed.position.y,s=new window.THREE.Euler((180-i)*o,(n-90)*o,0,"YXZ");t.matrix=new window.THREE.Matrix4,t.matrix.makeRotationFromEuler(s)},updateRotate(e,t){const o=this.getModelByKey(e);if(!o||!o.model)return;this.updatePosMatrix(e);const n=Math.PI/180,i=new window.THREE.Euler(t.rx*n,-1*t.ry*n,-1*t.rz*n,"YXZ"),s=new window.THREE.Matrix4;s.makeRotationFromEuler(i),o.matrix.multiply(s);const a=new window.THREE.Quaternion;a.setFromRotationMatrix(o.matrix),o.model.rotation.setFromQuaternion(a)},updateScale(e,t){const o=this.getModelByKey(e);if(!o||!o.model)return;const n=o.options.content,i=t*n.scaleSize*this._radius/this._rate;o.model.scale.set(i,i,i),o.cscale=i},updateAlpha(e,t){const o=this.getModelByKey(e);o&&o.model&&o.model.traverse(e=>{e.material&&(e.material.length?e.material.forEach(e=>{e.transparent=!0,e.opacity=t}):(e.material.transparent=!0,e.material.opacity=t))})},show(e){const t=this.getModelByKey(e);t&&t.model&&(t.model.visible=!0,t.cscale&&t.model.scale.set(t.cscale,t.cscale,t.cscale),t.model._auto&&(cancelAnimationFrame(t.rotatetimer),this.autoRotate(e,t.model._autodegf)))},hide(e){const t=this.getModelByKey(e);if(!t||!t.model)return;t.model.visible=!1,t.model.scale.set(1e-6,1e-6,1e-6),cancelAnimationFrame(t.rotatetimer);const o=t.model.children[0];o&&o.rotation.set(0,0,0)},dispose(e){var t,o,n,i;e instanceof window.THREE.Mesh&&(null!==(t=e.geometry)&&void 0!==t&&t.dispose&&e.geometry.dispose(),null!==(o=e.material)&&void 0!==o&&o.dispose&&e.material.dispose(),null!==(n=e.material)&&void 0!==n&&null!==(i=n.texture)&&void 0!==i&&i.dispose&&e.material.texture.dispose());e instanceof window.THREE.Group&&e.remove(),e instanceof window.THREE.Object3D&&e.remove()}};function Td({isPass:e,delayLoads:t}){const o=(o,n)=>{const s=i["b"].state.krp.get("global");0!==s.view.fisheye&&(s.view.fisheye=0),e.value?Ed.load({options:o,events:n}):t.push({options:o,events:n})},n=e=>{Ed.show(e)},s=e=>{Ed.hide(e)},a=(e,t)=>{Ed.updatePos(e,t)},r=(e,t)=>{Ed.updateScale(e,t)},c=(e,t)=>{Ed.updateAlpha(e,t)},l=(e,t)=>{Ed.updateRotate(e,t)},d=(e,t)=>{Ed.autoRotate(e,t)},u=e=>{Ed.playSkeAnimation(e)},p=()=>{Ed._list.map(e=>{e.options=null,e.events=null}),Ed._delayList=[]};return{add:o,show:n,hide:s,upos:a,uscale:r,ualpha:c,urotate:l,arotatey:d,playani:u,destroy:p}}var Pd=kd;class _d extends Id{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.rtimer=0,i["b"].state.modelplugin||(i["b"].state.modelplugin=Pd()),this.create()}create(){if(!i["b"].state.modelplugin)return;const e={key:this.options.key,fixed:this.options.fixed,content:{geoPath:this.options.content.geoPath,mtlPath:this.options.content.mtlPath,scaleSize:this.options.content.scaleSize,animation:this.options.content.animation||{type:0,loop:!1,reverse:!1,speed:1},autoRotate:this.options.content.autoRotate||!1,rotateType:this.options.content.rotateType||0,rotateOrigin:this.options.content.rotateOrigin||0}};i["b"].state.modelplugin.add(e,{onloaded:e=>{super.updateTranslate(this.options.fixed.position.x,this.options.fixed.position.y,this.options.fixed.depth),super.updateRotate(this.options.fixed.rotate.rx,this.options.fixed.rotate.ry,this.options.fixed.rotate.rz),super.updateScale(this.options.fixed.scale),super.updateOpacity(this.options.fixed.opacity),this.options.events&&this.options.events.loaded&&this.options.events.loaded(e)},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)})}destroy(){super.destroy()}}var Ad=_d;class Md extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed};super(o),this.el=null,this.sclose=null,this.boxInfo={size:null,isUpdated:!1},this.initModelComponent(e),e.exclose&&this.initCloseComponent(e),this.cid=e.id,this.options=e,this._events=t||{},this.events=Al(t,{show:this.onshow.bind(this)})}initModelComponent(e){this.el=new Ad({id:e.id,key:e.key,fixed:e.fixed,other:e.other,content:e.content,events:Pl.bind(this)({loaded:e=>{e&&e.boxSize&&(this.boxInfo.size=e.boxSize),this.boxInfo.size&&this.updateCloseOffset(this.boxInfo.size.x/2,-1*this.boxInfo.size.y/2)}})}),super.push(this.el)}initCloseComponent(e){const t=zo(e.fixed,{opacity:1});this.boxInfo.size&&(t.offset.x=this.boxInfo.size.x/2+30,t.offset.y=-1*this.boxInfo.size.y/2),this.sclose=new Hl({key:"sclose_"+e.id,fixed:t,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({loaded:()=>{this.boxInfo.size&&this.updateCloseOffset(this.boxInfo.size.x/2,-1*this.boxInfo.size.y/2)},click:()=>{this._events.onclose&&this._events.onclose()}},!0)}),super.push(this.sclose)}updateCloseOffset(e,t){this.sclose&&this.sclose.updateOffset(e,t)}onshow(){this.autoRotate(),this.playAnimation()}autoRotate(){if(!this.options.content.autoRotate)return;let e=.01;this.options.content.rotateType||(e*=-1),i["b"].state.modelplugin.arotatey(this.options.key,e)}playAnimation(){const e=this.options.content.animation||{};1===e.type&&i["b"].state.modelplugin.playani(this.options.key)}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.sclose&&(this.sclose.destroy(),this.sclose=null)}}var Hd=Md;class zd extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.effectAction=null,this.titleInfo={fontsize:0,width:0,height:0,naturalw:0,naturalh:0},this.create(this.setConfig())}get getTitleInfo(){return this.titleInfo}setConfig(){const e=i["b"].state.sceneInfo.is2dRender,t=this.initTitleStr(String(this.options.content.title)),o=this.initTitleStyle(),n=this.initTitleBg(),s=o.size||{x:0,y:0},a=Math.max(s.x,this.options.content.size.x),r=Math.max(s.y,this.options.content.size.y);this.titleInfo.fontsize=o.fontsize,this.titleInfo.width=a,this.titleInfo.height=r,this.titleInfo.naturalw=s.x,this.titleInfo.naturalh=s.y;const c=sn.value*an.value*this.options.fixed.scale,l=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth;return{type:"text",html:t,css:o.styleStr,ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,ox:this.options.fixed.offset.x*c,oy:this.options.fixed.offset.y*c,oref:1,rotationorder:"ZXY",rx:this.options.fixed.rotate.rx,ry:this.options.fixed.rotate.ry,rz:this.options.fixed.rotate.rz,rotate:e?this.options.fixed.rotate.rz:0,tx:this.options.fixed.translate.x,ty:this.options.fixed.translate.y,tz:this.options.fixed.translate.z,edge:this.options.fixed.edge,alpha:this.options.fixed.opacity,width:a,height:r,handcursor:this.options.other.handcursor,capture:!1,scale:c,depth:l,vcenter:!0,mipmapping:!0,oversampling:2,padding:this.options.content.padding,bg:!0,bgcolor:n.color,bgroundedge:n.round,bgalpha:n.opacity,bgborder:0,zoom:e,distorted:this.options.other.destorted&&!e,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)}}create(e){new Cl(i["b"].state.krp,this.options.key,e)}initTitleStr(e){let t=fn(e);return t=hn(t),this.options.content.font.wordspace&&(t=this.getSplitText(t)),this.options.content.font.underline&&(t="[u]"+t+"[/u]"),"[p]"+t+"[/p]"}getSplitText(e){let t="";e=e.replace(/^\s+/,"");const o=e.split("");let n=0,i=0,s="";while(n<o.length)s=o[n],t||(t+="[span]")," "!==s?(i>=1?(t+="[/span]",n!==o.length-1&&(t+="[span]"),t+=s,i=0):t+=s,i++):t+="&nbsp;",/\n|(\r\n)/.test(s)&&(t+="<br/>"),n++;return t}initTitleStyle(){const e=this.options.content.font.size,t=i["b"].state.sceneInfo.is2dRender?e:1.2*ln(e),o=this.options.content.font.wordspace,n=Math.round(i["b"].state.sceneInfo.is2dRender?o/e*18:1.2*ln(o/e*12)),s=rn(this.options.content.font.color),a=i["b"].state.device.mobile?10:0,r=i["b"].state.device.mobile?5:0,c=`padding: 0px 0px ${a}px ${r}px;\n        text-align: ${this.options.content.font.align};\n        color: ${s};\n        font-style: ${this.options.content.font.italic?"italic":"normal"};\n        font-family: ${this.options.content.font.family};\n        font-weight: ${this.options.content.font.bolid?"bold":"normal"};\n        line-height: 1;\n        font-size: ${t}px;\n        white-space: nowrap;\n        box-sizing: border-box;\n        overflow: hidden;`,l=`letter-spacing: ${n}px;`,d=this.options.content.title.replace(/\s/g,"&nbsp;"),u=bn(d,[c,l]),p=`\n      p {${c}}\n      span {${l}}\n      i{font-style: normal;}\n    `;return{size:u,fontsize:t,styleStr:p}}initTitleBg(){const e=this.options.content.background||{},t=e.color?rn(e.color):"";return{color:t,opacity:e.opacity||0,round:2}}saveInstanceToParent(){this.updateInstance(this.el)}updateText(e){this.el&&(this.el.html=this.initTitleStr(e))}destroy(){super.destroy(),this.el&&(this.el=null)}}var Ld=zd;class Dd extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.bgel=null,e.content.path&&this.initImgComponent(e),this.initTextComponent(e),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initTextComponent(e){const t=zo(e.textContent,{});e.content.path&&t.background&&(t.background.opacity=0),this.el=new Ld({key:e.key,fixed:e.fixed,content:t,other:{enabled:!e.content.path},events:Pl.bind(this)()}),super.push(this.el)}initImgComponent(e){this.bgel=new Hl({id:e.id,key:"sposter_"+e.id,fixed:e.fixed,other:e.other,content:e.content,events:Pl.bind(this)()}),super.push(this.bgel)}updateValue(e){this.el&&void 0!==e&&this.el.updateText(String(e))}onshow(){this.bgel&&this.bgel.startCropAnimation()}onhide(){this.bgel&&this.bgel.stopCropAnimation()}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.bgel&&(this.bgel.destroy(),this.bgel=null)}}var Bd=Dd;class Nd extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.create(this.setConfig())}setConfig(){const e=i["b"].state.sceneInfo.is2dRender,t=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth,o=this.getHtmlStrByCss3d(),n=this.options.content.size.x,s=this.options.content.size.y,a=e?1:this.options.fixed.scale,r={type:"image",renderer:"css3d",ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,url:"%$prevPath%/skin/assets/transparent.png",ox:this.options.fixed.offset.x*a,oy:this.options.fixed.offset.y*a,oref:1,rotationorder:"ZXY",rx:this.options.fixed.rotate.rx,ry:this.options.fixed.rotate.ry,rz:this.options.fixed.rotate.rz,rotate:e?this.options.fixed.rotate.rz:0,tx:this.options.fixed.translate.x,ty:this.options.fixed.translate.y,tz:this.options.fixed.translate.z,edge:this.options.fixed.edge,accuracy:0,width:this.options.content.size.x,height:this.options.content.size.y,handcursor:this.options.other.handcursor,capture:!1,scale:sn.value*an.value*this.options.fixed.scale,depth:t,zoom:e,distorted:!e,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),this.addHtmlStrToSprite(o.html,n,s),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return r}create(e){new Cl(i["b"].state.krp,this.options.key,e)}getHtmlStrByCss3d(){const e=this.initTextStyleConfig()||{},t=`\n      padding: 0 10px;\n      font-size: 20px;\n      width: 100%;\n      height: 100%;\n      color: ${e.color};\n      background-color: ${e.bgColor};\n      border: 2px solid ${e.borderColor};\n      opacity: ${this.options.fixed.opacity};\n      overflow: hidden;\n      box-sizing: border-box;\n    `,o=document.createElement("fragment"),n=document.createElement("input");return n.style.cssText=t,o.appendChild(n),{html:o.innerHTML}}addHtmlStrToSprite(e,t,o){if(!this.el||!this.el.sprite)return;const n=document.createElement("div");n.className="my--event",n.style.cssText="\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      border: 0;\n      box-sizing: border-box;\n    ",n.innerHTML=e,this.el.registercontentsize(t,o),this.el.sprite.appendChild(n),this.bindEvent()}initTextStyleConfig(){let e="";this.options.content.background&&this.options.content.background.color&&(e=dn(this.options.content.background.color,this.options.content.background.opacity));let t="";this.options.content.color&&(t=dn(this.options.content.color,this.options.content.color.w/255));let o="";return this.options.content.borderColor&&(o=dn(this.options.content.borderColor,this.options.content.borderColor.w/255)),{rect:this.options.content.size,bgColor:e,color:t,borderColor:o}}saveInstanceToParent(){this.updateInstance(this.el)}bindEvent(){const e=this.el.sprite.querySelector("input");e&&(e.onmousedown=()=>{this.options.on&&this.options.on.inputDown&&this.options.on.inputDown()},e.ontouchstart=()=>{this.options.on&&this.options.on.inputDown&&this.options.on.inputDown()},e.onchange=()=>{this.options.on&&this.options.on.inputChange&&this.options.on.inputChange(e.value)})}destroy(){super.destroy(),this.el&&(this.el.sprite&&(this.el.sprite=null),this.el=null)}}var Vd=Nd;class Rd extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.labelEl=null,this.inputEl=null,this.initTextComponent(e),this.initInputComponent(e),this.cid=e.id,this.options=e||{},this._events=t,this.events=Al(t,{})}initTextComponent(e){const t={offset:e.fixed.offset||{},edge:"center"};let o=0;switch(e.content.align){case"left":o=0===e.content.titlePos?-1*e.textContent.font.size:0;break;case"center":o=0===e.content.titlePos?-.5*e.textContent.font.size:.5*e.textContent.font.size;break;case"right":o=0===e.content.titlePos?0:e.textContent.font.size;break;default:break}0===e.content.titlePos?(t.offset.x=e.content.size.x/2*-1,t.edge="right"):1===e.content.titlePos&&(t.offset.x=e.content.size.x/2*-1,t.offset.y=-1*(e.content.size.y/2+5),t.edge="leftbottom"),t.offset.x+=o;const n={id:e.id,key:e.key+"_label",fixed:Object.assign({},e.fixed,t),other:e.other,content:e.textContent,exclose:e.exclose,events:Pl.bind(this)()};this.labelEl=new Ld(n),super.push(this.labelEl)}initInputComponent(e){const t={id:e.id,key:e.key,fixed:e.fixed,other:e.other,content:{title:e.textContent.title,...e.content},exclose:e.exclose,events:Pl.bind(this)(),on:{inputDown:()=>{const e=window.event;e&&e.stopPropagation()},inputChange:e=>{this._events&&this._events.inputChange&&this._events.inputChange(e)}}};this.inputEl=new Vd(t),super.push(this.inputEl)}destroy(){super.destroy(),this.labelEl&&(this.labelEl.destroy(),this.labelEl=null),this._events=null}}var Fd=Rd;class Gd extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.poster=null,this.control=null,this.isInitial=!1,this.options=e||{},this.serverPath=e.content.path,this.initWebviewComponent(e),this.cid=e.id,this._events=t,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initWebviewComponent(e){this.el=new dd({id:e.id,key:"swebview_"+e.id,fixed:e.fixed,other:e.other,expand:e.expand,content:{path:e.content.path,size:e.content.size,control:e.content.control},exclose:e.exclose,events:Pl.bind(this)()}),super.push(this.el)}showIframe(e){const t=e.querySelector(".my--event"),o=t.querySelector("iframe"),n=this.options.content.path===this.serverPath;if(o)n||(o.src=this.serverPath);else{const e=document.createElement("iframe");e.style.width="100%",e.style.height="100%",e.frameBorder="0",e.style.opacity=this.options.fixed.opacity,t.appendChild(e),e.src=this.serverPath}}hideIframe(e){const t=e.querySelector(".my--event"),o=e.querySelector("iframe");t&&o&&t.removeChild(o)}async onshow(){this.el&&this.el.el.sprite&&this.showIframe(this.el.el.sprite)}onhide(){var e;this.el&&null!==(e=this.el.el)&&void 0!==e&&e.sprite&&this.hideIframe(this.el.el.sprite)}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null)}}var Wd=Gd;function $d(){const e={},t=t=>(e[t]||(e[t]={rotate:null,pos:null,prevPos:null}),e[t]),o=(e,o)=>{const n=t(e),i=Math.PI/180,s=new window.THREE.Euler;s.set(o.rx*i,o.ry*i,-1*o.rz*i,"ZXY"),n.rotate=new window.THREE.Matrix4,n.rotate.makeRotationFromEuler(s)},n=(e,o,n)=>{const i=t(e),s=Math.PI/180,a={rx:-1*o.y,ry:o.x,rz:0},r={rx:n.y,ry:0-n.x,rz:0},c=new window.THREE.Euler;c.set(a.rx*s,a.ry*s,a.rz*s,"ZXY");const l=new window.THREE.Euler;l.set(r.rx*s,r.ry*s,r.rz*s,"YXZ");const d=new window.THREE.Matrix4;d.makeRotationFromEuler(c);const u=new window.THREE.Matrix4;if(u.makeRotationFromEuler(l),d.multiply(u),i.prevPos){const e=new window.THREE.Matrix4;e.multiply(i.prevPos),e.multiply(d),i.pos=e}else i.pos=d},i=e=>{const o=t(e);o.prevPos=o.pos},s=e=>{const o=t(e),n=Math.PI/180,i=new window.THREE.Matrix4;o.rotate&&i.multiply(o.rotate),o.pos&&i.multiply(o.pos);const s=new window.THREE.Euler;return s.setFromRotationMatrix(i,"ZXY"),{rx:s.x/n,ry:s.y/n,rz:-1*s.z/n}};return{updateLocalRotate:o,updateNotFaceCameraRotate:n,saveTranslateRotate:i,getCorrectRotateEuler:s}}const{updateLocalRotate:Ud,updateNotFaceCameraRotate:Xd,saveTranslateRotate:Yd,getCorrectRotateEuler:Zd}=$d();class qd{constructor(e,t){this.options=e,this.events=t,this.timer=0,this.maxTime=this.getMaxAnimationTime(),this.timeline={initial:0,start:0,seek:0},this.stageline={translate:0},Ud(e.key,e.initial.rotate)}start(){cancelAnimationFrame(this.timer),this.timeline.initial||(this.timeline.initial=this.timeline.start),this.events.start&&this.events.start(),this.timeline.start=Date.now(),this.frame()}stop(){cancelAnimationFrame(this.timer),this.timeline.start&&(this.timeline.seek+=Date.now()-this.timeline.start)}reset(){this.stop();const e={x:this.options.initial.translate.ath,y:this.options.initial.translate.atv,z:i["b"].state.sceneInfo.is2dRender?1e3/72:this.options.initial.translate.radius};this.events.translate&&this.events.translate(e),this.events.rotate&&this.events.rotate(this.options.initial.rotate),this.events.scale&&this.events.scale(this.options.initial.scale.value),this.events.opacity&&this.events.opacity(this.options.initial.opacity.value),this.events.visible&&this.events.visible(this.options.initial.visible.value),this.timeline.initial=0,this.timeline.start=0,this.timeline.seek=0}frame(){const e=Date.now()-this.timeline.start+this.timeline.seek;e>=this.maxTime?this.onend():(this.actionFrame(e),this.timer=requestAnimationFrame(this.frame.bind(this)))}actionFrame(e){this.options.frames.forEach((t,o)=>{if(e>=t.start&&e<t.end+0){const n=(e-t.start)/(t.end-t.start)*1e3/1e3,i=Math.min(n,1);switch(t.type){case 0:this.setTranslate(t,o,i);break;case 1:this.setRotate(t,o,i);break;case 2:this.setScale(t,o,i);break;case 3:this.setVisible(t,i,e);break;case 4:this.setAlpha(t,o,i);break;default:break}}})}setTranslate(e,t,o){const n=this.options.frames.find((e,o)=>0===e.type&&o===t-1)||this.options.initial.translate;t>this.stageline.translate&&(this.stageline.translate++,Yd(this.options.key));const s=n.ath+(e.ath-n.ath)*o,a=n.atv+(e.atv-n.atv)*o;let r=1;r=i["b"].state.sceneInfo.is2dRender?1e3/72:n.radius+(e.radius-n.radius)*o;const c={x:s,y:a,z:r};if(this.events.translate&&this.events.translate(c),!this.options.isFaceCamera){const e={x:n.ath,y:n.atv};Xd(this.options.key,e,c);const t=Zd(this.options.key);this.events.rotate&&this.events.rotate(t)}}setRotate(e,t,o){const n=this.options.frames.find((e,o)=>1===e.type&&o===t-1)||this.options.initial.rotate,i=n.rx+(e.rx-n.rx)*o,s=n.ry+(e.ry-n.ry)*o,a=n.rz+(e.rz-n.rz)*o,r={rx:i,ry:s,rz:a};if(this.options.isFaceCamera)this.events.rotate&&this.events.rotate(r);else{Ud(this.options.key,r);const e=Zd(this.options.key);this.events.rotate&&this.events.rotate(e)}}setScale(e,t,o){const n=this.options.frames.find((e,o)=>2===e.type&&o===t-1)||this.options.initial.scale,i=n.value+(e.value-n.value)*o;this.events.scale&&this.events.scale(i)}setAlpha(e,t,o){const n=this.options.frames.find((e,o)=>4===e.type&&o===t-1)||this.options.initial.opacity,i=n.value+(e.value-n.value)*o;this.events.opacity&&this.events.opacity(i)}setVisible(e,t,o){Math.abs(o-e.end)<=200&&this.events.visible&&this.events.visible(e.value)}onend(){this.events.end&&this.events.end()}getMaxAnimationTime(){let e=0;return this.options.frames.forEach(t=>{t.end>e&&(e=t.end)}),e}destroy(){this.options={},this.events={},cancelAnimationFrame(this.timer)}}var Kd=qd;function Jd(){let e=[];const t=t=>e.find(e=>e.key===t)||{rendered:!1,paused:!0,complete:!0,enable:!1},o=(t,o,n={})=>{if(!o.frames.length)return;o.key=t;const i=new Kd(o,n);e.push({key:t,id:Number(t.split("_").shift()),instance:i,rendered:!0,paused:!0,complete:!0,enable:!1})},n=e=>{const o=t(e);var n;o&&o.rendered&&(c(e),null===(n=o.instance)||void 0===n||n.start(),o.paused=!1)},i=e=>{const o=t(e);var n;o&&o.rendered&&(null===(n=o.instance)||void 0===n||n.stop(),o.paused=!0)},s=e=>{const o=t(e);var n;o&&o.rendered&&(null===(n=o.instance)||void 0===n||n.reset(),o.paused=!0)},a=()=>{e.forEach(e=>{var t;s(e.key),e.complete=!1,null===(t=e.instance)||void 0===t||t.destroy(),e.instance=null});for(let t=0;t<e.length;t++)e.splice(t,1);e=[]},r=(e,o,n)=>{const i=t(e);i&&void 0!=i[o]&&(i[o]=n)},c=t=>{const o=Number(t.split("_").shift());e.forEach(e=>{e.id===o&&(e.enable=e.key===t)})},l=t=>e.find(e=>e.id===t&&e.enable);return{createAnimation:o,startAnimation:n,stopAnimation:i,resetAnimation:s,getAnimation:t,updateAnimationStatus:r,getCmAnimationEnable:l,removeAllAnimation:a}}const{createAnimation:Qd,startAnimation:eu,stopAnimation:tu,resetAnimation:ou,getAnimation:nu,updateAnimationStatus:iu,getCmAnimationEnable:su,removeAllAnimation:au}=Jd();function ru(){const e=[],t=t=>e.find(e=>e.key===t),o=(o,n)=>{const i=t(o);i||e.push({key:o,instances:n})},n=()=>{if(e.length){e.map(e=>{h(e.key)});for(let t=0;t<e.length;t++){const o=e[t];o.instances=[],e.splice(t,1),t--}}},i=e=>{const o=t(e);if(o&&o.instances.length)return o.instances[0].getFixedData},s=(e,o)=>{const n=t(e);n&&n.instances.length&&n.instances.forEach(e=>{e.translate(o.x,o.y,o.z)})},a=(e,o)=>{const n=t(e);n&&n.instances.length&&n.instances.forEach(e=>{e.rotate(o.rx,o.ry,o.rz)})},r=(e,o)=>{const n=t(e);n&&n.instances.length&&n.instances.forEach(e=>{e.scale(o)})},c=(e,o,n)=>{const i=t(e);i&&i.instances.length&&i.instances.forEach(e=>{e.multiplyscale(o,n)})},l=(e,o)=>{const n=t(e);n&&n.instances.length&&n.instances.forEach(e=>{e.opacity(o)})},d=(e,o)=>{const n=t(e);n&&n.instances.length&&n.instances.forEach(e=>{e.visible(o)})},u=e=>{const o=t(e);o&&o.instances.length&&o.instances.forEach(e=>{e.show()})},p=e=>{const o=t(e);o&&o.instances.length&&o.instances.forEach(e=>{e.hide()})},h=e=>{const o=t(e);o&&o.instances.length&&o.instances.forEach(e=>{e.destroy(),e=null})};return{getActionComponent:t,getActionComponentFixed:i,addActionComponent:o,removeAllActionComponent:n,updateActionTranslate:s,updateActionVisible:d,updateActionRotate:a,updateActionScale:r,updateActionMultiplyScale:c,updateActionOpacity:l,showActionComponent:u,hideActionComponent:p}}const{getActionComponent:cu,getActionComponentFixed:lu,addActionComponent:du,removeAllActionComponent:uu,updateActionTranslate:pu,updateActionVisible:hu,updateActionRotate:fu,updateActionScale:mu,updateActionMultiplyScale:vu,updateActionOpacity:bu,showActionComponent:gu,hideActionComponent:yu}=ru();function wu(){const e=(e,t)=>{var n;window.console.log("更新变量值",e,t),Ns.emit(Ba,{vid:e,name:(null===(n=o(e))||void 0===n?void 0:n.name)||"",value:t}),i["b"].commit(jo["y"],{vid:e,value:t})},t=()=>{i["b"].state.sceneInfo.variables.forEach(e=>{i["b"].commit(jo["y"],{vid:e.id,value:e.backupValue})})},o=e=>{const t=[...i["b"].state.sceneInfo.variables,...i["b"].state.skyBoxSceneGroup.glVariables];return t.find(t=>t.id===e)},n=e=>e.isUseVar?o(e.id).value:e.value,s=(t,o,i)=>{const s=n(o),a=n(i);e(t,Dn(s,a))},a=(t,o,i)=>{const s=n(o),a=n(i);e(t,Bn(s,a))},r=(t,o,i)=>{const s=n(o),a=n(i);e(t,Nn(s,a))},c=(t,o,i)=>{const s=n(o),a=n(i);0!==a&&e(t,Vn(s,a))},l=(t,o)=>{const i=n(o);e(t,i)},d=(t,o)=>{const i=n(o);e(t,!i)};return{updateVar:e,resetVars:t,getVar:o,OperationAdd:s,OperationSub:a,OperationMul:r,OperationDiv:c,OperationAss:l,OperationInv:d}}const{updateVar:xu,resetVars:Su,getVar:Iu,OperationAdd:ku,OperationSub:Ou,OperationMul:ju,OperationDiv:Cu,OperationAss:Eu,OperationInv:Tu}=wu();function Pu(){const e=(e,t)=>{let o=[];return 1===t?o=o.concat(i["b"].state.sceneInfo.hotspots):2===t?o=o.concat(i["b"].state.sceneInfo.parts):3===t&&(o=o.concat(i["b"].state.sceneInfo.triggers)),o.find(t=>t.id===e)},t=(t,o)=>{const n=e(t,o),i={};if(n&&n.propertyControl)for(const e in n.propertyControl){const t=n.propertyControl[e];t.isActive&&(i[e]=t)}return i},o=e=>{var t;const o=e.id>=0?Iu(e.id):e.constant;return null!==(t=null===o||void 0===o?void 0:o.value)&&void 0!==t?t:0},n=(t,o)=>{var n,i,s,a,r;const c=e(t,o)||{};return{position:{x:(null===(n=c.position)||void 0===n?void 0:n.x)||0,y:(null===(i=c.position)||void 0===i?void 0:i.y)||0,z:c.radius},rotate:{rx:(null===(s=c.rotate)||void 0===s?void 0:s.rx)||0,ry:(null===(a=c.rotate)||void 0===a?void 0:a.ry)||0,rz:(null===(r=c.rotate)||void 0===r?void 0:r.rz)||0},scale:c.scale,opacity:c.opacity}},s=(e,t)=>{let o="";return 1===t?o="hotspot_":2===t?o="part_":3===t&&(o="trigger_"),o+e},a=e=>Qn({x:e.rx,y:e.ry,z:e.rz}),r=(e,t)=>{const o=s(e,t),r=lu(o),c=n(e,t),l=r||c,d=Do(l);d.visible=Sl(o),d.opacity=l.opacity;const u=ei(l.position,!0);d.position.x=u.x,d.position.y=u.y,r&&(d.position.z=(i["b"].state.sceneInfo.is2dRender?1e3:d.position.z)/72);const p=a(l.rotate);return d.rotate.rx=p.rx,d.rotate.ry=p.ry,d.rotate.rz=p.rz,d},c=(e,t,n)=>{const s=r(e,t),a=[],c=i["b"].state.sceneInfo.is2dRender;for(const i in n)if(Object.prototype.hasOwnProperty.call(n,i)){const e=n[i],t=o(e),r=4===e.operationType&&0===t;if(r)a.push(i);else switch(i){case"posX":s.position.x=Xn(s.position.x,t,e.operationType),c&&(s.position.x=Rn(s.position.x,-1,1));break;case"posY":s.position.y=Xn(s.position.y,t,e.operationType),c&&(s.position.y=Rn(s.position.y,-1,1));break;case"posZ":s.position.z=Xn(s.position.z,t,e.operationType),s.position.z=Rn(s.position.z,1,50);break;case"rolX":s.rotate.rx=Xn(s.rotate.rx,t,e.operationType);break;case"rolY":s.rotate.ry=Xn(s.rotate.ry,t,e.operationType);break;case"rolZ":s.rotate.rz=Xn(s.rotate.rz,t,e.operationType);break;case"scale":s.scale=Xn(s.scale,t,e.operationType),s.scale=Rn(s.scale,.01,s.scale);break;case"opacity":s.opacity=Xn(s.opacity,t,e.operationType),s.opacity=Rn(s.opacity,0,1);break;case"visible":s.visible=Xn(s.visible,t,e.operationType);break;default:break}}return{dframe:s,invalidkeys:a}},l=(e,t,o)=>{const n=Do(o),i=a(n.rotate);n.rotate.rx=i.rx,n.rotate.ry=i.ry,n.rotate.rz=i.rz;const r=ei(n.position);n.position.x=r.x,n.position.y=r.y;const c=s(e,t);if(n.position&&(pu(c,n.position),1===t)){const t="hotspot_con_"+e;pu(t,n.position)}return n.rotate&&fu(c,n.rotate),void 0!==n.scale&&mu(c,n.scale),void 0!==n.opacity&&bu(c,n.opacity),void 0!==n.visible&&hu(c,Boolean(n.visible)),n},d=(e,t,o)=>{for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const i=e[n],s=o.indexOf(n)<0;if(s&&i.assignId>=0)switch(n){case"posX":xu(i.assignId,t.position.x);break;case"posY":xu(i.assignId,t.position.y);break;case"posZ":xu(i.assignId,t.position.z);break;case"rolX":xu(i.assignId,t.rotate.rx);break;case"rolY":xu(i.assignId,t.rotate.ry);break;case"rolZ":xu(i.assignId,t.rotate.rz);break;case"scale":xu(i.assignId,t.scale);break;case"opacity":xu(i.assignId,t.opacity);break;case"visible":xu(i.assignId,t.visible);break;default:break}}},u=(e,o)=>{const n=t(e,o),i=c(e,o,n),s=Do(i.dframe),a=l(e,o,i.dframe);return d(n,s,i.invalidkeys),a};return{getActiveProperty:t,startPropertyFrame:u}}const{getActiveProperty:_u,startPropertyFrame:Au}=Pu();function Mu(){const e=[],t=t=>e.find(e=>e.cid===t),o=(o,n,i)=>{const s=t(o);s?s.attr[n]=i:e.push({cid:o,attr:{[n]:i}})},n=()=>{if(e.length)for(let t=0;t<e.length;t++)e.splice(t,1),t--},s=e=>{const t=i["b"].state.sceneInfo.parts.find(t=>t.id===e);t&&o(e,"visible",!t.isShow)},a=e=>{const t=m(e,"open")||!1;o(e,"open",!t)},r=({cid:e,gearTarget:t,status:n,aniId:i,pointIndex:s})=>{o(e,"action",{aniId:i,gearTarget:t,pointIndex:s,status:n})},c=(e,t)=>{o(e,"aniId",t)},l=(e,t)=>{const n=Au(e,t),i=_u(e,t);("posX"in i||"posY"in i||"posZ"in i)&&o(e,"position",n.position),("rolX"in i||"rolY"in i||"rolZ"in i)&&o(e,"rotate",n.rotate),"scale"in i&&o(e,"scale",n.scale),"opacity"in i&&o(e,"opacity",n.opacity),"visible"in i&&o(e,"visible",n.visible)},d=(e,t)=>{o(e,"varId",t)},u=({cid:e,aniId:t,pointIndex:o})=>{0===o?a(e):1===o?c(e,t):2===o&&l(e,1)},p=(e,t,o,n)=>{0===o?s(e):1===o?c(e,t):2===o?l(e,2):3===o&&d(e,n)},h=({cid:e,aniId:t,pointIndex:o,gearTarget:n,status:i})=>{0===o?r({cid:e,gearTarget:n,status:i,aniId:t,pointIndex:o}):1===o?c(e,t):3===o&&l(e,3)},f=({cid:e,ctype:t,aniId:o,pointIndex:n,parentId:s,gearTarget:a,status:r})=>{let c=!1;for(let l=0,d=i["b"].state.preSetCmIds.length;l<d;l++){const t=i["b"].state.preSetCmIds[l];t!==e||c||(i["b"].state.preSetCmIds.splice(l,1),c=!0)}switch(t){case 1:u({cid:e,aniId:o,pointIndex:n});break;case 2:p(e,o,n,Number(s));break;case 3:h({cid:e,aniId:o,pointIndex:n,gearTarget:a,status:r});break;default:break}},m=(e,o)=>{const n=t(e);return n?n.attr[o]:null},v=(e,o,n)=>{const i=t(e);i&&(i.attr[o]=n)};return{getRecordProperty:t,getCmFrameProperty:m,setCmFrameProperty:v,uopdateCmRecord:f,removeAllProperty:n}}const{getRecordProperty:Hu,getCmFrameProperty:zu,setCmFrameProperty:Lu,uopdateCmRecord:Du,removeAllProperty:Bu}=Mu(),Nu=()=>{i["b"].state.krp.set("control.usercontrol","off")},Vu=()=>{i["b"].state.pageStatus.airpose||i["b"].state.krp.set("control.usercontrol","all")},{isReadyComplete:Ru}=bp(),{renderText:Fu,renderImage:Gu,renderVideo:Wu,renderImages:$u,renderLive:Uu,renderModel:Xu,renderNumber:Yu,renderFormInput:Zu,renderWebview:qu}=wp(),{renderSingerPart:Ku,renderHighResolutionGifPart:Ju,destroyRender:Qu}=gp(Ru),{showAllPart:ep,checkPartRenderAndToggle:tp,checkPartRenderAndShow:op,checkPartRenderAndHide:np}=xp(),{updatefocuscid:ip,checkFocuscidExist:sp}=Sp(),{replayCmAnimation:ap,resetCmAnimation:rp,getCmAnimationPlayingStatus:cp,checkShowAndStartAnimation:lp,checkHideAndStopAnimation:dp}=Ip(),{dragstart:up,dragend:pp,getDragPressStatus:hp}=kp(),{reportPartData:fp,reportPartInputData:mp}=jp();function vp(){Op(),Ep(),yp()}function bp(){const e=Object(n["ref"])(!1),t=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&(t||1===i["b"].state.sceneInfo.type)});return Object(n["watch"])(()=>t.value,t=>{e.value=t}),{isReadyComplete:e}}function gp(e){const t={},o=e=>{const t="part_"+e.id,o=9===e.type,n=11===e.type&&(e.content.gifInfo.imgWidth>=4e3||e.content.gifInfo.imgHeight>=4e3),a=1!==i["b"].state.sceneInfo.type&&!o&&!n;bl(e.id,t,a);const r=s(e);du(t,[r])},s=e=>{let t=null;switch(e.type){case 2:t=Fu(e);break;case 3:case 11:case 23:t=Gu(e);break;case 4:case 51:t=Wu(e);break;case 7:t=$u(e);break;case 9:t=Xu(e);break;case 22:t=Uu(e);break;case 53:t=Yu(e);break;case 55:t=Zu(e);break;case 56:t=qu(e);break;default:break}return t},a=e=>{if(t[e])return;const n=i["b"].state.sceneInfo.parts.find(t=>t.id===e);n&&(t[e]=!0,o(n))};let r=[],c=!1;const l=()=>{if(c&&!r.length)return;if(!c){const e=i["b"].state.sceneInfo.parts.filter(e=>11===e.type&&(e.content.gifInfo.imgWidth>=4e3||e.content.gifInfo.imgHeight>=4e3));r=e.map(e=>e.id)}const e=r.shift();e&&a(e),c=!0},d=()=>{const e=i["b"].state.sceneInfo.hotspots.length+i["b"].state.sceneInfo.triggers.length>0,t=i["b"].state.sceneInfo.parts.filter(t=>{const o=11===t.type&&t.content.gifInfo.imgWidth<4e3&&t.content.gifInfo.imgHeight<4e3,n=11!==t.type;return!e||(o||n)});t.forEach(e=>{a(e.id)})},u=()=>{for(const e in t)t[e]=!1,delete t[e];r=[],c=!1};return Object(n["watch"])(()=>e.value,e=>{e&&1!==i["b"].state.sceneInfo.type&&d()}),{renderSingerPart:a,renderHighResolutionGifPart:l,destroyRender:u}}function yp(){const e=e=>{new Ll({id:e.id,key:e.key,fixed:{position:e.position,rotate:e.rotate,visible:!0},content:{path:e.path,size:e.size}},{})},t=()=>{const t=i["b"].state.sceneInfo;t.isHiddenSetting||3===t.type||(t.skyShadeHot&&t.skyShadeHot.path&&e({id:0,key:"sky_0",path:t.skyShadeHot.path,size:t.skyShadeHot.size,position:{x:0,y:-90},rotate:t.skyShadeHot.rotate}),t.groundShadeHot&&t.groundShadeHot.path&&e({id:0,key:"ground_0",path:t.groundShadeHot.path,size:t.groundShadeHot.size,position:{x:0,y:90},rotate:t.groundShadeHot.rotate}))},o=Object(n["computed"])(()=>i["b"].state.lifecycle.isLoadedAnimation&&i["b"].state.lifecycle.isLoadedScene);Object(n["watch"])(()=>o.value,e=>{e&&t()})}function wp(){const e=e=>{var t,o,n,i,s,a;const r={position:zu(e.id,"position"),rotate:zu(e.id,"rotate"),scale:zu(e.id,"scale"),opacity:zu(e.id,"opacity")};return{position:null!==(t=r.position)&&void 0!==t?t:e.position,rotate:null!==(o=r.rotate)&&void 0!==o?o:e.rotate,scale:null!==(n=r.scale)&&void 0!==n?n:e.scale,opacity:null!==(i=r.opacity)&&void 0!==i?i:e.opacity,depth:72*(null!==(s=null===(a=r.position)||void 0===a?void 0:a.z)&&void 0!==s?s:e.radius),zorder:e.zorder}},t=(e,t)=>({loaded(){gl("part_"+e.id,!0),t&&t();const o=9===e.type,n=11===e.type&&(e.content.gifInfo.imgWidth>=4e3||e.content.gifInfo.imgHeight>=4e3),s=1!==i["b"].state.sceneInfo.type&&!(o||n),a=zu(e.id,"visible"),r=null==a?e.isShow:a;!s&&r&&op(e.id),n&&Ju()},show(){lp(e.id),xl("part_"+e.id,!0);const t=zu(e.id,"aniId");t>0&&ap(e.id,t);const o=zu(e.id,"varId");void 0!=o&&o>=0&&Cp(e.id,o)},hide(){dp(e.id),xl("part_"+e.id,!1)},down(){e.isAllowDrag&&up(e.id),i["b"].state.device.mobile&&e.isAllowScale&&ip(e.id)},up(){e.isAllowDrag&&pp(),i["b"].state.device.mobile&&e.isAllowScale&&ip(0)},over(){e.isAllowScale&&ip(e.id)},out(){const t=e.isAllowDrag?!hp():e.isAllowScale;t&&ip(0)}}),o=o=>new xd({id:o.id,key:"stext_"+o.id,fixed:e(o),content:{title:o.content.title,font:{family:o.content.fontFamily,size:o.content.fontSize,color:o.content.fontColor,wordspace:o.content.wordSpace,rowspace:o.content.rowSpace,bolid:o.content.bolid,italic:o.content.italic,underline:o.content.underline,align:o.content.textAlignment},background:{color:o.content.bgcolor,opacity:o.content.bgalpha},effect:o.content.texteffect,size:o.content.showSize}},t(o)),n=o=>{const n={id:o.id,key:"simage_"+o.id,fixed:e(o),content:{path:o.content.imagePath,type:o.content.imageType,size:o.content.showSize}};return 11===o.type&&(n.content.gifInfo=o.content.gifInfo,n.content.loopTime=o.content.loopTime),new Ll(n,t(o))},s=o=>{const n=()=>{const e=i["b"].state.krp.get(`hotspot[${"svideo_"+o.id}]`);Ka({id:o.id,type:"part_video",instance:e,isPauseMedia:o.content.isPauseMedia})},s={id:o.id,key:"svideo_"+o.id,fixed:e(o),isShow:o.isShow,content:{path:o.content.videoPath,poster:o.content.videoPoster,volume:o.content.volume,type:o.content.videoType,startTime:o.content.startTime,autoplay:o.content.autoplay,replay:o.content.replay,size:o.content.showSize,isVa:o.content.vaEnable,vaUid:o.content.vaUid,name:o.content.videoName},tag:2};return 51===o.type&&(s.content.alphaColor=o.content.alphaColor,s.content.threshold=o.content.threshold,s.content.smoothing=o.content.smoothing),new ad(s,{...t(o,n),onplay(e){Ja(o.id,!1),e&&fp(o)},onpause(){Ja(o.id,!0)},oncomplete:()=>{Qa(o.id,"isEnded",!0)}})},a=o=>new cd({id:o.id,key:"simages_"+o.id,fixed:e(o),content:{paths:o.content.imagePaths,type:o.content.imageType,gifInfos:o.content.gifInfos,autoplay:o.content.autoplay,interval:o.content.interval,size:o.content.showSize}},{...t(o),onprev(){fp(o)},onnext(){fp(o)}}),r=o=>new pd({id:o.id,key:"slive_"+o.id,fixed:e(o),content:{liveId:o.content.liveId,path:o.content.livePath,poster:o.content.livePoster,gifInfo:o.content.gifInfo,size:o.content.showSize,control:o.isAllowDrag||o.isAllowScale}},t(o)),c=o=>new Hd({id:o.id,key:"smodel_"+o.id,fixed:e(o),content:{geoPath:o.content.modelPath,mtlPath:o.content.modelMtlPath,scaleSize:o.content.scaleSize,rotateType:o.content.rotationAnimationType,rotateOrigin:o.content.rotateOriginType,autoRotate:o.content.isAutoRotation,animation:o.content.animation,openInModelViewer:o.content.openInModelViewer}},{...t(o),click(){o.content.openInModelViewer&&(fp(o),Ns.emit(Sa,o))}}),l=o=>{const n=o.content.showSize.x,i=o.content.showSize.y,s=Math.min(Math.ceil(n/10),i/1.2),a={id:o.id,key:"snumber_"+o.id,fixed:e(o),content:{path:o.content.imagePath,size:o.content.showSize,gifInfo:o.content.gifInfo,loopTime:o.content.loopTime},textContent:{title:"0",font:{family:o.content.fontFamily,size:s,color:o.content.fontColor,wordspace:o.content.wordSpace,rowspace:o.content.rowSpace,bolid:o.content.bold,italic:o.content.italic,underline:o.content.underline,align:o.content.fontAlign},background:{color:o.content.backgroundColor,opacity:o.content.backgroundAlpha},size:o.content.showSize}};return new Bd(a,t(o))},d=o=>{const n={id:o.id,key:"sforminput_"+o.id,fixed:e(o),content:{size:o.content.inputSize,titlePos:o.content.titlePos,align:o.content.textAlignment,color:o.content.inputColor,borderColor:o.content.inputBorderColor,background:{color:o.content.inputBackgroundColor,opacity:o.content.inputBackgroundOpacity}},textContent:{title:o.content.title,font:{family:o.content.fontFamily,size:o.content.fontSize,color:o.content.fontColor,wordspace:o.content.wordSpace,rowspace:o.content.rowSpace,bolid:o.content.bolid,italic:o.content.italic,underline:o.content.underline,align:o.content.textAlignment}}};return new Fd(n,{...t(o),inputChange:e=>{mp({title:n.textContent.title,value:e,enableStatistics:o.content.enableStatistics})}})},u=o=>new Wd({id:o.id,key:"swebview_"+o.id,fixed:e(o),content:{path:o.content.path,poster:o.content.poster,size:o.content.showSize,control:o.isAllowDrag||o.isAllowScale}},t(o));return{renderText:o,renderImage:n,renderVideo:s,renderImages:a,renderLive:r,renderModel:c,renderNumber:l,renderFormInput:d,renderWebview:u}}function xp(){const e=e=>{const t="part_"+e;gu(t)},t=e=>{const t="part_"+e;yu(t)},o=()=>{i["b"].state.sceneInfo.parts.forEach(t=>{const o=zu(t.id,"visible"),n=null==o?t.isShow:o;n&&e(t.id)})},n=()=>{i["b"].state.sceneInfo.parts.forEach(e=>{t(e.id)})},s={},a=e=>s[e],r=e=>{const t="part_"+e,o=Sl(t);o?l(e):c(e)},c=t=>{const o="part_"+t,n=yl(o);let r=a(t);0===i["b"].state.sceneInfo.type&&(r=!0),n?r&&e(t):(Ku(t),s[t]=!0)},l=e=>{const o="part_"+e,n=yl(o);n?t(e):s[e]=!1};return{showPart:e,hidePart:t,showAllPart:o,hideAllPart:n,checkPartRenderAndToggle:r,checkPartRenderAndShow:c,checkPartRenderAndHide:l}}function Sp(){let e=0;const t={},o={},n=(o,n,i)=>{t[e]||(t[e]=1);let s=o*t[e];if(n){const e=n;s<e&&(s=e)}if(i){const e=i;s>e&&(s=e)}return s},s=t=>{i["b"].state.pageStatus.airpose||(e=t,e?Nu():i["b"].state.sceneInfo.isLockViewAngle||Vu())},a=()=>e>0;return Ns.on("change::wheel",({status:o})=>{if(e){const i=o?1.06:.94,s="part_"+e;t[e]=n(i,.1);const a=cp(e);if(vu(s,"wheel",t[e]),!a){const e=lu(s);mu(s,e.scale)}}}),Ns.on("change::pinch",({scale:n,ended:i,double:s})=>{if(e&&s){const s="part_"+e;o[s]||(o[s]=1),t[e]=o[s]*(n<.1?.1:n);const a=cp(e);if(vu(s,"wheel",t[e]),!a){const e=lu(s);mu(s,e.scale)}i&&(o[s]=t[e])}}),{updatefocuscid:s,checkFocuscidExist:a}}function Ip(){const e=(e,t)=>{const o=i["b"].state.sceneInfo.parts.find(t=>t.id===e);if(!o||!o.animationInfos||!o.animationInfos.length)return null;let n=o.animationInfos[o.animationInfos.length-1];return t&&(n=o.animationInfos.find(e=>e.id===t)),n.initial||(n.initial={translate:{ath:o.position.x,atv:o.position.y,radius:o.radius},rotate:o.rotate,opacity:{value:o.opacity},scale:{value:o.scale},visible:{value:!0}}),n},t=(t,n)=>{const i=e(t,n);if(!i)return;const s=t+"_"+n,a="part_"+t;Qd(s,i,{start(){iu(s,"complete",!1),iu(s,"paused",!1)},translate(e){pu(a,e)},rotate(e){fu(a,e)},scale(e){mu(a,e)},opacity(e){bu(a,e)},visible(e){hu(a,e)},end(){o(t,n)}})},o=(t,o)=>{const n=e(t,o);if(!n)return;const i=t+"_"+o,s=n.isRecover||n.isLoop;s&&ou(i),n.isLoop?eu(i):(iu(i,"complete",!0),iu(i,"paused",!0))},n=(e,o)=>{c(e);const n=e+"_"+o,i=nu(n);i.rendered||t(e,o),ou(n),i.paused&&eu(n)},s=(e,o)=>{const n=e+"_"+o,i=nu(n);i.rendered||t(e,o),i.paused&&eu(n)},a=(e,t)=>{const o=e+"_"+t,n=nu(o);n.rendered&&!n.paused&&tu(o)},r=(e,t)=>{const o=e+"_"+t,n=nu(o);n.rendered&&ou(o)},c=e=>{const t=i["b"].state.sceneInfo.parts.find(t=>t.id===e);t&&t.animationInfos.filter(t=>{a(e,t.id),r(e,t.id)})},l=e=>{const t=su(e);return!!t&&!t.paused},d=e=>{const t=i["b"].state.sceneInfo.parts.find(t=>t.id===e);if(!t||!t.animationInfos||!t.animationInfos.length)return null;const o=t.animationInfos.filter(e=>0===e.trigType),n=o[o.length-1];if(n){let t=e+"_"+n.id;const o=su(e);o&&(t=o.key);let i=!1;if(o&&(i=o.complete),!i){const o=Number(t.split("_").pop());s(e,o)}}},u=e=>{const t=su(e);t&&tu(t.key)};return{replayCmAnimation:n,resetCmAnimation:r,getCmAnimationPlayingStatus:l,checkShowAndStartAnimation:d,checkHideAndStopAnimation:u}}function kp(){const e={press:!1,timer:0,dis:{startx:0,starty:0,movex:0,movey:0},end:{x:0,y:0,z:0}};let t="",o=!0;const n={x:window.innerWidth,y:window.innerHeight},s=t=>{const o=cp(t);return e.press||e.timer||o||i["b"].state.pageStatus.airpose},a=n=>{if(i["b"].state.pageStatus.airpose)return;if(!o||s(n))return;Nu();const a="part_"+n;t=a;const c=lu(a);e.press=!0,e.end.x=c.position.x,e.end.y=c.position.y;const l=i["b"].state.krp.spheretoscreen(e.end.x,e.end.y),d=i["b"].state.krp.get("mouse");e.dis.startx=d.stagex-l.x,e.dis.starty=d.stagey-l.y,r()},r=()=>{if(i["b"].state.touch.doubleFinger)return void c();const o=i["b"].state.krp.get("mouse"),s=Math.max(0,Math.min(o.stagex,n.x)),a=Math.max(0,Math.min(o.stagey,n.y));e.dis.movex=s-e.dis.startx,e.dis.movey=a-e.dis.starty;const l=i["b"].state.krp.screentosphere(e.dis.movex,e.dis.movey);t&&pu(t,l),e.end=l,e.timer=requestAnimationFrame(r)},c=()=>{i["b"].state.pageStatus.airpose||(cancelAnimationFrame(e.timer),e.timer=0,e.press=!1,sp()||i["b"].state.sceneInfo.isLockViewAngle||Vu())},l=e=>{o=e},d=()=>e.press;return{dragstart:a,dragend:c,updateDragAuth:l,getDragPressStatus:d}}function Op(){Object(n["watch"])(()=>wl.value,e=>{e&&1!==i["b"].state.sceneInfo.type&&(ep(),Ju())})}function jp(){const e=e=>{bc.emit("action",{key:"part",data:{id:e.id,type:e.type,statisticsProperity:e.statisticsProperity}})},t=e=>{e.enableStatistics&&bc.emit("action",{key:"formInput",data:{label:e.title,value:e.value,enableStatistics:e.enableStatistics}})};return{reportPartData:e,reportPartInputData:t}}function Cp(e,t){if(void 0==t||t<0)return;const o=i["b"].state.sceneInfo.parts.find(t=>t.id===e);if(o){const o="part_"+e,n=cu(o).instances;if(n&&n[0]){const e=t>=0?Iu(t):null;let o=(null===e||void 0===e?void 0:e.value)||0;"boolean"===typeof o&&(o=Number(o)),n[0].updateValue(Number(o.toFixed(2)))}}}function Ep(){const e=e=>{if(1!==i["b"].state.sceneInfo.type)return!0;const t=i["b"].state.sceneInfo.parts.find(t=>t.id===e);if(t){const e=t.startTime/1e3,o=t.endTime/1e3;return i["b"].state.scenevideo.time>=e&&i["b"].state.scenevideo.time<=o}return!1};Ns.on(Gs,({id:t,status:o})=>{o&&!e(t)||(o?op(t):np(t))}),Ns.on(Xs,({partId:t,parentId:o,aniId:n,pointIndex:s,status:a})=>{if(!e(t))return;const r=yl("part_"+t),c=Sl("part_"+t);[0,1,2,3].indexOf(s)<0&&(s=n>0?1:0);const l=1===s&&!c,d=0===s&&!r,u=2===s&&!r,p=3===s&&!r,h=i["b"].state.preSetCmIds.indexOf(t)>=0;h&&(l||d||u||p)?Du({cid:t,ctype:2,aniId:n,pointIndex:s,parentId:o,status:a}):(1===s&&n>0&&c&&(-1===a?rp(t,n):ap(t,n)),0===s&&t>0&&r&&(3===a?tp(t):1===a?op(t):np(t)),2===s&&t>0&&r&&-1!==a&&Au(t,2),3===s&&t>0&&r&&-1!==a&&Cp(t,o))})}function Tp(){Ns.on(Rs,()=>{Qu()})}Tp();class Pp extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.stitle=null,this.options=e||{},this.dragInfo={key:"trigger_"+this.options.id,press:!1,timer:0,dis:{startx:0,starty:0,movex:0,movey:0},end:{x:0,y:0,z:0}},this.enableCheck=!0,this.initModelComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),click:this.onclick.bind(this)}),this.screen={x:window.innerWidth,y:window.innerHeight}}initModelComponent(){this.el=new Ad({key:this.options.key,fixed:this.options.fixed,other:this.options.other,content:this.options.content,events:Pl.bind(this)({loaded:e=>{e.boxSize&&this.initTitleComponent(e.boxSize)},click:()=>{this.triHandle(0,0)},over:()=>{i["b"].state.device.mobile||this.triHandle(0,2)},down:()=>{1===this.options.type&&this.dragstart()},up:()=>{1===this.options.type&&this.dragend()}})}),super.push(this.el)}initTitleComponent(e){if(!this.options.titleContent)return;const t=-1*(e.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),o=zo(this.options.fixed,{offset:{x:0,y:t},edge:"bottom"});this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:o,content:this.options.titleContent,events:Pl.bind(this)()}),super.push(this.stitle)}triHandle(e,t){let o=this.options.content.triggerMode===t;i["b"].state.device.mobile&&2===this.options.content.triggerMode&&(o=!0),this.options.type===e&&o&&this.clickAction()}dragstart(){if(this.dragInfo.press||!this.enableCheck||i["b"].state.pageStatus.airpose)return;Nu(),this.dragInfo.press=!0,this.dragInfo.end.x=this.getFixedData.position.x,this.dragInfo.end.y=this.getFixedData.position.y;const e=i["b"].state.krp.spheretoscreen(this.dragInfo.end.x,this.dragInfo.end.y),t=i["b"].state.krp.get("mouse");this.dragInfo.dis.startx=t.stagex-e.x,this.dragInfo.dis.starty=t.stagey-e.y,this.dragmove()}dragmove(){if(i["b"].state.touch.doubleFinger)return void this.dragend();const e=i["b"].state.krp.get("mouse"),t=Math.max(0,Math.min(e.stagex,this.screen.x)),o=Math.max(0,Math.min(e.stagey,this.screen.y));this.dragInfo.dis.movex=t-this.dragInfo.dis.startx,this.dragInfo.dis.movey=o-this.dragInfo.dis.starty;const n=i["b"].state.krp.screentosphere(this.dragInfo.dis.movex,this.dragInfo.dis.movey);this.dragInfo.key&&pu(this.dragInfo.key,n),this.dragInfo.end=n,this.dragInfo.timer=requestAnimationFrame(this.dragmove.bind(this))}dragend(){i["b"].state.pageStatus.airpose||(cancelAnimationFrame(this.dragInfo.timer),this.dragInfo.timer=0,this.dragInfo.press=!1,Vu(),this.enableCheck&&this.checkApproachArea())}checkApproachArea(){const e={x:this.dragInfo.end.x,y:this.dragInfo.end.y},t=this.options.content.activearea;zn(e,t.vecPos)?(this.clickAction(),this.enableCheck=!1):t.isReturn&&this.dragInfo.key&&pu(this.dragInfo.key,{x:this.options.fixed.position.x,y:this.options.fixed.position.y,z:0})}updateEnableDrag(e){this.enableCheck=e}clickAction(){this.events.trigger&&this.events.trigger({type:0,gear:0})}updateDragendPos(e){e?(this.dragInfo.end.x=e.x,this.dragInfo.end.y=e.y):(this.dragInfo.end.x=this.getFixedData.position.x,this.dragInfo.end.y=this.getFixedData.position.y)}updateHoverScale(e){if(!this.el)return;this.el.multiplyscale("hover",e);const t=this.getFixedData;this.el.updateScale(t.scale)}onshow(){this.autoRotate()}onclick(){const{content:e}=this.options;e.allowModelViewer&&Ns.emit(Sa,{type:9,content:{animation:{loop:!0,reverse:!1,speed:1,type:0},modelPath:e.geoPath,modelMtlPath:e.mtlPath,showSize:e.size,isAutoRotation:e.autoRotate,isTriggerIcon:!0}})}autoRotate(){if(!this.options.content.autoRotate)return;let e=.01;this.options.content.rotateType||(e*=-1),i["b"].state.modelplugin.arotatey(this.options.key,e)}autoAction(){if(0===this.options.type)this.clickAction();else if(1===this.options.type){const e=this.options.content.activearea.position;pu(this.options.key,e),this.updateDragendPos(e),this.checkApproachArea()}}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var _p=Pp;class Ap extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.stitle=null,this.options=e||{},this.dragInfo={key:this.options.key,press:!1,timer:0,dis:{startx:0,starty:0,movex:0,movey:0},end:{x:0,y:0,z:0}},this.enableCheck=!0,this.initIconComponent(),this.initTitleComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)}),this.screen={x:window.innerWidth,y:window.innerHeight}}initIconComponent(){this.el=new Hl({key:this.options.key,fixed:this.options.fixed,expand:this.options.expand,other:this.options.other,content:this.options.content,events:Pl.bind(this)({click:()=>{this.triHandle(0,0)},over:()=>{i["b"].state.device.mobile||this.triHandle(0,2)},down:()=>{1===this.options.type&&this.dragstart()},up:()=>{1===this.options.type&&this.dragend()}})}),super.push(this.el)}triHandle(e,t){let o=this.options.content.triggerMode===t;i["b"].state.device.mobile&&2===this.options.content.triggerMode&&(o=!0),this.options.type===e&&o&&this.clickAction()}initTitleComponent(){if(!this.options.titleContent)return;const e=-1*(this.options.content.size.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),t=zo(this.options.fixed,{offset:{x:0,y:e},edge:"bottom"});this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:t,content:this.options.titleContent,events:Pl.bind(this)()}),super.push(this.stitle)}dragstart(){if(this.dragInfo.press||!this.enableCheck||i["b"].state.pageStatus.airpose)return;Nu(),this.dragInfo.press=!0,this.dragInfo.end.x=this.getFixedData.position.x,this.dragInfo.end.y=this.getFixedData.position.y;const e=i["b"].state.krp.spheretoscreen(this.dragInfo.end.x,this.dragInfo.end.y),t=i["b"].state.krp.get("mouse");this.dragInfo.dis.startx=t.stagex-e.x,this.dragInfo.dis.starty=t.stagey-e.y,this.dragmove()}dragmove(){if(i["b"].state.touch.doubleFinger)return void this.dragend();const e=i["b"].state.krp.get("mouse"),t=Math.max(0,Math.min(e.stagex,this.screen.x)),o=Math.max(0,Math.min(e.stagey,this.screen.y));this.dragInfo.dis.movex=t-this.dragInfo.dis.startx,this.dragInfo.dis.movey=o-this.dragInfo.dis.starty;const n=i["b"].state.krp.screentosphere(this.dragInfo.dis.movex,this.dragInfo.dis.movey);this.dragInfo.key&&pu(this.dragInfo.key,n),this.dragInfo.end=n,this.dragInfo.timer=requestAnimationFrame(this.dragmove.bind(this))}dragend(){i["b"].state.pageStatus.airpose||(cancelAnimationFrame(this.dragInfo.timer),this.dragInfo.timer=0,this.dragInfo.press=!1,Vu(),this.enableCheck&&this.checkApproachArea())}checkApproachArea(){const e={x:this.dragInfo.end.x,y:this.dragInfo.end.y},t=this.options.content.activearea;zn(e,t.vecPos)?(this.clickAction(),this.enableCheck=!1):t.isReturn&&this.dragInfo.key&&pu(this.dragInfo.key,{x:this.options.fixed.position.x,y:this.options.fixed.position.y,z:0})}updateEnableDrag(e){this.enableCheck=e}clickAction(){this.events.trigger&&this.events.trigger({type:0,gear:0})}updateDragendPos(e){e?(this.dragInfo.end.x=e.x,this.dragInfo.end.y=e.y):(this.dragInfo.end.x=this.getFixedData.position.x,this.dragInfo.end.y=this.getFixedData.position.y)}updateTexture(e,t){this.el&&(this.el.updateGifInfo(t),t&&t.imgPath?this.el.updateTexture(t.imgPath):e&&this.el.updateTexture(e))}updateHoverScale(e){if(!this.el)return;this.el.multiplyscale("hover",e);const t=this.getFixedData;this.el.updateScale(t.scale)}onshow(){this.el&&this.el.startCropAnimation()}onhide(){this.el&&this.el.stopCropAnimation()}autoAction(){if(0===this.options.type)this.clickAction();else if(1===this.options.type){const e=this.options.content.activearea.position;pu(this.dragInfo.key,e),this.updateDragendPos(e),this.checkApproachArea()}}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Mp=Ap;function Hp(e){let t=Math.floor(e),o=0,n=0,i=0;t>=3600?(o=Math.floor(t/3600),t-=3600*o,n=Math.floor(t/60),i=Math.floor(t%60)):t<3600&&t>=60?(n=Math.floor(t/60),i=Math.floor(t%60)):i=Math.floor(t%60);let s="";return s+=o?o.toString().padStart(2,"0")+":":"00:",s+=n.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0"),s}class zp extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.timeEl=null,this.stitle=null,this.options=e||{},this.timeInfo={timer:0,seconds:e.timeContent.time||0,currentCount:0},this.isCountDown=e.timeContent.isCountDown,this.initIconComponent(),this.initTitleComponent(),this.initTimeComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initIconComponent(){this.el=new Hl({key:this.options.key,fixed:this.options.fixed,expand:this.options.expand,other:this.options.other,content:this.options.content,events:Pl.bind(this)()}),super.push(this.el)}initTitleComponent(){if(!this.options.titleContent)return;const e=-1*(this.options.content.size.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),t=zo(this.options.fixed,{offset:{x:0,y:e},edge:"bottom"});this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:t,content:this.options.titleContent,events:Pl.bind(this)()}),super.push(this.stitle)}initTimeComponent(){if(!this.options.timeContent.show)return;const e=()=>{let e="",t=0,o=0;switch(this.options.timeContent.direction){case 0:e="bottom",o=this.options.content.size.y/2*-1-10;break;case 1:default:e="top",o=this.options.content.size.y/2+10;break;case 2:e="right",t=this.options.content.size.x/2*-1-10;break;case 3:e="left",t=this.options.content.size.x/2+10;break;case 4:e="center";break}return{ox:t,oy:o,edge:e}},t=e(),o=zo(this.options.fixed,{offset:{x:t.ox,y:t.oy},edge:t.edge});this.timeEl=new Ld({key:"stime_"+this.options.id,fixed:o,content:{title:Hp(this.options.timeContent.timerTitle),font:this.options.timeContent.font,background:{opacity:0}},events:Pl.bind(this)()}),super.push(this.timeEl)}onshow(){this.el&&this.el.startCropAnimation(),this.options.content.isRelationOther||this.startTimeLine()}onhide(){this.el&&(this.el.stopCropAnimation(),this.resetTimeLine())}startTimeLine(){if(!this.timeInfo.seconds)return;window.clearInterval(this.timeInfo.timer);let e="";this.timeInfo.timer=window.setInterval(()=>{var t;this.isCountDown?(this.timeInfo.seconds--,this.timeInfo.seconds<=0?(this.endTimeLine(),e=Hp(0)):e=Hp(this.timeInfo.seconds)):(this.timeInfo.currentCount++,this.timeInfo.currentCount>=this.timeInfo.seconds?(this.endTimeLine(),e=Hp(this.timeInfo.seconds)):e=Hp(this.timeInfo.currentCount)),null===(t=this.timeEl)||void 0===t||t.updateText(e)},1e3)}stopTimeLine(){window.clearInterval(this.timeInfo.timer)}resetTimeLine(){this.stopTimeLine(),this.timeEl&&(this.isCountDown?(this.timeInfo.seconds=this.options.timeContent.time,this.timeEl.updateText(Hp(this.timeInfo.seconds))):(this.timeInfo.currentCount=0,this.timeEl.updateText(Hp(0))))}endTimeLine(){window.clearInterval(this.timeInfo.timer),this.events.trigger&&this.events.trigger({type:0,gear:0})}autoAction(){this.resetTimeLine(),this.startTimeLine()}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.timeEl&&(this.timeEl.destroy(),this.timeEl=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Lp=zp;class Dp extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.stitle=null,this.options=e||{},this.initIconComponent(),this.initTitleComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initIconComponent(){this.el=new Hl({key:this.options.key,fixed:this.options.fixed,other:this.options.other,content:{path:this.options.content.close.path,gifInfo:this.options.content.close.gifInfo,size:this.options.content.size},events:Pl.bind(this)({click:this.toggleStatus.bind(this)})}),super.push(this.el)}initTitleComponent(){if(!this.options.titleContent)return;const e=-1*(this.options.content.size.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),t=zo(this.options.fixed,{offset:{x:0,y:e},edge:"bottom"});this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:t,content:this.options.titleContent,events:Pl.bind(this)()}),super.push(this.stitle)}onshow(){this.el&&this.el.startCropAnimation()}onhide(){this.el&&this.el.stopCropAnimation()}updateTexture(){const e=this.options.content.status?"open":"close",t=this.options.content[e].gifInfo,o=this.options.content[e].path;this.el&&(this.el.updateGifInfo(t),this.el.updateTexture(t.imgPath||o))}clickAction(){this.events.trigger&&this.events.trigger({type:this.options.content.status?1:-1,gear:0})}toggleStatus(){this.el&&(this.options.content.status=!this.options.content.status,this.updateTexture(),this.clickAction())}autoAction(e){this.options.content.status=1===e||-1!==e&&!this.options.content.status,this.options.content.status&&this.updateTexture(),this.clickAction()}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Bp=Dp;class Np extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.cycle=null,this.stitle=null,this.options=e||{},this.disInfo={timer:0,minox:0,maxox:0,prevox:0,ox:0,lock:!0,unit:1/e.content.maxValue,gear:0},this.initCycleComponent(),this.initHandleComponent(),this.initTitleComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initHandleComponent(){const e=this.options.content.cycle.size,t=this.options.content.handle.size,o=-1*(e.x-t.x)/2,n=zo(this.options.fixed,{offset:{x:o,y:0}});this.disInfo.minox=o,this.disInfo.maxox=-1*o,this.disInfo.prevox=o,this.el=new Hl({key:this.options.key,fixed:n,other:this.options.other,content:{path:this.options.content.handle.path,gifInfo:this.options.content.handle.gifInfo,size:this.options.content.handle.size},events:Pl.bind(this)({down:this.handledown.bind(this),up:this.handleup.bind(this)})}),super.push(this.el)}initCycleComponent(){this.cycle=new Hl({key:"sbg_"+this.options.id,fixed:this.options.fixed,other:this.options.other,content:{path:this.options.content.cycle.path,gifInfo:this.options.content.cycle.gifInfo,size:this.options.content.cycle.size},events:Pl.bind(this)()}),super.push(this.cycle)}initTitleComponent(){if(!this.options.titleContent)return;const e=-1*(this.options.content.cycle.size.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),t=zo(this.options.fixed,{offset:{x:0,y:e},edge:"bottom"});this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:t,content:this.options.titleContent,events:Pl.bind(this)()}),super.push(this.stitle)}onshow(){this.el&&this.el.startCropAnimation(),this.cycle&&this.cycle.startCropAnimation()}onhide(){this.el&&this.el.stopCropAnimation(),this.cycle&&this.cycle.stopCropAnimation()}handledown(){Nu();const e=i["b"].state.krp.get("mouse.x"),t=()=>{const o=i["b"].state.krp.get("mouse.x"),n=this.disInfo.prevox+(o-e)/(this.getFixedData.scale*sn.value);if(this.disInfo.ox=Rn(n,this.disInfo.minox,this.disInfo.maxox),this.el&&this.el.updateOffset(this.disInfo.ox),!this.disInfo.lock){const e=(this.disInfo.ox-this.disInfo.minox)/(2*this.disInfo.maxox),t=this.disInfo.gear*this.disInfo.unit-.05,o=this.disInfo.gear*this.disInfo.unit+.05;(e<t||e>o)&&(this.disInfo.lock=!0)}this.disInfo.timer=requestAnimationFrame(t)};t()}handleup(){Vu(),cancelAnimationFrame(this.disInfo.timer),this.disInfo.prevox=this.disInfo.ox;const e=(this.disInfo.prevox-this.disInfo.minox)/(2*this.disInfo.maxox);this.disInfo.gear=Math.round(e/this.disInfo.unit);const t=Math.abs(this.disInfo.gear*this.disInfo.unit-e);if(t<=.05&&this.disInfo.gear>=0&&this.disInfo.gear<=1/this.disInfo.unit){const e=this.disInfo.minox+this.disInfo.gear*this.disInfo.unit*(2*this.disInfo.maxox);this.el&&this.el.updateOffset(e),this.disInfo.prevox=e,this.disInfo.lock&&(this.disInfo.lock=!1,this.events.trigger&&this.events.trigger({type:0,gear:this.disInfo.gear}))}}autoAction(e){this.disInfo.gear=e,this.disInfo.ox=this.disInfo.minox+e/this.options.content.maxValue*(2*this.disInfo.maxox),this.disInfo.prevox=this.disInfo.ox,this.el&&this.el.updateOffset(this.disInfo.ox),this.disInfo.lock=!1,this.events.trigger&&this.events.trigger({type:0,gear:this.disInfo.gear})}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.cycle&&(this.cycle.destroy(),this.cycle=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Vp=Np;class Rp extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.cycle=null,this.stitle=null,this.options=e||{},this.disInfo={prevAngle:0,angle:0,timer:0,gear:0,unit:360/(this.options.content.maxValue+1),lock:!0},this.initCycleComponent(),this.initHandleComponent(),this.initTitleComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initHandleComponent(){this.el=new Hl({key:this.options.key,fixed:this.options.fixed,other:this.options.other,content:{path:this.options.content.handle.path,gifInfo:this.options.content.handle.gifInfo,size:this.options.content.handle.size},events:Pl.bind(this)({down:this.handledown.bind(this),up:this.handleup.bind(this)})}),super.push(this.el)}initCycleComponent(){this.cycle=new Hl({key:"sbg_"+this.options.id,fixed:this.options.fixed,other:this.options.other,content:{path:this.options.content.cycle.path,gifInfo:this.options.content.cycle.gifInfo,size:this.options.content.cycle.size},events:Pl.bind(this)()}),super.push(this.cycle)}initTitleComponent(){if(!this.options.titleContent)return;const e=-1*(this.options.content.cycle.size.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),t=zo(this.options.fixed,{offset:{x:0,y:e},edge:"bottom"});this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:t,content:this.options.titleContent,events:Pl.bind(this)()}),super.push(this.stitle)}onshow(){this.el&&this.el.startCropAnimation(),this.cycle&&this.cycle.startCropAnimation()}onhide(){this.el&&this.el.stopCropAnimation(),this.cycle&&this.cycle.stopCropAnimation()}handledown(){Nu();const e=i["b"].state.krp.get("mouse"),t={x:e.x,y:e.y},o=i["b"].state.krp.spheretoscreen(this.options.fixed.position.x,this.options.fixed.position.y),n={x:Math.round(o.x),y:Math.round(o.y)},s=Un(t,n),a=()=>{const t={x:e.x,y:e.y},o=Un(t,n);let i=(this.disInfo.prevAngle+(o-s))%360;if(i<0&&(i+=360),this.disInfo.angle=i,this.el&&this.el.updateSelfRotate(0,0,i),!this.disInfo.lock){const e=Math.floor(i/this.disInfo.unit);e>=0&&e!==this.disInfo.gear&&(this.disInfo.lock=!0)}this.disInfo.timer=requestAnimationFrame(a)};a()}handleup(){Vu(),cancelAnimationFrame(this.disInfo.timer),this.disInfo.gear=Math.floor(this.disInfo.angle/this.disInfo.unit);const e=this.disInfo.gear*this.disInfo.unit;this.disInfo.prevAngle=e,this.el&&this.el.updateSelfRotate(0,0,e),this.disInfo.gear>=0&&this.disInfo.gear<=this.options.content.maxValue&&this.disInfo.lock&&(this.disInfo.lock=!1,this.events.trigger&&this.events.trigger({type:0,gear:this.disInfo.gear}))}autoAction(e){this.disInfo.gear=e,this.disInfo.angle=e/(this.options.content.maxValue+1)*360,this.disInfo.prevAngle=this.disInfo.angle,this.el&&this.el.updateSelfRotate(0,0,this.disInfo.angle),this.disInfo.lock=!1,this.events.trigger&&this.events.trigger({type:0,gear:this.disInfo.gear})}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.cycle&&(this.cycle.destroy(),this.cycle=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Fp=Rp;class Gp extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.inputEl=null,this.inputValue=e.content.title,this.options=e||{},this.initTitleComponent(),this.initInputComponent(),this.initKeyboardComponent(),this.cid=e.id,this.events=Al(t)}initTitleComponent(){if(!this.options.titleContent)return;const e=zo(this.options.fixed,{offset:{x:0,y:0},edge:"bottom"}),t=new Ld({key:"stitle_"+this.options.id,fixed:e,content:this.options.titleContent,events:Pl.bind(this)()});super.push(t)}initInputComponent(){this.inputEl=new yd({key:this.options.key,fixed:zo(this.options.fixed,{offset:{x:0,y:34}}),content:this.options.content,exclose:!1,events:Pl.bind(this)({click:()=>{this.updateKeyboardVisible(!0)}})}),super.push(this.inputEl)}initKeyboardComponent(){this.initBoard(),this.initKey()}initBoard(){const e={title:"",font:{family:"Youyuan",size:14,color:{x:0,y:0,z:0,w:0},wordspace:0,rowspace:0,bolid:0,italic:0,underline:0,align:"center"},background:{color:{x:238,y:238,z:238,w:255},opacity:1,round:10},size:{x:182,y:168},isTrigger:!0},t=new yd({key:"trigger_board"+this.options.id,fixed:zo(this.options.fixed,{offset:{x:0,y:152},visible:!1}),content:e,exclose:!1,events:Pl.bind(this)()});super.push(t)}initKey(){const e=[{key:`trigger_input_${this.options.id}_1`,offset:{x:-58,y:92},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_1.png",code:"1"},{key:`trigger_input_${this.options.id}_2`,offset:{x:0,y:92},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_2.png",code:"2"},{key:`trigger_input_${this.options.id}_3`,offset:{x:58,y:92},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_3.png",code:"3"},{key:`trigger_input_${this.options.id}_4`,offset:{x:-58,y:132},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_4.png",code:"4"},{key:`trigger_input_${this.options.id}_5`,offset:{x:0,y:132},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_5.png",code:"5"},{key:`trigger_input_${this.options.id}_6`,offset:{x:58,y:132},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_6.png",code:"6"},{key:`trigger_input_${this.options.id}_7`,offset:{x:-58,y:172},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_7.png",code:"7"},{key:`trigger_input_${this.options.id}_8`,offset:{x:0,y:172},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_8.png",code:"8"},{key:`trigger_input_${this.options.id}_9`,offset:{x:58,y:172},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_9.png",code:"9"},{key:`trigger_input_${this.options.id}_del`,offset:{x:-58,y:212},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_del.png",code:"del"},{key:`trigger_input_${this.options.id}_0`,offset:{x:-14,y:212},size:{x:20,y:32},path:"%$prevPath%/skin/Input/num_0.png",code:"0"},{key:`trigger_input_${this.options.id}_point`,offset:{x:14,y:212},size:{x:20,y:32},path:"%$prevPath%/skin/Input/num_point.png",code:"."},{key:`trigger_input_${this.options.id}_enter`,offset:{x:58,y:212},size:{x:50,y:32},path:"%$prevPath%/skin/Input/num_enter.png",code:"enter"}],t=e=>{(this.inputValue||e)&&("."===e&&this.inputValue.indexOf(".")>0||this.inputValue.length>=7&&["del","enter"].indexOf(e)<0||("enter"===e?(this.inputValue&&this.clickAction(Number(this.inputValue)),this.updateKeyboardVisible(!1)):"del"===e?this.inputValue=this.inputValue.slice(0,this.inputValue.length-1):this.inputValue+=e,this.updateInputNum()))};e.forEach(e=>{const o=new Hl({key:e.key,fixed:zo(this.options.fixed,{offset:{x:e.offset.x,y:e.offset.y}}),content:{path:e.path,size:e.size},exclose:!1,events:Pl.bind(this)({click:()=>t(e.code)})});super.push(o)})}updateInputNum(){this.inputEl&&this.inputEl.updateText(this.inputValue)}updateKeyboardVisible(e){this.childrens.forEach(t=>{t.key!=="stitle_"+this.options.id&&t.key!=="trigger_"+this.options.id&&t.updateVisible(e)})}getShowCmKeys(){const e=[this.options.key];return this.options.titleContent&&e.push("stitle_"+this.options.id),this.options.exclose&&e.push("sclose_"+this.cid),e}show(){super.show(this.getShowCmKeys())}clickAction(e){this.events.trigger&&this.events.trigger({type:0,gear:0,value:e})}destroy(){super.destroy(),this.inputEl&&(this.inputEl.destroy(),this.inputEl=null)}}var Wp=Gp;const $p=(e,t)=>{t.move.enablePath&&e.updateTexture&&e.updateTexture(t.move.path,t.move.gifInfo),t.move.enableScale&&e.updateHoverScale(t.move.scale),t.move.enableAudio&&Ns.emit(xa,{path:t.move.audio,status:!0,mode:1})},Up=(e,t)=>{t.move.enablePath&&e.updateTexture&&e.updateTexture(t.initial.path,t.initial.gifInfo),t.move.enableScale&&e.updateHoverScale(1),t.move.enableAudio&&Ns.emit(xa,{path:t.move.audio,status:!1,mode:1})},Xp=(e,t)=>{t.down.enablePath&&e.updateTexture&&e.updateTexture(t.down.path,t.down.gifInfo),t.down.enableScale&&e.updateHoverScale(t.down.scale),t.down.enableAudio&&Ns.emit(xa,{path:t.down.audio,status:!0,mode:2})},Yp=(e,t)=>{t.down.enablePath&&e.updateTexture&&e.updateTexture(t.initial.path,t.initial.gifInfo),t.down.enableScale&&e.updateHoverScale(1)},Zp=new Map,qp=(e,t)=>{Zp.set(e,t)},Kp=e=>Zp.get(e),Jp=()=>{Zp.clear()},Qp=e=>{let t=0,o=null;const n=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);n&&(t=1,o=n);const s=i["b"].state.sceneInfo.parts.find(t=>t.id===e);s&&(t=2,o=s);const a=i["b"].state.sceneInfo.conditioners.find(t=>t.id===e);a&&(t=3,o=a);const r=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);r&&(t=4,o=r);const c=i["b"].state.sceneInfo.randomItems.find(t=>t.instanceId===e);c&&(t=5,o=c);const l=i["b"].state.sceneInfo.operationItems.find(t=>t.itemId===e);l&&(t=6,o=l);const d=i["b"].state.sceneInfo.logicItems.find(t=>t.itemId===e);d&&(t=7,o=d);const u=i["b"].state.sceneInfo.variItems.find(t=>t.instanceId===e);u&&(t=8,o=u);const p=i["b"].state.sceneInfo.propertyControl.find(t=>t.id===e);p&&(t=9,o=p);const h=i["b"].state.skyBoxSceneGroup.globalParts.find(t=>t.id===e);h&&(t=10,o=h);const f=i["b"].state.sceneInfo.initItems.id===e;return f&&(t=11,o=i["b"].state.sceneInfo.initItems),{type:t,instance:o}},eh=(e,t)=>{var o;const n={tId:e.targetId,pId:e.parentId,aniId:e.animationId,pointIndex:e.targetPoint,type:e._directiveType,tGear:e.triggerTarget,status:null!==(o=e.parentFrameStatus)&&void 0!==o?o:t};return n},th=(e,t)=>{const o="trigger"===e?3:"show"===e?1:-1,n=eh(t,o);if(!([1,2,4,9,10].indexOf(t._directiveType)>=0)||n.tId)switch(t._directiveType){case 1:Ns.emit(Us,{hotspotId:n.tId,aniId:n.aniId,pointIndex:n.pointIndex,status:n.status});break;case 2:Ns.emit(Xs,{partId:n.tId,parentId:n.pId,aniId:n.aniId,pointIndex:n.pointIndex,status:n.status});break;case 3:Ns.emit(Zs,{condId:t.targetId,triggerId:t.parentId,status:o});break;case 4:Ns.emit(Ys,{triggerId:n.tId,aniId:n.aniId,gearTarget:n.tGear,pointIndex:n.pointIndex,status:n.status});break;case 5:Ns.emit(za,{randId:t.targetId,status:o});break;case 6:Ns.emit(Ma,{operId:t.targetId,value:t.parentResult,type:t.parentType,status:o});break;case 7:Ns.emit(Ha,{logicId:t.targetId,value:t.parentResult,type:t.parentType,status:o});break;case 8:Ns.emit(La,{varId:t.targetId,value:t.parentResult,type:t.parentType,status:o});break;case 9:Ns.emit(Da,{sitemId:n.tId,status:n.status});break;case 10:Ns.emit(Fa,{partId:n.tId,parentId:n.pId,pointIndex:n.pointIndex,status:n.status});break;case 11:Ns.emit(Xa);break;default:break}};function oh(){let e=[];const t={gear:0,singleGear:!1,mode:"trigger"},o=o=>{o.forEach(o=>{o.parentTriParams={...t},e.push(o)});while(e.length){const o=e.shift()||{},l=Qp(o.targetId);if(o._directiveType=l.type,o.parentTriParams||(o.parentTriParams={...t}),o.triggerValue===o.parentTriParams.gear){var n,i;const t=o.parentTriParams.singleGear?"show":o.parentTriParams.mode;th(t,o);const d=7!==o._directiveType||Kp(o.targetId),u=(null===(n=l.instance)||void 0===n?void 0:n.lines)||[];var s,a,r,c;if(3===l.type&&null!==(i=l.instance)&&void 0!==i&&i.parentResult)e.push({targetId:null===(s=l.instance)||void 0===s?void 0:s.nextSceneId,parentId:o.targetId,animationId:null===(a=l.instance)||void 0===a?void 0:a.animationId,targetPoint:null===(r=l.instance)||void 0===r?void 0:r.targetPoint,triggerTarget:(null===(c=l.instance)||void 0===c?void 0:c.gear)||0,triggerValue:o.triggerValue||0});else if(u.length&&11!==l.type){const t=u.filter(e=>{const t=Qp(e.targetId);return 8===(null===t||void 0===t?void 0:t.type)||d});e=e.concat(t),e.map(e=>{e.triggerValue=o.triggerValue||0})}}else o.parentTriParams.singleGear&&(window.console.log("非档位触发",o),th("hide",o))}},n=({mode:e,gear:n,signalGear:i,relations:s})=>{t.mode=e,t.gear=n,t.singleGear=i,o(s),Ns.emit(Js)};return Ns.on(Rs,()=>{e=[],Jp()}),{onActionRelations:n}}const{onActionRelations:nh}=oh(),{isReadyComplete:ih}=Eh(),{renderNormalIcon:sh,renderAreaIcon:ah,renderTimeIcon:rh,renderOnOffIcon:ch,renderSliderIcon:lh,renderDailIcon:dh,renderInputIcon:uh}=Ph(),{renderSingerTrigger:ph,destroyRender:hh}=Th(ih),{showAllTrigger:fh,checkTriggerRenderAndShow:mh,checkTriggerRenderAndHide:vh}=_h(),{replayTriggerAnimation:bh,resetTriggerAnimation:gh,checkShowAndStartAnimation:yh,checkHideAndStopAnimation:wh}=Ah(),{initTriggerAction:xh}=Hh(),{onTriggerHandle:Sh,checkTriggerShowAndAction:Ih,checkActiveAreaTrigger:kh,toggleDragAuth:Oh}=Mh(),{reportTrigger:jh}=Nh();function Ch(){Lh()}function Eh(){const e=Object(n["ref"])(!1),t=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});return Object(n["watch"])(()=>t.value,t=>{e.value=t}),{isReadyComplete:e}}function Th(e){const t={},o=e=>{const t="trigger_"+e.id,o=1!==i["b"].state.sceneInfo.type&&!e.iconData.isModelIcon;bl(e.id,t,o);const n=s(e);du(t,[n])},s=e=>{let t=null;switch(e.type){case 0:t=sh(e);break;case 1:t=ah(e);break;case 2:t=rh(e);break;case 3:t=ch(e);break;case 4:t=lh(e);break;case 5:t=dh(e);break;case 6:t=uh(e);break;default:break}return t},a=e=>{if(t[e])return;const n=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);n&&(t[e]=!0,o(n))},r=()=>{i["b"].state.sceneInfo.triggers.forEach(e=>{o(e)})},c=()=>{for(const e in t)t[e]=!1,delete t[e]};return Object(n["watch"])(()=>e.value,e=>{e&&1!==i["b"].state.sceneInfo.type&&r()}),{renderSingerTrigger:a,destroyRender:c}}function Ph(){const e=e=>{var t,o,n,i,s,a;const r={position:zu(e.id,"position"),rotate:zu(e.id,"rotate"),scale:zu(e.id,"scale"),opacity:zu(e.id,"opacity")};return{position:null!==(t=r.position)&&void 0!==t?t:e.position,rotate:null!==(o=r.rotate)&&void 0!==o?o:e.rotate,scale:null!==(n=r.scale)&&void 0!==n?n:e.scale,opacity:null!==(i=r.opacity)&&void 0!==i?i:e.opacity,depth:72*(null!==(s=null===(a=r.position)||void 0===a?void 0:a.z)&&void 0!==s?s:e.radius),zorder:e.zorder}},t=e=>({loaded(){gl("trigger_"+e.id,!0);const t=1!==i["b"].state.sceneInfo.type&&!e.iconData.isModelIcon,o=zu(e.id,"visible"),n=null==o?e.isShow:o;!t&&n&&mh(e.id)},show(){yh(e.id),xl("trigger_"+e.id,!0);const t=zu(e.id,"aniId");t>0&&bh(e.id,t);const o=zu(e.id,"action");o&&Ns.emit(Ys,{triggerId:e.id,aniId:o.aniId,gearTarget:o.gearTarget,pointIndex:o.pointIndex,status:o.status})},hide(){wh(e.id),xl("trigger_"+e.id,!1)},over(){0===e.type&&xh(e.id,0)},out(){0===e.type&&xh(e.id,1)},down(){0===e.type&&xh(e.id,2)},up(){0===e.type&&xh(e.id,3)},trigger(t){6===e.type&&Bh(e,t.value),Sh(t.type,t.gear,e)}}),o=o=>{let n=null;const i={id:o.id,key:"trigger_"+o.id,fixed:e(o),type:o.type,other:{handcursor:!0}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),o.iconData.isModelIcon?(i.content={geoPath:o.iconData.iconPath,mtlPath:o.iconData.mtlPath,scaleSize:o.iconData.modelScale,autoRotate:!0,triggerMode:o.iconData.triggerMode},n=new _p(i,t(o))):(i.content={path:o.iconData.iconPath,gifInfo:o.iconData.gifInfo,size:o.iconData.showSize,triggerMode:o.iconData.triggerMode},n=new Mp(i,t(o))),n},n=o=>{let n=null;const i={id:o.id,key:"trigger_"+o.id,fixed:e(o),type:o.type};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),o.iconData.isModelIcon?(i.content={geoPath:o.iconData.iconPath,mtlPath:o.iconData.mtlPath,scaleSize:o.iconData.modelScale,allowModelViewer:o.iconData.allowModelViewer,autoRotate:!0},n=new _p(i,t(o))):(i.content={path:o.iconData.iconPath,gifInfo:o.iconData.gifInfo,size:o.iconData.showSize},n=new Mp(i,t(o))),i.content.activearea=o.iconData.activearea,n},s=o=>{let n=null;const i={id:o.id,key:"trigger_"+o.id,fixed:e(o),content:{path:o.iconData.iconPath,gifInfo:o.iconData.gifInfo,size:o.iconData.showSize,isRelationOther:o.iconData.isRelationOther},timeContent:{show:o.iconData.isShowTime,timerTitle:o.iconData.isCountDown?o.iconData.time:0,time:o.iconData.time,font:{size:o.iconData.font.size,color:o.iconData.font.color},direction:o.iconData.direction,isCountDown:o.iconData.isCountDown}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),n=new Lp(i,t(o)),n},a=o=>{let n=null;const i={id:o.id,key:"trigger_"+o.id,fixed:e(o),other:{handcursor:!0},content:{open:{path:o.iconData.openIcon.iconPath,gifInfo:o.iconData.openIcon.gifInfo},close:{path:o.iconData.closeIcon.iconPath,gifInfo:o.iconData.closeIcon.gifInfo},size:o.iconData.showSize,status:o.iconData.status}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),n=new Bp(i,t(o)),n},r=o=>{let n=null;const i={id:o.id,key:"trigger_"+o.id,fixed:e(o),content:{handle:{path:o.iconData.handleIcon.iconPath,gifInfo:o.iconData.handleIcon.gifInfo,size:o.iconData.handleIcon.showSize},cycle:{path:o.iconData.cycleIcon.iconPath,gifInfo:o.iconData.cycleIcon.gifInfo,size:o.iconData.cycleIcon.showSize},initValue:0,maxValue:o.iconData.maxValue}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),n=new Vp(i,t(o)),n},c=o=>{let n=null;const i={id:o.id,key:"trigger_"+o.id,fixed:e(o),content:{handle:{path:o.iconData.handleIcon.iconPath,gifInfo:o.iconData.handleIcon.gifInfo,size:o.iconData.handleIcon.showSize},cycle:{path:o.iconData.cycleIcon.iconPath,gifInfo:o.iconData.cycleIcon.gifInfo,size:o.iconData.cycleIcon.showSize},initValue:0,maxValue:o.iconData.maxValue}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),n=new Fp(i,t(o)),n},l=o=>{let n=null;const i={id:o.id,key:"trigger_"+o.id,fixed:e(o),content:{title:o.iconData.inputValue?String(o.iconData.inputValue):"",font:{family:"Youyuan",size:16,color:{x:255,y:255,z:255,w:0},wordspace:0,rowspace:0,bolid:0,italic:0,underline:0,align:"left",padding:"2 8"},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:200,y:48},isTrigger:!0}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),n=new Wp(i,t(o)),n};return{renderNormalIcon:o,renderAreaIcon:n,renderTimeIcon:s,renderOnOffIcon:a,renderSliderIcon:r,renderDailIcon:c,renderInputIcon:l}}function _h(){const e=e=>{const t="trigger_"+e;gu(t)},t=e=>{const t="trigger_"+e;yu(t)},o=()=>{i["b"].state.sceneInfo.triggers.forEach(t=>{const o=zu(t.id,"visible"),n=null==o?t.isShow:o;n&&e(t.id)})},n={},s=e=>n[e],a=t=>{const o="trigger_"+t,a=yl(o);let r=s(t);0===i["b"].state.sceneInfo.type&&(r=!0),a?r&&e(t):(ph(t),n[t]=!0)},r=e=>{const o="trigger_"+e,i=yl(o);i?t(e):n[e]=!1};return{showAllTrigger:o,checkTriggerRenderAndShow:a,checkTriggerRenderAndHide:r}}function Ah(){const e=(e,t)=>{const o=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);if(!o||!o.animationInfos||!o.animationInfos.length)return null;let n=o.animationInfos[o.animationInfos.length-1];return t&&(n=o.animationInfos.find(e=>e.id===t)),n.initial||(n.initial={translate:{ath:o.position.x,atv:o.position.y,radius:o.radius},rotate:o.rotate,opacity:{value:o.opacity},scale:{value:o.scale},visible:{value:!0}}),n},t=(t,n)=>{const i=e(t,n);if(!i)return;const s=t+"_"+n,a="trigger_"+t;Qd(s,i,{start(){iu(s,"complete",!1),Oh(t,!1)},translate(e){pu(a,e)},rotate(e){fu(a,e)},scale(e){mu(a,e)},opacity(e){bu(a,e)},visible(e){hu(a,e)},end(){o(t,n)}})},o=(t,o)=>{const n=e(t,o);if(!n)return;const i=t+"_"+o,s=n.isRecover||n.isLoop;s&&ou(i),n.isLoop?eu(i):(iu(i,"complete",!0),iu(i,"paused",!0),Oh(t,!0),kh(t))},n=(e,o)=>{c(e);const n=e+"_"+o,i=nu(n);i.rendered||t(e,o),ou(n),i.paused&&eu(n)},s=(e,o)=>{const n=e+"_"+o,i=nu(n);i.rendered||t(e,o),i.paused&&eu(n)},a=(e,t)=>{const o=e+"_"+t,n=nu(o);n.rendered&&!n.paused&&tu(o)},r=(e,t)=>{const o=e+"_"+t,n=nu(o);n.rendered&&ou(o)},c=e=>{const t=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);t&&t.animationInfos.filter(t=>{a(e,t.id),r(e,t.id)})},l=e=>{const t=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);if(!t||!t.animationInfos||!t.animationInfos.length)return null;const o=t.animationInfos.filter(e=>0===e.trigType),n=o[o.length-1];if(n){let t=e+"_"+n.id;const o=su(e);o&&(t=o.key);let i=!1;if(o&&(i=o.complete),!i){const o=Number(t.split("_").pop());s(e,o)}}},d=e=>{const t=su(e);t&&tu(t.key)};return{replayTriggerAnimation:n,resetTriggerAnimation:r,checkShowAndStartAnimation:l,checkHideAndStopAnimation:d}}function Mh(){const e=(e,t,o)=>{jh(o);let n="trigger";1===e?n="show":-1===e&&(n="hide"),nh({mode:n,gear:t,signalGear:o.signalGear,relations:o.relations});const s=i["b"].state.sceneInfo.triggers.find(e=>e.id===o.id);s&&s.conditionTrigger&&s.conditionTrigger.triggerId>0&&Ns.emit(Ks,{conditioner:s.conditionTrigger,id:o.id,mode:n,gear:t})},t=(e,t)=>{const o=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);if(o&&1===o.type){const o=cu("trigger_"+e),n=o.instances||[];n.map(e=>{e.updateEnableDrag&&e.updateEnableDrag(t)})}},o=e=>{const t=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);if(t&&1===t.type){const t=cu("trigger_"+e),o=t.instances||[];o.map(e=>{e.updateDragendPos&&e.updateDragendPos(),e.checkApproachArea&&e.checkApproachArea()})}},n=(e,t,o)=>{const n="trigger_"+e;if(!yl(n)||!Sl(n))return;const s=i["b"].state.sceneInfo.triggers.find(t=>t.id===e),a=cu(n),r=a.instances||[];r.map(e=>{[0,1,2].indexOf(s.type)>=0?e.autoAction&&e.autoAction():3===s.type?e.autoAction&&e.autoAction(o):e.autoAction&&e.autoAction(t)})};return{onTriggerHandle:e,toggleDragAuth:t,checkActiveAreaTrigger:o,checkTriggerShowAndAction:n}}function Hh(){const e=(e,t)=>{const o=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);if(!o)return;if(i["b"].state.pageStatus.popup&&[0,2].indexOf(t)>=0)return;const n=o.hotspotTriEffect;n.initial.path=o.iconData.iconPath,n.initial.gifInfo=o.iconData.gifInfo;const s="trigger_"+e,a=cu(s);if(!a||!a.instances.length)return;const r=a.instances[0];switch(t){case 0:$p(r,n);break;case 1:Up(r,n);break;case 2:Xp(r,n);break;case 3:Yp(r,n);break;default:break}};return{initTriggerAction:e}}function zh(){const e=(e,t)=>{let o=e.status;3!==e._mode&&(o=e._prevstatus!==e._nextstatus),o&&(3!==e._mode?e._prevstatus=e._nextstatus:e.hotPots.forEach(e=>{e.status=!1}),t&&t())};let t=[];const o=()=>{i["b"].state.sceneInfo.conditioners.forEach(e=>{e.hotPots.forEach(e=>{t.indexOf(e.id)>=0&&(e.status=!1)})}),t=[]};Ns.on(qs,t=>{const o=t.conditioner.triggerId;i["b"].state.skyBoxSceneGroup.conditioners.forEach(t=>{const n=t.hotPots.some(e=>e.id===o);n&&(t.hotPots.forEach(e=>{e.id===o&&(e.status=!0)}),1===t.type?t.status=t.hotPots.every(e=>e.status):2===t.type&&(t.status=t.hotPots.some(e=>e.status)),t._mode=3,e(t,()=>{Ns.emit(Fs,{sceneId:t.nextSceneId})}))})}),Ns.on(Ks,t=>{const o=t.conditioner.triggerId;if(o<=0)return;const n=t.conditioner.triggerMode,s=t.conditioner.gear,a=t.mode||"trigger",r=t.gear||0;let c=!1;i["b"].state.skyBoxSceneGroup.conditioners.forEach(t=>{t.hotPots.forEach(e=>{e.id===o&&(c=!0,0===n?e.status="trigger"===a:1===n?e.status="show"===a:2===n?e.status="hide"===a:3===n?e.status="trigger"===a:4===n&&(e.status=r===s))}),c&&(1===t.type?t.status=t.hotPots.every(e=>e.status):2===t.type&&(t.status=t.hotPots.some(e=>e.status)),t._mode=3,e(t,()=>{Ns.emit(Fs,{sceneId:t.nextSceneId})}))})}),Ns.on(Zs,({condId:e,triggerId:o,status:n})=>{const s=i["b"].state.sceneInfo.conditioners.find(t=>t.id===e);if(s){s.hotPots.forEach(e=>{e.id===o&&(e.status=3===n||1===n)});let e=!1;1===s.type?e=s.hotPots.every(e=>e.status):2===s.type&&(e=s.hotPots.some(e=>e.status));let i=!1;const r=3!==n;let c=3;if(r&&(c=e?1:-1),e||r){i=!0,r||s.hotPots.forEach(e=>{e.status=!1});const o=Qp(s.nextSceneId);var a;if(4===o.type)i=3===(null===(a=o.instance)||void 0===a?void 0:a.type)||s.animationId>0||e;s.clearRecords&&s.hotPots.forEach(e=>{t.indexOf(e.id)<0&&t.push(e.id)})}s.parentType="logic",s.parentResult=i,s.parentFrameStatus=c}}),Ns.on(Js,()=>{t.length&&o()});const s=()=>{i["b"].state.sceneInfo.conditioners.forEach(e=>{e.hotPots.forEach(e=>{e.status=!1})})};Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e||s()})}function Lh(){Object(n["watch"])(()=>wl.value,e=>{e&&1!==i["b"].state.sceneInfo.type&&fh()})}function Dh(){const e=e=>{if(1!==i["b"].state.sceneInfo.type)return!0;const t=i["b"].state.sceneInfo.triggers.find(t=>t.id===e);if(t){const e=t.startTime/1e3,o=t.endTime/1e3;return i["b"].state.scenevideo.time>=e&&i["b"].state.scenevideo.time<=o}return!1};Ns.on(Ws,({id:t,status:o})=>{o&&!e(t)||(o?mh(t):vh(t))}),Ns.on(Ys,({triggerId:t,aniId:o,gearTarget:n,pointIndex:s,status:a})=>{if(!e(t))return;const r=yl("trigger_"+t),c=Sl("trigger_"+t);[0,1,3].indexOf(s)<0&&(s=o>0?1:0);const l=1===s&&!c,d=0===s&&!c,u=3===s&&!r,p=i["b"].state.preSetCmIds.indexOf(t)>=0;p&&(l||d||u)?Du({cid:t,ctype:3,aniId:o,pointIndex:s,gearTarget:n,status:a}):(1===s&&o>0&&c&&(-1===a?gh(t,o):bh(t,o)),0===s&&t>0&&c&&Ih(t,n,a),3===s&&t>0&&r&&-1!==a&&Au(t,3))})}function Bh(e,t){e.relations.forEach(o=>{o.parentType="input",o.parentId=e.id,o.parentResult=t})}function Nh(){const e=e=>{bc.emit("action",{key:"trigger",data:{id:e.id,title:e.name,type:e.type,statisticsProperity:e.statisticsProperity}})};return{reportTrigger:e}}function Vh(){Ns.on(Rs,()=>{hh()})}function Rh(e,t,o,n,i){let s=e,a=t;const r=10;return"rightbottom"===o?(s+=-1*(n.x-i-r),a+=-1*(n.y-i)/2):"righttop"===o?(s+=-1*(n.x-i-r),a+=(n.y-i)/2):"lefttop"===o?(s+=r,a+=(n.y-i)/2):"leftbottom"===o?(s+=r,a+=-1*(n.y-i)/2):"right"===o?s+=-1*(n.x-i-r):"top"===o?(s+=-1*(n.x-i-r)/2,a+=(n.y-r)/2):"left"===o?s+=r:"bottom"===o?(s+=-1*(n.x-i-r)/2,a+=-1*(n.y-i)/2):"center"===o&&(s+=-1*(n.x-i-r)/2),{x:s,y:a}}zh(),Dh(),Vh();class Fh extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.options=e||{},this.el=null,this.aicon=null,this.stitle=null,this.initModelComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this)})}initModelComponent(){this.el=new Ad({key:this.options.key,fixed:this.options.fixed,other:this.options.other,content:this.options.content,events:Pl.bind(this)({loaded:e=>{e.boxSize&&this.initTitleComponent(e.boxSize)}})}),super.push(this.el)}initTitleComponent(e){if(!this.options.titleContent)return;const t=-1*(e.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),o=zo(this.options.fixed,{offset:{x:0,y:t},edge:"bottom"});if(this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:o,other:{enabled:!1},content:this.options.titleContent,events:Pl.bind(this)({loaded:()=>{if(5===this.options.type&&this.stitle){const e=this.stitle.getTitleInfo;this.stitle.el.width+=e.fontsize+20,this.stitle.el.padding="0 0 0 "+(e.fontsize+20)/2}}})}),super.push(this.stitle),5===this.options.type){const e=this.stitle.getTitleInfo;this.initAudioIconComponent(o,e)}}initAudioIconComponent(e,t){const o=Rh(e.offset.x,e.offset.y,e.edge,{x:t.width,y:t.height},t.fontsize),n=zo(this.options.fixed,{offset:{x:o.x-(t.fontsize+20)/2,y:o.y},edge:e.edge});this.aicon=new Hl({key:"sicon_"+this.options.id,fixed:n,content:{path:"",gifInfo:{imgPath:"%$prevPath%/skin/assets/voice.png",imgWidth:50,imgHeight:1500,gifWidth:50,gifHeight:50,delayTime:1e3/30,replenishNum:0,frameNum:30},size:{x:t.fontsize,y:t.fontsize}},events:Pl.bind(this)()}),super.push(this.aicon)}updateHoverScale(e){if(!this.el)return;this.el.multiplyscale("hover",e);const t=this.getFixedData;this.el.updateScale(t.scale)}onshow(){this.autoRotate()}autoRotate(){if(!this.options.content.autoRotate)return;let e=.01;this.options.content.rotateType||(e*=-1),i["b"].state.modelplugin.arotatey(this.options.key,e)}toggleAudioGif(e){this.aicon&&(e?this.aicon.startCropAnimation():this.aicon.stopCropAnimation())}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.aicon&&(this.aicon.destroy(),this.aicon=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Gh=Fh;class Wh extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.stitle=null,this.aicon=null,this.options=e||{},this.initIconComponent(),this.initTitleComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initIconComponent(){this.el=new Hl({id:this.options.id,key:this.options.key,fixed:this.options.fixed,other:this.options.other,content:this.options.content,events:Pl.bind(this)({})}),super.push(this.el)}initTitleComponent(){if(!this.options.titleContent)return;const e=-1*(this.options.content.size.y/2+(i["b"].state.sceneInfo.is2dRender?10:15)),t=zo(this.options.fixed,{offset:{x:0,y:e},edge:"bottom"});if(this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:t,content:this.options.titleContent,other:{enabled:!1},events:Pl.bind(this)({loaded:()=>{if(5===this.options.type&&this.stitle){const e=this.stitle.getTitleInfo;this.stitle.el.width+=e.fontsize+20,this.stitle.el.padding="0 0 0 "+(e.fontsize+20)/2}}})}),super.push(this.stitle),5===this.options.type){const e=this.stitle.getTitleInfo;this.initAudioIconComponent(t,e)}}initAudioIconComponent(e,t){const o=Rh(e.offset.x,e.offset.y,e.edge,{x:t.width,y:t.height},t.fontsize),n=zo(this.options.fixed,{offset:{x:o.x-(t.fontsize+20)/2,y:o.y},edge:e.edge});this.aicon=new Hl({key:"sicon_"+this.options.id,fixed:n,content:{path:"",gifInfo:{imgPath:"%$prevPath%/skin/assets/voice.png",imgWidth:50,imgHeight:1500,gifWidth:50,gifHeight:50,delayTime:1e3/30,replenishNum:0,frameNum:30},size:{x:t.fontsize,y:t.fontsize}},events:Pl.bind(this)()}),super.push(this.aicon)}onshow(){this.el&&this.el.startCropAnimation()}onhide(){this.el&&this.el.stopCropAnimation(),this.aicon&&this.aicon.stopCropAnimation()}updateTexture(e,t){this.el&&(this.el.updateGifInfo(t),t&&t.imgPath?this.el.updateTexture(t.imgPath):e&&this.el.updateTexture(e))}updateHoverScale(e){if(!this.el)return;this.el.multiplyscale("hover",e);const t=this.getFixedData;this.el.updateScale(t.scale)}toggleAudioGif(e){this.aicon&&(e?this.aicon.startCropAnimation():this.aicon.stopCropAnimation())}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.aicon&&(this.aicon.destroy(),this.aicon=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var $h=Wh;class Uh extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.aicon=null,this.stitle=null,this.options=e||{},this.markInfo=this._getMarkInfo(),this.initIconComponent(),this.initTitleComponent(),this.cid=e.id,this.events=Al(t,{loaded:this.onloaded.bind(this)})}_getMarkInfo(){const e={ox:0,oy:0,rz:0,edge:"center",radius:5},t=e.radius,o=this.options.content.linePos,n=this.options.content.lineLength;let i=0,s=0;switch(o){case 0:e.rz=135,e.edge="rightbottom",i=-1*(n+t/2)*Math.cos(45*Math.PI/180),s=-1*(n+t/2)*Math.sin(45*Math.PI/180);break;case 1:e.rz=45,e.edge="righttop",i=-1*(n+t/2)*Math.cos(45*Math.PI/180),s=(n+t/2)*Math.sin(45*Math.PI/180);break;case 2:e.rz=-45,e.edge="lefttop",i=(n+t/2)*Math.cos(45*Math.PI/180),s=(n+t/2)*Math.sin(45*Math.PI/180);break;case 3:e.rz=-135,e.edge="leftbottom",i=(n+t/2)*Math.cos(45*Math.PI/180),s=-1*(n+t/2)*Math.sin(45*Math.PI/180);break;case 4:e.rz=90,e.edge="right",i=-1*(n+t/2);break;case 5:e.rz=0,e.edge="top",s=n+t/2;break;case 6:e.rz=-90,e.edge="left",i=n+t/2;break;case 7:e.rz=180,e.edge="bottom",s=-1*(n+t/2);break;default:break}return e.ox=i,e.oy=s,e}initIconComponent(){const e=({lineLength:e,color:t,radius:o})=>{const n=document.createElement("canvas"),i=window.devicePixelRatio>1?window.devicePixelRatio:2;n.width=2*o*i,n.height=(e+o)*i;const s=n.getContext("2d");return s&&(s.save(),s.translate(n.width/2,0),s.save(),s.strokeStyle=t,s.lineWidth=2*i,s.beginPath(),s.moveTo(0,o*i),s.lineTo(0,(e+o)*i),s.stroke(),s.closePath(),s.restore(),s.save(),s.fillStyle="#fff",s.beginPath(),s.arc(0,o*i,o*i,0,2*Math.PI),s.fill(),s.closePath(),s.restore(),s.save(),s.fillStyle="#81c1ff",s.beginPath(),s.arc(0,o*i,.7*o*i,0,2*Math.PI),s.fill(),s.closePath(),s.restore(),s.restore()),n.toDataURL("image/png")},t=e({lineLength:this.options.content.lineLength,color:rn(this.options.content.lineColor,!0,"#"),radius:this.markInfo.radius}),o=zo(this.options.fixed,{edge:"top"});this.el=new Hl({key:this.options.key,fixed:o,other:this.options.other,content:{path:t,size:{x:2*this.markInfo.radius,y:this.options.content.lineLength+this.markInfo.radius/2}},events:Pl.bind(this)()}),super.push(this.el)}initTitleComponent(){if(!this.options.titleContent)return;const e=zo(this.options.fixed,{offset:{x:this.markInfo.ox,y:this.markInfo.oy},edge:this.markInfo.edge}),t=zo(this.options.other,{handcursor:!0});if(this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:e,other:t,content:this.options.titleContent,events:Pl.bind(this)({loaded:()=>{if(5===this.options.type&&this.stitle){const e=this.stitle.getTitleInfo;this.stitle.el.width+=e.fontsize+20,this.stitle.el.padding="0 0 0 "+(e.fontsize+20)/2}}})}),super.push(this.stitle),5===this.options.type){const t=this.stitle.getTitleInfo;this.initAudioIconComponent(e,t)}}initAudioIconComponent(e,t){const o=Rh(e.offset.x,e.offset.y,e.edge,{x:t.width,y:t.height},t.fontsize),n=zo(this.options.fixed,{offset:{x:o.x,y:o.y},edge:e.edge});this.aicon=new Hl({key:"sicon_"+this.options.id,fixed:n,content:{path:"",gifInfo:{imgPath:"%$prevPath%/skin/assets/voice.png",imgWidth:50,imgHeight:1500,gifWidth:50,gifHeight:50,delayTime:1e3/30,replenishNum:0,frameNum:30},size:{x:t.fontsize,y:t.fontsize}},events:Pl.bind(this)()}),super.push(this.aicon)}onloaded(){this.el&&this.el.updateSelfRotate(0,0,this.markInfo.rz)}toggleAudioGif(e){this.aicon&&(e?this.aicon.startCropAnimation():this.aicon.stopCropAnimation())}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.aicon&&(this.aicon.destroy(),this.aicon=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Xh=Uh;class Yh extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.aicon=null,this.stitle=null,this.labelicon=null,this.options=e||{},this.iconData={},this.bubbleTagData={},this.initTitleComponent(),this.initIconComponent(),this.cid=e.id,this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initIconComponent(){this.initIconSize(),this.el=new Hl({key:this.options.key,fixed:this.iconData.fixed,other:this.options.other,content:this.iconData.content,events:Pl.bind(this)({})}),super.push(this.el)}initTitleComponent(){if(!this.options.titleContent)return;const e=zo(this.options.fixed,{offset:{x:0,y:0}});if(this.options.titleContent.background&&(this.options.titleContent.background.opacity=0),this.options.titleContent.size.x=0,this.options.titleContent.size.y=0,this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:e,other:{enabled:!1},content:this.options.titleContent,events:Pl.bind(this)({})}),super.push(this.stitle),5===this.options.type){const t=this.stitle.getTitleInfo;this.initAudioIconComponent(e,t)}}initAudioIconComponent(e,t){const o={x:e.offset.x-(t.naturalw+t.fontsize)/2,y:e.offset.y},n=zo(this.options.fixed,{offset:{x:o.x+0,y:o.y},edge:e.edge,zorder:e.zorder});this.aicon=new Hl({key:"sicon_"+this.options.id,fixed:n,content:{path:"",gifInfo:{imgPath:"%$prevPath%/skin/assets/voice.png",imgWidth:50,imgHeight:1500,gifWidth:50,gifHeight:50,delayTime:1e3/30,replenishNum:0,frameNum:30},size:{x:t.fontsize,y:t.fontsize}},events:Pl.bind(this)()}),super.push(this.aicon)}initIconSize(){const e={x:this.stitle?this.stitle.titleInfo.width:this.options.content.size.x,y:this.stitle?this.stitle.titleInfo.height:this.options.content.size.y},t={x:0,y:0};let o={},n={},i=0;if(5===this.options.type&&this.stitle&&(e.x+=this.stitle.titleInfo.fontsize,t.x+=-this.stitle.titleInfo.fontsize/2),0===this.options.content.stype){this.stitle&&(e.x+=Math.max(.2*e.x,60),e.y+=e.y);const s=.4*e.y,a=1.5*s;o=zo(this.options.content,{path:"%$prevPath%/skin/assets/bubble_tag.png",size:{x:a,y:s}});const r=e.x/2,c=e.y/2,l=c/Math.pow(r,2);n=zo(this.options.fixed,{offset:{x:.5*r+t.x,y:c-l*Math.pow(.5*r,2)},zorder:this.options.fixed.zorder-1}),i=s/2}if(1===this.options.content.stype){this.stitle&&(e.x+=40,e.y+=e.y);let s=0,a=0;e.y<=e.x/2?(s=.28*e.y,a=1.9*s):(a=.27*e.x,s=.52*a),o=zo(this.options.content,{path:"%$prevPath%/skin/assets/dialog_tag.png",size:{x:a,y:s}}),n=zo(this.options.fixed,{offset:{x:e.x/2*.43+t.x,y:(e.y+s)/2-.07*s}}),i=s}2===this.options.content.stype&&(this.stitle&&(e.x+=40,e.y+=e.y),o=zo(this.options.content,{path:"%$prevPath%/skin/assets/label_tag.png",size:{x:.73*e.y,y:e.y}}),n=zo(this.options.fixed,{offset:{x:-(e.x+o.size.x)/2,y:0}})),3===this.options.content.stype&&this.stitle&&(e.x+=20,e.y+=20),this.bubbleTagData={content:o,fixed:n,contentOffsetY:i},this.initBubbleTagIcon();const s=zo(this.options.content,{path:this.getBubbleIconPath(),size:e}),a=zo(this.options.fixed,{offset:t,zorder:this.options.fixed.zorder-1});this.iconData={content:s,fixed:a}}initBubbleTagIcon(){[0,1,2].includes(this.options.content.stype)&&(this.labelicon=new Hl({key:"bubble_tag_"+this.options.id,fixed:this.bubbleTagData.fixed,other:this.options.other,content:this.bubbleTagData.content,events:Pl.bind(this)({})}),super.push(this.labelicon))}getBubbleIconPath(){let e="";switch(this.options.content.stype){case 0:e="%$prevPath%/skin/assets/bubble.png";break;case 1:e="%$prevPath%/skin/assets/bubble_dialog.png";break;case 2:e="%$prevPath%/skin/assets/bubble_label.png";break;default:e=this.options.content.path;break}return e}onshow(){this.el&&this.el.startCropAnimation()}onhide(){this.el&&this.el.stopCropAnimation()}toggleAudioGif(e){this.aicon&&(e?this.aicon.startCropAnimation():this.aicon.stopCropAnimation())}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.aicon&&(this.aicon.destroy(),this.aicon=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Zh=Yh;class qh extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.create(this.setConfig())}setConfig(){const e={type:"image",renderer:this.options.other.renderer,points:this.options.content.points,fillcolor:this.options.content.backgroundColor,fillalpha:this.options.content.backgroundOpacity,bordercolor:this.options.content.borderColor,borderalpha:this.options.content.borderOpacity,borderwidth:1,handcursor:this.options.other.handcursor,capture:!1,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return e}create(e){new Cl(i["b"].state.krp,this.options.key,e)}saveInstanceToParent(){this.updateInstance(this.el)}destroy(){super.destroy(),this.el&&(this.el=null)}}var Kh=qh;class Jh extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.aicon=null,this.stitle=null,this.options=e||{},this.initIconComponent(),this.initTitleComponent(),this.cid=e.id,this.events=Al(t)}initIconComponent(){this.el=new Kh({key:this.options.key,fixed:this.options.fixed,other:this.options.other,content:{points:this.options.content.points,borderColor:rn(this.options.content.border.color,!1,"0x"),borderOpacity:this.options.content.border.opacity,backgroundColor:rn(this.options.content.background.color,!1,"0x"),backgroundOpacity:this.options.content.background.opacity},events:Pl.bind(this)({})}),super.push(this.el)}initTitleComponent(){if(!this.options.titleContent)return;const e="stitle_"+this.options.id;Ud(e,this.options.fixed.rotate),Xd(e,this.options.fixed.position,this.options.content.title.position);const t=Zd(e),o=zo(this.options.fixed,{position:this.options.content.title.position,rotate:t,depth:72*this.options.content.title.radius});if(this.stitle=new Ld({key:"stitle_"+this.options.id,fixed:o,other:{enabled:!1},content:this.options.titleContent,events:Pl.bind(this)({loaded:()=>{if(5===this.options.type&&this.stitle){const e=this.stitle.getTitleInfo;this.stitle.el.width+=e.fontsize+20,this.stitle.el.padding="0 0 0 "+(e.fontsize+20)/2}}})}),super.push(this.stitle),5===this.options.type){const e=this.stitle.getTitleInfo;this.initAudioIconComponent(o,e)}}initAudioIconComponent(e,t){const o=Rh(e.offset.x,e.offset.y,e.edge,{x:t.width,y:t.height},t.fontsize),n=zo(e,{offset:{x:o.x-(t.fontsize+20)/2,y:o.y}});this.aicon=new Hl({key:"sicon_"+this.options.id,fixed:n,content:{path:"",gifInfo:{imgPath:"%$prevPath%/skin/assets/voice.png",imgWidth:50,imgHeight:1500,gifWidth:50,gifHeight:50,delayTime:1e3/30,replenishNum:0,frameNum:30},size:{x:t.fontsize,y:t.fontsize}},events:Pl.bind(this)()}),super.push(this.aicon)}toggleAudioGif(e){this.aicon&&(e?this.aicon.startCropAnimation():this.aicon.stopCropAnimation())}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null),this.aicon&&(this.aicon.destroy(),this.aicon=null),this.stitle&&(this.stitle.destroy(),this.stitle=null)}}var Qh=Jh;class ef{constructor(e,t,o){this.imgWrap=e,this.gifInfo=t,this.index=0,this.rowLen=0,this.columnLen=0,this.then=0,this.loopTime=0,this.scaleX=1,this.scaleY=1,this.timer=0,this.allFrameNum=this.gifInfo.frameNum+this.gifInfo.replenishNum,this.size=o,this.init()}init(){this.scaleX=this.gifInfo.gifWidth/this.size.x,this.scaleY=this.gifInfo.gifHeight/this.size.y,this.rowLen=Math.ceil(this.gifInfo.imgHeight/this.gifInfo.gifHeight),this.columnLen=Math.ceil(this.gifInfo.imgWidth/this.gifInfo.gifWidth),this.imgWrap.style.backgroundSize=`${this.gifInfo.imgWidth/this.scaleX}px ${this.gifInfo.imgHeight/this.scaleY}px`}prev(){this.index=(this.index-1+this.allFrameNum)%this.allFrameNum;const e=this.index%this.columnLen*-1*this.gifInfo.gifWidth,t=-1*Math.floor(this.index/this.rowLen)*this.gifInfo.gifHeight;this.imgWrap.style.backgroundPosition=`${e/this.scaleX}px ${t/this.scaleY}px`}next(){this.index=(this.index+1)%this.allFrameNum;const e=this.index%this.columnLen*-1*this.gifInfo.gifWidth,t=-1*Math.floor(this.index/this.rowLen)*this.gifInfo.gifHeight;this.imgWrap.style.backgroundPosition=`${e/this.scaleX}px ${t/this.scaleY}px`}checkTime(){return!(this.gifInfo.loopTime&&this.loopTime>=this.gifInfo.loopTime)||(this.stop(),!1)}start(){this.then||(this.then=Date.now());const e=Date.now(),t=e-this.then;t>this.gifInfo.gifFrame&&(this.then=e-t%this.gifInfo.gifFrame,this.next(),this.index===this.gifInfo.frameNum-1&&this.loopTime++),this.checkTime()&&(this.timer=requestAnimationFrame(this.start.bind(this)))}stop(){cancelAnimationFrame(this.timer)}reset(){this.stop(),this.index=-1,this.next(),this.loopTime=0}destroy(){}}var tf=ef;const{reportComponentClick:of,reportSelectorClick:nf}=Tf();class sf extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.exclose=e.exclose,this._events={...t,show:()=>{this.playbgAudio(),t.show()},hide:()=>{this.pausebgAudio(),t.hide()}},this.audioInstance=null,this.selectorData=i["b"].state.skyBoxSceneGroup.sceneList.find(t=>{var o;return t.id===(null===(o=e.content)||void 0===o?void 0:o.nextSceneId)}),this.create(e,this.setConfig(e)),this.initSelectorAudio(this.selectorData),this.events=Al(this._events,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}setConfig(e){var t,o,n,s,a,r,c,l,d,u;const p=i["b"].state.sceneInfo.is2dRender;if(!this.selectorData)return;const h=cf(this.selectorData,1,this.exclose),f=this.getLastSelectorHtml(e,h),m=this.selectorData.skin.showSize.x,v=this.selectorData.skin.showSize.y,b=p?1e3:e.fixed.depth,g=sn.value*an.value*e.fixed.scale,y=()=>this.selectorData.components.some(e=>e.content&&0===e.content.texteffect),w={x:(null===(t=e.fixed.contentPosition)||void 0===t?void 0:t.x)||(null===(o=e.fixed.position)||void 0===o?void 0:o.x)||0,y:(null===(n=e.fixed.contentPosition)||void 0===n?void 0:n.y)||(null===(s=e.fixed.position)||void 0===s?void 0:s.y)||0,rx:(null===(a=e.fixed.contentRotate)||void 0===a?void 0:a.rx)||(null===(r=e.fixed.rotate)||void 0===r?void 0:r.rx)||0,ry:(null===(c=e.fixed.contentRotate)||void 0===c?void 0:c.ry)||(null===(l=e.fixed.rotate)||void 0===l?void 0:l.ry)||0,rz:(null===(d=e.fixed.contentRotate)||void 0===d?void 0:d.rz)||(null===(u=e.fixed.rotate)||void 0===u?void 0:u.rz)||0},x={id:e.id,type:"image",ath:w.x,atv:w.y,initath:w.x,initatv:w.y,url:"%$prevPath%/skin/assets/transparent.png",renderer:"css3d",ox:0,oy:0,oref:1,rotationorder:"ZXY",rx:w.rx,ry:w.ry,rz:w.rz,rotate:p?w.rz:0,alpha:e.fixed.opacity,width:m,height:v,handcursor:!1,accuracy:0,capture:y(),scale:g,depth:b,zoom:p,distorted:!p,enable:!0,visible:!1,zorder:e.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${e.key}]`);const t=document.createElement("div");t.style.cssText="\n          position: absolute;\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n          border: 0;\n        ",t.innerHTML=f,this.el.registercontentsize(m,v),this.el.sprite.appendChild(t),this.events.loaded&&this.events.loaded()},onclick:()=>{or(this.selectorData.id)||this.playbgAudio()}};return this.inithotspotcloseEvent(),x}getLastSelectorHtml(e,t){const o=document.createElement("div");if(this.exclose){const t=document.createElement("span");t.className="css3d-close";let n="onclick";i["b"].state.device.mobile&&(n="ontouchend"),t.setAttribute(n,`myKrp.onhotspotclose(${e.id}, ${e.type})`),o.appendChild(t)}return o.innerHTML+=t,o.innerHTML}inithotspotcloseEvent(){let e=window.myKrp;e||(e=window.myKrp={}),e.onhotspotclose=e=>{this._events.hideSelector(e)}}initSelectorAudio(e){e.bgAudio.fileUrl&&(this.audioInstance=document.createElement("audio"),this.audioInstance.src=e.bgAudio.fileUrl,this.audioInstance.volume=e.bgAudio.volume,e.bgAudio.loopTime<=0&&(this.audioInstance.loop=!0),this.audioInstance.onended=()=>{Qa("s"+e.id,"isEnded",!0)},Ka({pid:e.id,id:"s"+e.id,type:"selector_bg_audio",instance:this.audioInstance,isPauseMedia:e.bgAudio.isPauseMedia,isEventSelector:!this.exclose}))}playbgAudio(){this.audioInstance&&this.audioInstance.paused&&(this.audioInstance.play(),Ja("s"+this.selectorData.id,!1))}pausebgAudio(){this.audioInstance&&!this.audioInstance.paused&&(this.audioInstance.pause(),this.audioInstance.currentTime=0,Ja("s"+this.selectorData.id,!0))}create(e,t){new Cl(i["b"].state.krp,e.key,t)}translate(e,t,o){this.el&&(this.el.ath=e,this.el.atv=t,o&&(this.el.depth=o))}onshow(){this.el.visible=!0,this.playbgAudio(),Ef(this.selectorData.id,!0)}onhide(){this.el.visible=!1,rf(this.selectorData.components),Ef(this.selectorData.id,!1),this.pausebgAudio(),er("s"+this.selectorData.id)}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null)}}var af=sf;function rf(e){e.forEach(e=>{e.hotspot&&5===e.hotspot.type&&Ns.emit(Ta,e.hotspot.id)})}function cf(e,t,o){const{wrapStyle:n,coverImg:s,opacity:a}=lf(e.skin),r=df(t),c=uf(e.components,e.id,o),l=()=>{const t=i["b"].state.device.mobile;let o=`<div class="selector__wrap my--selector_container" data-id="${e.id}" ${t?'ontouchend="myKrp.componentClick(event)"':'onclick="myKrp.componentClick(event)"'} style="${n}">\n        <div class="selector__inner" style="${r}">${c}</div>\n        <div class="inner__hotpot-wrap">\n          <div class="inner__hotpot-con"></div>\n        </div>\n        `;return o+=s?`<div class="inner__cover-img" style="position: absolute; left: 0; top: 0;width: 100%;height: 100%; opacity: ${a};">\n          <img src="${s}" alt="" style="width: 100%;height: 100%">\n        </div>\n      </div>`:"</div>",o};return xf(o),l()}function lf(e){const t={position:"relative",width:"100%",height:"100%","user-select":"none",overflow:"hidden"};let o=e&&e.backImg||"";return e.backImg||(o=""),o||(t["background-color"]=dn(e.backColor,e.opacity/100)||"none"),{wrapStyle:un(t),coverImg:o,opacity:e.opacity/100}}function df(e){return`position: relative; z-index: 10; transform: scale(${e}); transform-origin: left top;`}function uf(e,t,o){const n=document.createElement("div"),i=document.createDocumentFragment();return e.forEach((e,n)=>{if(!e.isShow)return;let s;switch(e.type){case 0:s=document.createElement("p");break;case 1:s=document.createElement("h1");break;case 2:s=document.createElement("h2");break;case 3:s=document.createElement("h3");break;case 4:case 5:case 6:default:s=document.createElement("div");break}switch(e.type){case 0:case 1:case 2:case 3:pf(e,s);break;case 4:hf(e,s);break;case 5:case 6:ff(e,s);break;case 8:gf(e,s);break;case 9:mf(e,s);break;case 10:vf(e,s,t,o);break;case 12:yf(e,s);break;default:break}s.setAttribute("data-index",n+""),s.setAttribute("data-id",e.id),s.setAttribute("data-type",e.type),s.setAttribute("data-sid",t+""),wf(e,s),i.appendChild(s)}),n.appendChild(i),n.innerHTML||""}function pf(e,t){const o=e.content.texteffect;let n=null,i=null,s={txtWrap:null,txtNode:null,inited:!1,status:!1,init:()=>{if(!s.txtWrap)return;s.inited=!0;const t=s.txtNode.scrollHeight;if(1===o){const{start:t}=hd({txtDom:s.txtNode,width:e.size.x});n=t}else if(2===o){const{start:t}=fd({txtDom:s.txtNode,height:e.size.y});n=t}else 0===o&&t>e.size.y&&!i&&(s.txtWrap.addEventListener("mouseenter",s.onenter,!1),s.txtWrap.addEventListener("mouseleave",s.onleave,!1),s.txtWrap.setAttribute("canscroll","true"),s.initWheel(s.txtWrap),i=md({txtWrap:s.txtWrap,rotateAngle:0}));n&&n()},onenter:()=>{Nu()},onleave:()=>{Vu()},initWheel:e=>{Ns.on("change::wheel",({status:t})=>{if(!e)return;const o=window.event,n=Vo(o.target,"forbid__move");n===e&&(t?e.scrollTop-=10:e.scrollTop+=10)})},hide:()=>{s.txtNode&&([1,2].indexOf(o)>=0?(s.txtNode.style.transitionDuration="0s",1===o?s.txtNode.style.transform=`translateX(${e.size.x}px)`:2===o&&(s.txtNode.style.transform=`translateY(${e.size.y}px)`)):s.onleave())},reset:()=>{s.txtNode&&(s.txtNode.removeEventListener("transitionend",n,!1),i&&(s.txtWrap.removeEventListener("mouseenter",s.onenter,!1),s.txtWrap.removeEventListener("mouseleave",s.onleave,!1),i.destroy()))}};e._operate=s,e.destroy=()=>{delete s.inited,delete s.status,s.txtWrap=null,s.txtNode=null,s.reset(),s.init=null,s.onenter=null,s.onleave=null,s.initWheel=null,s.hide=null,s.reset=null,s=null,e._operate=null};const a=()=>{const n=document.createElement("span"),i=e.content.fontSize;let s=0;s=e.content.wordSpace>=0&&e.content.wordSpace<=100?1+.32*e.content.wordSpace:.32;const a=e.content.rowSpace+i,r={display:"table-cell","box-sizing":"border-box","font-size":i+"px","font-weight":e.content.bold?"bold":"normal","font-family":e.content.fontFamily,color:dn(e.content.fontColor,1),"text-decoration":e.content.underline?"underline":"none","font-style":e.content.italic?"italic":"none",width:e.size.x+"px",height:e.size.y+"px","letter-spacing":s+"px","line-height":a+"px","word-break":"break-all",position:"relative",top:14-e.content.rowSpace/2+"px"};o>0&&(r["transition-timing-function"]="linear",r["top"]="0px",1===o?(r["white-space"]="nowrap",r["height"]="auto",r["transform"]="translateX("+e.size.x+"px)"):2===o&&(r["transform"]="translateY("+e.size.y+"px)")),n.style.cssText=un(r);const c=fn(e.content.title);1===o?n.innerHTML=c.replace(/\n|\r\n/g,""):[0,1,2,3].includes(e.type)?n.innerHTML=c:n.innerHTML=pn(c),t.appendChild(n)};a()}function hf(e,t){const o=()=>{const t=/\.(gif|webp)/i.test(e.content.imagePath);return t?e.content.gifInfo&&e.content.gifInfo.imgPath:""},n=o(),s=()=>{const o=document.createElement("img");o.style.width="100%",o.style.height="100%",o.src=e.content.imagePath,t.appendChild(o)},a=()=>{const o=document.createElement("div"),i=e.content.gifInfo.gifWidth/e.size.x,s=e.content.gifInfo.gifHeight/e.size.y;o.style.cssText=`\n      width: 100%;\n      height: 100%;\n      background: url(${n}) no-repeat;\n      background-size: ${e.content.gifInfo.imgWidth/i}px ${e.content.gifInfo.imgHeight/s}px;\n    `,t.appendChild(o)},r=Po(i["b"].state.proInfo.version,"5.9.0");r&&n?a():s()}function ff(e,t){const o=document.createElement("span"),n={display:"table-cell","box-sizing":"border-box","font-size":(e.content.fontSize||12)+"px","font-weight":e.content.bold?"bold":"normal","font-family":e.content.fontFamily,color:dn(e.content.fontColor,1),"text-decoration":e.content.underline?"underline":"none","font-style":e.content.italic?"italic":"none",width:e.size.x+"px",height:e.size.y+"px","vertical-align":"middle"};o.style.cssText=un(n),o.innerHTML=pn(e.content.title),t.appendChild(o)}function mf(e,t){let o={imgWrap:null,inited:!1,status:!1,gifInstance:null,isLoaded:!1,init:()=>{o.inited||(o.inited=!0,e.content.gifInfo&&(o.gifInstance=new tf(o.imgWrap,{imgPath:e.content.gifInfo.imgPath,imgWidth:e.content.gifInfo.imgWidth,imgHeight:e.content.gifInfo.imgHeight,gifWidth:e.content.gifInfo.gifWidth,gifHeight:e.content.gifInfo.gifHeight,frameNum:e.content.gifInfo.frameNum,replenishNum:e.content.gifInfo.replenishNum,gifFrame:e.content.gifInfo.delayTime,loopTime:e.content.loopTime},e.size),o.preload())),o.isLoaded&&o.gifInstance&&o.show()},preload:()=>{const t=new Image;t.onload=()=>{o.isLoaded=!0,o.gifInstance&&o.show()},t.src=e.content.gifInfo.imgPath},show:()=>{o.gifInstance&&o.gifInstance.start()},reset:()=>{o.gifInstance&&o.gifInstance.reset()}};e._operate=o,e.destroy=()=>{o.reset(),delete o.inited,delete o.status,o.gifInstance&&(o.gifInstance.destroy(),o.gifInstance=null),o.imgWrap=null,o.show=null,o.reset=null,o.init=null,o=null,e._operate=null};const n=()=>{const o=document.createElement("div"),n=e.content&&e.content.gifInfo&&e.content.gifInfo.imgPath||e.content.imagePath;let i=`\n      width: 100%;\n      height: 100%;\n      background: url(${n}) no-repeat;\n    `;e.content.gifInfo.imgPath||(i+="background-size: cover"),o.style.cssText=i,t.appendChild(o)};n()}function vf(e,t,o,n){const s=i["b"].state.device.iphone,{createAudio:a,playAudio:r,pauseAudio:c,seekAudio:l,loopAudio:d,destroyAudio:u}=bf();let p={btn:null,video:null,timer:0,isUpdateStart:!1,inited:!1,status:!1,onplayCallback:()=>{p.btn.classList.remove("play"),p.btn.classList.add("pause"),p.showAnimateHandle(),Ns.emit("component-layer-video::toggle",{hotspotId:e.id,status:!0})},onpauseCallback:()=>{p.btn.classList.remove("pause"),p.btn.classList.add("play"),p.hideAnimateHandle(),window.clearTimeout(p._timer),Ns.emit("component-layer-video::toggle",{hotspotId:e.id,status:!1})},ontimechangeCallback:()=>{!p.isUpdateStart&&p.video.currentTime<e.content.startTime&&(p.video.currentTime=e.content.startTime,p.isUpdateStart=!0)},onendCallback:()=>{p.video.currentTime=e.content.startTime,Qa(e.id,"isEnded",!0),e.content.replay&&(p.video.play(),d(!0),Ja(e.id,!1))},showAnimateHandle:()=>{p.btn.classList.add("is--show")},hideAnimateHandle:()=>{p.btn.classList.remove("is--show")},clickHandle:()=>{p.hideAnimateHandle(),window.clearTimeout(p._timer),p._timer=window.setTimeout(()=>{p.showAnimateHandle()},3e3)},togglePlay:()=>{p.video&&(p.video.paused?(p.video.play(),Ja(e.id,!1)):(p.video.pause(),Ja(e.id,!0)))},init:()=>{!p.inited&&p.video&&(s&&e.content.audiobuffer&&(p.video.muted=!0,a(e.content.audiobuffer,e.content.volume)),p.video.onplay=()=>{p.onplayCallback(),r()},p.video.onpause=()=>{p.onpauseCallback(),c()},p.video.ontimeupdate=()=>{e.content.startTime&&p.ontimechangeCallback()},p.video.onended=()=>{p.onendCallback()},p.video.onwaiting=()=>{c()},p.video.onplaying=()=>{l(p.video.currentTime),r()},p.video.oncanplaythrough=()=>{l(p.video.currentTime)},p.video.onseeking=()=>{c()},p.video.onseeked=()=>{l(p.video.currentTime),r()},p.inited=!0,Ka({pid:o,id:e.id,type:"selector_video",instance:p.video,isPauseMedia:e.content.isPauseMedia,isEventSelector:!n})),p.show()},show:()=>{p.video.volume=e.content.volume,e.content.autoplay&&(p.togglePlay(),e.content.startTime&&(p.video.currentTime=e.content.startTime))},hide:()=>{p.video&&(p.video.pause(),p.video.currrentTime=0,Ja(e.id,!0,{isHide:!0}))}};e._operate=p,e.destroy=()=>{delete p.timer,delete p.isUpdateStart,delete p.inited,delete p.status,p.btn=null,p.video=null,p.onplayCallback=null,p.onpauseCallback=null,p.ontimechangeCallback=null,p.onendCallback=null,p.showAnimateHandle=null,p.hideAnimateHandle=null,p.clickHandle=null,p.togglePlay=null,p.init=null,p.show=null,p.hide=null,p=null,e._operate=null,u()};const h=()=>{const o=document.createElement("video");o.className="is--video",o.style.width="100%",o.style.height="100%",o.style.objectFit="fill",o.setAttribute("crossOrigin","anonymous"),o.setAttribute("playsinline",""),o.setAttribute("webkit-playsinline",""),o.setAttribute("x5-video-player-type","h5"),o.src=e.content.videoPath,o.poster=e.content.videoPoster,o.volume=e.content.volume,o.preload="none",t.appendChild(o)},f=()=>{const o=document.createElement("div");o.className="is--video_btn play";const n=e.size.x/280;o.style.transform="scale("+n+")",o.style.transformOrigin="center",t.appendChild(o)};h(),f()}function bf(){let e=null;const t=(t,n)=>{const i=document.createElement("audio");i.src=t,i.volume=n,i.currentTime=0,e=i,o(),s(!1)},o=()=>{e&&e.paused&&e.play()},n=()=>{e&&!e.paused&&e.pause()},i=t=>{e&&(e.currentTime=t)},s=t=>{e&&(e.muted=t)},a=t=>{e&&(e.loop=t)},r=()=>{n(),e=null};return{createAudio:t,playAudio:o,pauseAudio:n,seekAudio:i,loopAudio:a,destroyAudio:r}}function gf(e,t){const o=e.content||{};let n={currentIndex:0,img:null,prevBtn:null,nextBtn:null,timer:0,inited:!1,status:!1,prev:()=>{if(!n.img)return;const e=(--n.currentIndex+o.imageSum)%o.imageSum;n.img.src=o.imagePaths[e],n.updateBtn(),n.img.setAttribute("data-index",e+"")},next:()=>{if(!n.img)return;const e=++n.currentIndex%o.imageSum;n.updateBtn(),n.img.src=o.imagePaths[e],n.img.setAttribute("data-index",e+"")},updateBtn:()=>{1===o.imageSum||o.autoplay||(n.currentIndex?n.currentIndex===o.imageSum-1?(n.prevBtn.classList.add("is--show"),n.nextBtn.classList.remove("is--show")):(n.prevBtn.classList.add("is--show"),n.nextBtn.classList.add("is--show")):(n.prevBtn.classList.remove("is--show"),n.nextBtn.classList.add("is--show")))},auto:()=>{clearInterval(n.timer),n.timer=window.setInterval(n.next,1e3*o.interval)},stop:()=>{clearInterval(n.timer)},reset:()=>{n.stop(),n.currentIndex=-1,n.next()},init:()=>{o.autoplay&&n.auto(),n.updateBtn(),n.inited||(n.inited=!0)}};e._operate=n,e.destroy=()=>{n.stop(),delete n.currentIndex,delete n.img,delete n.prevBtn,delete n.nextBtn,delete n.timer,delete n.inited,delete n.status,delete n.prev,delete n.next,delete n.auto,delete n.stop,delete n.reset,n=null,e._operate=null};const i=()=>{const e=document.createElement("img");e.style.width="100%",e.style.height="100%",e.src=o.imagePaths[n.currentIndex],e.setAttribute("data-index","0"),t.appendChild(e)};if(o.imagePaths&&i(),o.imagePaths&&!o.autoplay){const o=()=>{const o=document.createElement("div");o.className="is--imgs_btn is--left";const n=e.size.x/280;o.style.transform="scale("+n+")",o.style.transformOrigin="left center",t.appendChild(o)},n=()=>{const o=document.createElement("div");o.className="is--imgs_btn is--right";const n=e.size.x/280;o.style.transform="scale("+n+")",o.style.transformOrigin="right center",t.appendChild(o)};o(),n()}}function yf(e,t){const o=e.content||{};let n={cacheImgs:[],currentIndex:0,timer:0,resumeTimer:0,thenTime:0,canvas:null,ctx:null,hammerInstance:null,canvasWidth:0,canvasHeight:0,inited:!1,status:!1,next:e=>{n.currentIndex=void 0!==e?e:(n.currentIndex+1)%o.imageSum;const t=n.cacheImgs[n.currentIndex];t&&t.el&&n.ctx&&n.ctx.drawImage(t.el,0,0,n.canvasWidth,n.canvasHeight)},stop:()=>{clearTimeout(n.timer)},auto:()=>{n.next(),n.timer=window.setTimeout(n.auto,o.interval)},checkAuto:(e=!0)=>{o.autoplay&&(e?(window.clearTimeout(n.resumeTimer),n.resumeTimer=window.setTimeout(()=>{n.status&&(n.stop(),n.auto())},2e3)):(n.stop(),n.auto()))},preload:()=>{o.imagePaths.forEach((e,t)=>{const i=new Image;i.onload=function(){const e=n.cacheImgs.some(e=>e.index===t);e||(n.cacheImgs.push({el:i,index:t}),o.imageSum&&n.cacheImgs.length>=o.imageSum&&(n.cacheImgs=n.cacheImgs.sort((e,t)=>e.index-t.index),n.checkAuto(!1)))},i.src=e})},initHammer:()=>{const e=window.Hammer,t=Math.floor(360/o.imageSum);let i=0,s=0;n.hammerInstance=new e(n.canvas),n.hammerInstance.get("pan").set({direction:e.DIRECTION_HORIZONTAL}),n.hammerInstance.on("press panstart",(function(){n.stop(),i=n.currentIndex*t})),n.hammerInstance.on("pressup",(function(){n.checkAuto()})),n.hammerInstance.on("panmove",(function(e){const a=e.deltaX+i;let r=Math.floor(a/t)%o.imageSum;r<0&&(r+=o.imageSum),s=a,n.next(Math.abs(r))})),n.hammerInstance.on("panend",(function(){i=s,n.checkAuto()}))},reset:()=>{n.stop(),n.currentIndex=-1,n.next()},init:()=>{if(n.inited)n.checkAuto(!1);else{if(!n.canvas)return;n.canvas.parentNode.setAttribute("canscroll","true");const t=new Image;t.onload=function(){n.ctx=n.canvas.getContext("2d"),n.ctx&&(n.canvasWidth=n.canvas.width,n.canvasHeight=n.canvas.height,n.ctx.drawImage(t,0,0,n.canvasWidth,n.canvasHeight),n.currentIndex=(n.currentIndex+1)%o.imageSum)},t.src=o.imagePaths[n.currentIndex],n.inited=!0,n.preload(),e.hotspot&&e.hotspot.hotPotId||(n.initHammer(),n.canvas.addEventListener("mouseenter",n.onenter,!1),n.canvas.addEventListener("mouseleave",n.onleave,!1))}},onenter:()=>{Nu()},onleave:()=>{Vu()}};e._operate=n,e.destroy=()=>{n.reset(),n.canvas&&(n.canvas.removeEventListener("mouseenter",n.onenter,!1),n.canvas.removeEventListener("mouseleave",n.onleave,!1)),delete n.cacheImgs,delete n.currentIndex,delete n.timer,delete n.resumeTimer,delete n.thenTime,n.canvas=null,n.ctx=null,delete n.canvasWidth,delete n.canvasHeight,delete n.inited,delete n.status,n.next=null,n.stop=null,n.auto=null,n.checkAuto=null,n.preload=null,n.initHammer=null,n.reset=null,n.init=null,n.onenter=null,n.onleave=null,n.hammerInstance&&(n.hammerInstance.destroy(),n.hammerInstance=null),n=null,e._operate=null};const i=()=>{const o=document.createElement("canvas");o.width=e.size.x*window.devicePixelRatio,o.height=e.size.y*window.devicePixelRatio,o.style.width=e.size.x+"px",o.style.height=e.size.y+"px",t.appendChild(o)};o.imagePaths&&i()}function wf(e,t){let o="item--component";const n={position:"absolute",left:e.position.x+"px",top:e.position.y+"px",width:e.size.x+"px",height:e.size.y+"px",opacity:e.opacity,boxSizing:"border-box",overflow:"hidden","text-align":e.content.textAlignment,transform:`rotate(${e.rotateAngle}deg) translateZ(0)`,"will-change":"transform",display:""+(e.isShow?"block":"none"),"z-index":e.zIndex};[0,1,2,3].indexOf(e.type)>=0?(-1!==e.content.texteffect&&1!==e.content.texteffect||(n["display"]="flex",n["align-items"]="center",n["padding-right"]="5px"),e.content.bgcolor&&(n["background"]=dn(e.content.bgcolor,e.content.bgcolor.w/255)),o+=" forbid__move"):[5,6].indexOf(e.type)>=0?(n["background"]=dn(e.content.bgcolor,e.content.bgcolor.w/255),n["opacity"]=e.opacity,n["vertical-align"]="middle",6!==e.type?n["border-radius"]=e.radius+"px":n["border-radius"]="50%"):7===e.type?(n["background-size"]=`${e.size.x/6}px ${e.size.y/6}px`,o+=" is--sand"):12===e.type&&(o+=" forbid__move"),t.className=o,t.style.cssText=un(n)}function xf(e){let t=window.myKrp;t||(t=window.myKrp={}),t.componentClick||(t.componentClick=t=>{const o=Vo(t.target,"item--component");if(!o){const e=Vo(t.target,"selector__wrap");if(!e)return;const o=e.getAttribute("data-id")||0,n=i["b"].state.skyBoxSceneGroup.sceneList.filter(e=>e.id===Number(o))[0];return void nf(n)}const n=o.getAttribute("data-sid")||0,s=o.getAttribute("data-id")||0,a=o.getAttribute("data-index")||0,r=o.getAttribute("data-type")||0,c=i["b"].state.skyBoxSceneGroup.sceneList.filter(e=>e.id===Number(n))[0],l=c.components[a];l&&(Sf(n,s,l,e),l.jumpSceneId||l.hotspot||(10===Number(r)&&(kf(t.target,o,l),t.stopPropagation()),8===Number(r)&&Of(t.target,o,l)))})}function Sf(e,t,o,n){o.jumpSceneId?(of({sid:e,cdata:o,type:2}),Ns.emit(Fs,{sceneId:o.jumpSceneId,startTime:o.jumpSceneStartTime})):o.hotspot?(of({sid:e,cdata:o,type:1}),Ns.emit(ba,{pid:Number(e),...o.hotspot,isSelectorHot:!0,isEventSelector:!n})):of({sid:e,cdata:o,type:3})}function If(e,t,o){t._operate&&(t._operate.inited||(t._operate.txtWrap=e,t._operate.txtNode=e.children[0]),t._operate.status=o,o?t._operate.init():t._operate.hide())}function kf(e,t,o,n){o._operate&&(o._operate.inited||(o._operate.video=t.querySelector("video"),o._operate.btn=t.querySelector(".is--video_btn")),"boolean"===typeof n&&(o._operate.status=n,n?o._operate.init():o._operate.hide()),e&&e.classList.contains("is--video")?o._operate.clickHandle():e&&e.classList.contains("is--video_btn")&&o._operate.togglePlay())}function Of(e,t,o,n){o._operate&&(o._operate.inited||(o._operate.img=t.querySelector("img"),o._operate.prevBtn=t.querySelector(".is--imgs_btn.is--left"),o._operate.nextBtn=t.querySelector(".is--imgs_btn.is--right")),"boolean"===typeof n&&(o._operate.status=n,n?o._operate.init():o._operate.reset()),o.content.autoplay||(e===o._operate.prevBtn?o._operate.prev():e===o._operate.nextBtn&&o._operate.next()))}function jf(e,t,o){t._operate&&(t._operate.inited||(t._operate.canvas=e.querySelector("canvas")),t._operate.status=o,o?t._operate.init():t._operate.reset())}function Cf(e,t,o){t._operate&&(t._operate.inited||(t._operate.imgWrap=e.children[0]),t._operate.status=o,o?t._operate.init():t._operate.reset())}function Ef(e,t=!0){const o=document.querySelectorAll(".my--selector_container"),n=Array.from(o).filter(t=>Number(t.getAttribute("data-id"))===e);let s=n[0];const a=i["b"].state.skyBoxSceneGroup.sceneList.filter(t=>t.id===e)[0];if(a.isGlobal&&(s=n[1]),!s)return;const r=s.querySelectorAll(".item--component");Array.from(r).forEach(e=>{const o=Number(e.getAttribute("data-id"))||0,n=Number(e.getAttribute("data-type"))||0,i=a.components.filter(e=>e.id===o)[0];switch(n){case 0:case 1:case 2:case 3:If(e,i,t);break;case 8:Of(null,e,i,t);break;case 9:Cf(e,i,t);break;case 10:kf(null,e,i,t);break;case 12:jf(e,i,t);break;default:break}})}function Tf(){const e=e=>{bc.emit("action",{key:"parentComponent",data:{id:e.id,statisticsProperity:e.statisticsProperity}})},t=({sid:e,cdata:t,type:o})=>{bc.emit("action",{key:"component",data:{pid:e,id:t.id,type:o,statisticsProperity:t.statisticsProperity}})};return{reportSelectorClick:e,reportComponentClick:t}}class Pf extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,e["textSize"]=wn(e.content),this.initTxtComponent(e),this.initImgComponent(e),e.exclose&&this.initCloseComponent(e),this.cid=e.id,this._events=t||{},this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initImgComponent(e){const t=Do(e.fixed),{offset:o}=e.fixed;e.content.displayAlign&&(e.content.displayMode?t.offset.y=o.y-.5*e.textSize.y:t.offset.x=o.x-.5*e.textSize.x),e.content.displayAlign||e.content.displayMode||(t.offset.x=o.x-.5*e.textSize.x),3===e.content.showStyle&&!e.content.displayAlign&&e.content.displayMode&&(t.offset.y=t.offset.y-.5*e.textSize.y),this.el=new Hl({id:e.id,key:e.key,fixed:t,other:e.other,content:e.content,txtInfo:e.txtInfo,events:Pl.bind(this)()}),super.push(this.el)}initTxtComponent(e){const t=Do(e.fixed),{offset:o}=e.fixed,n=e.content.size;e.content.displayAlign?e.content.displayMode?t.offset.y=o.y+.5*n.y:(t.offset.x=o.x+.5*e.textSize.x,t.offset.y=o.y-.5*(n.y-e.textSize.y)):e.content.displayMode?3===e.content.showStyle?t.offset.y=o.y+.5*e.textSize.x:t.offset.y=o.y+n.y:(t.offset.x=o.x+.5*e.textSize.x,3===e.content.showStyle&&(t.offset.y=o.y-.5*(n.y-e.textSize.y)));const i=new yd({id:e.id,key:e.key+"_txt",fixed:t,other:e.other,content:e.content,txtInfo:e.txtInfo,events:Pl.bind(this)()});super.push(i)}initCloseComponent(e){let t=e.content.size.x/2,o=-1*e.content.size.y/2;e.content.displayAlign&&(e.content.displayMode?o-=.5*e.textSize.y:t+=.5*e.textSize.x);const n=zo(e.fixed,{offset:{x:t,y:o},opacity:1}),i=new Hl({key:"sclose_"+e.id,fixed:n,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({click:()=>{this._events.onclose&&this._events.onclose()}})});super.push(i)}onshow(){this.el&&this.el instanceof Hl&&this.el.startCropAnimation()}onhide(){this.el&&this.el instanceof Hl&&this.el.stopCropAnimation()}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null)}}var _f=Pf;class Af extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.options=e||{},this.el=null,e["textSize"]=wn(e.content),this.initTxtComponent(e),this.initImgComponent(e),e.exclose&&this.initCloseComponent(e),this.cid=e.id,this._events=t||{},this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initImgComponent(e){const t=Do(e.fixed),{offset:o}=e.fixed;e.content.displayAlign&&(e.content.displayMode?t.offset.y=o.y-.5*e.textSize.y:t.offset.x=o.x-.5*e.textSize.x),e.content.displayAlign||e.content.displayMode||(t.offset.x=o.x-.5*e.textSize.x),3===e.content.showStyle&&!e.content.displayAlign&&e.content.displayMode&&(t.offset.y=t.offset.y-.5*e.textSize.y),this.el=new Hl({id:e.id,key:e.key,fixed:t,other:e.other,content:e.content,txtInfo:e.txtInfo,events:Pl.bind(this)()}),super.push(this.el)}initTxtComponent(e){const t=Do(e.fixed),{offset:o}=e.fixed,n=e.content.size;e.content.displayAlign?e.content.displayMode?t.offset.y=o.y+.5*n.y:(t.offset.x=o.x+.5*e.textSize.x,t.offset.y=o.y-.5*(n.y-e.textSize.y)):e.content.displayMode?3===e.content.showStyle?t.offset.y=o.y+.5*e.textSize.x:t.offset.y=o.y+n.y:(t.offset.x=o.x+.5*e.textSize.x,3===e.content.showStyle&&(t.offset.y=o.y-.5*(n.y-e.textSize.y))),this.el=new yd({id:e.id,key:e.key+"_txt",fixed:t,other:e.other,content:e.content,txtInfo:e.txtInfo,events:Pl.bind(this)()}),super.push(this.el)}initCloseComponent(e){let t=e.content.size.x/2,o=-1*e.content.size.y/2;e.content.displayAlign&&(e.content.displayMode?o-=.5*e.textSize.y:t+=.5*e.textSize.x);const n=zo(e.fixed,{offset:{x:t,y:o},opacity:1}),i=new Hl({key:"sclose_"+e.id,fixed:n,other:{handcursor:!0},content:{path:"%$prevPath%/skin/assets/close.png",size:{x:36,y:36},crop:"0|0|36|36",onovercrop:"0|36|36|36"},events:Pl.bind(this)({click:()=>{this._events.onclose&&this._events.onclose()}})});super.push(i)}onshow(){this.el&&this.el instanceof Hl&&this.el.startCropAnimation()}onhide(){this.el&&this.el instanceof Hl&&this.el.stopCropAnimation()}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null)}}var Mf=Af;class Hf extends Tl{constructor(e){super(e);const t=_l();this.options=zo(t,e),this.key=this.options.key,this.el=null,this.infos={canvas:null,ctx:null,isupdatesize:!1},this.create(this.setConfig())}setConfig(){const e=i["b"].state.sceneInfo.is2dRender,t=i["b"].state.sceneInfo.is2dRender?1e3:this.options.fixed.depth,o=e?1:this.options.fixed.scale,n={type:"image",renderer:"css3d",ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,url:"%$prevPath%/skin/assets/transparent.png",ox:this.options.fixed.offset.x*o,oy:this.options.fixed.offset.y*o,oref:1,rotationorder:"ZXY",rx:this.options.fixed.rotate.rx,ry:this.options.fixed.rotate.ry,rz:this.options.fixed.rotate.rz,rotate:e?this.options.fixed.rotate.rz:0,tx:this.options.fixed.translate.x,ty:this.options.fixed.translate.y,tz:this.options.fixed.translate.z,edge:this.options.fixed.edge,width:this.options.content.size.x,height:this.options.content.size.y,handcursor:this.options.other.handcursor,capture:!1,scale:sn.value*an.value*this.options.fixed.scale,depth:t,zoom:e,distorted:!e,enabled:this.options.other.enabled,visible:this.options.fixed.visible,zorder:this.options.fixed.zorder,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),this.addHtmlStrToSprite(),this.saveInstanceToParent(),this.initCanvas(),super.onloaded()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return n}create(e){new Cl(i["b"].state.krp,this.options.key,e)}getHtmlStrByCss3d(){return`<canvas style="width: 100%;height: 100%;opacity: ${this.options.fixed.opacity}"></canvas>`}addHtmlStrToSprite(){if(!this.el||!this.el.sprite)return;const e=document.createElement("div");if(e.className="my--event",e.style.cssText="\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      border: 0;\n      text-align: center;\n    ",this.options.exclose){const t=document.createElement("span");t.className="css3d-close";const o=i["b"].state.device.mobile?"ontouchend":"onclick";t.setAttribute(o,`myKrp.onhidecss3dhotspot(${this.options.id})`),e.appendChild(t)}e.innerHTML+=this.getHtmlStrByCss3d(),this.el.registercontentsize(this.options.content.size.x,this.options.content.size.y),this.el.sprite.appendChild(e)}saveInstanceToParent(){this.updateInstance(this.el)}initCanvas(){this.el&&this.el.sprite&&(this.infos.canvas=this.el.sprite.querySelector("canvas"),this.infos.canvas&&(this.infos.canvas.width=this.options.content.size.x*window.devicePixelRatio,this.infos.canvas.height=this.options.content.size.y*window.devicePixelRatio,this.infos.ctx=this.infos.canvas.getContext("2d"),"string"===typeof this.options.content.path?this.updatePath(this.options.content.path):this.updateTexture(this.options.content.path)))}updateCanvasSize(){if(this.infos.isupdatesize||!this.infos.canvas)return;const e=Ro({x:this.infos.canvas.width,y:this.infos.canvas.height},this.options.content.size);this.infos.canvas.style.width=e.x+"px",this.infos.canvas.style.height=e.y+"px",this.infos.isupdatesize=!0}loadTexture(e){return new Promise(t=>{const o=new window.Image;o.onload=()=>{t(o)},o.src=e})}updatePath(e){this.loadTexture(e).then(e=>{this.options.events.ontextureupdate&&this.options.events.ontextureupdate(e),this.updateTexture(e)})}updateTexture(e){const t=e.width>1e3||e.height>1e3,o=Math.min(this.el.width/e.naturalWidth,1),n=(t?o:1)*window.devicePixelRatio;this.infos.canvas.width=e.width*n,this.infos.canvas.height=e.height*n,this.updateCanvasSize(),this.infos.ctx.clearRect(0,0,this.infos.canvas.width,this.infos.canvas.height),this.infos.ctx.drawImage(e,0,0,e.width,e.height,0,0,this.infos.canvas.width,this.infos.canvas.height)}destroy(){super.destroy(),this.el&&(this.el=null)}}var zf=Hf;function Lf(e,t=!1){const o=.9*window.innerWidth,n=.9*window.innerHeight;let i=e.x,s=e.y;const a=Math.max(e.y/n,1),r=Math.max(e.x/o,1);return t||(r>1||a>1)&&(r>=a?(i=o,s=o*e.y/e.x):(i=n*e.x/e.y,s=n)),{w:i,h:s}}function Df(e,t){const o=t.x,n=t.y;let i=e.x,s=e.y;const a=Math.max(e.y/n,1),r=Math.max(e.x/o,1);return(r>1||a>1)&&(r>=a?(i=o,s=o*e.y/e.x):(i=n*e.x/e.y,s=n)),{x:Math.round(i),y:Math.round(s)}}class Bf extends Ol{constructor(e,t){const o={id:e.id,fixed:e.fixed,expand:e.expand};super(o),this.el=null,this.options=e||{},this.playData={currentIdx:0,autoStartTime:0,interval:Math.ceil(1e3/e.content.playSpeed),len:e.content.paths.length,timer:0,playRAF:0,dragRAF:0,mouseStart:0,isDraged:!1,delayTimer:0,delayTime:3e3,delayControlTimer:0,delayControlTime:100},this.infos={maxWidth:600,maxHeight:600,imgEls:[]},this.cid=e.id,this.worker=null,this.pressPassCount=0,this.events=Al(t,{show:this.onShow.bind(this),hide:this.onHide.bind(this),down:this.onDown.bind(this),up:this.onUp.bind(this)}),this.pressData={canvas:null,ctx:null},this.initPressWorker(),this.compressList()}initImageComponent(){this.el=new zf({id:this.options.id,key:this.options.key,fixed:this.options.fixed,other:this.options.other,expand:this.options.expand,content:{path:this.infos.imgEls[0].value,size:this.options.content.size},exclose:this.options.exclose,events:Pl.bind(this)()}),super.push(this.el)}compressList(){this.options.content.paths.forEach((e,t)=>{const o=this.getPressImgCached(e);o?(this.pressPassCount++,this.pressPassCount===this.options.content.paths.length&&this.onAllCompressComplete()):this.compressImg(e,t)})}compressImg(e,t){this.getImgBlobByPath(e).then(o=>{var n;window.OffscreenCanvas?null===(n=this.worker)||void 0===n||n.postMessage({key:e,index:t,blob:o}):this.pressImgByMain(e,t,o)})}pressImgByMain(e,t,o){this.pressData.canvas||(this.pressData.canvas=document.createElement("canvas"),this.pressData.ctx=this.pressData.canvas.getContext("2d")),createImageBitmap(o).then(o=>{const n=Df({x:o.width,y:o.height},{x:this.infos.maxWidth,y:this.infos.maxHeight});this.pressData.canvas.width=n.x,this.pressData.canvas.height=n.y,this.pressData.ctx.clearRect(0,0,this.pressData.canvas.width,this.pressData.canvas.height),this.pressData.ctx.drawImage(o,0,0,o.width,o.height,0,0,this.pressData.canvas.width,this.pressData.canvas.height),this.pressData.canvas.toBlob(o=>{createImageBitmap(o).then(o=>{this.onCompressComplete({key:e,index:t,imageBit:o})})})})}initPressWorker(){if(window.OffscreenCanvas){const e=a()+"workers/pressImg.js";this.worker=new window.Worker(e),this.worker&&(this.worker.onmessage=e=>{this.onCompressComplete(e.data)})}}onAllCompressComplete(){window.console.log("全部压缩完成"),this.pressData.canvas=null,this.worker&&this.worker.terminate(),this.options.content.paths.forEach((e,t)=>{this.infos.imgEls.push({key:e,index:t,value:this.getPressImgCached(e)})}),this.initImageComponent()}onCompressComplete(e){this.savePressImgToCache(e.key,e.imageBit),this.pressPassCount++,this.pressPassCount===this.options.content.paths.length&&this.onAllCompressComplete()}getPressImgCached(e){const t=window;return t.pressImgMap||(t.pressImgMap=new Map),t.pressImgMap.get(e)}savePressImgToCache(e,t){const o=window;o.pressImgMap||(o.pressImgMap=new Map),o.pressImgMap.get(e)||o.pressImgMap.set(e,t)}getImgBlobByPath(e){return new Promise(t=>{fetch(e).then(e=>e.blob()).then(e=>{t(e)})})}prev(){var e;this.el&&(this.playData.currentIdx=Math.abs((this.playData.currentIdx-1+this.playData.len)%this.playData.len),null!==(e=this.infos.imgEls[this.playData.currentIdx])&&void 0!==e&&e.value&&this.el.updateTexture(this.infos.imgEls[this.playData.currentIdx].value))}next(){var e;this.el&&(this.playData.currentIdx=(this.playData.currentIdx+1)%this.playData.len,null!==(e=this.infos.imgEls[this.playData.currentIdx])&&void 0!==e&&e.value&&this.el.updateTexture(this.infos.imgEls[this.playData.currentIdx].value))}auto(){if(!this.options.content.isAutoPlay)return;const e=new Date,t=e-this.playData.autoStartTime||0;t>this.playData.interval&&(this.playData.autoStartTime=e-t%this.playData.interval,this.next()),this.playData.playRAF=requestAnimationFrame(this.auto.bind(this))}stop(){cancelAnimationFrame(this.playData.playRAF)}onDown(){this.el&&(clearTimeout(this.playData.delayTimer),clearTimeout(this.playData.delayControlTimer),this.playData.isDraged=!0,Nu(),cancelAnimationFrame(this.playData.playRAF),this.playData.mouseStart=i["b"].state.krp.get("mouse").stagex,this.stop(),this.onMove())}onMove(){const e=i["b"].state.krp.get("mouse"),t=e.stagex-this.playData.mouseStart;t>5&&(this.playData.mouseStart=e.stagex,this.next()),t<-5&&(this.playData.mouseStart=e.stagex,this.prev()),this.playData.dragRAF=requestAnimationFrame(this.onMove.bind(this))}onUp(){this.playData.isDraged=!1,cancelAnimationFrame(this.playData.dragRAF),this.options.content.isAutoPlay&&(clearTimeout(this.playData.delayTimer),this.playData.delayTimer=setTimeout(()=>{this.auto()},this.playData.delayTime)),clearTimeout(this.playData.delayControlTimer),this.playData.delayControlTimer=setTimeout(()=>{Vu()},this.playData.delayControlTime)}onShow(){this.el&&this.auto()}onHide(){clearTimeout(this.playData.delayTimer),cancelAnimationFrame(this.playData.playRAF),cancelAnimationFrame(this.playData.dragRAF),this.playData.currentIdx=0}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null)}}var Nf=Bf;class Vf{constructor(e){this.options=e,this.key=this.options.key,this.el=null,this.status=!0,this.create(this.setConfig())}setConfig(){var e,t,o;const n=i["b"].state.sceneInfo.is2dRender,s=i["b"].state.sceneInfo.is2dRender?1e3:this.options.depth,a=this.options.size?Math.min(this.options.size.x,this.options.size.y):120,r=Math.min(30,Math.max(a/4,20)),c={type:"image",renderer:"css3d",ath:this.options.position.x,atv:this.options.position.y,url:"%$prevPath%/skin/assets/transparent.png",oref:1,rotationorder:"ZXY",rx:(null===(e=this.options.rotate)||void 0===e?void 0:e.rx)||0,ry:(null===(t=this.options.rotate)||void 0===t?void 0:t.ry)||0,rz:(null===(o=this.options.rotate)||void 0===o?void 0:o.rz)||0,width:r,height:r,scale:sn.value*an.value,depth:s,zoom:n,distorted:!n,visible:!1,zorder:100,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),this.addLoading(r),this.status&&this.show()}};return c}create(e){new Cl(i["b"].state.krp,this.options.key,e)}addLoading(e){if(!this.el||!this.el.sprite)return;const t=document.createElement("div");t.style.cssText="\n      width: 100%;\n      height: 100%\n    ";const o=`\n      width: ${e}px;\n      height: ${e}px;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-left: ${-e/2}px;\n      margin-top: ${-e/2}px;\n    `,n="@keyframes loading {\n        0% {\n            opacity: 0;\n        }\n        25% {\n            opacity: 1;\n        }\n        50% {\n            opacity: 0.5;\n        }\n        75% {\n            opacity: 0.25;\n        }\n        100% {\n            opacity: 0;\n        }\n    }",i=`\n      position: absolute;\n      width: ${e/4}px;\n      height: ${e/4}px;\n      background-color: #000;\n      border-radius: 50%;\n      animation: loading 0.8s both infinite;\n    `,s=`\n      <div style="${o}">\n        <div style="${i} top: 0; left: 0; animation-delay: 0s;"></div>\n        <div style="${i} top: 0; right: 0; animation-delay: 0.2s;"></div>\n        <div style="${i} bottom: 0; right: 0; animation-delay: 0.4s;"></div>\n        <div style="${i} bottom: 0; left: 0; animation-delay: 0.6s;"></div>\n      </div>\n      <div style="${o} transform: rotate(45deg);">\n        <div style="${i} top: 0; left: 0; animation-delay: 0.1s;"></div>\n        <div style="${i} top: 0; right: 0; animation-delay: 0.3s;"></div>\n        <div style="${i} bottom: 0; right: 0; animation-delay: 0.5s;"></div>\n        <div style="${i} bottom: 0; left: 0; animation-delay: 0.7s;"></div>\n      </div>\n    `;if(!this.getkeyframes("loading")){const e=document.createElement("style");e.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(e)}t.innerHTML=s,this.el.registercontentsize(e,e),this.el.sprite.appendChild(t)}getkeyframes(e){const t=Array.prototype.slice.call(document.styleSheets)||[],o=t.some(t=>t.cssRules[0]&&t.cssRules[0].name&&t.cssRules[0].name===e);return o}show(){this.el&&(this.el.visible=!0)}hide(){this.status=!1,this.el&&(this.el.visible=!1,this.status=!0)}destroy(){this.el&&(this.el.destroy&&this.el.destroy(),this.el=null)}}var Rf=Vf;function Ff(){const e=[],t=t=>e.find(e=>e.key===t),o=(o,n)=>{const i=t(o);if(i)i.instance.show();else{n.key=o;const t=new Rf(n);e.push({key:o,instance:t,rendered:!0})}},n=e=>{const o=t(e);o&&o.rendered&&o.instance.hide()};return{showLoading:o,hideLoading:n}}const{showLoading:Gf,hideLoading:Wf}=Ff(),{isReadyComplete:$f}=Ym(),{renderNormalIcon:Uf,renderMarkIcon:Xf,renderBubbleIcon:Yf,renderPolyIcon:Zf}=qm(),{renderSingerHotspot:qf,destroyRender:Kf}=Zm($f),{showAllHotspots:Jf,checkHotspotRenderAndShow:Qf,checkHotspotRenderAndHide:em,showHotspot:tm,hideHotspot:om}=Km(),{dragstart:nm,dragend:im}=Qm(),{replayHotspotAnimation:sm,checkShowAndStartAnimation:am,checkHideAndStopAnimation:rm,getCmAnimationPlayingStatus:cm,resetHotspotAnimation:lm}=Jm();ev();const{initTriggerAction:dm,stopTriggerAction:um}=ov(),{hotOver:pm,hotOut:hm,hotClick:fm}=tv(),{renderText:mm,renderImage:vm,renderVideo:bm,renderSwitch:gm,renderImages:ym,renderImageText:wm,renderModel:xm,renderRing:Sm,renderLive:Im,renderApp:km,renderAudio:Om,renderLink:jm,renderAudioImgTxt:Cm}=iv(),{renderSingerContent:Em,destroyContentRender:Tm}=nv(),{showCallback:Pm,hideCallback:_m,hideContent:Am,checkContentRenderAndToggle:Mm,checkContentRenderAndShow:Hm,checkContentRenderAndHide:zm,destroyContentVisibleSpace:Lm}=sv(),{checkConditionTrigger:Dm}=cv(),{bindLinktoForcePlay:Bm,updateLinktoForcePlay:Nm,stopLinktoForcePlay:Vm,destroyForcePlaySpace:Rm}=lv(),{completeCallback:Fm}=av(),{showMediaCallback:Gm,hideMediaCallback:Wm}=uv(),{reportNormalHotspot:$m,reportSceneHotspot:Um}=fv();function Xm(){rv()}function Ym(){const e=Object(n["ref"])(!1),t=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});return Object(n["watch"])(()=>t.value,t=>{e.value=t}),{isReadyComplete:e}}function Zm(e){const t={},o=e=>{const t="hotspot_"+e.id,o=1!==i["b"].state.sceneInfo.type&&!e.iconData.isModelIcon;bl(e.id,t,o);const n=s(e);du(t,[n]),e.forceProperty&&2!==e.forceProperty.forcePlayType&&e.forceProperty.forcePlayTime&&(Bm(e.id,e.forceProperty),1===e.forceProperty.forcePlayType&&(e.isInvolveForcePlay=!0))},s=e=>{let t=null;switch(e.showStyle){case 0:t=Uf(e);break;case 1:t=Xf(e);break;case 2:t=Yf(e);break;case 3:t=Zf(e);break;default:break}return t},a=e=>{if(t[e])return;const n=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);n&&(t[e]=!0,o(n))},r=()=>{i["b"].state.sceneInfo.hotspots.forEach(e=>{o(e)})},c=()=>{for(const e in t)t[e]=!1,delete t[e]};return Object(n["watch"])(()=>e.value,e=>{e&&1!==i["b"].state.sceneInfo.type&&r()}),{renderSingerHotspot:a,destroyRender:c}}function qm(){const e=e=>{var t,o,n,i,s,a;const r={position:zu(e.id,"position"),rotate:zu(e.id,"rotate"),scale:zu(e.id,"scale"),opacity:zu(e.id,"opacity")};return{position:null!==(t=r.position)&&void 0!==t?t:e.position,rotate:null!==(o=r.rotate)&&void 0!==o?o:e.rotate,scale:null!==(n=r.scale)&&void 0!==n?n:e.scale,opacity:null!==(i=r.opacity)&&void 0!==i?i:1,depth:72*(null!==(s=null===(a=r.position)||void 0===a?void 0:a.z)&&void 0!==s?s:e.radius),zorder:e.zorder}},t=e=>({loaded(){gl("hotspot_"+e.id,!0);const t=1!==i["b"].state.sceneInfo.type&&!e.iconData.isModelIcon,o=zu(e.id,"visible"),n=null==o?e.isShow:o;!t&&n&&Qf(e.id)},show(){am(e.id),xl("hotspot_"+e.id,!0);const t=zu(e.id,"open");t&&(Lu(e.id,"open",!1),Hm(e.id));const o=zu(e.id,"aniId");o>0&&sm(e.id,o)},hide(){rm(e.id),xl("hotspot_"+e.id,!1)},down(){e.isAllowDrag&&nm(e.id),dm(e.id,2)},up(){e.isAllowDrag&&im(),dm(e.id,3)},over(){pm(e),dm(e.id,0)},out(){hm(e),dm(e.id,1)},click(){fm(e)}}),o=o=>{let n=null;const i={id:o.id,key:"hotspot_"+o.id,fixed:e(o),type:o.type,other:{handcursor:!0}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),o.iconData.isModelIcon?(i.content={geoPath:o.iconData.iconPath,mtlPath:o.iconData.mtlPath,scaleSize:o.iconData.modelScale,autoRotate:!0},n=new Gh(i,t(o))):(i.content={path:o.iconData.iconPath,gifInfo:o.iconData.gifInfo,size:o.iconData.showSize},n=new $h(i,t(o))),n},n=o=>{let n=null;const i={id:o.id,key:"hotspot_"+o.id,fixed:e(o),type:o.type,other:{handcursor:!0,destorted:o.destorted}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),o.iconData&&(i.content={lineLength:o.iconData.lineLength,lineColor:o.iconData.lineColor,linePos:o.iconData.linePos},n=new Xh(i,t(o))),n},s=o=>{let n=null;const i={id:o.id,key:"hotspot_"+o.id,fixed:e(o),type:o.type,other:{handcursor:!0}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),o.iconData&&(i.content={path:o.iconData.iconPath,stype:o.iconData.type,gifInfo:o.iconData.gifInfo,size:o.iconData.showSize},n=new Zh(i,t(o))),n},a=o=>{let n=null;const i={id:o.id,key:"hotspot_"+o.id,fixed:e(o),type:o.type,other:{handcursor:!0}};return o.name&&o.showName&&(i.titleContent={title:o.name,font:{family:o.fontStyle.fontFamily,size:o.fontStyle.fontSize,color:o.fontStyle.fontColor,wordspace:o.fontStyle.wordSpace,rowspace:o.fontStyle.rowSpace,bolid:o.fontStyle.bold,italic:o.fontStyle.italic,underline:o.fontStyle.underline,align:o.fontStyle.fontAlign},background:{color:o.fontStyle.backgroundColor,opacity:o.fontStyle.backgroundAlpha},size:{x:o.fontStyle.showSize.x,y:o.fontStyle.showSize.y}}),o.iconData&&(i.content={points:o.iconData.points,title:{position:o.iconData.titlePos,radius:o.iconData.titleRadius},border:{color:o.iconData.borderColor,opacity:o.iconData.borderOpacity},background:{color:o.iconData.backColor,opacity:o.iconData.backOpacity}},n=new Qh(i,t(o))),n};return{renderNormalIcon:o,renderMarkIcon:n,renderBubbleIcon:s,renderPolyIcon:a}}function Km(){const e=e=>{const t="hotspot_"+e;gu(t)},t=e=>{const t="hotspot_"+e;yu(t)},o=()=>{i["b"].state.sceneInfo.hotspots.forEach(t=>{const o=zu(t.id,"visible"),n=null==o?t.isShow:o;n&&e(t.id)})},n=()=>{i["b"].state.sceneInfo.hotspots.forEach(e=>{t(e.id)})},s={},a=e=>s[e],r=t=>{const o="hotspot_"+t,n=yl(o);let r=a(t);0===i["b"].state.sceneInfo.type&&(r=!0),n?r&&e(t):(qf(t),s[t]=!0)},c=e=>{const o="hotspot_"+e,n=yl(o);n?t(e):s[e]=!1};return{showHotspot:e,hideHotspot:t,showAllHotspots:o,hideAllHotspots:n,checkHotspotRenderAndShow:r,checkHotspotRenderAndHide:c}}function Jm(){const e=(e,t)=>{const o=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);if(!o||!o.animationInfos||!o.animationInfos.length)return null;let n=o.animationInfos[o.animationInfos.length-1];return t&&(n=o.animationInfos.find(e=>e.id===t)),n.initial||(n.initial={translate:{ath:o.position.x,atv:o.position.y,radius:o.radius},rotate:o.rotate,opacity:{value:o.opacity},scale:{value:o.scale},visible:{value:!0}}),n},t=(t,n)=>{const i=e(t,n);if(!i)return;const s=t+"_"+n,a="hotspot_"+t;Qd(s,i,{start(){iu(s,"complete",!1)},translate(e){pu(a,e);const o="hotspot_con_"+t;pu(o,e)},rotate(e){fu(a,e)},scale(e){mu(a,e)},opacity(e){bu(a,e)},visible(e){hu(a,e)},end(){o(t,n)}})},o=(t,o)=>{const n=e(t,o);if(!n)return;const i=t+"_"+o,s=n.isRecover||n.isLoop;s&&ou(i),n.isLoop?eu(i):(iu(i,"complete",!0),iu(i,"paused",!0))},n=(e,o)=>{c(e);const n=e+"_"+o,i=nu(n);i.rendered||t(e,o),ou(n),i.paused&&eu(n)},s=(e,o)=>{const n=e+"_"+o,i=nu(n);i.rendered||t(e,o),i.paused&&eu(n)},a=(e,t)=>{const o=e+"_"+t,n=nu(o);n.rendered&&!n.paused&&tu(o)},r=(e,t)=>{const o=e+"_"+t,n=nu(o);n.rendered&&ou(o)},c=e=>{const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);t&&t.animationInfos.filter(t=>{a(e,t.id),r(e,t.id)})},l=e=>{const t=su(e);return!!t&&!t.paused},d=e=>{const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);if(!t||!t.animationInfos||!t.animationInfos.length)return null;const o=t.animationInfos.filter(e=>0===e.trigType),n=o[o.length-1];if(n){let t=e+"_"+n.id;const o=su(e);o&&(t=o.key);let i=!1;if(o&&(i=o.complete),!i){const o=Number(t.split("_").pop());s(e,o)}}},u=e=>{const t=su(e);t&&tu(t.key)};return{replayHotspotAnimation:n,resetHotspotAnimation:r,checkShowAndStartAnimation:d,checkHideAndStopAnimation:u,getCmAnimationPlayingStatus:l}}function Qm(){const e={press:!1,timer:0,dis:{startx:0,starty:0,movex:0,movey:0},end:{x:0,y:0,z:0}};let t="";const o={x:window.innerWidth,y:window.innerHeight},n=t=>{const o=cm(t),n=Sl("hotspot_con_"+t);return e.press||e.timer||o||n||i["b"].state.pageStatus.airpose},s=o=>{if(i["b"].state.pageStatus.airpose)return;const s="hotspot_"+o;if(n(o))return;Nu(),t=s;const r=lu(s);e.press=!0,e.end.x=r.position.x,e.end.y=r.position.y;const c=i["b"].state.krp.spheretoscreen(e.end.x,e.end.y),l=i["b"].state.krp.get("mouse");e.dis.startx=l.stagex-c.x,e.dis.starty=l.stagey-c.y,a()},a=()=>{if(i["b"].state.touch.doubleFinger)return void r();const n=i["b"].state.krp.get("mouse"),s=Math.max(0,Math.min(n.stagex,o.x)),c=Math.max(0,Math.min(n.stagey,o.y));e.dis.movex=s-e.dis.startx,e.dis.movey=c-e.dis.starty;const l=i["b"].state.krp.screentosphere(e.dis.movex,e.dis.movey);t&&pu(t,l),e.end=l,e.timer=requestAnimationFrame(a)},r=()=>{if(i["b"].state.pageStatus.airpose)return;cancelAnimationFrame(e.timer),e.timer=0,e.press=!1;const o=t.split("_").pop();pu("hotspot_con_"+o,e.end),Vu()};return{dragstart:s,dragend:r}}function ev(){const e=Object(n["computed"])(()=>i["b"].state.sceneInfo.hotspots.filter(e=>e.follow.enable&&e.follow.points.length)),t=t=>{const n=e.value.filter(e=>{const o=0,n=e.follow.points[e.follow.points.length-1].time;return t>=o&&t<=n});n.forEach(e=>{const n=e.follow.points.findIndex(e=>t<e.time);if(n>=0){const i=n>0?e.follow.points[n-1]:{position:e.follow.position,time:0},s=e.follow.points[n],a=(t-i.time)/(s.time-i.time),r=i.position.x+a*(s.position.x-i.position.x),c=i.position.y+a*(s.position.y-i.position.y);o(e.id,r,c)}})},o=(e,t,o)=>{const n="hotspot_"+e;pu(n,{x:t,y:o,z:0});const i="hotspot_con_"+e;pu(i,{x:t,y:o,z:0})};Object(n["watch"])(()=>i["b"].state.scenevideo.time,e=>{t(e)})}function tv(){const e=e=>{i["b"].state.pageStatus.popup||2!==e.displayMode||i["b"].state.device.mobile||Hm(e.id)},t=e=>{const t=!i["b"].state.device.mobile&&0===e.displayAlign,o=5===e.type;2===e.displayMode&&(t||o)&&zm(e.id)},o=e=>{if(3===e.displayMode&&!Sl("hotspot_con_"+e.id))return;const t=3===e.displayMode&&Sl("hotspot_con_"+e.id);(t||0===e.displayMode||2===e.displayMode&&i["b"].state.device.mobile)&&Mm(e.id)};return{hotOver:e,hotOut:t,hotClick:o}}function ov(){const e=(e,t)=>{const o=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e),n=!o||i["b"].state.pageStatus.popup,s=o&&[1,2].indexOf(o.displayAlign)>=0&&2===o.displayMode;if(n||s)return;const a=o.isEnableGlobalTriEffect?i["b"].state.skyBoxSceneGroup.hotspotTriEffect:o.hotspotTriEffect,r=JSON.parse(JSON.stringify(a));0!==o.showStyle?(r.move.enablePath=!1,r.move.enableScale=!1,r.down.enablePath=!1,r.down.enableScale=!1):(r.initial.path=o.iconData.iconPath,r.initial.gifInfo=o.iconData.gifInfo,r.move.enablePath=a.move.enablePath,r.move.enableScale=a.move.enableScale,r.down.enablePath=a.down.enablePath,r.down.enableScale=a.down.enableScale);const c="hotspot_"+e,l=cu(c);if(!l||!l.instances.length)return;const d=l.instances[0];switch(t){case 0:$p(d,r);break;case 1:Up(d,r);break;case 2:Xp(d,r);break;case 3:Yp(d,r);break;default:break}},t=e=>{const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);t&&0!==t.displayAlign&&window.console.log("停止图标触发效果",e)};return{initTriggerAction:e,stopTriggerAction:t}}function nv(){const e={},t=e=>{const t="hotspot_con_"+e.id;bl(e.id,t,!1);const n=[],i=o(e);i&&n.push(i),n.length&&du(t,n)},o=e=>{let t=null;switch(e.type){case 2:t=mm(e);break;case 3:t=vm(e);break;case 4:case 54:t=bm(e);break;case 5:Om(e);break;case 6:t=gm(e);break;case 7:t=ym(e);break;case 8:t=wm(e);break;case 9:t=xm(e);break;case 10:jm(e);break;case 20:t=Sm(e);break;case 21:t=Im(e);break;case 23:t=km(e);break;case 52:t=Cm(e);break;default:break}return t},n=o=>{if(e[o])return;const n=i["b"].state.sceneInfo.hotspots.find(e=>e.id===o);n&&(e[o]=!0,t(n))},s=()=>{for(const t in e)e[t]=!1,delete e[t]};return{renderSingerContent:n,destroyContentRender:s}}function iv(){const e=e=>{const t=o(e);return{position:t.position,rotate:t.rotate,scale:e.scale,offset:t.offset,opacity:e.opacity,depth:72*t.radius,zorder:e.zorder,edge:t.edge}},t=(e,t)=>({loaded(){gl("hotspot_con_"+e.id,!0),Wf("loading_"+e.id),t&&t(),Hm(e.id)},show(){Pm(e)},hide(){_m(e),um(e.id)},onclose(){zm(e.id)}}),o=e=>{let t="center";const o={x:0,y:0},n="hotspot_"+e.id,i=lu(n),s={x:i.position?i.position.x:e.position.x,y:i.position?i.position.y:e.position.y};let a=e.radius;const r=e.rotate;if(3===e.showStyle){s.x=e.iconData.contentPos.x,s.y=e.iconData.contentPos.y,a=e.iconData.contentRadius;const t="hotspot_con_"+e.id;Xd(t,{x:e.position.x,y:e.position.y},s);const o=Zd(t);r.rx=o.rx,r.ry=o.ry,r.rz=o.rz}if(0===e.displayAlign&&3!==e.showStyle&&(t="top",o.y=e.iconData.showSize.y/2+5,2===e.showStyle)){const t=cu("hotspot_"+e.id),n=t.instances[0].el||{},i=n.options.content.size.y||0,s=t.instances[0].bubbleTagData||{},a=s.contentOffsetY||0;o.y=i/2+a+5}return{edge:t,offset:o,position:s,rotate:r,radius:a}},n=e=>3!==e.disappearMode&&1===e.displayAlign,s=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{title:o.content.title,font:{family:o.content.fontFamily,size:o.content.fontSize,color:o.content.fontColor,wordspace:o.content.wordSpace,rowspace:o.content.rowSpace,bolid:o.content.bolid,italic:o.content.italic,underline:o.content.underline,align:o.content.textAlignment},background:{color:o.content.bgcolor,opacity:o.content.bgalpha},effect:o.content.texteffect,size:o.content.showSize,reset:!0}};return i=new xd(s,t(o)),i},a=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{path:o.content.imagePath,gifInfo:o.content.gifInfo,loopTime:o.content.loopTime,type:o.content.imageType,size:o.content.showSize}};return i=new Ll(s,{...t(o),oncomplete:()=>{Fm(o.id)}}),i},r=o=>{let s=null;const a=()=>{const e=i["b"].state.krp.get(`hotspot[${"hotspot_con_"+o.id}]`);Ka({id:o.id,type:"hotspot_video",instance:e,isPauseMedia:o.content.isPauseMedia})},r={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),isHotspotVideo:!0,content:{path:o.content.videoPath,poster:o.content.videoPoster,volume:o.content.volume,type:o.content.videoType,startTime:o.content.startTime,autoplay:!0,replay:o.content.replay,size:o.content.showSize,reset:!0,isVa:o.content.vaEnable,vaUid:o.content.vaUid,name:o.content.videoName}};return 54===o.type&&(r.content.alphaColor=o.content.alphaColor,r.content.threshold=o.content.threshold,r.content.smoothing=o.content.smoothing),s=new ad(r,{...t(o,a),onplay(e,t){Ja(o.id,!1,{isShow:t})},onpause(){Ja(o.id,!0)},oncomplete:()=>{Fm(o.id),Qa(o.id,"isEnded",!0)}}),s},c=e=>{Ns.emit(Ea,e)},l=e=>{let t=null;const o=e.content.nextSceneId,n=i["b"].state.skyBoxSceneGroup.sceneList.findIndex(e=>e.id===o&&2===e.scenetype);return n>=0?t=d(e):(Um(e),Ns.emit(Fs,{sceneId:o,startTime:e.content.startTime,switchEffect:e.content.switchIndex,switchKey:e.content.switchKey,hotspotId:e.id})),t},d=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:o.content};return i=new af(s,{...t(o),hideSelector(e){zm(e)}}),i},u=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{paths:o.content.imagePaths,type:o.content.imageType,gifInfos:o.content.gifInfos,autoplay:o.content.autoplay,interval:o.content.interval,size:o.content.showSize,reset:!0}};return i=new cd(s,t(o)),i},p=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{path:o.content.imagePath,type:o.content.imageType,gifInfo:o.content.gifInfo,size:o.content.showSize,title:o.content.title,font:{family:o.content.fontFamily,size:o.content.fontSize,color:o.content.fontColor,wordspace:o.content.wordSpace,rowspace:o.content.rowSpace,bolid:o.content.bolid,italic:o.content.italic,underline:o.content.underline,align:o.content.textAlignment},hotspotType:o.type,displayMode:o.content.imageTxtMode,displayAlign:o.displayAlign,showStyle:o.showStyle}};return i=new _f(s,t(o)),i},h=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{path:o.content.imagePath,type:o.content.imageType,gifInfo:o.content.gifInfo,size:o.content.showSize,title:o.content.title,font:{family:o.content.fontFamily,size:o.content.fontSize,color:o.content.fontColor,wordspace:o.content.wordSpace,rowspace:o.content.rowSpace,bolid:o.content.bolid,italic:o.content.italic,underline:o.content.underline,align:o.content.textAlignment},hotspotType:o.type,displayMode:o.content.imageTxtMode,displayAlign:o.displayAlign,showStyle:o.showStyle,audioPath:o.content.audioPath,audioName:o.content.audioName,isPauseMedia:o.content.isPauseMedia,replay:o.content.replay,volume:o.content.volume}};return i=new Mf(s,t(o)),i},f=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{geoPath:o.content.modelPath,mtlPath:o.content.modelMtlPath,scaleSize:o.content.scaleSize,rotateType:o.content.rotationAnimationType,rotateOrigin:o.content.rotateOriginType,autoRotate:o.content.isAutoRotation,animation:o.content.animation,openInModelViewer:o.content.openInModelViewer}};return i=new Hd(s,{...t(o),click(){o.content.openInModelViewer&&Ns.emit(Sa,o)}}),i},m=e=>{1===e.content.type?Ns.emit(ba,e):Ho(e.content.path)},v=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{isAutoPlay:o.content.isAutoPlay,rotateType:o.content.rotateType,playSpeed:o.content.playSpeed,paths:o.content.paths,size:o.content.showSize}};return i=new Nf(s,t(o)),i},b=o=>{let i=null;const s=()=>{Ka({id:o.id,type:"hotspot_video",instance:null,isPauseMedia:o.content.isPauseMedia})},a={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{liveId:o.content.liveId,path:o.content.livePath,poster:o.content.livePoster,gifInfo:o.content.gifInfo,size:o.content.showSize,control:!1}};return i=new pd(a,t(o,s)),i},g=o=>{let i=null;const s={id:o.id,key:"hotspot_con_"+o.id,fixed:e(o),type:o.type,exclose:n(o),content:{path:o.content.imagePath,type:o.content.imageType,size:o.content.showSize}};return i=new Ll(s,t(o)),i};return{renderText:s,renderImage:a,renderVideo:r,renderSwitch:l,renderImages:u,renderImageText:p,renderModel:f,renderRing:v,renderLive:b,renderApp:g,renderAudio:c,renderLink:m,renderAudioImgTxt:h}}function sv(){let e=[];const t=t=>{n(t)||e.push(t)},o=t=>{if(n(t))for(let o=0;o<e.length;o++)e[o]===t&&(e.splice(o,1),o--)},n=t=>e.includes(t),s=e=>{const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);if(t){if(10===t.type)jm(t);else if(5===t.type)Om(t);else if(2===t.displayAlign)6===t.type?Ns.emit(Oa,{data:t}):Ns.emit(ba,t);else{const t="hotspot_con_"+e;gu(t)}Dm(e,1)}},a=e=>{const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);if(t)if(5===t.type)Ns.emit(Ta,t.id);else if(2===t.displayAlign)Ns.emit(ga,t.id);else{const t="hotspot_con_"+e;yu(t)}},r=()=>{i["b"].state.sceneInfo.hotspots.forEach(e=>{a(e.id)})},c=e=>{const t="hotspot_con_"+e.id;if(Sl(t))return;xl(t,!0);const i=cm(e.id);if(1!==e.displayAlign||i||om(e.id),[4,54].includes(e.type)&&Ja(e.id,!1,{isShow:!0}),5===e.type){const t=cu("hotspot_"+e.id);t.instances&&t.instances[0]&&t.instances[0].toggleAudioGif(!0)}52===e.type&&Ns.emit(Ea,e),21===e.type&&Ja(e.id,!1,{isShow:!0}),pv(e.id,e.type)&&Gm(e.id),n(e.id)||$m(e),o(e.id),Nm(e.id,0)},l=e=>{const t="hotspot_con_"+e.id,s=Sl(t);if(s){if(xl(t,!1),1===e.displayAlign&&e.isShow&&tm(e.id),[4,54].includes(e.type)&&Ja(e.id,!0),5===e.type){const t=cu("hotspot_"+e.id);t.instances&&t.instances[0]&&t.instances[0].toggleAudioGif(!1)}52===e.type&&Ns.emit(Ta,e.id),21===e.type&&Ja(e.id,!0),pv(e.id,e.type)&&Wm(e.id)}!i["b"].state.sceneInfo.disposeStatus&&yl(t)&&(n(e.id)||Dm(e.id,2),o(e.id)),s&&Vm(e.id)},d={},u=e=>d[e],p=e=>{const t="loading_"+e,o=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);if(!o)return;const n=lu("hotspot_"+e),s=n.position||o.position;3===o.showStyle&&(s.x=o.iconData.contentPos.x,s.y=o.iconData.contentPos.y),Gf(t,{size:o.content.showSize||{x:100,y:100},position:s,rotate:o.rotate,depth:72*o.radius})},h=(e,o=!1)=>{o&&t(e);const n="hotspot_con_"+e;Sl(n)?m(e):f(e)},f=(e,o=!1)=>{o&&t(e);const n="hotspot_con_"+e,a=yl(n),r=u(e),c=i["b"].state.sceneInfo.hotspots.findIndex(t=>{const o=i["b"].state.skyBoxSceneGroup.sceneList.some(e=>e.id===t.content.nextSceneId&&2!==e.scenetype),n=2===t.displayAlign&&!o,s=10===t.type&&0===t.content.type;return t.id===e&&(n||s)})>=0;c&&!a&&(bl(e,n,!1),gl(n,!0)),a&&!d[e]&&(d[e]=!0),c||a?(c||r)&&s(e):(p(e),Em(e),d[e]=!0)},m=(e,o=!1)=>{o&&t(e);const n="hotspot_con_"+e,i=yl(n);i?a(e):d[e]=!1};Ns.on(ya,({status:e,id:t})=>{if(!i["b"].state.sceneInfo||!i["b"].state.sceneInfo.id)return;const o=i["b"].state.sceneInfo.hotspots.find(e=>e.id===t),n=i["b"].state.skyBoxSceneGroup.mediaIdTypeList.findIndex(e=>e.id===t&&[4,5,10,54].indexOf(e.type)>=0)>=0;o?e?c(o):l(o):n&&(e?Gm(t):Wm(t))});const v=()=>{r(),e=[]};return{showCallback:c,hideCallback:l,hideContent:a,hideAllContent:r,checkContentRenderAndToggle:h,checkContentRenderAndShow:f,checkContentRenderAndHide:m,destroyContentVisibleSpace:v}}function av(){const e=e=>{Nm(e,1)};return Ns.on(ka,t=>{e(t)}),{completeCallback:e}}function rv(){Object(n["watch"])(()=>wl.value,e=>{e&&1!==i["b"].state.sceneInfo.type&&Jf()})}function cv(){const e=e=>{const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);if(!t)return!1;const o=t.forceProperty||{};return 2!==o.forcePlayType&&o.forcePlayTime},t=(t,o,n=!0)=>{if(n&&e(t))return;const s=i["b"].state.sceneInfo.hotspots.find(e=>e.id===t);if(!s||!s.conditionTrigger)return;const a=o?s.conditionTrigger.triggerMode:0;a===o&&Ns.emit(qs,{conditioner:s.conditionTrigger,id:t})};return{checkConditionTrigger:t}}function lv(){const e=Object(n["ref"])([]),t=t=>e.value.find(e=>e.id===t),o=(o,n)=>{t(o)||e.value.push({id:o,type:n.forcePlayType,times:n.forcePlayTime,showtime:0,numtimes:0,timer:0,pass:!1})},i=(e,o)=>{const n=t(e);n&&2!==n.type&&(1===o?(n.numtimes++,a(e)):0===o&&(clearInterval(n.timer),n.timer=window.setInterval(()=>{n.showtime++,a(e)},1e3)))},s=e=>{const o=t(e);o&&(clearInterval(o.timer),o.showtime=0,o.numtimes=0)},a=e=>{const o=t(e);o&&(o.pass=o.times===(0===o.type?o.showtime:o.numtimes),o.pass&&(s(e),Dm(e,1,!1)))},r=()=>{e.value.forEach(e=>{s(e.id)}),e.value=[]};return{bindLinktoForcePlay:o,updateLinktoForcePlay:i,stopLinktoForcePlay:s,destroyForcePlaySpace:r}}function dv(){const e=e=>{let t=null;const i="hotspot_con_"+e.id,s={id:e.id,key:i,fixed:{position:e.position,rotate:e.rotate,opacity:e.opacity,scale:1,depth:72*e.radius,zorder:e.zorder},type:6,exclose:!1,content:{nextSceneId:e.nextSceneId,startTime:e.startTime,switchIndex:e.startIndex}};t=new af(s,{loaded(){gl(i,!0),a(e.id)},show(){o(e.id)},hide(){n(e.id)}}),t&&du(i,[t])},t=e=>{const t="hotspot_con_"+e;gu(t)},o=e=>{const t="hotspot_con_"+e;Sl(t)||(xl(t,!0),pv(e,6)&&Gm(e))},n=e=>{const t="hotspot_con_"+e;Sl(t)&&(xl(t,!1),pv(e,6)&&Wm(e))},s=e=>{Ns.emit(Oa,{data:{id:e.id,type:6,exclose:!1,content:{nextSceneId:e.nextSceneId,startTime:e.startTime,switchIndex:e.startIndex}}})},a=o=>{const n="hotspot_con_"+o;bl(o,n,!1);const a=yl(n),r=i["b"].state.sceneInfo.events.find(e=>e.id===o);2===r.displayAlign?(gl(n,!0),s(r)):a?t(r.id):e(r)};Ns.on(Pa,e=>{a(e)})}function uv(){const e=(e,t,o=!1)=>{5===t?Ns.emit(Ta,e):o?(Ns.emit("hide::flat-hotspot",e),Ns.emit(ga,e)):Am(e)},t=(e,t,o=!1)=>{},o=o=>{const n=i["b"].state.sceneInfo.hotspots.filter(e=>[4,5,6,21,52,54].indexOf(e.type)>=0&&e.id!==o),s=i["b"].state.sceneInfo.events.filter(e=>e.id!==o),a=i["b"].state.skyBoxSceneGroup.hotspots.filter(e=>[4,5,54].indexOf(e.type)>=0&&e.id!==o);n.forEach(o=>{6===o.type?t(o.id,o.type,!1):e(o.id,o.type,!1)}),a.forEach(t=>{e(t.id,t.type,!0)}),s.forEach(e=>{t(e.id,e.type,!0)})},n=e=>{er(e)};return{showMediaCallback:o,hideMediaCallback:n}}function pv(e,t){if([4,5,21,52,54].indexOf(t)>=0)return!0;if(6===t){const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e),o=i["b"].state.sceneInfo.events.find(t=>t.id===e);let n=0;t?n=t.content.nextSceneId:o&&(n=o.nextSceneId);const s=i["b"].state.skyBoxSceneGroup.sceneList.find(e=>2===e.scenetype&&e.id===n);return!!(s&&s.bgAudio&&s.bgAudio.fileUrl)}return!1}function hv(){const e=e=>{if(1!==i["b"].state.sceneInfo.type)return!0;const t=i["b"].state.sceneInfo.hotspots.find(t=>t.id===e);if(t){const e=t.startTime/1e3,o=t.endTime/1e3;return i["b"].state.scenevideo.time>=e&&i["b"].state.scenevideo.time<=o}return!1};Ns.on($s,({id:t,status:o})=>{o&&!e(t)||(o?Qf(t):(zm(t),em(t)))}),Ns.on(Us,({hotspotId:t,aniId:o,pointIndex:n,status:s})=>{if(!e(t))return;const a=yl("hotspot_"+t),r=Sl("hotspot_"+t);[0,1,2].indexOf(n)<0&&(n=o>0?1:0);const c=1===n&&!r,l=0===n&&!a,d=2===n&&!a,u=i["b"].state.preSetCmIds.indexOf(t)>=0;u&&(c||l||d)?Du({cid:t,ctype:1,aniId:o,pointIndex:n,gearTarget:0,status:s}):(1===n&&o>0&&r&&(-1===s?lm(t,o):sm(t,o)),0===n&&t>0&&a&&(3===s?Mm(t):1===s?Hm(t):zm(t)),2===n&&t>0&&a&&-1!==s&&Au(t,1))}),Ns.on(Ca,e=>{zm(e)})}function fv(){const e=e=>{bc.emit("action",{key:"hotspot",data:{id:e.id,type:e.type,status:Sl("hotspot_con_"+e.id),isGlobal:!1,statisticsProperity:e.statisticsProperity}})},t=e=>{bc.emit("action",{key:"changeScene",data:{id:e.id,type:e.type,statisticsProperity:e.statisticsProperity}})};return{reportNormalHotspot:e,reportSceneHotspot:t}}function mv(){Ns.on(Rs,()=>{Kf(),Tm(),Lm(),Rm()})}function vv(){const e=Object(n["ref"])(null),t=()=>{const t=i["b"].state.sceneInfo.events||[];t.length&&(e.value=t[0])},o=Object(n["ref"])(!1),s=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});Object(n["watch"])(()=>s.value,n=>{n?(t(),o.value=!0):(o.value=!1,e.value=null)}),bv(e,o),gv(e)}function bv(e,t){let o=0,s=0,a=0;const r=()=>{s||(a=e.value.triggerTime);const t=e.value.id,n=e.value.nextSceneId;window.clearTimeout(o),s=Date.now(),o=window.setTimeout(()=>{const s=i["b"].state.skyBoxSceneGroup.sceneList.find(e=>e.id===n&&2===e.scenetype);s?Ns.emit(Pa,t):(window.clearTimeout(o),Ns.emit(Fs,{sceneId:n,startTime:e.value.startTime||0}))},a)},c=Object(n["computed"])(()=>{const e=i["b"].state.sceneInfo||{};if(0===e.type){const e=i["b"].state.sceneInfo.hotspots.length,t=i["b"].state.sceneInfo.parts.length,o=i["b"].state.sceneInfo.triggers.length,n=!!e||!!t||!!o;return!n||wl.value}return!1});Object(n["watch"])(()=>t.value&&e.value&&c.value,e=>{e?(s=0,a=0,r()):clearTimeout(o)}),Object(n["watch"])(()=>i["b"].state.pageStatus.newPage,t=>{if(t){window.clearTimeout(o);const e=Date.now()-s;e<a&&(a-=e)}else a>0&&e.value&&r()})}function gv(e){const t=()=>{const t=e.value.id,o=e.value.nextSceneId,n=i["b"].state.skyBoxSceneGroup.sceneList.find(e=>e.id===o&&2===e.scenetype);n?Ns.emit(Pa,t):Ns.emit(Fs,{sceneId:o,startTime:e.value.startTime||0})};Ns.on(wa,()=>{e.value&&t()})}dv(),hv(),mv();var yv=vv;function wv(){vp(),Ch(),Xm(),yv(),xv(),Sv()}function xv(){Ns.on(Rs,()=>{uu(),au(),Il(),Bu(),i["b"].state.modelplugin&&i["b"].state.modelplugin.destroy()})}function Sv(){Ns.on(Xa,()=>{Ns.emit(Fs,{sceneId:i["b"].state.sceneInfo.id})})}function Iv(){const e=e=>{const c=i["b"].state.sceneInfo,l=c.propertyControl.find(t=>t.id===e);if(!l||!l.properties)return;const d=i["b"].state.krp.get("view"),u={viewF:!1,viewH:!1,viewV:!1,viewValue:{fov:c.fov,hlookat:c.hlookat,vlookat:c.vlookat},rate:!1,rateValue:1,seek:!1,seekValue:0,forward:!1,forwardValue:0,move:!1,moveValue:{}},p=!l.properties["move"]||0===l.properties["move"]["type"];for(const t in l.properties)if(Object.prototype.hasOwnProperty.call(l.properties,t)){const e=l.properties[t];if(e.isActive){var h;const o=(null===(h=Iu(e.varId))||void 0===h?void 0:h.value)||0;"fov"===t?(u.viewF=!0,u.viewValue.fov=Xn(d.fov,o,e.operType)):"angleX"===t&&p?(u.viewH=!0,u.viewValue.hlookat=Xn(d.hlookat,o,e.operType)):"angleY"===t&&p?(u.viewV=!0,u.viewValue.vlookat=Xn(Mn(d.vlookat),o,e.operType)):"backrate"===t?(u.rate=!0,u.rateValue=Xn(u.rateValue,o,3),c.playbackrate=u.rateValue):"forward"===t?(u.forward=!0,u.forwardValue=Xn(u.forwardValue,o,1),c.startForward=u.forwardValue):"seek"===t?(u.seek=!0,u.seekValue=e.value,c.cutStartTime=u.seekValue):"move"===t&&(u.move=!0,u.moveValue=e)}}(u.viewF||u.viewH||u.viewV)&&t(u.viewValue),u.rate&&o(u.rateValue),u.seek&&n(u.seekValue),u.forward&&s(u.forwardValue),u.move&&(i["b"].state.lifecycle.isLoadedAnimation?a(u.moveValue):r(u.moveValue))},t=e=>{if(i["b"].state.sceneInfo.is2dRender||i["b"].state.pageStatus.airpose)return;const t=i["b"].state.krp.get("view");t.hlookat=e.hlookat,t.vlookat=Mn(e.vlookat),t.fov=e.fov,i["b"].state.lifecycle.isLoadedAnimation||(i["b"].state.sceneInfo.vlookat=t.vlookat)},o=e=>{Ns.emit(Na,e)},n=e=>{Ns.emit(Va,e)},s=e=>{Ns.emit(Ra,e)},a=e=>{if(1===e.type){var t,o;const n=e.rotateTimeType?e.rotateTimeValue:(null===(t=Iu(e.rotateTimeVarId))||void 0===t?void 0:t.value)||0;let s=-1,a=0;0===e.direction?(s=0,a=parseFloat(i["b"].state.krp.get("view.hlookat").toFixed(2))):1===e.direction&&(s=1,a=Mn(parseFloat(i["b"].state.krp.get("view.vlookat").toFixed(2))));const r=(null===(o=Iu(e.rotateVarId))||void 0===o?void 0:o.value)||0;let c=Xn(a,r,e.rotateOperType);if(1===s)c=Mn(c);else if(0===s){const e=i["b"].state.krp.get("view.hlookat"),t=c;c=e>t?t+360*Math.ceil(e/360):t}if(1===s&&(c<-70||c>70))return;s>=0&&(0===s&&a===c&&(c+=360),i["b"].state.krp.call(`tween(${s?"view.vlookat":"view.hlookat"}, ${c}, ${n}, linear)`))}};kv({updateSceneProperty:e});const{saveViewRotateInfo:r}=Ov({updateSceneViewMove:a})}function kv({updateSceneProperty:e}){Ns.on(Da,({sitemId:t,status:o})=>{-1!==o&&e(t)})}function Ov({updateSceneViewMove:e}){let t=null;const o=e=>{t=e};return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedAnimation,o=>{o&&t&&e(t)}),Ns.on(Rs,()=>{i["b"].state.krp.call("stoptween(view.hlookat|view.vlookat)")}),{saveViewRotateInfo:o}}var jv=Iv;function Cv(){const e=window.wx,t=()=>{const e=i["b"].state.proInfo.firstEnterUrl.split("#")[0];Ev(e),Tv()};e&&wo("Share")&&t()}const Ev=e=>{const t=document.getElementById("jssdk");t&&document.body.removeChild(t);let o="";const n=document.createElement("script");n.id="jssdk";const i=window.shareConfig||{};o=location.protocol.match("https")?i.https:i.http,o&&(n.src=Object(Ti["d"])(o,"url",encodeURIComponent(e)),document.body.appendChild(n))},Tv=()=>{const e=location.href.replace(/&scene=\d+/g,"").split("#").shift(),t=i["b"].state.skyBoxSceneGroup.weChatShare;let o=t.icon||"";o&&!/^http(s)?/.test(o)&&(o=r().previewPath+"/"+o);const n={imgUrl:o,title:t.title||"Nibiru Creator",link:e,desc:t.description||"最方便的 AR/VR 内容创作工具",success:function(){},error:()=>{}},s=window.wx;s.ready((function(){s.updateAppMessageShareData(n),s.updateTimelineShareData(n),s.onMenuShareAppMessage(n),s.onMenuShareQQ(n),s.onMenuShareTimeline(n)}))},Pv={id:"creatorContainer",class:"creatorContainer"};var _v=Object(n["defineComponent"])({__name:"index",setup(e){const{startView:t,updatePreview:o,updateViewRange:s}=l(),{updateLockView:a}=m();function r(){Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedXml,e=>{if(e){const e=i["b"].state.proInfo.sid;e&&ml(e)}}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedSceneXml,e=>{if(e){const e=i["b"].state.sceneInfo.id;e&&ml(e)}})}function c(){const e=()=>{const e=1===i["b"].state.sceneInfo.type,t=!i["b"].state.sceneInfo.isShowScene;(e||t)&&window.myKrp.onscenecomplete()},{initOpenanimation:o,stopOpenanimation:r}=d(),{startInitRelations:c,deleteRelationCmId:l}=f(),u=()=>{c(),t(),o(),e()},p=()=>{r(),l()};Object(n["watch"])(()=>i["b"].state.lifecycle.scenestatus,e=>{0===e?u():-1===e?p():1===e&&a()}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedAnimation&&i["b"].state.lifecycle.isLoadedScene,()=>{s()})}function l(){const e={fov:"",limitview:""},t=()=>{const t=i["b"].state.krp.get("view");e.fov=t.fov,e.limitview=t.limitview},o=()=>{const t=i["b"].state.krp.get("view");t.limitview=e.limitview,t.fov=e.fov},n=()=>{const e={hlookat:0,vlookat:0,fovmax:179,fovmin:1,fov:75},t={hlookat:i["b"].state.sceneInfo.hlookat,vlookat:i["b"].state.sceneInfo.vlookat,fov:i["b"].state.sceneInfo.fov,fovmax:i["b"].state.sceneInfo.fovmax,fovmin:i["b"].state.sceneInfo.fovmin};return Object.assign({},e,t)},s=()=>{const e=i["b"].state.krp.get("view"),t=n();e.hlookat=t.hlookat,e.vlookat=t.vlookat,i["b"].state.pageStatus.airpose||(e.fovtype="VFOV",e.fovmax=t.fovmax,e.fovmin=t.fovmin,e.fov=t.fov)},a=()=>{const e=i["b"].state.krp.get("view"),t=i["b"].state.krp.get("image"),o=i["b"].state.krp.get("area"),n=t.hres||i["b"].state.sceneInfo.size.width,s=t.vres||i["b"].state.sceneInfo.size.height,a=1;let r=t.vfov;if(!r||i["b"].state.sceneInfo.isHiddenSetting){let e=o.pixelheight/o.pixelwidth,t=s/n;r=Math.max(e,t)}const c=n/s,l=a/r,d=o.pixelwidth/o.pixelheight;r=Math.max(r,window.innerHeight/window.innerWidth),window.screen.width<=767&&c<.5625&&l<d?(e.fovtype="HFOV",e.fov=a,e.fovmin=a,e.fovmax=a,e.vlookat=-1*e.vlookatrange):(e.fovtype="VFOV",e.fovmin=.1,e.fovmax=179,e.fov=r)},r=()=>{const e=i["b"].state.krp.get("view"),t=i["b"].state.sceneInfo;e.limitview=t.is2dRender?"fullrange":"auto"},c=()=>{const e=i["b"].state.krp.get("view"),t=i["b"].state.krp.get("control");i["b"].state.sceneInfo.is2dRender||(e.hlookatmax=i["b"].state.sceneInfo.hlookatMax,e.hlookatmin=i["b"].state.sceneInfo.hlookatMin,e.vlookatmax=i["b"].state.sceneInfo.vlookatMax,e.vlookatmin=i["b"].state.sceneInfo.vlookatMin),1===i["b"].state.sceneInfo.vrType?(e.limitview="offrange",t.bouncinglimits=!1):(e.limitview=i["b"].state.sceneInfo.is2dRender?"fullrange":"auto",t.bouncinglimits=!0),window.console.log("更新视角范围")},l=()=>{const e=i["b"].state.sceneInfo,t=i["b"].state.krp.get("control");e.is2dRender?(a(),window.console.log(a.name),t.mode="follow"):(s(),t.mode="drag"),r()};return{startView:l,updatePreview:t,resumePrevView:o,updateViewRange:c}}function d(){let e=!1;const t=()=>{if(e&&i["b"].state.lifecycle.isLoadedAnimation)return;const t=i["b"].state.skyBoxSceneGroup.startAnimation;if(!t.animationType)return void window.myKrp.onanimationcomplete();let o="";const n=i["b"].state.sceneInfo,s=i["b"].state.skyBoxSceneGroup.otherSettingInfo||{},a=i["b"].state.device.mobile&&s.enableAirpose;switch(a&&(t.animationType=0),n.isHiddenSetting&&(t.animationType=0),t.animationType){case 1:o="skin_setup_little()";break;case 2:o="skin_setup_rotate()";break;case 3:o="skin_setup_little_rotate()";break;case 4:o="skin_setup_ball()";break;case 5:o="skin_setup_little_scale()";break;default:o="";break}const r=[0,1].indexOf(n.type)>=0&&!n.is2dRender;1===t.animationTiming?(r&&o?i["b"].state.krp.call(o):window.myKrp.onanimationcomplete(),e=!0):r&&o?(i["b"].commit(jo["e"],{key:"isLoadedAnimation",status:!1}),i["b"].state.krp.call(o),e=!0):window.myKrp.onanimationcomplete()},o=()=>{i["b"].state.lifecycle.isLoadedAnimation||e&&(i["b"].state.krp.call("\n        stoptween(view.hlookat|view.vlookat|view.fov|view.distortion)\n      "),i["b"].state.krp.set("view.distortion",0),e=!0)};return{initOpenanimation:t,stopOpenanimation:o}}function u(){Ns.on(Fs,({sceneId:e,startTime:t,switchEffect:n,switchKey:s,hotspotId:a})=>{i["b"].commit(jo["w"],{startTime:Number(t)/1e3,switchEffect:n,switchKey:s,hotspotId:a}),o(),ml(e)}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{if(e){window.history.replaceState(null,"",Object(Ti["a"])({scene_id:i["b"].state.sceneInfo.sort}));const e=i["b"].state.viewedIds.concat([i["b"].state.sceneInfo.id]);i["b"].commit(jo["z"],e),Cv()}})}function p(){const{initVReportTimer:e,destroyInterVal:t}=h();Ns.on(Rs,()=>{Su()}),window.onunload=()=>{bc.emit("action",{key:"pro",isUnload:!0}),t()},e()}function h(){let e=null;const t=()=>{e=setInterval(()=>{bc.emit("action",{key:"variable"})},3e5)},o=()=>{clearInterval(e)};return{initVReportTimer:t,destroyInterVal:o}}function f(){const e=()=>{i["b"].state.sceneInfo.initItems.lines.length&&(t(),nh({mode:"trigger",gear:0,signalGear:!1,relations:i["b"].state.sceneInfo.initItems.lines}))},t=()=>{const e=[],t=e=>{const t=Qp(e),o=t.instance||null;let n=[];return o&&(n=t&&4===t.type?n.concat(o.relations||[]):n.concat(o.lines||[])),n},o=n=>{n.forEach(n=>{e.push(n.targetId);const i=t(n.targetId);o(i)})};o(i["b"].state.sceneInfo.initItems.lines),i["b"].commit(jo["l"],e),window.console.log("执行场景初始化指令",123,e)},o=()=>{i["b"].commit(jo["l"],[])};return{startInitRelations:e,deleteRelationCmId:o}}function m(){const e=()=>{const e=i["b"].state.sceneInfo;e.isLockViewAngle?Nu():Vu()},t=Object(n["computed"])(()=>i["b"].state.lifecycle.isLoadedScene&&i["b"].state.lifecycle.isLoadedAnimation);return Object(n["watch"])(()=>t.value,t=>{t&&e()}),{updateLockView:e}}return r(),jv(),c(),wv(),u(),p(),(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Pv))}});o("de5d");const Av=Tr()(_v,[["__scopeId","data-v-2cb11119"]]);var Mv=Av;const Hv=e=>(Object(n["pushScopeId"])("data-v-87a58504"),e=e(),Object(n["popScopeId"])(),e),zv={class:"video__control-wrap"},Lv={class:"status__waiting"},Dv={class:"video__control"},Bv={class:"progress-wrap",ref:"progress"},Nv=Hv(()=>Object(n["createElementVNode"])("span",{class:"progress-handle"},null,-1)),Vv=Hv(()=>Object(n["createElementVNode"])("div",{class:"progress-inner"},null,-1)),Rv={class:"time-wrap"},Fv={class:"current"},Gv={class:"total"};function Wv(e,t,o,i,s,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",zv,[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Lv,null,512),[[n["vShow"],e.iswaiting]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"action__toggle",onClick:t[0]||(t[0]=(...t)=>e.toggleVideo&&e.toggleVideo(...t))},[Object(n["createElementVNode"])("span",{class:"icon",style:Object(n["normalizeStyle"])({backgroundImage:"url("+e.gplayIcon+")"})},null,4)],512),[[n["vShow"],e.isShowGVideoBtn]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Dv,[Object(n["createElementVNode"])("div",{class:"toggle-wrap",onClick:t[1]||(t[1]=(...t)=>e.toggleVideo&&e.toggleVideo(...t))},[Object(n["createElementVNode"])("span",{class:Object(n["normalizeClass"])([[e.ispaused?"play":"pause"],"btn__toggle"])},null,2)]),Object(n["createElementVNode"])("div",Bv,[Nv,Object(n["createElementVNode"])("div",{class:"progress-buffer",style:Object(n["normalizeStyle"])([e.bufferprogress])},null,4),Object(n["createElementVNode"])("div",{class:"progress-line",style:Object(n["normalizeStyle"])([e.timeprogress])},null,4),Vv],512),Object(n["createElementVNode"])("div",Rv,[Object(n["createElementVNode"])("span",Fv,Object(n["toDisplayString"])(e.formatctime),1),Object(n["createTextVNode"])(" / "),Object(n["createElementVNode"])("span",Gv,Object(n["toDisplayString"])(e.formatduration),1)])],512),[[n["vShow"],e.isShowProgress]])],512),[[n["vShow"],e.isVideoScene]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"action__toggle",onClick:t[2]||(t[2]=(...t)=>e.openLiveHandle&&e.openLiveHandle(...t))},[Object(n["createElementVNode"])("span",{class:"icon",style:Object(n["normalizeStyle"])({backgroundImage:"url("+e.gplayIcon+")"})},null,4)],512),[[n["vShow"],e.isShowGLiveBtn]])],64)}function $v({isplayed:e,ctime:t},{changevideorate:o,changevideotime:s}){let a=!1;const r=Object(n["computed"])(()=>e.value&&1===i["b"].state.sceneInfo.type&&t.value>.1);Object(n["watch"])(()=>r.value,e=>{if(e&&!a){var n,r;const e=i["b"].state.sceneInfo,c=null!==(n=e.playbackrate)&&void 0!==n?n:1;o(c);const l=null!==(r=e.startForward)&&void 0!==r?r:0,d=(e.cutStartTime||t.value)+l;s(d),a=!0}}),Ns.on(Na,e=>{r.value&&o(e)}),Ns.on(Va,e=>{r.value&&a&&s(e)}),Ns.on(Ra,e=>{r.value&&a&&s(t.value+e)}),Ns.on(Rs,()=>{a=!1})}var Uv=$v;function Xv({ctime:e,duration:t,isended:o},{pauseVideo:s,replayVideo:a}){const r=Object(n["ref"])([]),c=Object(n["ref"])(!1),l=()=>{const e=i["b"].state.sceneInfo;e.events.length&&(r.value=[],e.events.forEach(o=>{const n=o.triggerTime/1e3,i=o.startTime/1e3,s=o.endTime/1e3;let a=o.isEvent;!a&&t.value&&(a=n>=t.value),r.value.push({id:o.id,name:o.name,sceneId:e.id||o.sceneId,nextSceneId:o.nextSceneId,triggerTime:n,isTrigger:!1,isTriggerLast:a,triggerLast:0,initialTime:i,startTime:i,endTime:s||t.value,duration:t.value||0})}),c.value=r.value.some(e=>e.isTriggerLast))},d=()=>{r.value.length&&r.value.forEach(e=>{e.isTriggerLast||p(e)})},u=()=>{r.value.forEach(e=>{e.isTriggerLast&&Ns.emit(wa,e.id)})},p=t=>{const o=e.value>=t.triggerTime;!t.isTrigger&&o&&(Ns.emit(wa,t.id),t.isTrigger=!0,s(!1))},h=()=>{r.value.length=0,r.value=[],c.value=!1};return Object(n["watch"])(()=>e.value,e=>{e>0&&d()}),Object(n["watch"])(()=>o.value,e=>{e&&(c.value?u():i["b"].state.sceneInfo.replayVideo&&a())}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{const t=i["b"].state.sceneInfo;e&&1===t.type&&l()}),{destroySceneEvent:h}}var Yv=Xv;function Zv({ctime:e,duration:t}){let o=[];const s=()=>{i["b"].state.sceneInfo.hotspots&&i["b"].state.sceneInfo.hotspots.forEach(e=>{o.push({id:e.id,type:e.type,triggerShow:e.startTime/1e3,triggerHide:e.endTime/1e3,isShow:!1,isHotspot:!0,isInitShow:!1})})},a=()=>{i["b"].state.sceneInfo.parts&&i["b"].state.sceneInfo.parts.forEach(e=>{o.push({id:e.id,type:e.type,triggerShow:e.startTime/1e3,triggerHide:e.endTime/1e3,isPart:!0})})},r=()=>{i["b"].state.sceneInfo.triggers&&i["b"].state.sceneInfo.triggers.forEach(e=>{o.push({id:e.id,type:e.type,triggerShow:e.startTime/1e3,triggerHide:e.endTime/1e3,isTrigger:!0})})},c=()=>{o.forEach(o=>{const n=o.triggerHide||t.value,i=Math.floor(1e3*e.value)/1e3,s=i>=o.triggerShow&&i<=n;s&&!o.isShow?(o.isPart?Ns.emit(Gs,{id:o.id,status:!0}):o.isTrigger?Ns.emit(Ws,{id:o.id,status:!0}):o.isHotspot&&Ns.emit($s,{id:o.id,status:!0}),o.isShow=!0):!s&&o.isShow&&(o.isPart?Ns.emit(Gs,{id:o.id,status:!1}):o.isTrigger?Ns.emit(Ws,{id:o.id,status:!1}):o.isHotspot&&Ns.emit($s,{id:o.id,status:!1}),o.isShow=!1)})},l=()=>{o.length=0,o=[]};return Object(n["watch"])(()=>e.value,()=>{o.length&&c()}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{const t=i["b"].state.sceneInfo;e&&1===t.type?(s(),a(),r()):o=[]}),{destroyComponentVisible:l}}var qv=Zv;function Kv({isVideoScene:e,videoplugin:t}){const o=()=>{e.value&&t.value&&t.value.toggle()},n=()=>{e.value&&t.value&&t.value.pause()},i=()=>{t.value&&t.value.reset()},s=o=>{e.value&&t.value&&t.value.changeTime(o)},a=o=>{e.value&&t.value&&t.value.changerate(o)},r=()=>{t.value&&(t.value.changeTime(0),t.value.play(),Ja(0,!1))};return{toggleVideo:o,pauseVideo:n,resetVideo:i,replayVideo:r,changevideotime:s,changevideorate:a}}var Jv=Kv;function Qv(){const e=Object(n["ref"])(!1),t=Object(n["ref"])(!1),o=Object(n["ref"])(!0),s=Object(n["ref"])(!1),a=(n,a)=>{"waiting"===n?t.value=a:"toggle"===n?o.value=a:"ended"===n?s.value=a:"played"===n&&(e.value=a),i["b"].commit(jo["t"],{key:n,value:a})};return{iswaiting:t,ispaused:o,isended:s,isplayed:e,updatevideostatus:a}}var eb=Qv;o("d9e2");class tb{constructor(e,t){if(this.$el=null,this.$handle=null,!e)throw new Error("el is not defined");if(this.$el=e,this.$handle=this.$el.querySelector(".progress-handle"),!this.$handle)throw new Error("Missing the progress-handle element under el");this.defaultOpt={value:0,diffNum:0,mode:"horizontal",scaleNum:1},this.opt=Object.assign({},this.defaultOpt,t),this.touch={disX:0,disY:0,offsetX:0,offsetY:0,diffX:0,diffY:0},this.currentRate=0,this.maxWidth=0,this.maxHeight=0,this.isMobile=!1,this.init()}init(){0===this.opt.value?this.opt.value="horizontal"===this.opt.mode?0:1:this.opt.value="horizontal"===this.opt.mode?this.opt.value:1-this.opt.value,this.isMobile=Object(To["d"])(),this.bindEvent(),this.update(100*this.opt.value,!0)}bindEvent(){if(!this.$el)return;const e=this,t=this.$el,o=this.$handle,n="click",i=this.isMobile?"touchstart":"mousedown",s=this.isMobile?"touchmove":"mousemove",a=this.isMobile?"touchend":"mouseup";function r(o){const n=o||window.event;n.stopPropagation();let i=n.clientX,r=n.clientY;if(e.isMobile){const e=n.touches[0];i=e.pageX,r=e.pageY}e.maxWidth=t.clientWidth*e.opt.scaleNum,e.maxHeight=t.clientHeight*e.opt.scaleNum,e.touch.disX=i,e.touch.disY=r,e.touch.offsetX=e.currentRate*e.maxWidth,e.touch.offsetY=e.currentRate*e.maxHeight,document.addEventListener(s,c),document.addEventListener(a,l),e.opt.down&&e.opt.down()}function c(t){const o=t||window.event;o.preventDefault(),o.stopPropagation();let n=o.clientX,i=o.clientY;if(e.isMobile){const e=o.touches[0];n=e.pageX,i=e.pageY}e.touch.diffX=n-e.touch.disX+e.touch.offsetX,e.touch.diffY=i-e.touch.disY+e.touch.offsetY;let s=0;"horizontal"===e.opt.mode?s=e.touch.diffX/e.maxWidth*100:"vertical"===e.opt.mode&&(s=e.touch.diffY/e.maxHeight*100),s=s>100?100:s<0?0:s,e.update(s),e.opt.move&&e.opt.move()}function l(){document.removeEventListener(s,c),document.removeEventListener(a,l),e.opt.up&&e.opt.up(100*e.currentRate),e.opt.change&&e.opt.change(e.currentRate)}this.$el.addEventListener(n,e=>{const o=e||window.event;if(o.target===this.$handle)return;const n=o.clientX,i=o.clientY;this.maxWidth=t.clientWidth*this.opt.scaleNum,this.maxHeight=t.clientHeight*this.opt.scaleNum,this.touch.diffX=n-t.getBoundingClientRect().left,this.touch.diffY=i-t.getBoundingClientRect().top;let s=0;"horizontal"===this.opt.mode?s=this.touch.diffX/this.maxWidth*100:"vertical"===this.opt.mode&&(s=this.touch.diffY/this.maxHeight*100),s=s>100?100:s<0?0:s,this.update(s,!0)}),o.addEventListener(i,r)}update(e,t=!1){this.change(e);let o=0;"horizontal"===this.opt.mode?o=e:"vertical"===this.opt.mode&&(o=100-e),t&&this.opt.change&&this.opt.change(o/100)}change(e){this.$handle&&("horizontal"===this.opt.mode?this.$handle.style.left="calc("+e+"% + "+this.opt.diffNum+"px)":"vertical"===this.opt.mode&&(this.$handle.style.top="calc("+e+"% + "+this.opt.diffNum+"px)"),this.currentRate=e/100)}}function ob({isplayed:e}){const t=Object(n["computed"])(()=>3===i["b"].state.sceneInfo.type),o=Object(n["computed"])(()=>{const t=1===i["b"].state.sceneInfo.type&&!i["b"].state.sceneInfo.isHiddenSetting,o=i["b"].state.lifecycle.isLoadedAnimation;return t&&!e.value&&o}),s=()=>{const e=i["b"].state.sceneInfo;3===e.type&&window.open(e.liveScene.livePath)},a=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconPlay||""});return{isShowGLiveBtn:t,isShowGVideoBtn:o,openLiveHandle:s,gplayIcon:a}}function nb({duration:e}){const t=Object(n["ref"])(0),o=o=>{o>=e.value&&(o=e.value),t.value=o,i["b"].commit(jo["t"],{key:"time",value:o})},s=Object(n["computed"])(()=>Hp(t.value));return{ctime:t,formatctime:s,updatevideotime:o}}function ib(){const e=Object(n["ref"])(0),t=t=>{e.value=Math.min(i["b"].state.sceneInfo.duration,t),i["b"].commit(jo["t"],{key:"total",value:e.value})},o=Object(n["computed"])(()=>Hp(e.value));return{duration:e,formatduration:o,updatevideoduration:t}}function sb(){const e=Object(n["ref"])(0),t=t=>{e.value=t};return{buffertime:e,updatevideobuffer:t}}function ab({currentInstance:e,ctime:t,buffertime:o,duration:s},{changevideotime:a}){const r=Object(n["computed"])(()=>{var e;return 2===(null===(e=i["b"].state.skyBoxSceneGroup.templateInfo)||void 0===e?void 0:e.type)}),c=Object(n["computed"])(()=>i["b"].state.sceneInfo.enableProgress&&i["b"].state.lifecycle.isLoadedAnimation&&!r.value),l=Object(n["computed"])(()=>({width:o.value/s.value*100+"%"})),d=Object(n["computed"])(()=>({width:t.value/s.value*100+"%"}));let u=!1,p=null;const h=()=>{const{progress:t}=e.value.refs;t&&!p&&(p=new tb(t,{diffNum:-8,change(e){a(e*s.value)},down(){u=!0},up(){u=!1}}))},f=()=>{p&&p.change(100*Math.min(t.value/s.value,1))};return Object(n["watch"])(()=>s.value,e=>{e&&h()}),Object(n["watch"])(()=>t.value,()=>{u||f()}),{isShowProgress:c,timeprogress:d,bufferprogress:l}}const{updateHiddenInfo:rb,isHiddenVideo:cb,onplayHidden:lb,onpauseHidden:db,onseekHidden:ub,destroyHidden:pb}=fb();class hb{constructor(e){this.el=null,this.options=e,this.create()}get getduration(){var e;return(null===(e=this.el)||void 0===e?void 0:e.totaltime)||i["b"].state.sceneInfo.duration||0}get getloaded(){var e;return(null===(e=this.el)||void 0===e?void 0:e.loaded)||!1}get getplayed(){var e;return(null===(e=this.el)||void 0===e?void 0:e.isplayed)||!1}create(){const e=i["b"].state.krp;if(this.el=e.get("plugin[video]"),!this.el)throw new Error("plugin[video] is not defined");this.el.html5preload=this.options.preload,this.el.panovideo=!0,this.initEvents()}async update(e){const t=i["b"].state.sceneInfo,o=t.isHiddenSetting||!1;if(o)rb(this.options);else if(this.el&&this.el.playvideo){pb();const t=i["b"].state.sceneInfo.size;this.el.videowidth=t.width||0,this.el.videoheight=t.height||0,this.el.volume=e.volume,this.reset(),od(e.src).then(t=>{this.el.playvideo(t,e.poster,!0,0)})}}play(){cb.value?(this.el.ispaused=!1,lb()):td(this.options.src)?od(this.options.src).then(e=>{this.el.playvideo(e,"",!1,0)}):this.el.play()}pause(){cb.value?(this.el.ispaused=!0,db()):this.el.pause&&this.el.pause()}toggle(){this.el.ispaused?this.play():this.pause()}destroy(){this.el.isdestroy=!0}reset(){this.pause(),this.changeTime(0),this.changerate(1),this.destroy()}changeTime(e){this.el.seek&&this.el.seek(e)}changerate(e){cb.value?ub(e):this.el.changerate&&this.el.changerate(e)}updatePreload(e){this.el.html5preload=e}initEvents(){this.el.onloaded=()=>{this.options.on&&this.options.on.loaded&&this.options.on.loaded()},this.el.onvideoready=()=>{this.options.on&&this.options.on.ready&&this.options.on.ready()},this.el.onvideowaiting=()=>{this.options.on&&this.options.on.waiting&&this.options.on.waiting(this.el.iswaiting)},this.el.onvideoplay=()=>{this.options.on&&this.options.on.toggle&&this.options.on.toggle(!1)},this.el.onvideopaused=()=>{this.options.on&&this.options.on.toggle&&this.options.on.toggle(!0)},this.el.onvideotimeupdate=()=>{this.options.on&&this.options.on.timeupdate&&this.options.on.timeupdate(this.el.time)},this.el.onvideoprogress=()=>{this.options.on&&this.options.on.bufferupdate&&this.options.on.bufferupdate(this.el.loadedbytes)},this.el.onvideocomplete=()=>{this.options.on&&this.options.on.ended&&this.options.on.ended()}}}function fb(){const e={timer:0,startTime:0,endTime:0,currentTime:0,duration:0,options:null},t=Object(n["ref"])(!1),o=o=>{e.options=o;const n=i["b"].state.sceneInfo;t.value=n.isHiddenSetting||!1,e.duration=n.duration||0,e.options&&e.options.on&&e.options.on.ready()},s=()=>{e.options&&e.options.on&&e.options.on.toggle(!1),e.startTime=Date.now(),c()},a=()=>{cancelAnimationFrame(e.timer),e.endTime=e.currentTime,e.options&&e.options.on&&e.options.on.toggle(!0)},r=()=>{a(),e.endTime=0,e.options&&e.options.on&&e.options.on.ended()},c=()=>{e.duration?(e.currentTime=e.endTime+(Date.now()-e.startTime)/1e3,e.currentTime>=e.duration?r():(e.options&&e.options.on&&e.options.on.timeupdate(e.currentTime),e.timer=requestAnimationFrame(c))):cancelAnimationFrame(e.timer)},l=t=>{e.currentTime=t},d=()=>{cancelAnimationFrame(e.timer),e.startTime=0,e.endTime=0,e.currentTime=0,e.duration=0,e.options=null,t.value=!1};return{isHiddenVideo:t,updateHiddenInfo:o,onplayHidden:s,onpauseHidden:a,onseekHidden:l,destroyHidden:d}}var mb=hb;function vb(){const e=Object(n["ref"])(!1);return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,t=>{t&&1===i["b"].state.sceneInfo.type&&(e.value=!0)}),Ns.on(Vs,()=>{e.value=!1}),{isRenderer:e}}function bb(e){e&&window.wx&&window.wx&&window.wx.getNetworkType({success(){e.play()}})}function gb({isRenderer:e,isplayed:t},{updatevideostatus:o,updatevideotime:s,updatevideoduration:a,updatevideobuffer:r}){const c=Object(n["ref"])(null);let l=!1;const d=()=>{c.value=new mb({preload:i["b"].state.lifecycle.isLoadedAnimation?"auto":"none",on:{loaded(){u()},ready(){c.value&&(a(c.value.getduration||0),i["b"].state.lifecycle.isLoadedAnimation&&c.value.play(),Ka({id:0,type:"part_video",instance:c.value,isPauseMedia:!1}),Ja(0,!1))},waiting(e){o("waiting",e)},toggle(e){o("toggle",e),e&&o("ended",!1)},timeupdate(e){s(e),i["b"].state.myswitch.startTime>0&&e>0&&(c.value&&c.value.changeTime(i["b"].state.myswitch.startTime),e>=i["b"].state.myswitch.startTime&&l&&i["b"].commit(jo["w"],{startTime:0})),!t.value&&e>.1&&o("played",!0)},bufferupdate(e){r(e)},ended(){o("ended",!0),Qa(0,"isEnded",!0)}}})},u=()=>{if(!c.value)return;const e=i["b"].state.sceneInfo;l=!0,c.value.update({src:e.src,poster:e.poster,volume:e.volume}),c.value&&!c.value.getplayed&&bb(c.value)},p=()=>{c.value||d(),c.value&&c.value.getloaded&&u()},h=()=>{l=!1};return Object(n["watch"])(()=>e.value,e=>{e&&p()}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedAnimation,e=>{e&&c.value&&(c.value.play(),c.value.updatePreload("auto"))}),{videoplugin:c,destroyVideoPluginSpace:h}}function yb({isRenderer:e},{resetVideo:t,destroyVideoPluginSpace:o,destroyComponentVisible:n,destroySceneEvent:i}){Ns.on(Rs,()=>{window.console.log("场景删除前暂停视频",e.value),t(),o(),n(),i()})}var wb=yb,xb=Object(n["defineComponent"])({setup(){const e=Object(n["ref"])(Object(n["getCurrentInstance"])()),t=Object(n["computed"])(()=>1===i["b"].state.sceneInfo.type),{isRenderer:o}=vb(),{iswaiting:s,ispaused:a,isended:r,isplayed:c,updatevideostatus:l}=eb(),{duration:d,formatduration:u,updatevideoduration:p}=ib(),{ctime:h,formatctime:f,updatevideotime:m}=nb({duration:d}),{buffertime:v,updatevideobuffer:b}=sb(),{videoplugin:g,destroyVideoPluginSpace:y}=gb({isRenderer:o,isplayed:c},{updatevideostatus:l,updatevideotime:m,updatevideoduration:p,updatevideobuffer:b}),{toggleVideo:w,pauseVideo:x,resetVideo:S,replayVideo:I,changevideotime:k,changevideorate:O}=Jv({isVideoScene:t,videoplugin:g}),{isShowProgress:j,timeprogress:C,bufferprogress:E}=ab({currentInstance:e,ctime:h,buffertime:v,duration:d},{changevideotime:k}),{gplayIcon:T,isShowGLiveBtn:P,isShowGVideoBtn:_,openLiveHandle:A}=ob({isplayed:c}),{destroyComponentVisible:M}=qv({ctime:h,duration:d}),{destroySceneEvent:H}=Yv({ctime:h,duration:d,isended:r},{pauseVideo:x,replayVideo:I});return Sb({toggleVideo:w,pauseVideo:x,changevideotime:k}),Uv({isplayed:c,ctime:h},{changevideorate:O,changevideotime:k}),wb({isRenderer:o},{resetVideo:S,destroyVideoPluginSpace:y,destroyComponentVisible:M,destroySceneEvent:H}),{isVideoScene:t,toggleVideo:w,iswaiting:s,ispaused:a,ctime:h,formatctime:f,duration:d,formatduration:u,isShowProgress:j,timeprogress:C,bufferprogress:E,gplayIcon:T,isShowGLiveBtn:P,isShowGVideoBtn:_,openLiveHandle:A}}});function Sb({toggleVideo:e,pauseVideo:t,changevideotime:o}){Ns.on(Ia,o=>{o?t():e()}),Ns.on($a,()=>{e()}),Ns.on(Ua,e=>{o(e)})}o("1fcf");const Ib=Tr()(xb,[["render",Wv],["__scopeId","data-v-87a58504"]]);var kb=Ib;function Ob(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("theme"),c=Object(n["resolveComponent"])("subtitle"),l=Object(n["resolveComponent"])("airpose"),d=Object(n["resolveComponent"])("Scenelist"),u=Object(n["resolveComponent"])("contact"),p=Object(n["resolveComponent"])("share"),h=Object(n["resolveComponent"])("intro"),f=Object(n["resolveComponent"])("pro-detail"),m=Object(n["resolveComponent"])("notice"),v=Object(n["resolveComponent"])("talk"),b=Object(n["resolveComponent"])("layer"),g=Object(n["resolveComponent"])("selector"),y=Object(n["resolveComponent"])("flat-icons"),w=Object(n["resolveComponent"])("flat-component"),x=Object(n["resolveComponent"])("flat-mode"),S=Object(n["resolveComponent"])("concise-template");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createVNode"])(r,{pure:e.pure},null,8,["pure"]),Object(n["createVNode"])(c),Object(n["createVNode"])(l),e.isConciseModel?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createBlock"])(d,{key:0,pure:e.pure},null,8,["pure"])),Object(n["createVNode"])(u),Object(n["createVNode"])(p),Object(n["createVNode"])(h),Object(n["createVNode"])(f),Object(n["createVNode"])(m,{pure:e.pure},null,8,["pure"]),Object(n["createVNode"])(v),Object(n["createVNode"])(b),Object(n["createVNode"])(g),Object(n["createVNode"])(y,{pure:e.pure},null,8,["pure"]),Object(n["createVNode"])(w),Object(n["createVNode"])(x,{pure:e.pure},null,8,["pure"]),Object(n["createVNode"])(S,{pure:e.pure},null,8,["pure"])],64)}const jb={class:"my-base-theme-wrap"},Cb={key:0,class:"top--space"},Eb={class:"left--space"},Tb={key:0,class:"right--space"},Pb={class:"icon__name"},_b={class:"icon-wrap"},Ab={class:"icon__name"},Mb={key:0,class:"bottom--space"},Hb={class:"btn--left"},zb=Object(n["createElementVNode"])("span",{class:"icon__name"},"场景列表",-1),Lb={class:"icon__name"},Db={class:"bottom-center"},Bb={class:"btn--right"};function Nb(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("g-hotspot"),c=Object(n["resolveComponent"])("logo"),l=Object(n["resolveComponent"])("private__menu"),d=Object(n["resolveComponent"])("g-selector"),u=Object(n["resolveComponent"])("flow"),p=Object(n["resolveComponent"])("browser"),h=Object(n["resolveComponent"])("scenename"),f=Object(n["resolveComponent"])("private__onlinecount"),m=Object(n["resolveComponent"])("private__comment");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createElementVNode"])("div",jb,[Object(n["createVNode"])(n["Transition"],{name:"fadeInLeft"},{default:Object(n["withCtx"])(()=>[i.isIconCustom?Object(n["createCommentVNode"])("",!0):Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Cb,[Object(n["createVNode"])(r,{pos:7}),Object(n["createVNode"])(c,{pos:1})],512)),[[n["vShow"],!i.props.pure]])]),_:1}),Object(n["createVNode"])(n["Transition"],{name:"fadeInLeft"},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Eb,[i.isEnablePriMenu?(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:0,"pro-scene-id":i.proSceneId,excludes:i.excludeProSceneList,onBackPrevScene:i.onBackPrevSceneHandle,onChangeScene:i.onChangeSceneHandle,onBackMainScene:i.onBackMainSceneHandle},null,8,["pro-scene-id","excludes","onBackPrevScene","onChangeScene","onBackMainScene"])):Object(n["createCommentVNode"])("",!0),i.isIconCustom?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[Object(n["createVNode"])(r,{pos:0}),Object(n["createVNode"])(c,{pos:2}),Object(n["createVNode"])(r,{pos:4})],64))],512),[[n["vShow"],!i.props.pure]])]),_:1}),Object(n["createVNode"])(n["Transition"],{name:"fadeInRight"},{default:Object(n["withCtx"])(()=>[i.isIconCustom?Object(n["createCommentVNode"])("",!0):Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Tb,[Object(n["createVNode"])(d),Object(n["createVNode"])(r,{pos:3}),i.isShowProdetailIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"icon-wrap",onClick:t[0]||(t[0]=(...e)=>i.showProDetailHandle&&i.showProDetailHandle(...e))},[Object(n["createElementVNode"])("div",{class:"icon__pic",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.prodetailIcon+")"})},null,4)])):Object(n["createCommentVNode"])("",!0),i.isShowFsIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:1,class:"icon-wrap",onClick:t[1]||(t[1]=(...e)=>i.showFullscreenHandle&&i.showFullscreenHandle(...e))},[Object(n["createElementVNode"])("div",{class:"icon__pic",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.fsIcon+")"})},null,4)])):Object(n["createCommentVNode"])("",!0),i.isShowPromusicIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:2,class:"icon-wrap",onClick:t[2]||(t[2]=(...e)=>i.showPromusicHandle&&i.showPromusicHandle(...e))},[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon__pic icon-music__pro",{muted:!i.promusicStatus}]),style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.promusicIcon+")"})},null,6)])):Object(n["createCommentVNode"])("",!0),i.isShowScenemusicIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:3,class:"icon-wrap",onClick:t[3]||(t[3]=(...e)=>i.showScenemusicHandle&&i.showScenemusicHandle(...e))},[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon__pic icon-music__scene",{muted:!i.scenemusicStatus}]),style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.scenemusicIcon+")"})},null,6)])):Object(n["createCommentVNode"])("",!0),i.isShowGyroIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:4,class:"icon-wrap",onClick:t[4]||(t[4]=(...e)=>i.showGyroHandle&&i.showGyroHandle(...e))},[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon__pic",{stop:!i.gyroStatus}]),style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.gyroIcon+")"})},null,6)])):Object(n["createCommentVNode"])("",!0),i.isShowVRIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:5,class:"icon-wrap",onClick:t[5]||(t[5]=(...e)=>i.showVRHandle&&i.showVRHandle(...e))},[Object(n["createElementVNode"])("div",{class:"icon__pic",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.vrIcon+")"})},null,4)])):Object(n["createCommentVNode"])("",!0),i.isShowShareIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:6,class:"icon-wrap",onClick:t[6]||(t[6]=(...e)=>i.showShareHandle&&i.showShareHandle(...e))},[Object(n["createElementVNode"])("div",{class:"icon__pic",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.shareIcon+")"})},null,4)])):Object(n["createCommentVNode"])("",!0),i.isShowStatisticsIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:7},[Object(n["createElementVNode"])("div",{class:"icon-wrap",onClick:t[7]||(t[7]=(...e)=>i.showLikeHandle&&i.showLikeHandle(...e))},[Object(n["createElementVNode"])("div",{class:"icon__pic",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.likeIcon+")"})},null,4),Object(n["createElementVNode"])("span",Pb,Object(n["toDisplayString"])(i.likeNum),1)]),Object(n["createElementVNode"])("div",_b,[Object(n["createElementVNode"])("div",{class:"icon__pic",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.pvIcon+")"})},null,4),Object(n["createElementVNode"])("span",Ab,Object(n["toDisplayString"])(i.pvNum),1)])],64)):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(r,{pos:6})],512)),[[n["vShow"],!i.props.pure]])]),_:1}),i.isIconCustom?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Mb,[Object(n["createVNode"])(n["Transition"],{name:"fadeInLeft"},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Hb,[i.isShowSceneListIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"icon-wrap",onClick:t[8]||(t[8]=(...e)=>i.toggleSLExpand&&i.toggleSLExpand(...e))},[Object(n["createElementVNode"])("div",{class:"icon__pic icon-scene",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.scenelistIcon+")"})},null,4),zb])):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(r,{pos:1}),i.isShowContactIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:1,class:"icon-wrap",onClick:t[9]||(t[9]=(...e)=>i.showContactHandle&&i.showContactHandle(...e))},[Object(n["createElementVNode"])("div",{class:"icon__pic icon-scene",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.contactIcon+")"})},null,4),Object(n["createElementVNode"])("span",Lb,Object(n["toDisplayString"])(e.$t("ContactTips.contacts")),1)])):Object(n["createCommentVNode"])("",!0)],512),[[n["vShow"],!i.props.pure]])]),_:1}),Object(n["createVNode"])(n["Transition"],{name:"fadeInBottom"},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Db,[Object(n["createVNode"])(r,{pos:5}),Object(n["createVNode"])(c,{pos:3})],512),[[n["vShow"],!i.props.pure]])]),_:1}),Object(n["createVNode"])(n["Transition"],{name:"fadeInRight"},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Bb,[Object(n["createVNode"])(c,{pos:4}),Object(n["createVNode"])(r,{pos:2})],512),[[n["vShow"],!i.props.pure]])]),_:1})]))]),i.isShowFlowTips?(Object(n["openBlock"])(),Object(n["createBlock"])(u,{key:0})):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(p),Object(n["createVNode"])(h,{pure:i.props.pure},null,8,["pure"]),i.isEnablePriOnlinecount?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createBlock"])(f,{key:1,"count-path":i.fetchOnlineCountPath},null,8,["count-path"])),[[n["vShow"],!i.props.pure]]):Object(n["createCommentVNode"])("",!0),i.isEnablePriComment?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createBlock"])(m,{key:2},null,512)),[[n["vShow"],!i.props.pure]]):Object(n["createCommentVNode"])("",!0)],64)}const Vb={class:"my-traffic-tips"},Rb={class:"normal_text"};function Fb(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Vb,[Object(n["createElementVNode"])("span",Rb,Object(n["toDisplayString"])(e.$t("flowRemind")),1)],512)),[[n["vShow"],e.isShowFlowTips]])}var Gb=Object(n["defineComponent"])({setup(){const e=Object(n["ref"])(!1);let t=!1;const o=()=>{e.value=!0,t=!0,setTimeout(()=>{e.value=!1},3e3)};return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{var n;const s=i["b"].state.privateInfo||{};!e||t||null!==(n=s.closeFlowTips)&&void 0!==n&&n.enable||o()}),{isShowFlowTips:e}}});o("ad44");const Wb=Tr()(Gb,[["render",Fb],["__scopeId","data-v-f98ea034"]]);var $b=Wb;function Ub(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"my-browser-tips",style:Object(n["normalizeStyle"])({backgroundImage:"url("+e.browserIcon+")"})},null,4)),[[n["vShow"],e.isShowBrowserTips]])}var Xb=Object(n["defineComponent"])({setup(){const{locale:e}=Object(oc["b"])(),t=Object(n["ref"])(!1),s=Object(n["computed"])(()=>{var t;const n=i["b"].state.skyBoxSceneGroup||{},s=(null===(t=n.weChatShare)||void 0===t?void 0:t.starticon)||"";if(s)return s;const r=i["b"].state.device.mobile;return r&&"zh"===e.value?a()+o("ad0b"):r&&"en"===e.value?a()+o("4db3"):r||"zh"!==e.value?a()+o("c423"):a()+o("bb0b")}),r=()=>{t.value&&(t.value=!1,l())},c=()=>{const e=i["b"].state.device.mobile?"touchstart":"mousedown";window.addEventListener(e,r,!1)},l=()=>{const e=i["b"].state.device.mobile?"touchstart":"mousedown";window.removeEventListener(e,r,!1)},d=()=>{const e=i["b"].state.sceneInfo;e.is2dRender||u||(t.value=!0,setTimeout(()=>{t.value=!1},2500),c())};Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedAnimation,e=>{e&&d()});let u=!1;return Object(n["watch"])(()=>i["b"].state.baseIconStatus.gyro,e=>{u=e}),{isShowBrowserTips:t,browserIcon:s}}});o("7d4b");const Yb=Tr()(Xb,[["render",Ub],["__scopeId","data-v-9c97f60a"]]);var Zb=Yb;const qb={key:0,class:"my-sceneTitle-wrap"};function Kb(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("private__scenetitle");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[e.isEnablePriScenetitle?Object(n["createCommentVNode"])("",!0):Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",qb,[Object(n["createElementVNode"])("div",{class:"normal_text",style:Object(n["normalizeStyle"])(e.sceneTitleStyle)},Object(n["toDisplayString"])(e.sceneTitle),5)],512)),[[n["vShow"],!e.props.pure&&e.isEnableSceneTitle&&e.isShowSceneTitle]]),e.isEnablePriScenetitle?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:1,title:e.sceneTitle},null,8,["title"])),[[n["vShow"],!e.props.pure&&e.isEnableSceneTitle&&e.isShowSceneTitle]]):Object(n["createCommentVNode"])("",!0)],64)}var Jb=Object(n["defineComponent"])({props:{pure:{type:Boolean,default:!1}},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.otherSettingInfo.enableSceneName||!1),o=Object(n["ref"])(!1),s=Object(n["ref"])(0),a=Object(n["computed"])(()=>i["b"].state.sceneInfo.title),{showTime:r,isShowWhilePlay:c,sceneTitleStyle:l}=Qb(),d=()=>{window.clearTimeout(s.value),o.value=!1},u=()=>{o.value=!0,window.clearTimeout(s.value),s.value=window.setTimeout(()=>{o.value=!1},1e3*r.value)},p=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t}),h=Object(n["computed"])(()=>Po(i["b"].state.proInfo.version,"6.3.0"));return Object(n["watch"])(()=>p.value,e=>{const t=!h.value&&!i["b"].state.sceneInfo.isHideFlowSceneName,o=h.value&&c.value;e?(t||o)&&u():d()}),{props:e,sceneTitle:a,isShowSceneTitle:o,isEnableSceneTitle:t,isEnablePriScenetitle:Ul,sceneTitleStyle:l}}});function Qb(){const e=Object(n["computed"])(()=>i["b"].state.sceneInfo.titleStyle||{}),t=Object(n["computed"])(()=>e.value.showTime),o=Object(n["computed"])(()=>e.value.isShowWhilePlay),s=Object(n["computed"])(()=>e.value.sceneName||""),a=Object(n["computed"])(()=>e.value.size||{}),r=Object(n["computed"])(()=>{const t=e.value.titleFont||{},o=e.value.backgroundColor||{},n=t.color||{},r=i["b"].state.sceneInfo.is2dRender,c=r?t.size:1.2*ln(t.size),l=(r?t.lineSpacing:1.2*ln(t.lineSpacing*t.size/50))+c,d=r?t.workSpacing/t.size*18:1.2*ln(t.workSpacing/t.size*12),u="center"===t.fontAlign?"center":"left"===t.fontAlign?"flex-start":"flex-end",p=`\n      font-family: ${t.family||"YouYuan"};\n      font-size: ${t.size}px;\n      color: ${dn(n,1)};\n      font-weight: ${t.bold?"bold":"normal"};\n      letter-spacing: ${Math.round(d)}px;\n      line-height: ${l}px;\n      text-decoration: ${t.underline?"underline":"none"};\n      text-align: ${t.fontAlign};\n      font-style: ${t.italic?"italic":"none"};\n      background-color: ${dn(o,.01*e.value.backgroundOpacity)};\n      justify-content: ${u};\n      box-sizing: border-box;\n    `,h=bn(s.value,[p]),f=a.value.x<h.x?h.x:a.value.x,m=a.value.y<h.y?h.y:a.value.y,v=`width: ${f}px;height: ${m}px;`;return v+p});return{showTime:t,isShowWhilePlay:o,sceneTitleStyle:r}}o("f42f");const eg=Tr()(Jb,[["render",Kb],["__scopeId","data-v-ba476eb8"]]);var tg=eg;const og=["src"];function ng(e,t,o,i,s,a){return e.isShowLogo&&e.isMatchPos?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:Object(n["normalizeClass"])(["my-logo-wrap",e.classData])},[Object(n["createElementVNode"])("img",{class:"logo",src:e.logoPath,alt:""},null,8,og)],2)):Object(n["createCommentVNode"])("",!0)}var ig=Object(n["defineComponent"])({props:{pos:{type:Number}},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),o=Object(n["computed"])(()=>t.value.showLogo&&c.value),s=Object(n["computed"])(()=>1===e.pos?!r.value.rightBottom&&r.value.topCenter:2===e.pos?!r.value.rightBottom&&r.value.leftTop:3===e.pos?!r.value.rightBottom&&r.value.bottomCenter:4===e.pos&&r.value.rightBottom),a=Object(n["computed"])(()=>4===e.pos?{rg:r.value.rightBottom}:{lf:r.value.leftTop,lc:r.value.topCenter,bc:r.value.bottomCenter}),r=Object(n["computed"])(()=>({leftTop:0===t.value.iconLogoPos,rightBottom:1===t.value.iconLogoPos,topCenter:2===t.value.iconLogoPos,bottomCenter:3===t.value.iconLogoPos})),c=Object(n["computed"])(()=>t.value.logoSrc);return{isMatchPos:s,classData:a,isShowLogo:o,logoPos:r,logoPath:c}}});o("971c");const sg=Tr()(ig,[["render",ng],["__scopeId","data-v-ee6bcce8"]]);var ag=sg;function rg(e,t,o,i,s,a){return e.isShowGlHotspotIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"icon-wrap",onClick:t[0]||(t[0]=(...t)=>e.showGlHotspotHandle&&e.showGlHotspotHandle(...t))},[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon__pic",{null:!e.glHotspotIcon}]),style:Object(n["normalizeStyle"])({backgroundImage:"url("+e.glHotspotIcon+")"})},null,6)])):Object(n["createCommentVNode"])("",!0)}var cg=Object(n["defineComponent"])({props:{pos:{type:Number,default:0}},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.globalHotspot||{}),o=Object(n["computed"])(()=>t.value.isEnable&&t.value.iconPos===e.pos),s=Object(n["computed"])(()=>t.value.iconPath||""),a=()=>{6===t.value.type?Ns.emit(Fs,{sceneId:t.value.content.nextSceneId,startTime:t.value.content.startTime,switchEffect:t.value.content.switchIndex}):Ns.emit(ba,{id:t.value.id,type:t.value.type,content:t.value.content})};return{isShowGlHotspotIcon:o,glHotspotIcon:s,showGlHotspotHandle:a}}});const lg=Tr()(cg,[["render",rg]]);var dg=lg;function ug(e,t,o,i,s,a){return e.isShowGlSelectorIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"icon-wrap global_selector_icon",onClick:t[0]||(t[0]=(...t)=>e.showGlSelectorHandle&&e.showGlSelectorHandle(...t))},[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon__pic",{null:!e.glSelectorIcon}]),style:Object(n["normalizeStyle"])({backgroundImage:"url("+e.glSelectorIcon+")"})},null,6)])):Object(n["createCommentVNode"])("",!0)}var pg=Object(n["defineComponent"])({setup(){const e=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.globalSelector||{}),t=Object(n["computed"])(()=>e.value.isEnable),o=Object(n["computed"])(()=>e.value.iconPath||""),s=e=>{e.target&&a(e.target)},a=t=>{if(!t)return;const o=t.getBoundingClientRect(),n=1-o.left/window.innerWidth,i=o.top/window.innerHeight;Ns.emit("show::flat-selector",{selectordata:e.value.content,styledata:{position:{x:n,y:i},offset:{x:.5*o.width*-1,y:-10,xf:"right",yf:"top"},opacity:1,rotation:0,scale:1,origin:"right top"},status:3})};let r=!1;const c=()=>{if(!r&&e.value&&e.value.isExpand){const e=document.querySelector(".my-base-theme-wrap .global_selector_icon");e&&setTimeout(()=>{a(e),r=!0},500)}},l=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});return Object(n["watch"])(()=>l.value,e=>{e&&c()}),Ns.on(Rs,()=>{e.value&&e.value.content&&Ns.emit("hide::flat-selector",{sid:e.value.content.id})}),{isShowGlSelectorIcon:t,glSelectorIcon:o,showGlSelectorHandle:s}}});const hg=Tr()(pg,[["render",ug]]);var fg=hg;const mg=()=>{const e=document.createElement("span");e.innerText="Nibiru Creator 教育版",e.className="gl__watermark";const t="auto",o=Object(To["d"])()?16:28,n=Object(To["d"])()?40:60,i=Object(To["d"])()?30:70;e.style.cssText=`position: fixed;right: ${n}px;bottom: ${i}px;z-index: 999999;family: ${t};font-size: ${o}px;font-weight: 500;color: rgb(170,170,170);opacity: 0.8;pointer-events: none;`;const s=document.querySelector("#app")||document.body;s.append(e)},vg=()=>{const e=new MutationObserver(e=>{e.forEach(e=>{const t=e.removedNodes||[];t.length&&"gl__watermark"===t[0].className&&mg()})}),t=document.querySelector("#app");t&&e.observe(t,{childList:!0})};var bg={props:{pure:{type:Boolean,default:!1}},components:{Flow:$b,Browser:Zb,Scenename:tg,Logo:ag,GHotspot:dg,GSelector:fg},setup(e){const t=Object(n["computed"])(()=>Po(i["b"].state.proInfo.version,"6.1.0")),{isShowProdetailIcon:o,prodetailIcon:s,showProDetailHandle:a}=gg(),{isShowFsIcon:r,fsIcon:c,showFullscreenHandle:l}=yg(),{isShowPromusicIcon:d,promusicStatus:u,promusicIcon:p,showPromusicHandle:h}=wg(),{isShowScenemusicIcon:f,scenemusicIcon:m,scenemusicStatus:v,showScenemusicHandle:b}=xg(),{isShowGyroIcon:g,gyroIcon:y,gyroStatus:w,showGyroHandle:x}=Sg(),{isShowVRIcon:S,vrIcon:I,showVRHandle:k}=Ig(),{isShowShareIcon:O,shareIcon:j,showShareHandle:C}=kg(),{isShowSceneListIcon:E,scenelistIcon:T,toggleSLExpand:P}=Og(),{isShowContactIcon:_,contactIcon:A,showContactHandle:M}=jg(),{isShowFlowTips:H}=Eg();Tg();const{isShowStatisticsIcon:z,likeIcon:L,likeNum:D,showLikeHandle:B,pvIcon:N,pvNum:V}=Cg();return{props:e,isIconCustom:t,isShowProdetailIcon:o,prodetailIcon:s,showProDetailHandle:a,isShowFsIcon:r,fsIcon:c,showFullscreenHandle:l,isShowPromusicIcon:d,promusicIcon:p,promusicStatus:u,showPromusicHandle:h,isShowScenemusicIcon:f,scenemusicIcon:m,scenemusicStatus:v,showScenemusicHandle:b,isShowGyroIcon:g,gyroIcon:y,gyroStatus:w,showGyroHandle:x,isShowVRIcon:S,vrIcon:I,showVRHandle:k,isShowShareIcon:O,shareIcon:j,showShareHandle:C,isShowSceneListIcon:E,scenelistIcon:T,toggleSLExpand:P,isShowContactIcon:_,contactIcon:A,showContactHandle:M,isShowStatisticsIcon:z,likeIcon:L,likeNum:D,showLikeHandle:B,pvIcon:N,pvNum:V,isEnablePriOnlinecount:Wl,fetchOnlineCountPath:$l,isEnablePriMenu:Xl,proSceneId:Yl,excludeProSceneList:Zl,onBackMainSceneHandle:ql,onBackPrevSceneHandle:Kl,onChangeSceneHandle:Jl,isEnablePriComment:Ql,isShowFlowTips:H}}};function gg(){const e=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return!!e.title||!1}),t=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconProInfo}),o=()=>{Ns.emit(va)};return{isShowProdetailIcon:e,prodetailIcon:t,showProDetailHandle:o}}function yg(){const e=Object(n["computed"])(()=>!i["b"].state.device.iphone),t=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconFullScreen}),o=()=>{Ns.emit(oa)};return{isShowFsIcon:e,fsIcon:t,showFullscreenHandle:o}}function wg(){const e=Object(n["computed"])(()=>i["b"].state.baseIconStatus||{}),t=Object(n["computed"])(()=>e.value.promusic_visible),o=Object(n["computed"])(()=>!e.value.promusic_paused),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return o.value?e.iconMusicGlobalOpen:e.iconMusicGlobalClose}),a=()=>{Ns.emit(ea)};return{isShowPromusicIcon:t,promusicIcon:s,promusicStatus:o,showPromusicHandle:a}}function xg(){const e=Object(n["computed"])(()=>i["b"].state.baseIconStatus||{}),t=Object(n["computed"])(()=>e.value.scenemusic_visible),o=Object(n["computed"])(()=>!e.value.scenemusic_paused),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return o.value?e.iconMusicSceneOpen:e.iconMusicSceneClose}),a=()=>{Ns.emit(ta)};return{isShowScenemusicIcon:t,scenemusicIcon:s,scenemusicStatus:o,showScenemusicHandle:a}}function Sg(){const e=Object(n["ref"])(!1);Ns.on("gyro::toggle:visible",(t=!1)=>{e.value=t});const t=Object(n["ref"])(!1);Ns.on("gyro::toggle:status",(e=!1)=>{t.value=e});const o=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return t.value?e.iconGyroOpen:e.iconGyroClose}),s=()=>{Ns.emit(sa)};return{isShowGyroIcon:e,gyroIcon:o,gyroStatus:t,showGyroHandle:s}}function Ig(){const e=Object(n["computed"])(()=>{var e;const t=i["b"].state.privateInfo||{};return!(null!==(e=t.closeVRMode)&&void 0!==e&&e.enable)&&!i["b"].state.sceneInfo.is2dRender}),t=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconVr}),o=()=>{Ns.emit(ia)};return{isShowVRIcon:e,vrIcon:t,showVRHandle:o}}function kg(){const e=Object(n["computed"])(()=>{const e=i["b"].state.viewMode,t=i["b"].state.device;return!e.offline&&!e.local&&!t.mobile}),t=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconShare}),o=()=>{Ns.emit(fa)};return{isShowShareIcon:e,shareIcon:t,showShareHandle:o}}function Og(){const e=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconSceneList}),t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.navigation||{}),o=Object(n["computed"])(()=>!!t.value.enable),s=()=>{Ns.emit(Qs)};return{isShowSceneListIcon:o,scenelistIcon:e,toggleSLExpand:s}}function jg(){const e=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.showContact||!1}),t=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconLink}),o=()=>{Ns.emit(ma)};return{isShowContactIcon:e,contactIcon:t,showContactHandle:o}}function Cg(){const e=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),t=Object(n["computed"])(()=>{const t=i["b"].state.viewMode;return e.value.showStatistics&&!t.offline&&!t.local}),o=Object(n["computed"])(()=>i["b"].state.statistics||{}),s=Object(n["computed"])(()=>o.value.whether?e.value.iconLiked:e.value.iconLike),a=Object(n["computed"])(()=>o.value.likeNum||0),r=()=>{Ns.emit(aa)},c=Object(n["computed"])(()=>e.value.iconPv),l=Object(n["computed"])(()=>o.value.pv);return{isShowStatisticsIcon:t,likeIcon:s,likeNum:a,showLikeHandle:r,pvIcon:c,pvNum:l}}function Eg(){const e=Object(n["computed"])(()=>!i["b"].state.viewMode.local&&!i["b"].state.viewMode.offline);return{isShowFlowTips:e}}function Tg(){i["b"].state.skyBoxSceneGroup.waterMark&&(mg(),vg())}o("c354");const Pg=Tr()(bg,[["render",Nb]]);var _g=Pg;const Ag=e=>(Object(n["pushScopeId"])("data-v-6c1795c0"),e=e(),Object(n["popScopeId"])(),e),Mg={class:"cm__airpose"},Hg=Object(n["createStaticVNode"])('<div class="left_wrap" data-v-6c1795c0><div class="control__view" data-v-6c1795c0><span class="direction up" data-v-6c1795c0></span><span class="direction down" data-v-6c1795c0></span><span class="direction left" data-v-6c1795c0></span><span class="direction right" data-v-6c1795c0></span><span class="finger" data-v-6c1795c0></span><span class="reset" data-v-6c1795c0></span></div></div>',1),zg={class:"control__fov"},Lg={class:"conic",ref:"dial"},Dg={class:"fov"},Bg=Ag(()=>Object(n["createElementVNode"])("span",{class:"shot"},null,-1)),Ng=Ag(()=>Object(n["createElementVNode"])("div",{class:"shot-img-wrap"},[Object(n["createElementVNode"])("img",{class:"shot-img",crossorigin:"anonymous",src:"",alt:""}),Object(n["createElementVNode"])("span",{class:"white_bg"})],-1));function Vg(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Mg,[Hg,Object(n["createElementVNode"])("div",zg,[Object(n["createElementVNode"])("canvas",Lg,null,512),Object(n["createElementVNode"])("span",Dg,Object(n["toDisplayString"])(i.dialText),1),Bg]),Ng],512)),[[n["vShow"],i.isRendered]])}var Rg={setup(){const e=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isRendered:t}=Xg(),{dialText:o,myEvents:i}=Fg(t,e),{resetView:s}=$g(t);return Wg(t,{resetView:s}),Gg(t,e,i),Ug(t),{dialText:o,isRendered:t}}};function Fg(e,t){const s=Object(n["ref"])(1),r=Object(n["computed"])(()=>s.value+"x"),c={canvas:null,ctx:null,littleImg:null,fovElement:null,canvasWidth:0,canvasHeight:0,curAngle:120,singleAngle:0,prevAngle:0,timer:0,dialLineCount:31,dialList:["0","0.25x","0.5x","0.75x","1x","2x","4x"],maxFov:150,minFov:30,initFov:90,max:4,min:0},l={initBasic(){c.singleAngle=180/(c.dialLineCount-1)},initCanvas(){const{dial:e}=t.value.refs;if(!e)return;c.canvas=e,c.canvasWidth=e.offsetWidth,c.canvasHeight=e.offsetHeight;const o=window.devicePixelRatio;c.canvas&&(c.canvas.width=c.canvasWidth*o,c.canvas.height=c.canvasHeight*o,c.ctx=c.canvas.getContext("2d"))},initImg(e){return new Promise(t=>{const o=new Image;o.onload=function(){t(o)},o.src=e})},draw(){if(!c.ctx||!c.canvas)return;const e=window.devicePixelRatio,t=c.curAngle/c.singleAngle;c.ctx.save(),c.ctx.clearRect(0,0,c.canvas.width,c.canvas.height),c.ctx.translate(c.canvasHeight/2*e,c.canvas.height/2),c.ctx.rotate(-c.curAngle*Math.PI/180),c.ctx.beginPath(),c.ctx.arc(0,0,(c.canvasHeight/2-20)*e,Math.PI,2*Math.PI),c.ctx.lineWidth=5,c.ctx.strokeStyle="#fff",c.ctx.stroke(),c.ctx.closePath(),c.ctx.save(),c.ctx.lineWidth=2;for(let o=0;o<c.dialLineCount;o++)c.ctx.rotate((o>0?1:0)*c.singleAngle*Math.PI/180),c.ctx.beginPath(),o%5===0?c.ctx.moveTo(-1*(c.canvasHeight/2-15)*e,0):c.ctx.moveTo(-1*(c.canvasHeight/2-10)*e,0),c.ctx.lineTo(c.canvasHeight/2*-1*e,0),c.ctx.lineWidth=2,Math.abs(o-t)<=2?c.ctx.strokeStyle="#277DFF":c.ctx.strokeStyle="#fff",c.ctx.stroke(),c.ctx.closePath();c.ctx.restore(),c.ctx.save(),c.ctx.font=15*e+"px arial",c.ctx.fillStyle="#fff",c.ctx.rotate(-90*Math.PI/180);for(let o=0,n=c.dialList.length;o<n;o++){const t=c.dialList[o];if(c.ctx.rotate(30*(o>0?1:0)*Math.PI/180),0!==o||!c.littleImg){const o=c.ctx.measureText(t);c.ctx.fillText(t,-1*o.width/2,(-1*c.canvasHeight/2+45)*e)}}c.ctx.restore(),c.ctx.save(),c.littleImg&&(c.ctx.translate((-1*c.canvasHeight/2+30)*e,10*e),c.ctx.rotate(-90*Math.PI/180),c.ctx.drawImage(c.littleImg,0,0,c.littleImg.naturalWidth,c.littleImg.naturalHeight,0,0,20*e,20*e)),c.ctx.restore(),c.ctx.restore()},getCorrectAngle(){let e=0;return e=s.value>2?20*c.singleAngle+5*c.singleAngle+(s.value-2)/2*5*c.singleAngle:s.value>1&&s.value<=2?20*c.singleAngle+5*(s.value-1)*c.singleAngle:s.value/1*20*c.singleAngle,e},getCorrectValue(){let e=0;return e=c.curAngle>150?2+(c.curAngle-150)/c.singleAngle/5*2:c.curAngle>120&&c.curAngle<=150?1+(c.curAngle-120)/c.singleAngle/5:c.curAngle/c.singleAngle/20,e},updateFov(){const e=i["b"].state.krp.get("view");s.value>1?e.fov=c.initFov+(c.initFov-c.minFov)/(c.max-1)*(1-s.value):e.fov=c.initFov+(c.maxFov-c.initFov)/(1-c.min)*(1-s.value)}},d={changeStart(){c.prevAngle=c.curAngle,c.fovElement||(c.fovElement=document.querySelector(".cm__airpose .fov")),c.fovElement&&c.fovElement.classList.add("show")},changing(e){let t=c.prevAngle+100*e;t>180?t=180:t<0&&(t=0),c.curAngle=t,l.draw(),s.value=Math.floor(100*l.getCorrectValue())/100,c.fovElement&&c.fovElement.classList.add("show"),l.updateFov()},changeend(){clearTimeout(c.timer),c.timer=window.setTimeout(()=>{c.fovElement&&c.fovElement.classList.remove("show")},1e3)}},u=()=>{l.initBasic(),l.initCanvas();const e=a()+o("78c0");l.initImg(e).then(e=>{e&&e instanceof HTMLImageElement&&(c.littleImg=e,l.draw())})},p=()=>{c.curAngle=120,s.value=1};return Object(n["watch"])(()=>e.value,e=>{e?Object(n["nextTick"])(()=>{setTimeout(u,50)}):p()}),{dialText:r,myEvents:d}}function Gg(e,t,o){let i=null;const s={sy:0,ww:0},a=e=>{var t;s.sy=e.touches[0].pageY,s.ww=(null===(t=i)||void 0===t?void 0:t.clientHeight)||0,o.changeStart()},r=e=>{const t=e.touches[0].pageY-s.sy,n=t/s.ww;o.changing(n)},c=()=>{s.sy=0,o.changeend()},l=()=>{const{dial:e}=t.value.refs;e&&(i=e,e.addEventListener("touchstart",a,!1),e.addEventListener("touchmove",r,!1),e.addEventListener("touchend",c,!1))},d=()=>{i&&(i.removeEventListener("touchstart",a,!1),i.removeEventListener("touchmove",r,!1),i.removeEventListener("touchend",c,!1))};Object(n["watch"])(()=>e.value,e=>{e?Object(n["nextTick"])(l):d()})}function Wg(e,{resetView:t}){const o={airposeElement:null,viewElement:null,resetElement:null,fingerElement:null,vw:0,vh:0,sl:0,st:0,dis:{sx:0,sy:0,mx:0,my:0},timer:0},s={startFn:e=>{if(!o.viewElement)return;const t=e.touches[0],n=t.pageX||0,i=t.pageY||0;n>.5*window.innerWidth||(o.viewElement.style.left=n-o.vw/2+"px",o.viewElement.style.top=i-o.vh/2+"px",o.viewElement.style.transform="scale(1.5) translateZ(0)",o.viewElement.style.transition="transform 1s linear",o.resetElement&&(o.resetElement.style.display="none"),o.fingerElement&&(o.fingerElement.style.transform=`scale(${1/1.5}) translateZ(0)`,o.fingerElement.style.transition="transform 1s linear"),o.dis.sx=n,o.dis.sy=i,s.updateView())},moveFn:e=>{if(!o.viewElement)return;const t=e.touches[0],n=(t.pageX||0)-o.dis.sx,i=(t.pageY||0)-o.dis.sy;o.dis.mx=n,o.dis.my=i,s.moveBtn()},endFn:()=>{o.viewElement&&(o.viewElement.style.left=o.sl+"px",o.viewElement.style.top=o.st+"px",o.viewElement.style.transform="scale(1) translateZ(0)",o.viewElement.style.transition="",o.resetElement&&(o.resetElement.style.display="block"),o.fingerElement&&(o.fingerElement.style.transform="scale(1) translateZ(0)",o.fingerElement.style.transition=""),o.dis.mx=0,o.dis.my=0,s.moveBtn(),cancelAnimationFrame(o.timer))},moveBtn:()=>{if(!o.fingerElement)return;let e=0,t=0;const n=o.vw/2,i=Math.sqrt(o.dis.mx*o.dis.mx+o.dis.my*o.dis.my)>o.vw/2;i?(e=n*Math.cos(Math.atan(o.dis.my/o.dis.mx))*(o.dis.mx>=0?1:-1),t=n*Math.sin(Math.atan(o.dis.my/o.dis.mx))*(o.dis.mx>=0?1:-1)):(e=o.dis.mx,t=o.dis.my),o.fingerElement.style.left=`calc(50% + ${e}px)`,o.fingerElement.style.top=`calc(50% + ${t}px)`},updateView:()=>{const e=i["b"].state.krp.get("view"),t=()=>{e.hlookat+=o.dis.mx/100,e.vlookat+=o.dis.my/100,o.timer=requestAnimationFrame(t)};t()}},a=()=>{o.airposeElement=document.querySelector(".cm__airpose .left_wrap"),o.airposeElement&&(o.viewElement=o.airposeElement.querySelector(".control__view")),o.viewElement&&(o.resetElement=o.viewElement.querySelector(".reset"),o.fingerElement=o.viewElement.querySelector(".finger"),o.vw=o.viewElement.offsetWidth,o.vh=o.viewElement.offsetHeight,o.sl=o.viewElement.offsetLeft,o.st=o.viewElement.offsetTop),o.airposeElement&&(o.airposeElement.addEventListener("touchstart",s.startFn,!1),o.airposeElement.addEventListener("touchmove",s.moveFn,!1),o.airposeElement.addEventListener("touchend",s.endFn,!1)),o.resetElement&&o.resetElement.addEventListener("touchend",t,!1)},r=()=>{o.airposeElement&&(o.airposeElement.removeEventListener("touchstart",s.startFn,!1),o.airposeElement.removeEventListener("touchmove",s.moveFn,!1),o.airposeElement.removeEventListener("touchend",s.endFn,!1)),o.resetElement&&o.resetElement.removeEventListener("touchend",t,!1)};Object(n["watch"])(()=>e.value,e=>{e?Object(n["nextTick"])(()=>{setTimeout(a,1e3)}):r()})}function $g(e){const t=()=>{window.console.log("禁用用户操作"),Nu(),a()},o=()=>{i["b"].state.krp&&(Vu(),c())},s=()=>{const e=i["b"].state.sceneInfo.hotspots.some(e=>e.iconData.isModelIcon),t=i["b"].state.sceneInfo.triggers.some(e=>e.iconData.isModelIcon),o=i["b"].state.sceneInfo.parts.some(e=>9===e.type);return e||t||o},a=()=>{const e=i["b"].state.krp.get("view"),t=i["b"].state.sceneInfo;e.fovtype="MFOV",e.fov=90,e.fovmax=179,e.fovmin=1;const o=s()?0:1;i["b"].state.krp.call(`lookat(${t.hlookat}, ${t.vlookat}, 90, ${o}, 0, 0)`)},r=()=>{const e=i["b"].state.sceneInfo;i["b"].state.krp.call(`tween(view.hlookat|view.vlookat, ${e.hlookat}|${e.vlookat}, 2.0, easeOutQuad)`)},c=()=>{const e=i["b"].state.sceneInfo,t=i["b"].state.krp.get("view");t.hlookat=e.hlookat,t.vlookat=e.vlookat,t.fov=e.fov,t.fovmax=e.fovmax,t.fovmin=e.fovmin,t.fovtype="VFOV",t.distortion=0};return Object(n["watch"])(()=>e.value,e=>{e?t():o()}),{resetView:r}}function Ug(e){let t=null;const o={shotElement:null,shotImgWrap:null,shotImg:null,shotWhite:null,poster:"",dis:{sx:0,sy:0,st:0,mx:0,my:0}},s={loadPlugin(e){if(t)e&&e();else{const o=document.createElement("script");o.src=a()+"cdn/html2canvas.js",o.onload=()=>{t=window.html2canvas,e&&e()},document.body.appendChild(o)}},getscreenshot(){const e=i["b"].state.device.iphone?"#krpanoSWFObject canvas":"#krpanoSWFObject",n=document.querySelector(e);t(n,{useCORS:!0,allowTaint:!1,scale:window.devicePixelRatio}).then(e=>{const t=e.toDataURL("image/png");t&&o.shotImg&&(o.poster=t||"",s.startAnimation())}).catch(()=>{s.stopAnimation()})},showAnimation(){o.shotWhite&&o.shotWhite.classList.add("show")},startAnimation(){o.shotWhite&&o.shotWhite.classList.add("start")},stopAnimation(){o.shotWhite&&o.shotWhite.classList.remove("start")},animationEndCb(){var e;o.shotImg&&(o.shotImg.classList.add("show"),null===(e=o.shotImgWrap)||void 0===e||e.classList.add("show"),o.shotImg.src=o.poster,requestAnimationFrame(()=>{o.shotImg&&o.shotImg.classList.add("start")}))},initScreenshot(){s.showAnimation(),s.loadPlugin(()=>{s.getscreenshot()})},touchstartFn(e){const t=e.touches[0];o.dis.st=Date.now(),o.dis.sx=t.pageX,o.dis.sy=t.pageY},touchMoveFn(e){const t=e.touches[0];o.dis.mx=t.pageX,o.dis.my=t.pageY},touchendFn(){const e=Date.now()-o.dis.st,t=Math.abs(o.dis.mx-o.dis.sx),n=o.dis.my-o.dis.sy;t>=30&&n<=-30&&e<=300&&s.resetFn()},resetFn(){o.shotWhite&&(o.shotWhite.classList.remove("start"),o.shotWhite.classList.remove("show")),o.shotImg&&(o.shotImg.classList.remove("start"),o.shotImg.classList.remove("show"),o.shotImg.src=""),o.shotImgWrap&&o.shotImgWrap.classList.remove("show"),o.poster=""}},r=()=>{o.shotElement=document.querySelector(".cm__airpose .shot"),o.shotImg=document.querySelector(".cm__airpose .shot-img"),o.shotWhite=document.querySelector(".cm__airpose .white_bg"),o.shotImgWrap=document.querySelector(".cm__airpose .shot-img-wrap"),o.shotElement&&o.shotElement.addEventListener("touchend",s.initScreenshot,!1),o.shotWhite&&o.shotWhite.addEventListener("transitionend",s.animationEndCb,!1),o.shotImg&&(o.shotImg.addEventListener("touchstart",s.touchstartFn,!1),o.shotImg.addEventListener("touchmove",s.touchMoveFn,!1),o.shotImg.addEventListener("touchend",s.touchendFn,!1))},c=()=>{o.shotElement&&o.shotElement.removeEventListener("touchend",s.initScreenshot,!1),o.shotWhite&&(o.shotWhite.removeEventListener("transitionend",s.animationEndCb,!1),o.shotWhite.classList.remove("start"),o.shotWhite.classList.remove("show")),o.shotImg&&(o.shotImg.removeEventListener("touchstart",s.touchstartFn,!1),o.shotImg.removeEventListener("touchmove",s.touchMoveFn,!1),o.shotImg.removeEventListener("touchend",s.touchendFn,!1),o.shotImg.classList.remove("start"),o.shotImg.classList.remove("show"),o.shotImg.src=""),o.shotImgWrap&&o.shotImgWrap.classList.remove("show"),o.poster=""};Object(n["watch"])(()=>e.value,e=>{e?Object(n["nextTick"])(r):c()})}function Xg(){let e=!1;const t=Object(n["ref"])(!1),o=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.otherSettingInfo||{},o=e.enableAirpose,n=i["b"].state.device.mobile,s=i["b"].state.sceneInfo.is2dRender;return o&&n&&!s&&t.value}),s={resizeChangeFn:()=>{t.value=90===window.orientation||-90===window.orientation},visibleChangeFn:e=>{t.value=!!e&&(90===window.orientation||-90===window.orientation)}},a=()=>{e=!0;const o=i["b"].state.device.mobile;if(o){t.value=window.innerWidth>=window.innerHeight;const e="onorientationchange"in window?"orientationchange":"resize";window.addEventListener(e,s.resizeChangeFn,!1),Ns.on("visibleChangeFn",s.visibleChangeFn)}};return Object(n["watch"])(()=>!e&&i["b"].state.lifecycle.isLoadedScene,e=>{e&&a()}),Object(n["watch"])(()=>o.value,e=>{const t=i["b"].state.skyBoxSceneGroup.otherSettingInfo;i["b"].state.lifecycle.isLoadedAnimation&&t.enableAirpose&&Ns.emit(ra,e),i["b"].commit(jo["j"],{key:"airpose",value:e})}),{isRendered:o}}o("ea5e");const Yg=Tr()(Rg,[["render",Vg],["__scopeId","data-v-6c1795c0"]]);var Zg=Yg;function qg(e,t,o,i,s,a){return i.noticeInfo.isShow?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"notice-container",style:Object(n["normalizeStyle"])(`\n    background-color: ${i.noticeInfo.bgColor};\n    opacity: ${i.noticeInfo.bgOpacity};\n    color: ${i.noticeInfo.fontColor};\n    font-size: ${i.noticeInfo.fontSize}px;\n    height: ${i.noticeInfo.fontSize+20}px;\n    line-height: ${i.noticeInfo.fontSize+20}px;\n    visibility: ${i.isShowNotice?"visible":"hidden"}\n  `)},[Object(n["createElementVNode"])("div",{id:"scroll",class:"scroll",style:Object(n["normalizeStyle"])(`\n        animation: scroll linear ${i.scrollTime}s 1;\n        animation-play-state: ${i.animationPlayState};\n        right: -${i.textWidth}px;\n        letter-spacing: ${i.noticeInfo.wordSpace}px;\n        `)},Object(n["toDisplayString"])(i.noticeInfo.noticeText),5)],4)),[[n["vShow"],!i.props.pure]]):Object(n["createCommentVNode"])("",!0)}var Kg={props:{pure:{type:Boolean,default:!1}},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.noticeInfo||{}),o=Object(n["ref"])(0),s=Object(n["ref"])(0);let a=Object(n["ref"])(0);const r=Object(n["ref"])(!1),c=Object(n["ref"])("running"),l=()=>{Object(n["nextTick"])(()=>{var e,n;if(r.value)return;a.value=null!==(e=null===(n=document.getElementById("scroll"))||void 0===n?void 0:n.clientWidth)&&void 0!==e?e:0,s.value=document.documentElement.clientWidth||document.body.clientWidth,o.value=Math.round((a.value+s.value)/t.value.rollSpeed);let i=document.styleSheets[0];a.value&&i.insertRule(`@keyframes scroll {0% {transform: translateX(0);}100% {transform: translateX(-${a.value+s.value}px);}}`);const c=document.getElementById("scroll");null===c||void 0===c||c.addEventListener("animationend",d,!1);let l=null;function d(){c.setAttribute("style",`right: -${a.value}px;letter-spacing: ${t.value.wordSpace}px;`),l=setTimeout(()=>{c.setAttribute("style",`animation: scroll linear ${o.value}s 1;right: -${a.value}px;letter-spacing: ${t.value.wordSpace}px;`)},1e3*t.value.spaceTime)}r.value=!0,clearTimeout(l)})},d=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t}),u=Object(n["computed"])(()=>{const e=i["b"].state.sceneInfo.sort,o=t.value.applyScenIds||[];return o.includes(e)}),p=Object(n["computed"])(()=>d.value&&u.value);return Object(n["watch"])(()=>p.value,e=>{e?(l(),c.value="running"):c.value="paused"}),{props:e,store:i["b"],noticeInfo:t,textWidth:a,animationPlayState:c,loaded:d,scrollTime:o,windowWidth:s,isShowNotice:p,handleScroll:l}}};o("8145");const Jg=Tr()(Kg,[["render",qg],["__scopeId","data-v-4df69d50"]]);var Qg=Jg;const ey={key:0,class:"send_container"},ty={class:"send_talk"},oy=["placeholder"],ny={key:0,class:"error_words"},iy={class:"send_footer"},sy=["disabled"];function ay(e,t,o,i,s,a){return Object(n["openBlock"])(),Object(n["createBlock"])(n["Transition"],{name:"fadeInBottom"},{default:Object(n["withCtx"])(()=>[i.talkVisible?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ey,[Object(n["createElementVNode"])("div",ty,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{class:Object(n["normalizeClass"])(["send_input",i.hasError]),placeholder:e.$t("talk.placeholder"),"onUpdate:modelValue":t[0]||(t[0]=e=>i.content=e),maxlength:50},null,10,oy),[[n["vModelText"],i.content]]),i.hasError?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",ny,Object(n["toDisplayString"])(e.$t("talk.errorTip"))+"【"+Object(n["toDisplayString"])(i.checkSenWords.join(", "))+"】",1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",iy,[Object(n["createElementVNode"])("button",{disabled:!i.content,type:"button",class:"btn send_button",onClick:t[1]||(t[1]=(...e)=>i.sendTalk&&i.sendTalk(...e))},Object(n["toDisplayString"])(e.$t("talk.send")),9,sy)])])):Object(n["createCommentVNode"])("",!0)]),_:1})}function ry(e){return new Promise((t,o)=>{So["b"].post(Io["a"].talkList(),e).then(e=>{t(e.data)}).catch(e=>{o(e)})})}function cy(e){return new Promise((t,o)=>{So["b"].post(Io["a"].saveTalk(),e).then(e=>{t(e.data)}).catch(e=>{o(e)})})}class ly extends Tl{constructor(e){super(e),this.options=e,this.key=this.options.key,this.el=null,this.create(this.setConfig())}setConfig(){const e={type:"image",ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,url:"%$prevPath%/skin/assets/talk_ys.png",edge:"bottom",width:40,height:40,capture:!0,handcursor:!0,enabled:!0,visible:this.options.fixed.visible,zorder:101,onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return e}create(e){new Cl(i["b"].state.krp,this.options.key,e)}saveInstanceToParent(){this.updateInstance(this.el)}destroy(){super.destroy(),this.el&&(this.el=null)}}class dy extends Tl{constructor(e){super(e),this.options=e,this.key=this.options.key,this.el=null,this.create(this.setConfig())}setConfig(){const e={type:"text",ath:this.options.fixed.position.x,atv:this.options.fixed.position.y,ox:-20,oy:-40,width:this.options.content.width,edge:"leftbottom",capture:!0,enable:!0,visible:this.options.fixed.visible,zorder:101,html:this.options.content.html,css:this.options.content.css,autoheight:"auto",bg:!0,bgcolor:"0xDD6919",bgalpha:"0.9",bgroundedge:"10",onloaded:()=>{this.el=i["b"].state.krp.get(`hotspot[${this.options.key}]`),super.onloaded(),this.saveInstanceToParent()},onover:super.onover.bind(this),onout:super.onout.bind(this),ondown:super.ondown.bind(this),onup:super.onup.bind(this),onclick:super.onclick.bind(this)};return e}create(e){new Cl(i["b"].state.krp,this.options.key,e)}saveInstanceToParent(){this.updateInstance(this.el)}destroy(){super.destroy(),this.el&&(this.el=null)}}class uy extends Ol{constructor(e,t){const o={fixed:e.fixed};super(o),this.el=null,this.initImgComponent(e),this.initTxtComponent(e),this.events=Al(t,{show:this.onshow.bind(this),hide:this.onhide.bind(this)})}initImgComponent(e){this.el=new ly({key:e.key,fixed:e.fixed,content:{},events:Pl.bind(this)()}),super.push(this.el)}initTxtComponent(e){const t=new dy({key:e.key+"_txt",fixed:e.fixed,content:{width:e.width,html:e.html,css:e.css},events:Pl.bind(this)()});super.push(t)}onshow(){}onhide(){}destroy(){super.destroy(),this.el&&(this.el.destroy(),this.el=null)}}var py=uy,hy=o("55b6");const{talkVisibleList:fy,exitTalkVisible:my,bubbleKey:vy,initTalkData:by}=ky(),{toggleTalkBubble:gy,toggleShieldTalk:yy}=jy(),{setTalkTextHtml:wy,addTalk:xy}=Cy(),{dragstart:Sy,dragend:Iy}=Ay();function ky(){const e=Object(n["ref"])([]),t=Object(n["ref"])(!0),o="talk_bubble",s=o=>{t.value=o;const n=i["b"].state.proInfo.pid,s=i["b"].state.sceneInfo.sort,a={materialId:n,sceneId:s};ry(a).then(t=>{if(e.value=[],1!==t.resCode)return;const o=t.resData;o.rows.forEach(t=>{const o={id:t.id,ath:t.positionX,atv:t.positionY,content:t.content};e.value.push({name:"talk_image_"+t.id,isRendered:!1}),e.value.push({name:"talk_txt_"+t.id,isRendered:!1}),Py(o),_y(o)})}),Ty(),Ey({talkVisibleList:e})};return Ns.on(pa,()=>{e.value=[]}),{talkVisibleList:e,exitTalkVisible:t,bubbleKey:o,initTalkData:s}}function Oy(e){fy.value.forEach(t=>{t.name===e.name&&(t.isRendered=!0)})}function jy(){const e=e=>{const t=i["b"].state.krp,o=t.get("view.hlookat"),n=t.get("view.vlookat");if(e){gu(vy),pu(vy,{x:o,y:n,z:0});const e=`<div>${hy["a"].global.t("talk.dragTip")}</div>`;t.set("hotspot['talk_bubble_txt'].html",e),Ns.emit(ha,{ath:o,atv:n})}else yu(vy)},t=e=>{const t=i["b"].state.krp;fy.value.forEach(o=>{t.set(`hotspot[${o.name}].visible`,e)})};return{toggleTalkBubble:e,toggleShieldTalk:t}}function Cy(){const e=e=>{const t=`<div>${e}</div>`;i["b"].state.krp.set("hotspot['talk_bubble_txt'].html",t)},t=e=>{fy.value.push({name:"talk_image_"+e.id,isRendered:!1}),fy.value.push({name:"talk_txt_"+e.id,isRendered:!1}),Py(e),_y(e)};return{setTalkTextHtml:e,addTalk:t}}function Ey({talkVisibleList:e}){const t=Object(n["ref"])(!1),o=Object(n["computed"])(()=>e.value.map(e=>e.isRendered));Object(n["watch"])(()=>o.value,e=>{t.value=e.every(e=>e)}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e||(t.value=!1)});const s=()=>{e.value.map(e=>{requestAnimationFrame(()=>{i["b"].state.krp.set(`hotspot[${e.name}].visible`,my.value)})})};Object(n["watch"])(()=>t.value,e=>{e&&setTimeout(()=>{s()},100)})}function Ty(){const e=i["b"].state.sceneInfo.is2dRender,t=i["b"].state.device.mobile;let o="14px",n="60px",s=200,a=10;t&&(a=e?3:5,o=e?"10px":"12px",n="50px",s=160);const r=`${a}px 10px ${a}px 10px`,c=`<div>${hy["a"].global.t("talk.dragTip")}</div>`,l={display:"table-cell","box-sizing":"border-box","font-size":o,"font-weight":"500","font-family":"Arial, sans-serif",color:"#FFF","min-width":s+"px",height:n,padding:r,"vertical-align":"middle","line-height":"1.5"},d={key:vy,fixed:{position:{x:0,y:0},rotate:{rx:0,ry:0,rz:0},scale:1,opacity:1,visible:!1},width:s,html:c,css:un(l)},u=new py(d,{down(){Sy()},up(){const e=Iy();Ns.emit(ha,e)}});du(vy,[u])}function Py(e){const t="talk_image_"+e.id,o={id:1,type:"image",ath:e.ath,atv:e.atv,initath:e.ath,initatv:e.atv,ox:-8,edge:"leftbottom",url:"%$prevPath%/skin/assets/talk_point.png",width:40,height:40,visible:!!e.visible&&e.visible,zorder:100,onloaded:()=>{Oy({name:t,status:!0})}};new Cl(i["b"].state.krp,t,o)}function _y(e){const t="talk_txt_"+e.id,o=i["b"].state.sceneInfo.is2dRender,n=i["b"].state.device.mobile;let s=1,a=10;const r=10;n?(a=o?3:5,s=o?1:1.2):(a=10,s=1.4);const c=`${a}px ${r}px ${a}px ${r}px`,l=Math.round(10*s)+"px",d=`<div>${e.content}</div>`,u={display:"table-cell","box-sizing":"border-box","font-size":l,"font-weight":"500","font-family":"Arial, sans-serif",color:"#FFF",padding:c,"vertical-align":"middle"},p={id:1,type:"text",ath:e.ath,atv:e.atv,initath:e.ath,initatv:e.atv,ox:30,oy:-38,autowidth:"auto",autoheight:"auto",edge:"leftbottom",visible:!!e.visible&&e.visible,zorder:100,html:d,css:un(u),bg:!0,bgcolor:"0x000000",bgalpha:"0.7",onloaded:()=>{Oy({name:t,status:!0})}};new Cl(i["b"].state.krp,t,p)}function Ay(){const e={timer:0,dis:{startx:0,starty:0,movex:0,movey:0},end:{x:0,y:0,z:0}},t="talk_bubble",o=()=>{Nu();const o=lu(t);e.end.x=o.position.x,e.end.y=o.position.y;const s=i["b"].state.krp.spheretoscreen(e.end.x,e.end.y),a=i["b"].state.krp.get("mouse");e.dis.startx=a.stagex-s.x,e.dis.starty=a.stagey-s.y,n()},n=()=>{const o=i["b"].state.krp.get("mouse");e.dis.movex=o.stagex-e.dis.startx,e.dis.movey=o.stagey-e.dis.starty;const s=i["b"].state.krp.screentosphere(e.dis.movex,e.dis.movey);pu(t,s),e.end=s,e.timer=requestAnimationFrame(n)},s=()=>(cancelAnimationFrame(e.timer),e.timer=0,Vu(),{ath:e.end.x,atv:e.end.y});return{dragstart:o,dragend:s}}var My={props:{isPureMode:{type:Boolean,require:!0}},setup(e){const{pos:t}=zy(),{talkVisible:o,exitTalkV:n,content:i,hasError:s,checkSenWords:a,sendTalk:r,closeTalk:c}=Hy(t);return{props:e,talkVisible:o,exitTalkV:n,content:i,hasError:s,checkSenWords:a,sendTalk:r,closeTalk:c}}};function Hy(e){const t=Object(n["ref"])(!1),o=Object(n["ref"])(!0),s=Object(n["ref"])(""),a=Object(n["ref"])(""),r=Object(n["ref"])([]),c=e=>{t.value=e};Ns.on(ca,c);const l=e=>{o.value=e};Ns.on(da,l),Object(n["watch"])(s,e=>{wy(e),e||(a.value="")}),Object(n["watch"])(()=>t.value,e=>{e||(s.value=""),e&&(o.value=!0),gy(e),Ns.emit(la,e)}),Object(n["watch"])(()=>o.value,e=>{yy(e),Ns.emit(ua,e)});const d=()=>{const o=wo("Talk");if(!o)return;const n={materialId:i["b"].state.proInfo.pid,sceneId:i["b"].state.sceneInfo.sort,content:s.value,positionX:e.value.ath,positionY:e.value.atv};cy(n).then(o=>{if(1!==o.resCode)return;const n={id:o.resData.id,...e.value,visible:!0,content:s.value};xy(n),t.value=!1})},u=No(d),p=()=>{t.value=!1},h=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});return Object(n["watch"])(()=>h.value,e=>{if(e){const e=window.getTalkPath&&wo("Talk");e&&by(o.value)}else t.value=!1,Ns.emit(pa)}),{talkVisible:t,exitTalkV:o,content:s,hasError:a,checkSenWords:r,sendTalk:u,closeTalk:p}}function zy(){const e=Object(n["ref"])({}),t=t=>{e.value=t};return Ns.on(ha,t),{pos:e}}o("0da0");const Ly=Tr()(My,[["render",ay],["__scopeId","data-v-6a59ffa6"]]);var Dy=Ly;const By={key:0,class:"cm__flat-icons"};function Ny(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("my-icon");return e.isIconCustom?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",By,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.enableUiIcons,(t,o)=>Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:o,value:t,"is-show":!e.props.pure},null,8,["value","is-show"])),[[n["vShow"],e.isShowFlatIcon(t)]])),128)),Object(n["createElementVNode"])("div",{class:"drawer-container",ref:"drawerRef",style:Object(n["normalizeStyle"])([e.containerStyle,e.expandStyle])},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.enableDrawerUiIcons,(t,o)=>Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:o,value:t,"is-show":!e.props.pure,"is-drawer-icon":!0},null,8,["value","is-show"])),[[n["vShow"],e.isShowFlatIcon(t)]])),128))],4)])):Object(n["createCommentVNode"])("",!0)}const Vy=["src"];function Ry(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"icon-container",style:Object(n["normalizeStyle"])([i.wrapStyle]),ref:"iconContainer",onPointerdown:t[4]||(t[4]=(...e)=>i.onDragStartHandle&&i.onDragStartHandle(...e))},[Object(n["createElementVNode"])("img",{class:Object(n["normalizeClass"])([i.isCompassIcon?"icon__compass":""]),style:Object(n["normalizeStyle"])([i.iconStyle,i.compassIconStyle]),src:i.iconPath,alt:"",onClick:t[0]||(t[0]=(...e)=>i.onClickHandle&&i.onClickHandle(...e)),onMouseenter:t[1]||(t[1]=(...e)=>i.onEnterHandle&&i.onEnterHandle(...e)),onMouseleave:t[2]||(t[2]=(...e)=>i.onLeaveHandle&&i.onLeaveHandle(...e))},null,46,Vy),i.iconText?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon__text",style:Object(n["normalizeStyle"])(i.textStyle)},Object(n["toDisplayString"])(i.iconText),5)):Object(n["createCommentVNode"])("",!0),10===i.iconInfo.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:1,class:Object(n["normalizeClass"])(["icon__talk-sub",[i.talksubclass]]),style:Object(n["normalizeStyle"])({height:i.props.isDrawerIcon?"":"100%"}),onClick:t[3]||(t[3]=(...e)=>i.toggleTalkDisabled&&i.toggleTalkDisabled(...e))},null,6)):Object(n["createCommentVNode"])("",!0)],36)),[[n["vShow"],i.isShowIcon]])}var Fy=o("5880");function Gy(){const e=Object(n["ref"])(!0),t=Object(n["computed"])(()=>i["b"].state.lifecycle.isLoadedAnimation);return Object(n["watch"])(()=>t.value,t=>{t&&(e.value=!1)}),Ns.on(ra,t=>{e.value=t}),{pure:e}}var Wy=Gy,$y={props:{value:{type:Object,default:()=>({})},isShow:{type:Boolean,default:!1},isDrawerIcon:{type:Boolean,default:!1}},setup(e){const t=Object(Fy["useStore"])(i["a"]),{pure:o}=Wy(),s=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isShowIcon:a}=Xy(e),r=Object(n["computed"])(()=>e.value.iconInfo||{}),c=Object(n["computed"])(()=>t.state.skyBoxSceneGroup.weChatShare||{}),{dragData:l,onDragStartHandle:d,onDragMoveHandle:u,onDragUpHandle:p}=rw(e),{wrapStyle:h,iconStyle:f}=Yy(r,c.value,e.isDrawerIcon,l),{iconPath:m,isActive:v}=Zy(r,o),{iconText:b,textStyle:g}=qy(r,e.isDrawerIcon),{onClickHandle:y,onEnterHandle:w,onLeaveHandle:x,isDrawerExpand:S}=Jy({props:e,curInstance:s,pure:o,dragData:l},v);Qy(r,v),Ky(e,{onClickHandle:y});const{talksubclass:I,toggleTalkDisabled:k}=tw(),{compassIconStyle:O,isCompassIcon:j}=Uy(e);return{iconInfo:r,iconPath:m,iconText:b,textStyle:g,wrapStyle:h,onClickHandle:y,onEnterHandle:w,onLeaveHandle:x,talksubclass:I,toggleTalkDisabled:k,isShowIcon:a,wxShareData:c,isDrawerExpand:S,isCompassIcon:j,compassIconStyle:O,iconStyle:f,props:e,onDragStartHandle:d,onDragMoveHandle:u,onDragUpHandle:p}}};function Uy(e){const t=Object(n["ref"])({}),o=Object(n["computed"])(()=>{const t=i["b"].state.sceneInfo.sort,o=e.value.applyScenIds||[];return o.includes(t)}),s=Object(n["computed"])(()=>24===e.value.iconInfo.type),a=()=>{t.value={transform:"rotateX(180deg)rotateY(180deg)rotateZ("+(e.value.compassSouthPath-i["b"].state.krp.get("view.hlookat"))+"deg)",display:o.value&&e.value.isCompassShow?"block":"none"}},r=Object(n["computed"])(()=>i["b"].state.lifecycle.isLoadedScene&&i["b"].state.lifecycle.isLoadedAnimation);return Object(n["watch"])(()=>r.value,t=>{24===e.value.iconInfo.type&&t&&i["b"].state.krp.set("events[skin_events].onviewchanged",a)}),{isCompassIcon:s,compassIconStyle:t}}function Xy(e){const t=Object(n["ref"])(!0),o=e=>{t.value=e},i=Object(n["computed"])(()=>{var t;return e.value&&20===(null===(t=e.value.iconInfo)||void 0===t?void 0:t.type)&&1===e.value.displayAlign}),s=Object(n["ref"])(!1),a=()=>{s.value||Ns.on("toggle::icon-status",({id:t,status:n})=>{const i=e.value.iconInfo||{};i.id===t&&5!==e.value.hotpot.type&&o(!n)})};return i.value&&a(),Object(n["watch"])(()=>i.value,e=>{e&&a()}),{isShowIcon:t,updateShowStatus:o}}function Yy(e,t,o,i){const s={width:50,height:50,opacity:1,scale:1,rotation:0},a=e.value||s,r=Object(n["computed"])(()=>{let n=(a.position.x+1)/2*100+"%",s=100*(1-(a.position.y+1)/2)+"%",r=.5*a.size.x*-1+"px",c=.5*a.size.y*-1+"px";if(!o&&13===e.value.type&&t.showLogo)switch(t.iconLogoPos){case 0:n="10px",s="16px",r="0px",c="0px";break;case 1:n="calc(100% - 1rem)",s="calc(100% - 1rem)",r=-1*a.size.x+"px",c=1.5*a.size.x*-1+"px";break;case 2:n="50%",s="1rem",r=.5*a.size.x*-1+"px",c="0px";break;case 3:n="50%",s="calc(100% - 1rem)",r=.5*a.size.x*-1+"px",c=1.5*a.size.x*-1+"px";break;default:break}const l={position:"absolute",left:n,top:s,marginLeft:r,marginTop:c,width:a.size.x+"px",height:a.size.y+"px"},d={display:"flex",flexDirection:"column",alignItems:"center",position:"relative",height:a.size.y+(a.fontSize||14)+16+"px"};return{...o?d:l,opacity:a.opacity,transform:`translate3d(${i.movX}px, ${i.movY}px, 0) scale(${a.scale}) rotate(${-1*a.rotation}deg)`}}),c=Object(n["computed"])(()=>({width:o?a.size.x+"px":"100%",height:o?"":"100%"}));return{wrapStyle:r,iconStyle:c}}function Zy(e,t){const o=Object(n["ref"])(!1),i=Object(n["computed"])(()=>{let n;return n=22===e.value.type?t.value?e.value.iconPath:e.value.iconPathSwitch:o.value&&e.value.iconPathSwitch||e.value.iconPath,n});return{isActive:o,iconPath:i}}function qy(e,t){const{likenum:o,viewnum:i}=ew(),s=Object(n["computed"])(()=>{const t=e.value||{};return t.isTitleShow?t.text:""}),a=Object(n["computed"])(()=>8===e.value.type?o:9===e.value.type?i:s.value),r=t?{}:{position:"absolute",left:"50%",top:"100%",transform:"translateX(-50%) translateZ(0)"},c=Object(n["computed"])(()=>{const t=e.value||{},o=t.fontSize||14;return{fontSize:o+"px",...r}});return{iconText:a,textStyle:c}}function Ky(e,{onClickHandle:t}){Object(n["watch"])(()=>e.isShow,o=>{if(o){var i;const o=null===(i=e.value.iconInfo)||void 0===i?void 0:i.type,s=e.value.selector||{};21===o&&s.expand&&Object(n["nextTick"])(()=>{t(o)})}})}function Jy({props:e,curInstance:t,pure:o,dragData:s},a){const r=Object(n["computed"])(()=>e.value.iconInfo||{}),c=Object(n["computed"])(()=>[20,21].indexOf(r.value.type)>=0),l=t=>e.value.displayMode===t,d=Object(n["ref"])(!1),u=()=>{if(l(0)||!c.value)switch(r.value.type){case 1:Ns.emit(Qs);break;case 2:Ns.emit(ea);break;case 3:Ns.emit(oa);break;case 4:Ns.emit(na);break;case 5:Ns.emit(ta);break;case 6:Ns.emit(ia);break;case 7:Ns.emit(sa);break;case 8:Ns.emit(aa);break;case 10:Ns.emit(ca,!a.value);break;case 11:Ns.emit(fa);break;case 12:Ns.emit(ma);break;case 20:sw(e.value,t,3,s);break;case 21:aw(e.value,t,e.isDrawerIcon);break;case 22:h();break;case 23:f();break;case 25:p();break;default:break}},p=()=>{d.value=!d.value,Ns.emit(Ya,d.value)},h=()=>{Ns.emit(ra,!o.value),Ns.emit(Wa,o.value)},f=()=>{const e=i["b"].state.viewedIds[i["b"].state.viewedIds.length-2];if(e){const t=i["b"].state.viewedIds.slice(0,Math.max(i["b"].state.viewedIds.length-2,0));i["b"].commit(jo["z"],t),Ns.emit(Fs,{sceneId:e})}},m=()=>{!l(2)&&c.value||20===r.value.type&&sw(e.value,t,1,s)},v=()=>{var o;if(!c.value)return;const n=!i["b"].state.device.mobile&&0===e.value.displayAlign,a=5===(null===(o=e.value.hotpot)||void 0===o?void 0:o.type);2===e.value.displayMode&&20===r.value.type&&(n||a)&&sw(e.value,t,-1,s)};return{onClickHandle:u,onEnterHandle:m,onLeaveHandle:v,isDrawerExpand:d}}function Qy(e,t){Object(n["watch"])(()=>i["b"].state.baseIconStatus.promusic_paused,o=>{2===e.value.type&&(t.value=!o)}),Object(n["watch"])(()=>i["b"].state.baseIconStatus.scenemusic_paused,o=>{5===e.value.type&&(t.value=!o)}),Object(n["watch"])(()=>i["b"].state.baseIconStatus.dolike,o=>{8===e.value.type&&(t.value=o)}),Ns.on(la,o=>{10===e.value.type&&(t.value=o)}),Object(n["watch"])(()=>i["b"].state.baseIconStatus.gyro,o=>{7===e.value.type&&(t.value=o)}),Ns.on(Ya,o=>{25===e.value.type&&(t.value=o)})}function ew(){const e=Object(n["computed"])(()=>i["b"].state.statistics||{}),t=Object(n["computed"])(()=>!!e.value.whether),o=Object(n["computed"])(()=>e.value.likeNum),s=Object(n["computed"])(()=>e.value.pv||0);return{whether:t,likenum:o,viewnum:s}}function tw(){const e=Object(n["ref"])(!1),t=Object(n["computed"])(()=>e.value?"":"is--disabled"),o=()=>{Ns.emit(da,e.value)};return Ns.on(ua,t=>{e.value=!t}),{talksubclass:t,toggleTalkDisabled:o}}function ow(){const e={},t=(t,o)=>{e[t]||(e[t]={},e[t].x=o.x,e[t].y=o.y)},o=t=>e[t]||{x:0,y:0};return{getHotspotCopySize:o,copyHotspotSize:t}}const{getHotspotCopySize:nw,copyHotspotSize:iw}=ow();function sw(e,t,o,i){const s=Object(n["ref"])(0),a=e.displayAlign;iw(e.hotpot.id,e.hotpot.content.showSize||{});const r=nw(e.hotpot.id),c=Object(n["ref"])(1),l=()=>{const{iconContainer:e}=t.value.refs;if(!e)return;const o=e.getBoundingClientRect(),n=o.left+o.width/2,i=o.top+o.height/2,{scale:a,align:r}=d(n,i,o);s.value=r,c.value=Math.min(a,1)},d=(e,t,o)=>{const n=[{x:window.innerWidth-o.left,y:window.innerHeight-o.bottom,type:0},{x:2*Math.min(e,window.innerWidth-e),y:window.innerHeight-o.bottom,type:7},{x:o.right,y:window.innerHeight-o.bottom,type:3},{x:o.left,y:window.innerHeight-o.top,type:10},{x:o.left,y:2*Math.min(t,window.innerHeight-t),type:6},{x:o.left,y:o.bottom,type:11},{x:o.right,y:o.top,type:2},{x:2*Math.min(e,window.innerWidth-e),y:o.top,type:5},{x:window.innerWidth-o.left,y:o.top,type:1},{x:window.innerWidth-o.right,y:o.bottom,type:9},{x:window.innerWidth-o.right,y:2*Math.min(t,window.innerHeight-t),type:4},{x:window.innerWidth-o.right,y:window.innerHeight-o.top,type:8}];let i=0,s=0;return n.forEach(e=>{const t=(e.x-10)/r.x,o=(e.y-10)/r.y,n=Math.min(t,o);(!i||n>=i)&&(i=n,s=e.type)}),{scale:i,align:s}},u=()=>{const e={x:0,y:0,xf:"left",yf:"top"},{iconContainer:o}=t.value.refs;if(!o)return e;const n=o.querySelector(".icon__text"),i=o.offsetHeight,a=(null===n||void 0===n?void 0:n.offsetHeight)||0,r=10,c=10,l=0;return[0,3,7].indexOf(s.value)>=0?(e.y=Math.floor(i/2+a),0===s.value?e.x=-1*(i/2+l):3===s.value&&(e.x=i/2+l,e.xf="right")):[1,2,5].indexOf(s.value)>=0?(e.y=-1*(i/2+r),e.yf="bottom",1===s.value?e.x=-1*(i/2+l):2===s.value&&(e.x=i/2+l,e.xf="right")):[4,8,9].indexOf(s.value)>=0?(e.x=i/2+c,8===s.value?e.y=i/2*-1:9===s.value&&(e.y=i/2,e.yf="bottom")):[6,10,11].indexOf(s.value)>=0&&(e.x=-1*(i/2+c),e.xf="right",10===s.value?e.y=i/2*-1:11===s.value&&(e.y=i/2,e.yf="bottom")),e},p=t=>({id:t.id,type:t.type,opacity:1,content:JSON.parse(JSON.stringify(t.content)),closeAnyWhere:e.closeAnyWhere}),h=()=>{let e="",t="";switch(s.value){case 0:case 7:e="left",t="top";break;case 3:e="right",t="top";break;case 10:case 6:e="right",t="top";break;case 11:e="right",t="bottom";break;case 2:e="right",t="bottom";break;case 1:case 5:e="left",t="bottom";break;case 9:e="left",t="bottom";break;case 4:case 8:e="left",t="top";break;default:e="left",t="top";break}return e+" "+t},f=e=>{const t=u();let o=(e.position.x+1)/2,n=1-(e.position.y+1)/2;return"right"===t.xf&&(o=1-o),"bottom"===t.yf&&(n=1-n),t.x*=e.scale,t.y*=e.scale,{position:{x:o,y:n},drag:{x:i.movX,y:i.movY},offset:t,opacity:e.opacity,rotation:e.rotation,scale:e.scale,origin:h()}};let m=null,v=null;const b=()=>{0===m.content.type?Ho(m.content.path):1===m.content.type?Ns.emit(ba,m):2===m.content.type&&Ns.emit("show::flat-hotspot",{hotspotdata:m,styledata:v,displayAlign:a,status:o})},g=()=>{Ns.emit(Fs,{sceneId:m.content.nextSceneId,startTime:m.content.startTime,switchEffect:m.content.switchIndex})},y=()=>{5===m.type?Ns.emit(Ea,m):2===a?Ns.emit(ba,m):Ns.emit("show::flat-hotspot",{hotspotdata:m,styledata:v,displayAlign:a,status:o})},w=()=>{i.pressTime>250||(e.hotpot&&10===e.hotpot.type&&2===e.hotpot.content.type&&l(),v=f(e.iconInfo),m=p(e.hotpot),m.content.showSize&&(m.content.showSize.x=r.x*c.value,m.content.showSize.y=r.y*c.value),m.opacity=v.opacity,10===m.type?b():6===m.type?g():y())};w()}function aw(e,t,o){const n=e.displayAlign,i=()=>{const e={x:0,y:0,xf:"left",yf:"top"},{iconContainer:o}=t.value.refs;if(!o)return e;const i=o.querySelector(".icon__text"),s=o.offsetHeight,a=(null===i||void 0===i?void 0:i.offsetHeight)||0,r=44,c=10,l=0;return[0,3,7].indexOf(n)>=0?(e.y=Math.floor(s/2+a),0===n?e.x=-1*(s/2+l):3===n&&(e.x=s/2+l),3===n&&(e.xf="right")):[1,2,5].indexOf(n)>=0?(e.y=-1*(s/2+r),e.yf="bottom",1===n?e.x=-1*(s/2+l):2===n&&(e.x=s/2+l),2===n&&(e.xf="right")):[4,8,9].indexOf(n)>=0?(e.x=s/2+c,8===n?e.y=s/2*-1:9===n&&(e.y=s/2),9===n&&(e.yf="bottom")):[6,10,11].indexOf(n)>=0&&(e.x=-1*(s/2+c),e.xf="right",10===n?e.y=s/2*-1:11===n&&(e.y=s/2),11===n&&(e.yf="bottom")),e},s=()=>{let e="",t="";switch(n){case 0:case 7:e="left",t="top";break;case 3:e="right",t="top";break;case 10:case 6:e="right",t="top";break;case 11:e="right",t="bottom";break;case 2:e="right",t="bottom";break;case 1:case 5:e="left",t="bottom";break;case 9:e="left",t="bottom";break;case 4:case 8:e="left",t="top";break;default:e="left",t="top";break}return e+" "+t},a=e=>{const t=i();let o=(e.position.x+1)/2,n=1-(e.position.y+1)/2;return"right"===t.xf&&(o=1-o),"bottom"===t.yf&&(n=1-n),t.x*=e.scale,t.y*=e.scale,{position:{x:o,y:n},offset:t,opacity:e.opacity,rotation:e.rotation,scale:e.scale,origin:s()}},r=a(e.iconInfo);Ns.emit("show::flat-selector",{selectordata:{...e.selector,isDrawerSelector:o},styledata:r,status:1})}function rw(e){const t=Object(n["reactive"])({isPress:!1,staX:0,staY:0,movX:0,movY:0,endX:0,endY:0,pressStartTime:0,pressTime:0}),o=Object(n["computed"])(()=>{var t;return(null===(t=e.value)||void 0===t?void 0:t.iconInfo)||{position:{x:0,y:0}}}),i=Object(n["computed"])(()=>{const e=(o.value.position.x+1)/2*window.innerWidth,t=(1-(o.value.position.y+1)/2)*window.innerHeight;return{minTransX:-1*e,maxTransX:window.innerWidth-e,minTransY:-1*t,maxTransY:window.innerHeight-t}}),s=Object(n["computed"])(()=>{var t;return(null===(t=e.value)||void 0===t?void 0:t.hotpot)||{}}),a=Object(n["computed"])(()=>10===s.value.type&&2===s.value.content.type),r=Object(n["ref"])(!1),c=e=>{let t=0,o=0;return e.touches&&e.touches[0]?(t=e.touches[0].pageX,o=e.touches[0].pageY):(t=e.pageX,o=e.pageY),{x:t,y:o}},l=e=>{if(!a.value||r.value)return;e.preventDefault(),t.isPress=!0;const o=c(e);t.staX=o.x,t.staY=o.y,t.pressStartTime=Date.now(),document.addEventListener("pointermove",d),document.addEventListener("pointerup",u)},d=()=>{if(!t.isPress)return;const e=window.event,o=c(e);t.movX=Rn(t.endX+o.x-t.staX,i.value.minTransX,i.value.maxTransX),t.movY=Rn(t.endY+o.y-t.staY,i.value.minTransY,i.value.maxTransY)},u=()=>{t.isPress&&(document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",u),t.isPress=!1,t.endX=t.movX,t.endY=t.movY,t.pressTime=Date.now()-t.pressStartTime)};return Ns.on("toggle::icon-status",({id:e,status:t})=>{e===s.value.id&&(r.value=t)}),{dragData:t,onDragStartHandle:l,onDragMoveHandle:d,onDragUpHandle:u}}o("973f");const cw=Tr()($y,[["render",Ry],["__scopeId","data-v-1ee64294"]]);var lw=cw,dw=Object(n["defineComponent"])({components:{MyIcon:lw},props:{pure:{type:Boolean,default:!1}},setup(e){const t=Object(n["getCurrentInstance"])(),o=Object(n["computed"])(()=>Po(i["b"].state.proInfo.version,"6.1.0")),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.uiIcons||[];return e.filter(e=>"boolean"!==typeof e.enable||e.enable)}),a=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.existDrawerIcon||!1),r=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.drawerUiIcons||[];return e.filter(e=>"boolean"!==typeof e.enable||e.enable)}),{isCleaning:c}=uw(),l=t=>{var o;if(!t)return!1;const n=(null===(o=t.iconInfo)||void 0===o?void 0:o.type)||-1;return!(22!==n||!c.value)||!e.pure},{containerStyle:d,expandStyle:u}=pw(s,t,a);return{isIconCustom:o,enableUiIcons:s,props:e,isShowFlatIcon:l,enableDrawerUiIcons:r,containerStyle:d,expandStyle:u}}});function uw(){const e=Object(n["ref"])(!1);return Ns.on(Wa,t=>{e.value=t}),{isCleaning:e}}function pw(e,t,o){const s=Object(n["ref"])(0),a=Object(n["ref"])({}),r=Object(n["ref"])({}),c=Object(n["computed"])(()=>{if(o.value){const t=e.value.filter(e=>25===e.iconInfo.type);return t[0]}return{iconInfo:{position:{x:0,y:0},size:{x:0,y:0},scale:1}}}),l=Object(n["computed"])(()=>c.value.iconInfo.scale||1),d=Object(n["computed"])(()=>(c.value.iconInfo.size.y+c.value.iconInfo.fontSize+16)*l.value),u=Object(n["computed"])(()=>"Down"===c.value.iconOpeningDirection),p=Object(n["computed"])(()=>`scale(${l.value})`);return Ns.on(Ya,e=>{const t=e?s.value:0,o=`translateY(${e?-s.value*l.value:0}px) ${p.value}`;r.value={height:t+"px",transform:u.value?p.value:o}}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedAnimation,e=>{e&&Object(n["nextTick"])(()=>{const{drawerRef:e}=t.refs;if(!e)return;s.value=e.offsetHeight+20;const o=(c.value.iconInfo.position.x+1)/2*100+"%",n=100*(1-(c.value.iconInfo.position.y+1)/2)+"%",i=`calc(${o} - ${e.offsetWidth/2}px)`;a.value={height:"0px",transform:p.value,borderRadius:(e.offsetWidth+20)/2+"px",left:i,top:u.value?`calc(${n} + ${d.value/2+10}px)`:`calc(${n} - ${c.value.iconInfo.size.y/2}px)`}})}),{containerStyle:a,expandStyle:r}}o("d382");const hw=Tr()(dw,[["render",Ny]]);var fw=hw;const mw=e=>(Object(n["pushScopeId"])("data-v-8cf10530"),e=e(),Object(n["popScopeId"])(),e),vw={class:"contact__inner is--inner"},bw=["innerHTML"],gw={class:"contact__btn"},yw=["href"],ww=mw(()=>Object(n["createElementVNode"])("span",{class:"icon-phone"},null,-1)),xw={class:"icon-text"},Sw={key:1},Iw=mw(()=>Object(n["createElementVNode"])("span",{class:"icon-phone"},null,-1)),kw={class:"icon-text is--disabled"};function Ow(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("popup");return Object(n["openBlock"])(),Object(n["createBlock"])(r,{value:i.isShowContact,onClose:t[1]||(t[1]=e=>i.onHideHandle())},{content:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",vw,[Object(n["createElementVNode"])("div",{class:"contact__con",innerHTML:i.remark||e.$t("ContactTips.empty")},null,8,bw),Object(n["createElementVNode"])("div",gw,[i.userPhone?(Object(n["openBlock"])(),Object(n["createElementBlock"])("a",{key:0,href:i.userPhone},[ww,Object(n["createElementVNode"])("span",xw,Object(n["toDisplayString"])(e.$t("ContactTips.call")),1)],8,yw)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",Sw,[Iw,Object(n["createElementVNode"])("span",kw,Object(n["toDisplayString"])(e.$t("ContactTips.call")),1)]))])])]),footer:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon popup__close",{normal:i.wxShareData.defClose}]),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e)),style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.wxShareData.iconClose+")"})},null,6)]),_:1},8,["value"])}const jw={class:"popup--footer"};function Cw(e,t,o,i,s,a){return Object(n["openBlock"])(),Object(n["createBlock"])(n["Transition"],{name:"fadeInLayout"},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"popup--container",style:Object(n["normalizeStyle"])({zIndex:100+(i.props.index||0),backgroundColor:i.props.bgColor}),ref:"myPopup",onMousedown:t[0]||(t[0]=(...e)=>i.onClickPopupHandle&&i.onClickPopupHandle(...e)),onTouchstart:t[1]||(t[1]=(...e)=>i.onClickPopupHandle&&i.onClickPopupHandle(...e))},[Object(n["renderSlot"])(e.$slots,"header"),Object(n["createElementVNode"])("div",{class:"popup--inner",style:Object(n["normalizeStyle"])({width:`calc(100% - ${i.props.padding})`,height:`calc(100% - ${i.props.padding})`})},[Object(n["renderSlot"])(e.$slots,"content")],4),Object(n["createElementVNode"])("div",jw,[Object(n["renderSlot"])(e.$slots,"footer")])],36),[[n["vShow"],i.props.value]])]),_:3})}var Ew={props:{width:{type:String},value:{type:Boolean},index:{type:Number},maskClosable:{type:Boolean,value:!0,default:!0},padding:{type:String,value:"10%",default:"10%"},bgColor:{type:String,value:"rgba(0, 0, 0, .3)",default:"rgba(0, 0, 0, .3)"}},setup(e,{emit:t}){const o=Object(Fy["useStore"])(i["a"]),s=Object(n["ref"])(Object(n["getCurrentInstance"])()),a=()=>{t("close")},r=t=>{const n=o.state.device.mobile;if(n&&"click"===t.type||!n&&"touchend"===t.type)return;if(!e.maskClosable)return;const{myPopup:i}=s.value.refs;let r=t.target,c=!1;while(r&&r!==i){if(r.classList.contains("is--inner")||r.classList.contains("icon-close")){c=!0;break}r=r.parentNode}c||a()};return{props:e,onClosePopupHandle:a,onClickPopupHandle:r}}};o("8bad");const Tw=Tr()(Ew,[["render",Cw]]);var Pw=Tw,_w={components:{Popup:Pw},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),o=Object(n["computed"])(()=>t.value.phone?"tel:"+t.value.phone:""),s=Object(n["computed"])(()=>a(t.value.remark)),a=e=>e?e.replace(/\n|\r\n/g,"<br>"):"",{isShowContact:r,hideContact:c}=Aw(),l=()=>{c()};return{props:e,remark:s,userPhone:o,wxShareData:t,onHideHandle:l,isShowContact:r}}};function Aw(){const e=Object(n["ref"])(!1),t=()=>{e.value=!1};return Ns.on(ma,()=>{e.value=!e.value}),{isShowContact:e,hideContact:t}}o("ba50");const Mw=Tr()(_w,[["render",Ow],["__scopeId","data-v-8cf10530"]]);var Hw=Mw;const zw={class:"share__inner is--inner"},Lw={class:"share__title"},Dw={key:0,class:"share__qrcode-wrap"};function Bw(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("v-qr-code"),c=Object(n["resolveComponent"])("popup");return Object(n["openBlock"])(),Object(n["createBlock"])(c,{value:i.isShowShare,onClose:t[1]||(t[1]=e=>i.onHideHandle())},{content:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",zw,[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["close-wrap",{normal:i.wxShareData.defClose}]),onClick:t[0]||(t[0]=e=>i.onHideHandle()),style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.wxShareData.iconClose+")"})},null,6),Object(n["createElementVNode"])("h3",Lw,Object(n["toDisplayString"])(e.$t("shareTips")),1),i.shareUrl?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Dw,[Object(n["createVNode"])(r,{value:i.shareUrl,color:{dark:"#1481e6"},width:250},null,8,["value"])])):Object(n["createCommentVNode"])("",!0)])]),_:1},8,["value"])}var Nw={components:{VQrCode:Ar,Popup:Pw},props:{value:{type:Boolean}},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),s=Object(n["computed"])(()=>t.value.icon||a()+o("b167")),{isShowShare:r,hideShare:c}=Vw(),l=()=>{c()},d=Object(n["ref"])("");return Object(n["watch"])(()=>r.value,e=>{e&&(d.value=window.location.href)}),{props:e,shareUrl:d,shareIcon:s,wxShareData:t,onHideHandle:l,isShowShare:r}}};function Vw(){const e=Object(n["ref"])(!1),t=()=>{e.value=!1};return Ns.on(fa,()=>{e.value=!e.value}),{isShowShare:e,hideShare:t}}o("129c");const Rw=Tr()(Nw,[["render",Bw],["__scopeId","data-v-3cb418a1"]]);var Fw=Rw;const Gw=e=>(Object(n["pushScopeId"])("data-v-99a919b0"),e=e(),Object(n["popScopeId"])(),e),Ww={class:"intro-inner is--inner"},$w={class:"title"},Uw={class:"content"},Xw={class:"header"},Yw={class:"intro"},Zw={class:"address"},qw=["src"],Kw=Gw(()=>Object(n["createElementVNode"])("div",{id:"map-container"},null,-1));function Jw(e,t,i,s,a,r){const c=Object(n["resolveComponent"])("popup");return Object(n["openBlock"])(),Object(n["createBlock"])(n["Transition"],{name:"fadeInLayout"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(c,{value:s.isShowIntro,padding:"0px","mask-closable":!1,onClose:t[1]||(t[1]=e=>s.onHideHandle())},{content:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",Ww,[Object(n["createElementVNode"])("div",$w,[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.$t("introduction.title"))+" ",1),Object(n["createElementVNode"])("div",{class:"close",onClick:t[0]||(t[0]=(...e)=>s.onHideHandle&&s.onHideHandle(...e))},"×")]),Object(n["createElementVNode"])("div",Uw,[Object(n["createElementVNode"])("div",Xw,[Object(n["createElementVNode"])("div",Yw,[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(s.introIconData.projectIntroduction||"啊额，作者忘记写简介了~"),1)]),Object(n["createElementVNode"])("div",Zw,[Object(n["createElementVNode"])("img",{src:s.getHTMLPath()+o("c75c"),alt:""},null,8,qw),Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(s.introIconData.projectPos||"暂无"),1)])]),Kw])])]),_:1},8,["value"])]),_:1})}var Qw=o("862d"),ex=o.n(Qw);window._AMapSecurityConfig={securityJsCode:"a1f92c4ff51fd1cffe139736d73a6ac2"};var tx={components:{Popup:Pw},setup(e){const t="e33472127256878b688135b02910ef02",{introIconData:o}=nx(),i=Object(n["ref"])({}),{isShowIntro:s,hideIntro:r}=ox(),c=()=>{r()},l=e=>{const t=document.getElementById("map-container");e.plugin("AMap.PlaceSearch",()=>{const n={city:"全国",pageSize:1,pageIndex:1},s=new e.PlaceSearch(n);let a=o.value.projectPos;s.search(a,(o,n)=>{if("complete"===o&&"OK"===n.info){const o=n.poiList.pois.length;if(o){const o=n.poiList.pois[0],s=o.location.lat,a=o.location.lng;i.value=new e.Map(t,{center:[a,s],zoom:18});const r=new e.Marker({position:new e.LngLat(a,s)});i.value.add(r)}}})})};let d=!1;const u=()=>{ex.a.load({key:t,version:"2.0",plugins:[]}).then(e=>{l(e),d=!0}).catch(e=>{})};return Object(n["watch"])(()=>s.value,e=>{e&&!d&&u()}),{props:e,isShowIntro:s,introIconData:o,map:i,onHideHandle:c,getHTMLPath:a}}};function ox(){const e=Object(n["ref"])(!1),t=()=>{e.value=!1};return Ns.on(na,()=>{e.value=!e.value}),{isShowIntro:e,hideIntro:t}}function nx(){const e=Object(n["ref"])([]),t=i["b"].state.skyBoxSceneGroup.uiIcons||[],o=i["b"].state.skyBoxSceneGroup.drawerUiIcons||[],s=o.filter(e=>4===e.iconInfo.type),a=t.filter(e=>4===e.iconInfo.type),r=s.length?s:a;return e.value=r&&r.length?r[0]:{},{introIconData:e}}o("8b9c");const ix=Tr()(tx,[["render",Jw],["__scopeId","data-v-99a919b0"]]);var sx=ix;const ax=["effect"],rx={class:"sub__txt-wrap"},cx=["innerHTML"];function lx(e,t,o,i,s,a){return i.isExistSubtitle&&i.curSubtitle?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"my-subtitle-wrap",style:Object(n["normalizeStyle"])([i.posStyleObj])},[Object(n["createElementVNode"])("div",{class:"sub__text-rect",effect:i.effectInfo.textEffect,style:Object(n["normalizeStyle"])(`width: ${i.effectInfo.showRect.x}px;height: ${i.effectInfo.showRect.y}px;`)},[Object(n["createElementVNode"])("div",rx,[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"sub__txt",ref:"mySubTitle",style:Object(n["normalizeStyle"])([i.txtStyleObj]),innerHTML:i.curSubtitle.content},null,12,cx),[[n["vShow"],i.curSubtitle.content]])])],12,ax)],4)):Object(n["createCommentVNode"])("",!0)}function dx(e,t){const o=e.split("\n");for(let i=0;i<o.length;i++){if(""!==o[i].trim())break;""===o[i].trim()&&(o.splice(0,1),i--)}for(let i=o.length-1;i>-1;i--){if(""!==o[i].trim())break;""===o[i].trim()&&o.splice(o.length-1,1)}const n=void 0===t?ux(o):t;return"SRT"===n?fx(o):"LRC"===n?px(o):void 0}function ux(e){return e[0].startsWith("[")?"LRC":"SRT"}function px(e){const t={},o=[];for(let n=0;n<e.length;n++){let i=e[n];if(-1===i.indexOf("[")||-1===i.indexOf("]"))continue;const s=i.substring(i.lastIndexOf("]")+1);for(;;){if(-1===i.indexOf("[")||-1===i.indexOf("]"))break;const e=i.substring(i.indexOf("[")+1,i.indexOf("]")),n=e.split(":");if(i=i.substring(i.indexOf("]")+1),2!==n.length)if(3!==n.length){if(4===n.length){const t=parseInt(n[0]),i=parseInt(n[1]),a=parseInt(n[2]),r=parseInt(n[3]);o.push({time:{baseForm:e,hour:t,minute:i,second:a,millisecond:r,htmlCurrentTime:3600*t+60*i+a+r/1e3},content:s})}}else if(-1===n[2].indexOf(".")){const t=parseInt(n[0]),i=parseInt(n[1]),a=parseInt(n[2]);o.push({time:{baseForm:e,minute:t,second:i,millisecond:a,htmlCurrentTime:60*t+i+a/1e3},content:s})}else{const t=parseInt(n[0]),i=parseInt(n[1]),a=parseInt(n[2].split(".")[0]),r=parseInt(n[2].split(".")[1]);o.push({time:{baseForm:e,hour:t,minute:i,second:a,millisecond:r,htmlCurrentTime:3600*t+60*i+a+r/1e3},content:s})}else if(-1===n[1].indexOf(".")||isNaN(parseInt(n[0])))t[n[0]]=n[1];else{const t=parseInt(n[0]),i=parseInt(n[1].split(".")[0]),a=parseInt(n[1].split(".")[0]);o.push({time:{baseForm:e,minute:t,second:i,millisecond:a,htmlCurrentTime:60*t+i+a/1e3},content:s})}}}return hx(t,o)}function hx(e,t){const o={content:[]};for(const n in e)o[n]=e[n];for(let n=0;n<t.length;n++)o.content.push({time:t[n].time,content:t[n].content});return o}function fx(e){e.push(""),e.push("--\x3e");const t=[];let o=0;for(let n=0;n<e.length;n++)if(-1!==e[n].indexOf("--\x3e")){if(0===o){o=n;continue}const i=e[o].replace(/ /g,""),s=i.split("--\x3e")[0],a=i.split("--\x3e")[1],r=mx(s),c=mx(a);t.push({id:e[o-1],startTime:{baseForm:s,hour:r.hour,minute:r.minute,second:r.second,millisecond:r.millisecond,htmlCurrentTime:3600*r.hour+60*r.minute+r.second+r.millisecond/1e3},endTime:{baseForm:a,hour:c.hour,minute:c.minute,second:c.second,millisecond:c.millisecond,htmlCurrentTime:3600*c.hour+60*c.minute+c.second+c.millisecond/1e3},content:vx(e,o,n)}),o=n}return t}function mx(e){const t=parseInt(e.split(":")[0]),o=parseInt(e.split(":")[1]),n=parseInt(e.split(":")[2].split(",")[0]),i=parseInt(e.split(":")[2].split(",")[1]);return{hour:t,minute:o,second:n,millisecond:i}}function vx(e,t,o){let n="";for(let i=t+1;i<o-1;i++)n+=e[i],i<o-2&&(n+="\n");return n}const bx={parse:dx};var gx=bx,yx={setup(){const e=Object(n["ref"])(Object(n["getCurrentInstance"])()),{srtList:t,isExistSubtitle:o,isComplete:i}=wx(),{posStyleObj:s,txtStyleObj:a,effectInfo:r}=jx(i),{startAnimation:c,stopAnimation:l}=Cx({effectInfo:r,isComplete:i,curInstance:e}),{curSubtitle:d}=xx({srtList:t,isComplete:i,startAnimation:c,stopAnimation:l});return{curSubtitle:d,isExistSubtitle:o,posStyleObj:s,txtStyleObj:a,effectInfo:r}}};function wx(){const e=Object(n["ref"])([]),t=Object(n["ref"])(!1),o=Object(n["ref"])(!1),s=()=>{const t=i["b"].state.sceneInfo.subtitle;Object(xo["b"])(t.path).then(t=>{e.value=a(t),o.value=!0})},a=e=>{const t=gx.parse(String(e),"SRT"),o=[];return t.forEach(e=>{const t=o[o.length-1],n={id:e.id,startTime:e.startTime.htmlCurrentTime,endTime:e.endTime.htmlCurrentTime,content:e.content.trim(),waitTime:0};t&&(t.waitTime=parseFloat((n.startTime-t.endTime).toFixed(2))),n.content&&(/\n$/.test(n.content)||(n.content=n.content.replace(/\n/g,"<br/>")),o.push(n))}),o},r=()=>{t.value=!1,e.value=[],o.value=!1},c=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});return Object(n["watch"])(()=>c.value,e=>{if(e){const e=i["b"].state.sceneInfo.subtitle;e.path&&(t.value=!0,s())}else r()}),Ns.on(Vs,()=>{r()}),{srtList:e,isExistSubtitle:t,isComplete:o}}function xx({srtList:e,isComplete:t,startAnimation:o,stopAnimation:s}){const a=Object(n["ref"])(null);let r=!1,c=!1;const l=Object(n["ref"])(-1),d=()=>{const n=i["b"].state.sceneInfo.subtitle||{};if(!n.path)return;const d=i["b"].state.sceneInfo.subtitle.follow;l.value=d?2:i["b"].state.sceneInfo.type?1:0,0===d?i["b"].state.sceneInfo.type&&!r?(r=!0,kx(e,a,l,t,{startAnimation:o,stopAnimation:s})):i["b"].state.sceneInfo.type||Sx(e,a,l,t,{startAnimation:o,stopAnimation:s}):1!==d||c||(c=!0,Ix(e,a,l,t,{startAnimation:o,stopAnimation:s}))};return Object(n["watch"])(()=>t.value,e=>{e?d():a.value=null}),{curSubtitle:a}}function Sx(e,t,o,s,{startAnimation:a,stopAnimation:r}){const c={start:0,end:0},l=e.value[e.value.length-1].endTime;let d=0,u=0,p=0;const h=(o=!1)=>{o||(u=Date.now()),window.clearInterval(d),d=window.setInterval(()=>{const o=Date.now(),n=(o-u)/1e3;if(n>l)return t.value&&(t.value.content=""),void clearInterval(d);if(n>=c.start&&n<=c.end)return;const i=Ox({srtList:e,interval:n,curRange:c});i?t.value=i:t.value&&t.value.waitTime>1&&(t.value.content="");const s=t.value?parseInt(t.value.id):0;t.value&&t.value.content&&p!==s&&(p=parseInt(t.value.id),r(),a())},200)};0===o.value&&h(),Object(n["watch"])(()=>s.value,e=>{e||(clearInterval(d),c.start=0,c.end=0,r())}),Object(n["watch"])(()=>i["b"].state.pageStatus.newpage,e=>{e?(window.clearInterval(d),r()):h(!0)})}function Ix(e,t,o,s,{startAnimation:a,stopAnimation:r}){const c={start:0,end:0},l=e.value[e.value.length-1].endTime;let d=0;const u=n=>{if(2!==o.value)return;if(n>l)return void(t.value&&(t.value.content=""));if(n>=c.start&&n<=c.end)return;const i=Ox({srtList:e,interval:n,curRange:c});if(i?t.value=i:t.value&&t.value.waitTime>1&&(t.value.content=""),!t.value||!t.value.content)return;const s=t.value?parseInt(t.value.id):0;t.value&&t.value.content&&d!==s&&(d=parseInt(t.value.id),r(),a())};Object(n["watch"])(()=>i["b"].state.scenemusic.time,e=>{u(e)}),Object(n["watch"])(()=>i["b"].state.scenemusic.ended,e=>{e&&(t.value&&(t.value.content=""),r())}),Object(n["watch"])(()=>s.value,e=>{e||(c.start=0,c.end=0)})}function kx(e,t,o,s,{startAnimation:a,stopAnimation:r}){const c={start:0,end:0},l=e.value[e.value.length-1].endTime;let d=0;const u=n=>{if(1!==o.value)return;if(n>l)return void(t.value&&(t.value.content=""));if(n>=c.start&&n<=c.end)return;const i=Ox({srtList:e,interval:n,curRange:c});i?t.value=i:t.value&&t.value.waitTime>1&&(t.value.content="");const s=t.value?parseInt(t.value.id):0;t.value&&t.value.content&&d!==s&&(d=parseInt(t.value.id),r(),a())};Object(n["watch"])(()=>i["b"].state.scenevideo.time,e=>{u(e)}),Object(n["watch"])(()=>i["b"].state.scenevideo.ended,e=>{e&&(t.value&&(t.value.content=""),r())}),Object(n["watch"])(()=>s.value,e=>{e||(c.start=0,c.end=0)})}function Ox({srtList:e,interval:t,curRange:o}){for(let n=0,i=e.value.length;n<i;n++){const i=e.value[n],s=i.startTime,a=i.endTime;if(t>=s&&t<=a)return o.start=s,o.end=a,i}}function jx(e){const t=Object(n["ref"])(null),o=Object(n["ref"])(null),s=Object(n["ref"])(null),a=()=>{const e=i["b"].state.sceneInfo.subtitle;if(e.path){const n=e.offset.x,i=-1*e.offset.y;t.value={},[0,1,2].indexOf(e.pos)>=0?t.value.top=-1*i+"px":[3,4,5].indexOf(e.pos)>=0?(t.value.top=`calc(50% - ${i}px)`,t.value.transform="translateY(-50%)"):[6,7,8].indexOf(e.pos)>=0&&(t.value.bottom=i+"px"),[0,3,6].indexOf(e.pos)>=0?(t.value["justify-content"]="flex-start",t.value["margin-left"]=n+"px"):[1,4,7].indexOf(e.pos)>=0?(t.value["justify-content"]="center",t.value["margin-left"]=n+"px"):[2,5,8].indexOf(e.pos)>=0&&(t.value["justify-content"]="flex-end",t.value["margin-left"]=n+"px"),[2,5,8].indexOf(e.pos)<0&&n&&(t.value["width"]=`calc(100% - ${n}px)`);const a=.1;o.value={"font-family":e.font.family||"YouYuan","font-size":e.font.size+"px","font-weight":e.font.weight,"font-style":e.font.style,"text-decoration":e.font.decoration,"letter-spacing":e.font.letterSpacing*a+"px","text-align":e.font.alignMode,color:e.font.color,background:e.font.background},e.font.lineSpacing&&(o.value["line-height"]=e.font.lineSpacing+e.font.size+"px"),s.value={textEffect:e.textEffect||2,charSize:e.font.size,showRect:e.showRect||{}}}};return Object(n["watch"])(()=>e.value,e=>{e?a():(t.value=null,o.value=null)}),{posStyleObj:t,txtStyleObj:o,effectInfo:s}}function Cx({effectInfo:e,isComplete:t,curInstance:o}){let i=null,s=null,a=null,r=null;const c=()=>{1===a.textEffect?i=()=>{const e=parseInt(a.charSize),t=300,o=a.showRect.x;let n=0,i=0;requestAnimationFrame(()=>{n=r.scrollWidth,i=Math.ceil(n/e)*(t/1e3),c()}),s=()=>{r.style.transitionDuration="0s",r.style.transform=`translateX(${o}px)`,i=Math.ceil((n+o)/e)*(t/1e3),requestAnimationFrame(()=>{r.style.transitionDuration=i+"s",r.style.transform=`translateX(${-1*n}px)`})};const c=()=>{requestAnimationFrame(()=>{r.style.transitionDuration=i+"s",r.style.transform=`translateX(${-1*n}px)`}),s&&r.addEventListener("transitionend",s,!1)}}:2===a.textEffect&&(i=()=>{const e=parseInt(a.charSize),t=300,o=a.showRect.y;let n=0,i=0;requestAnimationFrame(()=>{n=r.scrollHeight,i=Math.ceil(n/e)*(t/1e3),c()}),s=()=>{r.style.transitionDuration="0s",r.style.transform=`translateY(${o}px)`,i=Math.ceil((n+o)/e)*(t/1e3),requestAnimationFrame(()=>{r.style.transitionDuration=i+"s",r.style.transform=`translateY(${-1*n}px)`})};const c=()=>{requestAnimationFrame(()=>{r.style.transitionDuration=i+"s",r.style.transform=`translateY(${-1*n}px)`}),s&&r.addEventListener("transitionend",s,!1)}}),i&&i()},l=()=>{e.value.textEffect>0&&Object(n["nextTick"])(()=>{const{mySubTitle:t}=o.value.refs;r=t,a=e.value,r&&c()})},d=()=>{r?i&&i():l()},u=()=>{r&&(r.style.transitionDuration="0s",r.style.transform="translateX(0) translateY(0)")},p=()=>{r&&s&&(r.removeEventListener("transitionend",s,!1),a=null,r=null,s=null,i=null)};return Object(n["watch"])(()=>t.value,e=>{e||p()}),{startAnimation:d,stopAnimation:u}}o("b768");const Ex=Tr()(yx,[["render",lx],["__scopeId","data-v-3e84b610"]]);var Tx=Ex;const Px={class:"project__inner is--inner"},_x={class:"project__top"},Ax={class:"project__con"},Mx={class:"project__title"},Hx={class:"project__desc"},zx={class:"project__cover-wrap"},Lx=["src"];function Dx(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("popup");return Object(n["openBlock"])(),Object(n["createBlock"])(r,{value:i.isShowProDetail,onClose:t[1]||(t[1]=e=>i.onHideHandle())},{content:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",Px,[Object(n["createElementVNode"])("div",_x,[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(i.props.title),1)]),Object(n["createElementVNode"])("div",Ax,[Object(n["createElementVNode"])("h1",Mx,Object(n["toDisplayString"])(i.wxShareData.title),1),Object(n["createElementVNode"])("p",Hx,Object(n["toDisplayString"])(i.wxShareData.description),1),Object(n["createElementVNode"])("div",zx,[Object(n["createElementVNode"])("img",{src:i.wxShareData.icon,alt:""},null,8,Lx)])])])]),footer:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon popup__close",{normal:i.wxShareData.defClose}]),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e)),style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.wxShareData.iconClose+")"})},null,6)]),_:1},8,["value"])}var Bx={components:{Popup:Pw},props:{title:{type:String,default:"项目详情"}},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),{isShowProDetail:o,hideProDetail:s}=Nx(),a=()=>{s()};return{props:e,isShowProDetail:o,wxShareData:t,onHideHandle:a}}};function Nx(){const e=Object(n["ref"])(!1),t=()=>{e.value=!1};return Ns.on(va,()=>{e.value=!e.value}),{isShowProDetail:e,hideProDetail:t}}o("2a62");const Vx=Tr()(Bx,[["render",Dx],["__scopeId","data-v-04b4a81f"]]);var Rx=Vx;const Fx={key:0,class:"my-base-sceneList-wrap"},Gx={class:"my-theme-wrap my-child-theme-wrap"},Wx={key:1,class:"my-concise-sceneList-wrap"},$x={class:"my-theme-wrap my-child-theme-wrap"};function Ux(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("Child"),c=Object(n["resolveComponent"])("Parent"),l=Object(n["resolveComponent"])("v-compass");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[i.isEnableList&&!i.isConciseModel?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Fx,[i.isCompassType?(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:1,show:i.isEnableGroup&&i.isExpandGroup,"group-list":i.groupNavList,"child-list":i.childNavList,"group-id":i.activeKey.groupId,"child-id":i.activeKey.childId,onChangeGroup:i.onChangeGroupHandle,onChangeChild:i.onChangeChildHandle},null,8,["show","group-list","child-list","group-id","child-id","onChangeGroup","onChangeChild"])):(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:0},[Object(n["createVNode"])(n["Transition"],{name:"fade-top"},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",Gx,[Object(n["createVNode"])(r,{"nav-list":i.childNavList,visible:i.isShowChildList,"scene-key":i.uniqueScenekey,onChange:i.onChangeChildHandle},null,8,["nav-list","visible","scene-key","onChange"])],512),[[n["vShow"],i.isShowChildList]])]),_:1}),Object(n["createVNode"])(n["Transition"],{name:"fade-top"},{default:Object(n["withCtx"])(()=>[i.isEnableGroup?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:Object(n["normalizeClass"])(["my-theme-wrap my-group-theme-wrap",{"is--text":i.isTextType}])},[Object(n["createVNode"])(c,{"nav-list":i.groupNavList,visible:i.isExpandGroup,"group-id":i.activeKey.groupId,"is-text-type":i.isTextType,onChange:i.onChangeGroupHandle},null,8,["nav-list","visible","group-id","is-text-type","onChange"])],2)),[[n["vShow"],i.isExpandGroup]]):Object(n["createCommentVNode"])("",!0)]),_:1})],64))])):Object(n["createCommentVNode"])("",!0),i.isEnableList&&i.isConciseModel?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Wx,[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",$x,[Object(n["createVNode"])(r,{"nav-list":i.childNavList,visible:i.isShowChildList,"scene-key":i.uniqueScenekey,onChange:i.onChangeChildHandle},null,8,["nav-list","visible","scene-key","onChange"])],512),[[n["vShow"],i.isShowChildList]]),i.isEnableGroup?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:Object(n["normalizeClass"])(["my-theme-wrap my-group-theme-wrap",{"is--text":!0}])},[Object(n["createVNode"])(c,{"nav-list":i.groupNavList,visible:i.isExpandGroup,"group-id":i.activeKey.groupId,"is-text-type":!0,onChange:i.onChangeGroupHandle},null,8,["nav-list","visible","group-id","onChange"])],512)),[[n["vShow"],i.isExpandGroup]]):Object(n["createCommentVNode"])("",!0)],512)),[[n["vShow"],i.isExpandGroup]]):Object(n["createCommentVNode"])("",!0)],64)}const Xx={class:"theme-list-wrap my-wheel-container"},Yx={class:"theme-list my-wheel-wrap"},Zx=["data-id","data-key","onClick"],qx={class:"theme__icon-wrap"},Kx=["src"];function Jx(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("v-marquee");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Xx,[Object(n["createElementVNode"])("ul",Yx,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.props.navList,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{class:Object(n["normalizeClass"])(["item-theme my-wheel-slide",{active:e.props.sceneKey===`${t.parentId}_${t.id}_${t.sceneId}`}]),key:t.id,"data-id":t.id,"data-key":t.parentId+"_"+t.id+"_"+t.sceneId,onClick:o=>e.onChangeHandle(t)},[Object(n["createElementVNode"])("div",qx,[Object(n["createElementVNode"])("img",{src:t.icon,alt:""},null,8,Kx)]),Object(n["createVNode"])(r,{"custom-class":"theme__title-wrap","custom-child-class":"theme__title","is-splice":!1,"is-show":e.props.visible,text:t.name,active:e.props.visible&&e.props.sceneKey===`${t.parentId}_${t.id}_${t.sceneId}`},null,8,["is-show","text","active"])],10,Zx))),128))])])}function Qx(e,t,o,i,s,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["my-marquee_wrap",[o.customClass]]),ref:"marqueeWrap"},[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["my-marquee_con",[o.customChildClass,i.props.active?"active":"normal"]]),ref:"marqueeCon",style:Object(n["normalizeStyle"])({transform:"translateX("+i.offsetX+")","transition-duration":i.duration})},Object(n["toDisplayString"])(i.props.active||!i.props.isSplice?i.props.text:i.props.text&&i.props.text.substr(0,5)),7)],2)}var eS={name:"marquee",props:{text:{type:String,value:""},active:{type:Boolean,value:!1},isShow:{type:Boolean,value:!1},customClass:{type:String,value:""},customChildClass:{type:String,value:""},isSplice:{type:Boolean,value:!1}},setup(e){const t=Object(n["getCurrentInstance"])(),o=Object(n["ref"])(!1),i=30,s=Object(n["ref"])(""),a=Object(n["ref"])(""),r=Object(n["ref"])(""),c=Object(n["ref"])(""),l=Object(n["ref"])(""),d=Object(n["ref"])(""),u=()=>{if(!t)return;const{marqueeWrap:e,marqueeCon:n}=t.refs,l=n,d=e;o.value=l.scrollWidth>d.offsetWidth,o.value&&(s.value=d.offsetWidth+"px",a.value=l.scrollWidth+"px",r.value=Math.ceil(l.scrollWidth/i)+"s",c.value=Math.ceil((d.offsetWidth+l.scrollWidth)/i)+"s",setTimeout(()=>{h(l)},100))},p=()=>{d.value="0s",l.value=s.value,f(s.value)},h=e=>{l.value="-"+a.value,d.value=r.value,e.addEventListener("transitionend",p,!1)},f=e=>{d.value="0s",l.value=e,setTimeout(()=>{d.value=c.value,l.value="-"+a.value},50)},m=()=>{e.active?u():(d.value="0s",l.value="")};return Object(n["onMounted"])(()=>{Object(n["nextTick"])(()=>{e.active&&m()})}),Object(n["watch"])(()=>e.isShow,t=>{t&&e.active&&Object(n["nextTick"])(()=>{f("0px")})}),Object(n["watch"])(()=>e.active,e=>{if(!e&&t){const{marqueeCon:e}=t.refs,o=e;d.value="0s",l.value="0px",o.removeEventListener("transitionend",p,!1)}else e&&Object(n["nextTick"])(m)}),{props:e,isScrollable:o,offsetX:l,duration:d}}};o("148d");const tS=Tr()(eS,[["render",Qx],["__scopeId","data-v-d4cd887c"]]);var oS=tS,nS=Object(n["defineComponent"])({components:{"v-marquee":oS},props:{navList:{type:Array,default:()=>[]},visible:Boolean,sceneKey:String},setup(e,{emit:t}){const o=e=>{t("change",e)};return{props:e,onChangeHandle:o}}});const iS=Tr()(nS,[["render",Jx]]);var sS=iS;const aS={class:"theme-list-wrap my-wheel-container"},rS={class:"theme-list my-wheel-wrap"},cS=["data-id","onClick"],lS={key:1,class:"theme__icon-wrap"},dS=["src"];function uS(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("v-marquee");return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",aS,[Object(n["createElementVNode"])("ul",rS,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.props.navList,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("li",{class:Object(n["normalizeClass"])(["item-theme my-wheel-slide",{active:e.props.groupId===t.id}]),key:t.id,"data-id":t.id,onClick:o=>e.onChangeHandle(t.id)},[e.props.isTextType?(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:0,"custom-class":"theme__title-wrap","custom-child-class":"theme__title",text:t.name,active:e.props.visible&&e.props.groupId===t.id},null,8,["text","active"])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",lS,[Object(n["createElementVNode"])("img",{src:t.icon,alt:""},null,8,dS),Object(n["createVNode"])(r,{"custom-class":"theme__title-wrap","custom-child-class":"theme__title",text:t.name,active:e.props.visible&&e.props.groupId===t.id},null,8,["text","active"])]))],10,cS))),128))])])}var pS=Object(n["defineComponent"])({components:{"v-marquee":oS},props:{navList:{type:Array,default:()=>[]},visible:Boolean,groupId:Number,isTextType:Boolean},setup(e,{emit:t}){const o=e=>{t("change",e)};return{props:e,onChangeHandle:o}}});const hS=Tr()(pS,[["render",uS]]);var fS=hS;const mS={class:"cm__compass",ref:"compass"},vS={class:"arc arc1",ref:"arc1"},bS=["onClick"],gS=["title"],yS={class:"arc arc2",ref:"arc2"},wS=["onClick"],xS=["title"],SS=Object(n["createElementVNode"])("div",{class:"arc arc3"},null,-1),IS={class:"control"},kS={class:"btn_text"};function OS(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",mS,[Object(n["createElementVNode"])("div",vS,[Object(n["createElementVNode"])("div",{class:"group_scenes",style:Object(n["normalizeStyle"])({transform:`rotate(${e.childAngle}deg)`})},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.childList,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["s_item",{active:t.id===e.props.childId}]),key:t.id,style:Object(n["normalizeStyle"])({transform:`rotate(${t.rz}deg)`}),onClick:o=>e.changeChildId(t.id)},[Object(n["createElementVNode"])("div",{class:"s_item__wrap",title:t._name},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(t.nameList,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{class:"text",key:t,style:Object(n["normalizeStyle"])(`transform: translate3d(${e.tx}px, ${e.ty}px, 0) rotate(${e.rz}deg)`)},Object(n["toDisplayString"])(e.text),5))),128))],8,gS)],14,bS))),128))],4)],512),Object(n["createElementVNode"])("div",yS,[Object(n["createElementVNode"])("div",{class:"group_scenes",style:Object(n["normalizeStyle"])({transform:`rotate(${e.groupAngle}deg)`})},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.groupList,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["s_item",{active:t.id===e.props.groupId}]),key:t.id,style:Object(n["normalizeStyle"])({transform:`rotate(${t.rz}deg)`}),onClick:o=>e.changeGroupId(t.id)},[Object(n["createElementVNode"])("div",{class:"s_item__wrap",title:t._name},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(t.nameList,(e,t)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{class:"text",key:t,style:Object(n["normalizeStyle"])(`transform: translate3d(${e.tx}px, ${e.ty}px, 0) rotate(${e.rz}deg)`)},Object(n["toDisplayString"])(e.text),5))),128))],8,xS)],14,wS))),128))],4)],512),SS,Object(n["createElementVNode"])("div",IS,[Object(n["createElementVNode"])("div",{class:"btn_icon",onClick:t[0]||(t[0]=(...t)=>e.toggleShow&&e.toggleShow(...t))}),Object(n["createElementVNode"])("span",kS,Object(n["toDisplayString"])(e.$t("sceneList")),1)])],512)),[[n["vShow"],e.props.show]])}var jS=Object(n["defineComponent"])({props:{groupList:{type:Array,default:()=>[]},childList:{type:Array,default:()=>[]},groupId:{type:Number,default:0},childId:{type:Number,default:0},show:{type:Boolean,default:!1}},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{groupList:i,groupAngle:s,minGroupAngle:a,changeGroupId:r,updateGroupAngle:c,checkGroupSceneIdByDeg:l}=ES({props:e,currentInstance:o},{emit:t}),{childList:d,childAngle:u,minChildAngle:p,changeChildId:h,updateChildAngle:f,checkChildSceneIdByDeg:m}=TS({props:e,currentInstance:o},{emit:t});PS({props:e,currentInstance:o,minGroupAngle:a,minChildAngle:p,groupAngle:s,childAngle:u},{updateGroupAngle:c,updateChildAngle:f,checkGroupSceneIdByDeg:l,checkChildSceneIdByDeg:m});const v=()=>{Ns.emit(Qs)};return{props:e,groupList:i,groupAngle:s,changeGroupId:r,childList:d,childAngle:u,changeChildId:h,toggleShow:v}}});function CS(e,t){const o=[],n={x:0,y:-1*t};return e.forEach((e,i)=>{const s=[],a=e.name.split(""),r=a.length%2===0,c=Math.floor(a.length/2),l=.5,d=4*l;a.forEach((e,o)=>{let i=0;i=o<c?-1*(c-o-.5)*d:r?(o-c+.5)*d:(o-1-c+.5)*d;const a=Fo(n,i),u={text:e,tx:0,ty:Math.round(Math.abs(t+a.y)*l),rz:i};s.push(u)}),e.nameList=s,e.rz=20*i,o.push(e)}),o}function ES({props:e,currentInstance:t},{emit:o}){const i=Object(n["ref"])([]),s=Object(n["ref"])(0),a=Object(n["ref"])(0),r=t=>{t!==e.groupId?t&&o("changeGroup",t):l(t)},c=e=>{s.value=e},l=e=>{const t=i.value.find(t=>t.id===e);if(t){const e=t.rz;s.value=-1*e}},d=e=>{let t=-1,o=-1,n=0;for(let s=0,a=i.value.length;s<a;s++){const n=i.value[s];Math.abs(e)>=n.rz&&(t=s),o<0&&Math.abs(e)<=n.rz&&(o=s)}n=Math.abs(e)-i.value[t].rz>=Math.abs(e)-i.value[o].rz?i.value[o].id:i.value[t].id,n&&r(n)};return Object(n["watch"])(()=>e.show,o=>{o&&Object(n["nextTick"])(()=>{const{arc2:o}=t.value.refs,n=o.scrollHeight/2,s=e.groupList.map(e=>(e._name=e.name,e.name.length>5&&(e.name=e.name.substring(0,5)+"..."),e));i.value=CS(s,n),i.value.length&&(a.value=-1*i.value[i.value.length-1].rz)})}),Object(n["watch"])(()=>i.value.length&&e.show&&e.groupId,t=>{t&&l(e.groupId)}),{groupList:i,groupAngle:s,minGroupAngle:a,changeGroupId:r,updateGroupAngle:c,checkGroupSceneIdByDeg:d}}function TS({props:e,currentInstance:t},{emit:o}){const i=Object(n["ref"])([]),s=Object(n["ref"])(0),a=Object(n["ref"])(0),r=()=>{const t=i.value.find(t=>t.id===e.childId);if(t){const e=t.rz;s.value=-1*e}else s.value=0},c=e=>{s.value=e},l=e=>{if(e){const t=i.value.find(t=>t.id===e);t&&o("changeChild",t),r()}},d=e=>{let t=-1,o=-1,n=0;for(let s=0,a=i.value.length;s<a;s++){const n=i.value[s];Math.abs(e)>=n.rz&&(t=s),o<0&&Math.abs(e)<=n.rz&&(o=s)}n=Math.abs(e)-i.value[t].rz>=Math.abs(e)-i.value[o].rz?i.value[o].id:i.value[t].id,n&&l(n)};return Object(n["watch"])(()=>e.show&&e.groupId,o=>{o&&Object(n["nextTick"])(()=>{const{arc1:o}=t.value.refs,n=o.scrollHeight/2,s=e.childList.map(e=>(e._name=e.name,e.name.length>5&&(e.name=e.name.substring(0,5)+"..."),e));i.value=CS(s,n),i.value.length&&(a.value=-1*i.value[i.value.length-1].rz),r()})}),Object(n["watch"])(()=>i.value.length&&e.show&&e.childId,e=>{e&&r()}),{childList:i,childAngle:s,minChildAngle:a,changeChildId:l,updateChildAngle:c,checkChildSceneIdByDeg:d}}function PS({props:e,currentInstance:t,minGroupAngle:o,minChildAngle:i,groupAngle:s,childAngle:a},{updateGroupAngle:r,updateChildAngle:c,checkGroupSceneIdByDeg:l,checkChildSceneIdByDeg:d}){let u=null;const p={pdeg:0,ndeg:0,g_maxdeg:0,c_maxdeg:0,level:0},h=e=>{const t=Vo(e,"arc");null!==t&&void 0!==t&&t.classList.contains("arc1")?p.level=1:null!==t&&void 0!==t&&t.classList.contains("arc2")&&(p.level=2)},f=()=>{1===p.level?p.ndeg=a.value:2===p.level&&(p.ndeg=s.value)},m=e=>{1===p.level?c(e):2===p.level&&r(e)},v=e=>{1===p.level?d(e):2===p.level&&l(e)},b=()=>({max:(1===p.level||p.level,0),min:1===p.level?i.value:2===p.level?o.value:0}),g=()=>{if(u)return;const{compass:e}=t.value.refs;if(!e)return;const o=window.Hammer;u=new o(e),u.on("panstart",(function(t){t.target&&h(t.target),f(),e.classList.add("pressed")})),u.on("panmove",(function(e){p.pdeg=p.ndeg+e.deltaX/5,m(p.pdeg)})),u.on("panend",(function(){e.classList.remove("pressed");const t=b();p.pdeg>t.max?p.pdeg=t.max:p.pdeg<t.min&&(p.pdeg=t.min),m(p.pdeg),v(p.pdeg),p.ndeg=p.pdeg}))};Object(n["watch"])(()=>e.show,e=>{e&&g()})}o("e56e");const _S=Tr()(jS,[["render",OS]]);var AS=_S;class MS{constructor(e,t={}){if(!e)throw new Error("el is not defined");this.el="string"===typeof e?document.querySelector(e):e,this.opt=t,this._isDraging=!1,this._isMobile=Object(To["d"])(),this._touch={disX:0,diffX:0,offsetX:0,disY:0,diffY:0,offsetY:0},this.init()}init(){const e=this._isMobile?"touchstart":"mousedown",t=this._isMobile?"touchmove":"mousemove",o=this._isMobile?"touchend":"mouseup";this.el.addEventListener(e,i,!1);const n=this;function i(e){const i=e||window.event;n._isDraging=!0;const r=n._isMobile?i.touches[0].clientX:i.clientX,c=n._isMobile?i.touches[0].clientY:i.clientY;n._touch.disX=r,n._touch.disY=c,"vertical"===n.opt.mode?n.opt.on.touchStart&&n.opt.on.touchStart(c):n.opt.on.touchStart&&n.opt.on.touchStart(r),document.body.addEventListener(t,s),document.body.addEventListener(o,a)}function s(e){const t=e||window.event;if(t.cancelable&&(t.defaultPrevented||t.preventDefault()),!n._isDraging)return;const o=n._isMobile?t.touches[0].clientX:t.clientX,i=n._isMobile?t.touches[0].clientY:t.clientY,s=o-n._touch.disX,a=i-n._touch.disY;n._touch.diffX=s,n._touch.diffY=a,"vertical"===n.opt.mode?n.opt.on.touchMove&&n.opt.on.touchMove(a):n.opt.on.touchMove&&n.opt.on.touchMove(s)}function a(){n._isDraging=!1,"vertical"===n.opt.mode?n.opt.on.touchEnd&&n.opt.on.touchEnd(n._touch.diffY):n.opt.on.touchEnd&&n.opt.on.touchEnd(n._touch.diffX),document.body.removeEventListener(t,s,!1),document.body.removeEventListener(o,a,!1)}}}var HS=MS;class zS{constructor(e,t={}){if(this.el=null,this.wheelStepNum=0,this._touch={disX:0,offsetX:0,diffX:0,offsetMin:0,offsetMax:0,translateX:0,wrapWidth:0,containerWidth:0},this._isCanScroll=!1,!e)throw new Error("el is not defined");this.el="string"===typeof e?document.querySelector(e):e,this.el&&(this.items=this.el.querySelectorAll(".my-wheel-slide"),this.opt=t,this.init())}init(){this._calcScrollWidth(),this.translate(this._touch.translateX),window.addEventListener("resize",()=>{this._calcScrollWidth(),this.translate(this._touch.translateX)},!1),this._isCanScroll&&(Object(To["d"])()?this._bindEvent():this._wheelHandle())}_calcScrollWidth(){if(!this.el)return;const e=this.el.querySelector(".my-wheel-wrap");e&&(e.style.width="auto");let t=0;for(let n=0,i=this.items.length;n<i;n++){const e=this.items[n],i=e.offsetWidth,s=o(e,"margin-left"),a=o(e,"margin-right"),r=i+parseInt(s)+parseInt(a);this.wheelStepNum=r,t+=r}function o(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle(e,null)[t]}e&&(e.style.width=t+"px"),this._touch.containerWidth=this.el.clientWidth||window.innerWidth,this._touch.offsetMax=0,this._touch.offsetMin=-1*(t-this._touch.containerWidth),this._touch.wrapWidth=t,this._isCanScroll=t>this._touch.containerWidth}_bindEvent(){if(!this.el)return;const e=this.el.querySelector(".my-wheel-wrap");new HS(e,{on:{touchStart:e=>{this._touch.offsetX=this._touch.translateX,this._touch.disX=e},touchMove:e=>{this._touch.diffX=e;const t=this._touch.offsetX+e;this.translate(t)}}})}_wheelHandle(){this.el&&(this._middleEvent=this.wheelHandle.bind(this),this.el.addEventListener("DOMMouseScroll",this._middleEvent,!1),this.el.addEventListener("mousewheel",this._middleEvent,!1))}wheelHandle(e){const t=this;let o=0;const n=e||window.event;let i=0;function s(e){if(e>0){if(t._touch.translateX<t._touch.offsetMin)return;o=t._touch.translateX-t.wheelStepNum}else{if(t._touch.translateX>t._touch.offsetMax)return;o=t._touch.translateX+t.wheelStepNum}t.translate(o)}n.wheelDelta?(i=n.wheelDelta/120,i=-i):n.detail&&(i=n.detail/3),i&&s(i)}updateSlide(){this.el&&(this.items=this.el.querySelectorAll(".my-wheel-slide"),this._calcScrollWidth(),this.translate(this._touch.translateX),Object(To["d"])()?this._bindEvent():this._wheelHandle())}updatePosition(e){if(!this._isCanScroll||!this.el)return;const t=this.items[e].offsetLeft,o=this.items[e].offsetWidth;let n=-1*Math.max(0,t-(this._touch.containerWidth-o)/2);n=Math.max(n,this._touch.offsetMin);const i=this.el.querySelector(".my-wheel-wrap");this._touch.translateX=n,i.style.webkitTransform=`translateX(${n}px) translateZ(0)`,i.style.transform=`translateX(${n}px) translateZ(0)`}translate(e){if(!this.el)return;const t=this.el.querySelector(".my-wheel-wrap");if(!this._isCanScroll)return t.style.webkitTransform="translateX(0px) translateZ(0)",void(t.style.transform="translateX(0px) translateZ(0)");e<this._touch.offsetMin?e=this._touch.offsetMin:e>this._touch.offsetMax&&(e=this._touch.offsetMax),this._touch.translateX=e,t.style.webkitTransform=`translateX(${e}px) translateZ(0)`,t.style.transform=`translateX(${e}px) translateZ(0)`}update(){this.el&&(this.translate(0),this.items=this.el.querySelectorAll(".my-wheel-slide"),this._calcScrollWidth())}destroy(){this.el&&(this.el.removeEventListener("DOMMouseScroll",this._middleEvent,!1),this.el.removeEventListener("mousewheel",this._middleEvent,!1))}}var LS=zS,DS={props:{pure:{type:Boolean,default:!1}},components:{"v-compass":AS,Child:sS,Parent:fS},setup(e){const{isTextType:t,isCompassType:o,isEnableGroup:n,isEnableList:i,isConciseModel:s}=RS(),{isExpandGroup:a,isExpandChild:r,toggleExpandChild:c}=FS({props:e}),{groupNavList:l}=BS(),{activeKey:d}=VS({groupNavList:l,isEnableGroup:n}),{childNavList:u,isShowChildList:p,uniqueScenekey:h}=NS({groupNavList:l,activeKey:d,isExpandGroup:a,isExpandChild:r,props:e}),{onChangeGroupHandle:f,onChangeChildHandle:m}=GS({activeKey:d},{toggleExpandChild:c});return WS({activeKey:d,groupNavList:l,childNavList:u,isExpandGroup:a,isExpandChild:r}),{isTextType:t,isCompassType:o,isConciseModel:s,isEnableGroup:n,isExpandGroup:a,isExpandChild:r,isEnableList:i,groupNavList:l,activeKey:d,onChangeGroupHandle:f,childNavList:u,isShowChildList:p,uniqueScenekey:h,onChangeChildHandle:m}}};function BS(){const e=Object(n["reactive"])({}),t=Object(n["ref"])([]),o=()=>{i["b"].state.skyBoxSceneGroup.sceneList.length&&i["b"].state.skyBoxSceneGroup.sceneList.forEach(t=>{const o=i["b"].state.krp.get(`scene[${t.sort}]`);o&&(e[t.id]=o.thumburl||""),e[t.id]||0!==t.scenetype||"SceneType_VR"!==t.renderMode||(e[t.id]=i["b"].state.proInfo.baseur+`panos/scene_${t.id}.tiles/thumb.jpg`)})},s=()=>{const o=[],n=i["b"].state.skyBoxSceneGroup.navigation||{};if(n.list&&n.list.length)n.list.forEach(t=>{const n={id:t.id,name:t.name,icon:t.icon,children:[]};t.subCategory&&t.subCategory.length&&t.subCategory.forEach(t=>{n.children.push({id:t.id,parentId:n.id||0,name:t.name,icon:t.icon||e[t.sceneId],sceneId:t.sceneId,link:t.hyperlink||"",linkType:t.linkType})}),o.push(n)});else{const t={id:1,name:"默认分组",icon:"",children:[]};i["b"].state.skyBoxSceneGroup.sceneList.forEach(o=>{t.children.push({id:o.id,parentId:1,name:o.title,icon:o.iconUrl||e[o.id],sceneId:o.id,link:"",linkType:o.type})}),o.push(t)}t.value=o};return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedXml,e=>{e&&(o(),s())}),{groupNavList:t}}function NS({groupNavList:e,activeKey:t,isExpandGroup:o,isExpandChild:s,props:a}){const r=Object(n["computed"])(()=>{if(!e.value.length||!t.groupId)return[];const o=e.value.filter(e=>e.id===t.groupId);return o&&o[0]?o[0].children:[]}),c=Object(n["computed"])(()=>!!(o.value&&s.value&&r.value.length));Object(n["watch"])(c,e=>{a.pure||(window.sceneListExpand=e)});const l=Object(n["computed"])(()=>{const e=i["b"].state.sceneInfo||{};return`${t.groupId}_${t.childId}_${e.id}`});return{childNavList:r,isShowChildList:c,uniqueScenekey:l}}function VS({groupNavList:e,isEnableGroup:t}){const o=Object(n["reactive"])({groupId:0,childId:0,firstGroupId:0,firstChildId:0,currentGroupId:0,currentChildId:0}),s=()=>{let n=o.groupId||o.firstGroupId,s=o.childId;const r=e.value.find(e=>e.id===n),c=((null===r||void 0===r?void 0:r.children)||[]).find(e=>e.sceneId===i["b"].state.sceneInfo.id);if(r&&c)n=r.id,s=c.id;else{const e=a();n=(null===e||void 0===e?void 0:e.gid)||0,s=(null===e||void 0===e?void 0:e.cid)||0}o.groupId=n,o.childId=s,o.currentGroupId=n,o.currentChildId=s,o.groupId||t.value||(o.groupId=e.value[0].id),window.history.replaceState(null,"",Object(Ti["a"])({g_id:o.groupId,c_id:o.childId}))},a=()=>{let t=0,o=0;for(let n=0,s=e.value.length;n<s;n++){const s=e.value[n];if(s)for(let e=0,n=s.children.length;e<n;e++){const n=s.children[e];if(n.sceneId===i["b"].state.sceneInfo.id)return t=s.id,o=n.id,{gid:t,cid:o}}}return{gid:t,cid:o}};return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedXml,()=>{var e;null!==(e=i["b"].state.skyBoxSceneGroup.weChatShare)&&void 0!==e&&e.initSceneAsMain||(o.firstGroupId=Number(Object(Ti["c"])("g_id"))||0,o.firstChildId=Number(Object(Ti["c"])("c_id"))||0)}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e&&s()}),{activeKey:o}}function RS(){const e=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.navigation||{}),t=Object(n["computed"])(()=>[0,4].indexOf(e.value.showType)>=0),o=Object(n["computed"])(()=>1===e.value.showStyle),s=Object(n["computed"])(()=>{var e;return 2===(null===(e=i["b"].state.skyBoxSceneGroup.templateInfo)||void 0===e?void 0:e.type)}),a=Object(n["computed"])(()=>[0,1,4].indexOf(e.value.showType)>=0),r=Object(n["computed"])(()=>e.value.enable);return{isTextType:t,isCompassType:o,isEnableGroup:a,isEnableList:r,isConciseModel:s}}function FS({props:e}){let t=!1,o=0;const s=Object(n["ref"])(!1),a=e=>{s.value=void 0==e?!s.value:e},r=Object(n["ref"])(!1),c=e=>{r.value=void 0==e?!r.value:e},l=()=>{const e=i["b"].state.skyBoxSceneGroup.navigation||{};e.expand&&(clearTimeout(o),o=window.setTimeout(()=>{a(!0),c(!0)},200)),t=!0};return Object(n["watch"])(()=>e.pure,e=>{e?(a(!1),c(!1)):t?e||(window.sceneListExpand?(a(!0),c(!0)):(a(!1),c(!1))):l()}),Ns.on(Qs,e=>{"boolean"!==typeof e||e?(a(),c()):(s.value=!1,r.value=!1)}),{isExpandGroup:s,isExpandChild:r,toggleExpandChild:c}}function GS({activeKey:e},{toggleExpandChild:t}){const o=o=>{e.groupId===o?t():(e.groupId=o,t(!0))},n=t=>{t.sceneId?(e.childId=t.id,Ns.emit(Fs,{sceneId:t.sceneId})):t.link&&Ho(t.link)};return{onChangeGroupHandle:o,onChangeChildHandle:n}}function WS({activeKey:e,groupNavList:t,childNavList:o,isExpandGroup:i,isExpandChild:s}){let a=Object(n["ref"])(null);const r=()=>{a.value||(a.value=new LS(".my-group-theme-wrap .my-wheel-container"))};Object(n["watch"])(()=>i.value,e=>{e&&Object(n["nextTick"])(()=>{r(),o.value.length&&l()})}),Object(n["watch"])(()=>e.groupId,e=>{if(a.value)for(let o=0,n=t.value.length;o<n;o++){const n=t.value[o];if(n.id===e)return void a.value.updatePosition(o)}});let c=Object(n["ref"])(null);const l=()=>{const e=d();c.value&&(c.value.update(),e&&c.value.updatePosition(e)),c.value||(c.value=new LS(".my-child-theme-wrap .my-wheel-container"),e&&c.value.updatePosition(e))};Object(n["watch"])(()=>o.value,e=>{e.length&&s.value&&Object(n["nextTick"])(l)},{deep:!0}),Object(n["watch"])(()=>e.childId,e=>{if(c.value)for(let t=0,n=o.value.length;t<n;t++){const n=o.value[t];if(n.id===e)return void c.value.updatePosition(t)}});const d=()=>{for(let t=0,n=o.value.length;t<n;t++){const n=o.value[t];if(n.id===e.childId)return t}return 0}}o("5543");const $S=Tr()(DS,[["render",Ux]]);var US=$S;class XS{constructor(){this.status=!1}requestFullScreen(e=document.documentElement){const t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;t&&(t.call(e),this.status=!0)}exitFullScreen(){const e=document,t=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;t&&(t.call(e),this.status=!1)}toggleFullScreen(e){XS.isFullScreening()?this.exitFullScreen():this.requestFullScreen(e)}static isFullScreening(){const e=document;return e.fullscreenElement||e.msFullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||!1}}var YS=XS;function ZS(){const e=Object(n["ref"])(null);Ns.on(oa,()=>{const t=i["b"].state.device.mini_wx&&i["b"].state.viewMode.tryWatch;t&&!e.value.isFullScreening()||(e.value||(e.value=new YS),e.value.toggleFullScreen())})}var qS=ZS;function KS(){const e=Object(n["ref"])(!1),t=Object(n["ref"])(!1),o=Object(n["computed"])(()=>i["b"].state.krp.get("autorotate")),s=Object(n["computed"])(()=>i["b"].state.sceneInfo),a=()=>{let e=0!==s.value.curSceneCruising.mode,t=s.value.curSceneCruising.time;return 1===s.value.curSceneCruising.mode&&(e=i["b"].state.skyBoxSceneGroup.scenecruising.enable,t=i["b"].state.skyBoxSceneGroup.scenecruising.time),!(!e||!t||i["b"].state.sceneInfo.is2dRender)&&(o.value&&(o.value.accel=10,o.value.waittime=2,o.value.zoomslowdown=!1,o.value.speed=360/Math.min(t,360)),!0)},r=()=>{a()&&o.value&&!o.value.enabled&&(o.value.start(),t.value=o.value.enabled)},c=()=>{o.value&&o.value.enabled&&(o.value.stop(),t.value=o.value.enabled)},l=()=>{var e;null!==(e=o.value)&&void 0!==e&&e.enabled?c():r()},d=()=>{const e=i["b"].state.sceneInfo;e.isHiddenSetting||3===e.type||e.is2dRender||r()},u=()=>{const t=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});Object(n["watch"])(()=>t.value,t=>{t&&(e.value=a(),setTimeout(()=>{d()},3e3))}),Ns.on(Vs,()=>{c()})};return{isEnableCruising:e,isPlayingCruising:t,toggleAutoRotate:l,onMountedCruising:u}}const{isEnableCruising:JS,isPlayingCruising:QS,toggleAutoRotate:eI,onMountedCruising:tI}=KS();function oI(){const e=Object(n["ref"])(!1),t=Object(n["ref"])(null),o=Object(n["ref"])(!1),s=Object(n["ref"])(!1),a=Object(n["computed"])(()=>i["b"].state.device.mobile&&!i["b"].state.sceneInfo.is2dRender),r=()=>{t.value&&a.value&&h(c)},c=()=>{e.value&&t.value&&(t.value.enabled?d():l(),o.value=!s.value)},l=()=>{e.value&&t.value&&(s.value||(t.value.enabled=!0,s.value=!0))},d=()=>{e.value&&t.value&&s.value&&(t.value.enabled=!1,s.value=!1)},u=()=>{const e=i["b"].state.sceneInfo;a.value&&e.isDefaultEnableGyro&&!o.value?l():d()};Object(n["watch"])(()=>s.value,e=>{i["b"].commit(jo["a"],{key:"gyro",value:e})});const p=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});Object(n["watch"])(()=>p.value,n=>{if(!n)return;const s=i["b"].state.sceneInfo||{};t.value||s.is2dRender||(t.value=i["b"].state.krp.get("plugin[skin_gyro]")),!t.value||s.isDefaultEnableGyro&&!s.is2dRender||d(),a.value&&s.isDefaultEnableGyro&&!o.value&&(e.value?l():h(c))});const h=t=>{e.value?t&&t():window.DeviceMotionEvent&&"function"===typeof window.DeviceMotionEvent.requestPermission?window.DeviceMotionEvent.requestPermission().then(o=>{"granted"===o?e.value=!0:"denied"===o&&(e.value=!1),t&&t()}).catch(()=>{e.value=!1}):(e.value=!0,t&&t())};return Ns.on(sa,()=>{r()}),Ns.on(Rs,()=>{t.value&&d()}),{isShowGyroIcon:a,isEnableGyro:s,toggleGyro:r,enableGyro:l,backOriginStatus:u}}var nI=oI;function iI(){const{t:e}=Object(oc["b"])();let t=null;const o=Object(n["computed"])(()=>{var e,t;const o=null===(e=i["b"].state.privateInfo)||void 0===e||null===(t=e.closeVRMode)||void 0===t?void 0:t.enable;return!o&&!i["b"].state.sceneInfo.is2dRender});let s=null;const a=(t=!0)=>{if(s||(s=i["b"].state.krp.get("plugin[webvr]")),!s)return;const o=i["b"].state.device.mini_wx&&i["b"].state.viewMode.tryWatch;if(t){o&&(s.mobilevr_fullscreen=!1),s.entervr&&s.entervr(),s.mobilevr_profile="75|62|43|44|0.15|0.12",s.flatpanohfov=1,sI(e);const t=i["b"].state.sceneInfo.size.width,n=i["b"].state.sceneInfo.size.height;let a=0,r=0;t>=n?(a=80,r=80*i["b"].state.sceneInfo.size.height/i["b"].state.sceneInfo.size.width):(r=80,a=80*i["b"].state.sceneInfo.size.width/i["b"].state.sceneInfo.size.height),i["b"].state.krp.set("image.hfov",a),i["b"].state.krp.set("image.vfov",r),i["b"].state.krp.call("updateobject()"),aI()}else s.exitvr&&s.exitvr()},r=()=>{let e=window.myKrp;e||(e=window.myKrp={}),e.onEnterVrHandle=()=>{var e;t||(t=null===(e=i["b"].state.krp)||void 0===e?void 0:e.get("view"))},e.onExitVrHandle=()=>{rI(),Ns.emit(ra,!1),t&&(i["b"].state.krp.set("image.hfov",1),i["b"].state.krp.set("image.vfov",i["b"].state.sceneInfo.size.height/i["b"].state.sceneInfo.size.width),i["b"].state.krp.call("updateobject()"),t.limitview="fullrange")}};return r(),Ns.on(ia,e=>{a(e),Ns.emit(ra,!e)}),{isShowVrIcon:o,toggleVR:a}}function sI(e){const t=i["b"].state.krp;t.set("layer[webvr_exitbutton].html",e("VRTips.exit")),t.set("layer[webvr_setupbutton].html",e("VRTips.vrSettings"));const o={mobileVRS:e("VRTips.mobileVRS"),screenSize:e("VRTips.screenSize"),vrPreset:e("VRTips.vrPreset"),headset:e("VRTips.headset"),configure:e("VRTips.configure"),close:e("VRTips.close"),preset:e("VRTips.preset"),spacing:e("VRTips.spacing"),distance:e("VRTips.distance"),coefficient:e("VRTips.coefficient"),oversampling:e("VRTips.oversampling")};t.set("overSData",o)}function aI(){const e=i["b"].state.krp.get("hotspot"),t=i["b"].state.krp.get("image.hfov");for(let o=0;o<e.count;o++){const n=e.getItem(o);n&&n.kid&&(n._ath=n.ath,n._atv=n.atv,n._scale=n.scale,n.ath*=t,n.atv*=t,n.scale*=t)}}function rI(){const e=i["b"].state.krp.get("hotspot");for(let t=0;t<e.count;t++){const o=e.getItem(t);o&&o.kid&&(o.ath=o._ath,o.atv=o._atv,o.scale=o._scale)}}var cI=iI;function lI(){const e=Object(n["computed"])(()=>i["b"].state.statistics||{}),t=()=>{const t=window.creatorMaterialLikePath&&wo("Statistics");if(!t||!e.value.identity||!i["b"].state.proInfo.pid)return;const o={materialId:i["b"].state.proInfo.pid,identity:e.value.identity};Object(xo["e"])(o).then(t=>{if(1!==t.resCode)return;const o=t.resData.record||{},n=e.value||{likeNum:0,whether:-1};o.likeNum>0?(n.likeNum++,n.whether=1):(n.likeNum--,n.whether=0),i["b"].commit(jo["v"],{...n,identity:e.value.identity}),i["b"].commit(jo["a"],{key:"dolike",value:!!n.whether})})};Object(n["watch"])(()=>e.value,()=>{i["b"].commit(jo["a"],{key:"dolike",value:!!e.value.whether})}),Ns.on(aa,()=>{t()})}var dI=lI;const uI={class:"layer__inner"};function pI(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("l-text"),c=Object(n["resolveComponent"])("l-img"),l=Object(n["resolveComponent"])("l-video"),d=Object(n["resolveComponent"])("l-imgs"),u=Object(n["resolveComponent"])("l-text-img"),p=Object(n["resolveComponent"])("l-model"),h=Object(n["resolveComponent"])("l-webview"),f=Object(n["resolveComponent"])("l-cut-out-video"),m=Object(n["resolveComponent"])("popup"),v=Object(n["resolveComponent"])("l-viewer");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createVNode"])(m,{value:i.isShowPopup,onClose:i.onHideHandle,"mask-closable":i.isCloseAnyWhere},{content:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("div",uI,[Object(n["createVNode"])(r,{"origin-data":i.originalData,show:2===i.hotspotType,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["origin-data","show","onHide","onShow"]),Object(n["createVNode"])(c,{id:i.originalData.id,"origin-data":i.originalData,show:[3,23].indexOf(i.hotspotType)>=0,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["id","origin-data","show","onHide","onShow"]),Object(n["createVNode"])(l,{id:i.originalData.id,"origin-data":i.originalData,show:4===i.hotspotType,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["id","origin-data","show","onHide","onShow"]),Object(n["createVNode"])(d,{id:i.originalData.id,"origin-data":i.originalData,show:7===i.hotspotType,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["id","origin-data","show","onHide","onShow"]),Object(n["createVNode"])(u,{"origin-data":i.originalData,show:8===i.hotspotType||52===i.hotspotType,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["origin-data","show","onHide","onShow"]),Object(n["createVNode"])(p,{"origin-data":i.originalData,show:9===i.hotspotType,"close-any-where":i.isCloseAnyWhere,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["origin-data","show","close-any-where","onHide","onShow"]),Object(n["createVNode"])(h,{"origin-data":i.originalData,show:[10,21].indexOf(i.hotspotType)>=0,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["origin-data","show","onHide","onShow"]),Object(n["createVNode"])(f,{id:i.originalData.id,"origin-data":i.originalData,show:54===i.hotspotType,onHide:i.onHideHandle,onShow:i.onShowHandle},null,8,["id","origin-data","show","onHide","onShow"])])]),_:1},8,["value","onClose","mask-closable"]),Object(n["createVNode"])(v,{onShow:i.onShowHandle,onHide:i.onCloseHandle},null,8,["onShow","onHide"])],64)}const hI=["effect"],fI=["innerHTML"];function mI(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"txt__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:-2===i.titleEffect?i.wrapStyle.height+"px":"auto",overflow:i.titleEffect<=0&&!i.isShowCloseIcon?"hidden":"initial"})},[i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:"txt__inner is--inner",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.titleEffect>0?i.wrapStyle.height+"px":"auto",backgroundColor:i.wrapStyle.bgColor,opacity:i.wrapStyle.opacity,textAlign:i.wrapStyle.align}),effect:i.titleEffect},[Object(n["createElementVNode"])("p",{style:Object(n["normalizeStyle"])(i.titleStyle),innerHTML:i.title,ref:"myText"},null,12,fI)],12,hI)],4)),[[n["vShow"],i.props.show]])}var vI={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},id:{type:Number},type:{type:Number},show:{type:Boolean,default:!1},isCom:{type:Boolean,default:!1}},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isShowed:i}=bI({props:e},{emit:t}),{isShowCloseIcon:s,closeIcon:a,onHideHandle:r}=gI({props:e},{emit:t}),{wrapStyle:c}=yI({props:e}),{titleStyle:l,title:d}=wI({props:e}),{titleEffect:u}=xI({props:e});return SI({props:e,curInstance:o,titleEffect:u,wrapStyle:c,isShowed:i}),{props:e,isShowCloseIcon:s,closeIcon:a,onHideHandle:r,title:d,wrapStyle:c,titleStyle:l,titleEffect:u}}};function bI({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1,s.value=!1}),Object(n["watch"])(()=>e.show,e=>{i.value=e,e?a(!0):s.value=!1});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&t("show"),s.value=e};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function gI({props:e},{emit:t}){const o=Object(n["computed"])(()=>e.isClose),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=()=>{t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function yI({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n,i;if(!t.value)return{};const s=Lf(t.value.showSize,e.isCom);let a="";return t.value.bgcolor&&(a=dn(t.value.bgcolor,t.value.bgalpha)),{width:s.w,height:s.h,scale:Math.min(s.w/200,1),bgColor:a,opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1,align:null===(i=e.originData)||void 0===i?void 0:i.content.textAlignment}});return{wrapStyle:o}}function wI({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{if(!t.value||!t.value.title)return"";let e=xn(t.value.title);return 1===t.value.texteffect&&(e=e.replace(/<br>/g,"&nbsp;")),e}),i=Object(n["computed"])(()=>{if(!t.value)return{};const e=t.value.fontSize,o=t.value.wordSpace/e*18,n=t.value.rowSpace+1.125*e;let i="";t.value.fontColor&&(i=dn(t.value.fontColor,1));const s={font:{family:t.value.fontFamily,size:e,color:i,lineheight:n,wordspace:o,bolid:t.value.bolid,italic:t.value.italic,underline:t.value.underline,align:t.value.textAlignment},rect:t.value.showSize,effect:t.value.texteffect};return cn(s)});return{titleStyle:i,title:o}}function xI({props:e}){const t=Object(n["computed"])(()=>{var t;const o=(null===(t=e.originData)||void 0===t?void 0:t.content)||{};return o.texteffect||-1});return{titleEffect:t}}function SI({props:e,curInstance:t,titleEffect:o,wrapStyle:i,isShowed:s}){let a=null,r=null,c=null;const l=()=>{if(1===o.value){const{start:e,reset:t}=hd({txtDom:c,width:i.value.width});a=e,r=t}else if(2===o.value){const t=e.originData.content.rowSpace||0,{start:o,reset:n}=fd({txtDom:c,height:i.value.height,lineHeight:t});a=o,r=n}a&&a()},d=()=>{c&&(r&&r(),c=null,a=null)};Object(n["watch"])(()=>s.value,e=>{e&&o.value>=0?Object(n["nextTick"])(()=>{const{myText:e}=t.value.refs;c=e,c&&l()}):d()})}o("9197");const II=Tr()(vI,[["render",mI],["__scopeId","data-v-6673fa42"]]);var kI=II;const OI=["src"];function jI(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"img__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.wrapStyle.height+"px"})},[i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["photo-inner",{sbs:i.isImage3d}]),ref:"photoInner",style:Object(n["normalizeStyle"])({opacity:i.wrapStyle.opacity})},[i.isFramesImg?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,ref:"imgRef",class:"photo-item is--inner",src:i.imgPath,style:Object(n["normalizeStyle"])({width:i.rect.x+"px",height:i.rect.y+"px",scale:i.imgScale}),alt:"",onWheel:t[1]||(t[1]=(...e)=>i.handleScaleImg&&i.handleScaleImg(...e)),onTouchstart:t[2]||(t[2]=(...e)=>i.handleTouchStart&&i.handleTouchStart(...e)),onMousedown:t[3]||(t[3]=(...e)=>i.handleMouseDown&&i.handleMouseDown(...e))},null,44,OI)),Object(n["createVNode"])(r,{value:i.isShowLoading,"onUpdate:value":t[4]||(t[4]=e=>i.isShowLoading=e),scale:i.wrapStyle.scale},null,8,["value","scale"])],6)],4)),[[n["vShow"],i.isShowed]])}const CI=e=>(Object(n["pushScopeId"])("data-v-8b631374"),e=e(),Object(n["popScopeId"])(),e),EI=CI(()=>Object(n["createElementVNode"])("span",{class:"loading-inner"},null,-1)),TI=[EI];function PI(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"loading",style:Object(n["normalizeStyle"])({transform:`scale(${e.props.scale})`})},TI,4)),[[n["vShow"],e.props.value]])}var _I=Object(n["defineComponent"])({props:{value:{type:Boolean},scale:{type:Number,default:1}},setup(e){return{props:e}}});o("b1b8");const AI=Tr()(_I,[["render",PI],["__scopeId","data-v-8b631374"]]);var MI=AI;class HI{constructor(e,t){const o={autoplay:!0,loop:!0,loopTime:0};this.path=e.imgPath,this.swidth=e.gifWidth,this.sheight=e.gifHeight,this.delayTime=Math.max(e.delayTime,40),this.wnums=e.imgWidth/e.gifWidth,this.hnums=e.imgHeight/e.gifHeight,this.allnums=e.frameNum,this.cycleTimes=0,this.ratio=window.devicePixelRatio,this.stepIndex=0,this.options=Object.assign(o,t),this.timer=0,this.img=null,this.ctx=null,this.canvas=null,this.inited=!0}create(e){this.canvas=document.createElement("canvas"),this.canvas&&(this.canvas.style.width=this.options.rect.x+"px",this.canvas.style.height=this.options.rect.y+"px",this.canvas.style.maxWidth="100%",this.canvas.style.maxHeight="100%",this.canvas.width=this.options.rect.x*this.ratio,this.canvas.height=this.options.rect.y*this.ratio,this.ctx=this.canvas.getContext("2d"),e&&e(this.canvas))}load(e){const t=new Image;t.onload=()=>{this.inited&&(this.img=t,this.create(e),this.play())},t.src=this.path}draw(){if(this.ctx&&this.img){const{offsetX:e,offsetY:t}=this.getFramePos();this.ctx.clearRect(0,0,this.options.rect.x*this.ratio,this.options.rect.y*this.ratio),this.ctx.drawImage(this.img,e,t,this.swidth,this.sheight,0,0,this.options.rect.x*this.ratio,this.options.rect.y*this.ratio)}}next(){this.options.loopTime&&this.cycleTimes>=this.options.loopTime?clearTimeout(this.timer):(this.draw(),this.stepIndex=this.stepIndex+1,this.stepIndex===this.allnums&&(this.cycleTimes++,this.stepIndex=0,this.options.oncomplete&&this.options.oncomplete()))}play(){this.options.autoplay?this.auto():this.next()}pause(){clearTimeout(this.timer)}reset(){this.pause(),this.stepIndex=0,this.cycleTimes=0}auto(){const e=()=>{this.next(),this.timer=window.setTimeout(e,this.delayTime)};e()}getFramePos(){const e=this.stepIndex%this.wnums*this.swidth,t=Math.floor(this.stepIndex/this.wnums)*this.sheight;return{offsetX:e,offsetY:t}}destroy(){this.reset(),this.img=null,this.inited=!1}}var zI=HI,LI={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},keepStatic:{type:Boolean,default:!1},id:{type:Number,default:0},type:{type:Number,default:0},show:{type:Boolean,default:!1},isCom:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),s=Object(n["computed"])(()=>Po(i["b"].state.proInfo.version,"6.3.0")),{isShowed:a,updateContentShowStatus:r}=BI({props:e},{emit:t}),{imgPath:c}=VI({props:e,isShowed:a}),{wrapStyle:l}=RI({props:e}),{isShowLoading:d,showLoading:u,hideLoading:p}=FI({isShowed:a},{updateContentShowStatus:r}),{rect:h,isImage3d:f}=GI({props:e,imgPath:c,wrapStyle:l},{showLoading:u}),{isFramesImg:m,destroyCanvas:v}=WI({props:e,isShowed:a,rect:h,curInstance:o},{hideLoading:p}),b=Object(n["computed"])(()=>{var t,o,n;let i;return l.value&&(i=l.value),!(null!==(t=e.originData)&&void 0!==t&&t.isSelectorHot)&&!(null!==(o=e.originData)&&void 0!==o&&o.isGlobalSelectorHot)&&!(null!==(n=e.originData)&&void 0!==n&&n.content.gifInfo.imgPath)&&(i.width>h.x||i.height>h.y)}),{imgScale:g,handleScaleImg:y,handleMouseDown:w,resetImgStyle:x,handleTouchStart:S}=DI({rect:h,curInstance:o,wrapStyle:l,isOverV630:s}),{isShowCloseIcon:I,closeIcon:k,onHideHandle:O}=NI({props:e},{emit:t},{resetImgStyle:x,allowDragAndScale:b});return $I({destroyCanvas:v}),{props:e,isShowed:a,isShowCloseIcon:I,closeIcon:k,imgPath:c,wrapStyle:l,isShowLoading:d,rect:h,isImage3d:f,isFramesImg:m,imgScale:g,isOverV630:s,onHideHandle:O,handleScaleImg:y,handleMouseDown:w,handleTouchStart:S}}};function DI({rect:e,curInstance:t,wrapStyle:o,isOverV630:s}){const a=Object(n["ref"])(1);let[r,c,l,d,u]=[0,0,0,0,0];const p=i["b"].state.device.mobile,h=n=>{if(!s)return;if(n.deltaY<0){const t=o.value.width>e.x&&e.x*(a.value+.05)<o.value.width,n=o.value.height>e.y&&e.y*(a.value+.05)<o.value.height;(t||n)&&(a.value+=.2)}else Number(a.value.toFixed(2))>1&&(a.value-=.2);const i=(e.y*a.value-e.y)/a.value/2,l=Math.abs(c/a.value)>i,d=(e.x*a.value-e.x)/a.value/2,u=Math.abs(r/a.value)>d;if(u){const{imgRef:e}=t.value.refs;e.style.transform=r<0?`translateX(${-1*d}px)`:`translateX(${d}px)`}if(l){const{imgRef:e}=t.value.refs;e.style.transform=c<0?`translateY(${-1*i}px)`:`translateY(${i}px)`}},f=n=>{const{imgRef:i}=t.value.refs,{touches:s}=n;if(p&&2===s.length){const t=Math.hypot(s[0].pageX-s[1].pageX,s[0].pageY-s[1].pageY),n=t-u;if(n>0){const t=o.value.width>e.x&&e.x*(1+n/100)<o.value.width,i=o.value.height>e.y&&e.y*(1+n/100)<o.value.height;(t||i)&&(a.value=1+n/100)}n<0&&a.value>1&&(a.value-=.05)}const h=p?s[0].pageY:n.clientY,f=p?s[0].pageX:n.clientX,m=h-d,v=f-l,b=(e.y*a.value-e.y)/a.value/2,g=Math.abs(c/a.value)<b+20,y=(e.x*a.value-e.x)/a.value/2,w=Math.abs(r/a.value)<y+20;function x(){m>0&&(c<=0||c>0&&g)&&(c+=m),m<0&&(c>=0||c<0&&g)&&(c+=m),i.style.transform=`translateY(${c/a.value}px)`,d=h}function S(){v>0&&(r<=0||r>0&&w)&&(r+=v),v<0&&(r>=0||r<0&&w)&&(r+=v),i.style.transform=`translateX(${r/a.value}px)`,l=f}Math.floor(o.value.width)>e.x&&x(),Math.floor(o.value.height)>e.y&&S()},m=()=>{const{imgRef:o}=t.value.refs,n=(e.y*a.value-e.y)/a.value/2,i=(e.x*a.value-e.x)/a.value/2;Math.abs(c)>(e.y*a.value-e.y)/2+20?o.style.transform=c>0?`translateY(${n}px)`:`translateY(${-1*n}px)`:Math.abs(r)>(e.x*a.value-e.x)/2&&(o.style.transform=r>0?`translateX(${i}px)`:`translateX(${-1*i}px)`)},v=e=>{if(!s||1===a.value)return;e.preventDefault(),d=e.clientY,l=e.clientX;const{imgRef:o}=t.value.refs;o.addEventListener("mousemove",f),window.addEventListener("mouseup",()=>{m(),o.removeEventListener("mousemove",f)})},b=e=>{if(!s)return;e.preventDefault();const{touches:o}=e;d=o[0].pageY,l=o[0].pageX,2===o.length&&(u=Math.hypot(o[0].pageX-o[1].pageX,o[0].pageY-o[1].pageY));const{imgRef:n}=t.value.refs;n.addEventListener("touchmove",f),window.addEventListener("touchend",()=>{m(),n.removeEventListener("touchmove",f)})},g=()=>{[r,c,l,d,u]=[0,0,0,0,0],a.value=1;const{imgRef:e}=t.value.refs;e.style.transform="translate(0, 0)"};return{imgScale:a,handleScaleImg:h,handleMouseDown:v,resetImgStyle:g,handleTouchStart:b}}function BI({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1}),Object(n["watch"])(()=>e.show,e=>{e&&(s.value=!1),i.value=e});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&(t("show"),s.value=!0)};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function NI({props:e},{emit:t},{resetImgStyle:o,allowDragAndScale:s}){const a=Object(n["computed"])(()=>e.isClose),r=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),c=()=>{t("hide"),s.value&&o()};return{isShowCloseIcon:a,closeIcon:r,onHideHandle:c}}function VI({props:e,isShowed:t}){const o=Object(n["ref"])("");return Object(n["watch"])(()=>t.value,t=>{if(t){var n;const t=(null===(n=e.originData)||void 0===n?void 0:n.content)||{};o.value=t.imagePath||""}else o.value=""}),{imgPath:o}}function RI({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n;if(!t.value)return{};const s=Lf(t.value.showSize,e.isCom),a=Po(i["b"].state.proInfo.version,"6.0.1");return a||(s.w=.9*window.innerWidth,s.h=.9*window.innerHeight),{width:s.w,height:s.h,scale:Math.min(s.w/200,1),opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}});return{wrapStyle:o}}function FI({isShowed:e},{updateContentShowStatus:t}){const o=Object(n["ref"])(!1),i=()=>{o.value=!0},s=()=>{o.value=!1,t(!0)};return Object(n["watch"])(()=>e.value,e=>{e||s()}),{isShowLoading:o,showLoading:i,hideLoading:s}}function GI({props:e,imgPath:t,wrapStyle:o},{showLoading:s}){const a=Object(n["reactive"])({x:0,y:0}),r=Object(n["computed"])(()=>{var t;const o=(null===(t=e.originData)||void 0===t?void 0:t.content)||{};return 1===o.imageType}),c=()=>new Promise(e=>{const o=new Image;o.onload=()=>{e({x:o.naturalWidth,y:o.naturalHeight})},o.src=t.value}),l=e=>{const t=o.value.width,n=o.value.height;let s=0,c=0;const l=t/e.x,d=n/e.y;l<d?(s=t,c=e.y*s/e.x):(c=n,s=e.x*c/e.y);const u=Po(i["b"].state.proInfo.version,"6.0.1"),p=Ao(i["b"].state.proInfo.version,"6.0.1","6.3.0");p&&(s=t,c=n),u||(o.value.width=s,o.value.height=c),a.x=Math.floor(s)*(r.value?2:1),a.y=Math.floor(c)};return Object(n["watch"])(()=>t.value,e=>{e?(s(),c().then(e=>{l(e)})):(a.x=0,a.y=0)}),{rect:a,isImage3d:r}}function WI({props:e,isShowed:t,rect:o,curInstance:i},{hideLoading:s}){const a=Object(n["ref"])(!1);let r=!1,c=null;const l=()=>{const n=e.originData.content.gifInfo;a.value=!(!n||!n.imgPath),a.value?(c||(c=new zI(n,{rect:{x:o.x,y:o.y},loopTime:e.originData.content.loopTime,autoplay:!e.keepStatic,oncomplete:()=>{Ns.emit(ka,e.id)}})),r?(c.reset(),c.play()):c.load(e=>{const{photoInner:o}=i.value.refs;o&&a.value&&t.value&&(e.className="is--inner",o.appendChild(e),r=!0,s())})):s()},d=()=>{const{photoInner:e}=i.value.refs;if(e){const t=e.querySelector("canvas");t&&e.removeChild(t)}c&&c.destroy(),c=null,a.value=!1,r=!1};return Object(n["watch"])(()=>t.value&&!!o.x,e=>{e?l():d()}),{isFramesImg:a,destroyCanvas:d}}function $I({destroyCanvas:e}){Object(n["onBeforeUnmount"])(()=>{e()})}o("b652");const UI=Tr()(LI,[["render",jI],["__scopeId","data-v-68d97887"]]);var XI=UI;const YI=e=>(Object(n["pushScopeId"])("data-v-6bb08284"),e=e(),Object(n["popScopeId"])(),e),ZI=["src"],qI={key:0,class:"img__control is--inner"},KI=YI(()=>Object(n["createElementVNode"])("span",{class:"icon_left"},null,-1)),JI=[KI],QI=YI(()=>Object(n["createElementVNode"])("span",{class:"icon_right"},null,-1)),ek=[QI];function tk(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"img__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.wrapStyle.height+"px"})},[i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:"photo-inner",ref:"photoInner",style:Object(n["normalizeStyle"])({opacity:i.wrapStyle.opacity})},[Object(n["createElementVNode"])("div",{class:"img__wrap",style:Object(n["normalizeStyle"])({width:i.rect.x+"px",height:i.rect.y+"px"})},[Object(n["createElementVNode"])("img",{class:Object(n["normalizeClass"])(["photo-item is--inner",{sbs:i.isImage3d}]),src:i.imgPath,alt:""},null,10,ZI)],4),i.imgsData.autoplay?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",qI,[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"btn-left",style:Object(n["normalizeStyle"])({left:i.btnOffsetX+"px",transform:`scale(${i.btnScale})`}),onClick:t[1]||(t[1]=(...e)=>i.prev&&i.prev(...e))},JI,4),[[n["vShow"],i.isShowBtnL]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"btn-right",style:Object(n["normalizeStyle"])({right:i.btnOffsetX+"px",transform:`scale(${i.btnScale})`}),onClick:t[2]||(t[2]=(...e)=>i.next&&i.next(...e))},ek,4),[[n["vShow"],i.isShowBtnR]])])),Object(n["createVNode"])(r,{value:i.isShowLoading,"onUpdate:value":t[3]||(t[3]=e=>i.isShowLoading=e),scale:i.wrapStyle.scale},null,8,["value","scale"])],4)],4)),[[n["vShow"],i.props.show]])}var ok={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},keepStatic:{type:Boolean,default:!1},id:{type:Number,default:0},type:{type:Number,default:0},show:{type:Boolean,default:!1},isCom:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const{isShowed:o,updateContentShowStatus:n}=nk({props:e},{emit:t}),{isShowCloseIcon:i,closeIcon:s,onHideHandle:a}=ik({props:e},{emit:t}),{imgPath:r,updateImgPath:c}=sk(),{wrapStyle:l}=ak({props:e}),{isShowLoading:d,showLoading:u,hideLoading:p}=rk({isShowed:o},{updateContentShowStatus:n}),{rect:h,isImage3d:f,imgsInfoMap:m,destroyImgStyle:v}=ck({props:e,imgPath:r,wrapStyle:l},{showLoading:u,hideLoading:p}),{prev:b,next:g,btnOffsetX:y,isShowBtnL:w,isShowBtnR:x,btnScale:S,imgsData:I,destroyControl:k}=lk({props:e,imgsInfoMap:m,isShowed:o},{updateImgPath:c,hideLoading:p});return dk({isShowed:o},{destroyControl:k,destroyImgStyle:v}),{props:e,isShowCloseIcon:i,closeIcon:s,onHideHandle:a,imgPath:r,wrapStyle:l,isShowLoading:d,rect:h,isImage3d:f,prev:b,next:g,btnOffsetX:y,btnScale:S,isShowBtnL:w,isShowBtnR:x,imgsData:I}}};function nk({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1}),Object(n["watch"])(()=>e.show,e=>{e&&(s.value=!1),i.value=e});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&(t("show"),s.value=!0)};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function ik({props:e},{emit:t}){const o=Object(n["computed"])(()=>e.isClose),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=()=>{t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function sk(){const e=Object(n["ref"])(""),t=t=>{e.value=t};return{imgPath:e,updateImgPath:t}}function ak({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n;if(!t.value)return{};const s=Lf(t.value.showSize,e.isCom),a=Po(i["b"].state.proInfo.version,"6.0.1");return a||(s.w=.9*window.innerWidth,s.h=.9*window.innerHeight),{width:s.w,height:s.h,scale:Math.min(s.w/200,1),opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}});return{wrapStyle:o}}function rk({isShowed:e},{updateContentShowStatus:t}){const o=Object(n["ref"])(!1),i=()=>{o.value=!0},s=()=>{o.value=!1,t(!0)};return Object(n["watch"])(()=>e.value,e=>{e||s()}),{isShowLoading:o,showLoading:i,hideLoading:s}}function ck({props:e,imgPath:t,wrapStyle:o},{showLoading:i,hideLoading:s}){const a=Object(n["ref"])({}),r=Object(n["reactive"])({x:0,y:0}),c=Object(n["computed"])(()=>{var t;const o=(null===(t=e.originData)||void 0===t?void 0:t.content)||{};return 1===o.imageType}),l=()=>new Promise(e=>{const o=new Image;o.onload=()=>{e({x:o.naturalWidth,y:o.naturalHeight})},o.src=t.value}),d=e=>{const t=o.value.width,n=o.value.height,i=t/e.x,s=n/e.y;let a=0,c=0;i<s?(a=t,c=e.y*a/e.x):(c=n,a=e.x*c/e.y),r.x=Math.floor(a),r.y=Math.floor(c)},u=(e,t)=>{let n=t.x;return o.value.width>=o.value.height&&(n=Math.round(t.y*e.x/e.y)),(o.value.width-n)/2+5},p=()=>{a.value={},h=0};let h=0;return Object(n["watch"])(()=>t.value,e=>{if(e){if(a.value[e])return r.x=a.value[e].size.x,void(r.y=a.value[e].size.y);i(),l().then(t=>{d(t),h||(h=Math.min(r.x/280,1)),a.value[e]={size:{x:r.x,y:r.y},scale:h,ox:u(t,r)},s()})}}),{rect:r,isImage3d:c,imgsInfoMap:a,destroyImgStyle:p}}function lk({props:e,imgsInfoMap:t,isShowed:o},{updateImgPath:i,hideLoading:s}){const a=Object(n["computed"])(()=>{var t;return(null===(t=e.originData)||void 0===t?void 0:t.content)||{}}),r=Object(n["ref"])(0),c=Object(n["computed"])(()=>a.value.imagePaths?a.value.imagePaths[r.value]:""),l=Object(n["computed"])(()=>{const e=t.value[c.value]||{};return e.ox||0}),d=Object(n["computed"])(()=>{const e=t.value[c.value]||{};return e.scale||1}),u=Object(n["computed"])(()=>!!a.value.imagePaths&&(a.value.imagePaths.length>1&&0!==r.value)),p=Object(n["computed"])(()=>!!a.value.imagePaths&&(a.value.imagePaths.length>1&&r.value!==a.value.imagePaths.length-1)),h=()=>{let e=r.value-1;-1===e&&(e=a.value.imagePaths.length-1),r.value=e,b()},f=()=>{r.value=(r.value+1)%a.value.imagePaths.length,b()};let m=0;const v=()=>{clearTimeout(m),m=window.setTimeout(()=>{f(),v()},1e3*a.value.interval)},b=()=>{if(a.value.imagePaths){const e=a.value.imagePaths[r.value];i(e);const o=t.value[e]||{};o&&o.size&&s()}},g=()=>{r.value=0,b(),i("")},y=()=>{clearTimeout(m),g()};return Object(n["watch"])(()=>o.value,e=>{e?(b(),a.value&&a.value.autoplay&&v()):y()}),{activeIndex:r,prev:h,next:f,btnScale:d,btnOffsetX:l,isShowBtnL:u,isShowBtnR:p,imgsData:a,destroyControl:y}}function dk({isShowed:e},{destroyControl:t,destroyImgStyle:o}){Object(n["watch"])(()=>e.value,e=>{e||(t(),o())})}o("32eb");const uk=Tr()(ok,[["render",tk],["__scopeId","data-v-6bb08284"]]);var pk=uk;const hk=["src","poster","volume"],fk=["src"];function mk(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"video__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.wrapStyle.height+"px"})},[i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["video__inner",{sbs:i.isVideo3d}]),style:Object(n["normalizeStyle"])(`opacity: ${i.wrapStyle.opacity};`)},[Object(n["createElementVNode"])("video",{crossOrigin:"anonymous",playsinline:"","webkit-playsinline":"","x5-video-player-type":"h5",class:Object(n["normalizeClass"])([{keepRate:i.wrapStyle.keepRate},"is--inner"]),src:i.processData.videoPath,poster:i.processData.videoPoster,volume:i.processData.volume,ref:"myVideo",onClick:t[1]||(t[1]=(...e)=>i.onTogglePlayHandle&&i.onTogglePlayHandle(...e))},null,10,hk),i.isReadyStartTime?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,class:"v-poster",src:i.processData.videoPoster,alt:"",onClick:t[2]||(t[2]=(...e)=>i.onTogglePlayHandle&&i.onTogglePlayHandle(...e))},null,8,fk)),Object(n["createVNode"])(n["Transition"],{name:"fadeInScale",onClick:Object(n["withModifiers"])(i.onTogglePlayHandle,["stop"])},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["btn__toggle is--inner",[i.videoStatus?"is--pause":"is--play"]]),style:Object(n["normalizeStyle"])({transform:`scale(${i.wrapStyle.scale})`})},null,6),[[n["vShow"],i.isShowVideoBtn]])]),_:1},8,["onClick"])],6),Object(n["withDirectives"])(Object(n["createVNode"])(r,{scale:i.wrapStyle.scale},null,8,["scale"]),[[n["vShow"],i.isShowLoading||!i.isReadyStartTime&&i.videoStatus]])],4)),[[n["vShow"],i.props.show]])}var vk={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},id:{type:Number},type:{type:Number},show:{type:Boolean},mediaType:{type:String,default:"hotspot"},isCom:{type:Boolean,default:!1},isEventSelector:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isIOSMode:i,isX5Mode:s}=bk(),{isShowed:a,updateContentShowStatus:r}=gk({props:e},{emit:t}),{isShowCloseIcon:c,closeIcon:l,onHideHandle:d}=yk({props:e},{emit:t}),{wrapStyle:u}=wk({props:e}),{isShowLoading:p,showLoading:h,hideLoading:f}=xk({props:e},{updateContentShowStatus:r}),m=Object(n["computed"])(()=>1===g.value.videoType),{isShowVideoBtn:v,videoStatus:b,processData:g,isReadyStartTime:y,onTogglePlayHandle:w}=Sk({props:e,curInstance:o,wrapStyle:u,isX5Mode:s,isIOSMode:i,isShowed:a},{showLoading:h,hideLoading:f});return Ik({processData:g,curInstance:o,isShowed:a}),{props:e,wrapStyle:u,isShowCloseIcon:c,closeIcon:l,isVideo3d:m,isShowLoading:p,processData:g,isShowVideoBtn:v,videoStatus:b,isReadyStartTime:y,onTogglePlayHandle:w,onHideHandle:d}}};function bk(){const e=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),t=Object(n["computed"])(()=>i["b"].state.device.qq),o=Object(n["computed"])(()=>i["b"].state.device.iphone);return{wxShareData:e,isIOSMode:o,isX5Mode:t}}function gk({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1}),Object(n["watch"])(()=>e.show,e=>{e&&(s.value=!1),i.value=e});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&(t("show"),s.value=!0)};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function yk({props:e},{emit:t}){const o=Object(n["computed"])(()=>e.isClose),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=()=>{t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function wk({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n;if(!t.value)return{};const s=Lf(t.value.showSize,e.isCom),a=Po(i["b"].state.proInfo.version,"6.0.1");return a||(s.w=.9*window.innerWidth,s.h=.9*window.innerHeight),{width:s.w,height:s.h,scale:Math.min(s.w/200,1),opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1,keepRate:!a}});return{wrapStyle:o}}function xk({props:e},{updateContentShowStatus:t}){const o=Object(n["ref"])(!1),i=()=>{o.value=!0},s=()=>{o.value=!1,t(!0)};return Object(n["watch"])(()=>e.show,e=>{e||s()}),{isShowLoading:o,showLoading:i,hideLoading:s}}function Sk({props:e,curInstance:t,wrapStyle:o,isX5Mode:s,isIOSMode:a,isShowed:r},{showLoading:c,hideLoading:l}){const d=Object(n["ref"])(null),u=Object(n["computed"])(()=>{var t;return(null===(t=e.originData)||void 0===t?void 0:t.content)||{}}),p=Object(n["ref"])(!0),h=Object(n["ref"])(!1);let f=!1,m=!1;const v=Object(n["ref"])(!0);let b=!1,g=!1;const y=(e,t)=>{const n=o.value.width,s=o.value.height,a=n/e,r=s/t;let c=0,l=0;a<r?(c=n,l=t*c/e):(l=s,c=e*l/t);const d=Po(i["b"].state.proInfo.version,"6.0.1");d&&(c=n,l=s),o.value.width=c,o.value.height=l},w=()=>{window.console.log("视频切换播放"),d.value&&(d.value.paused?S.play():S.pause())},x=()=>{d.value&&(a.value?d.value.ondurationchange=()=>{g||(l(),y(d.value.videoWidth,d.value.videoHeight),u.value.autoplay&&(d.value.play(),Ja(e.originData.id,!1)))}:d.value.oncanplay=()=>{g||(l(),y(d.value.videoWidth,d.value.videoHeight),u.value.autoplay&&d.value.play())},d.value.onplay=()=>{h.value=!0,p.value=!1,f=!1,window.console.log("视频播放了")},d.value.onpause=()=>{h.value=!1,p.value=!0,window.console.log("视频暂停了")},d.value.onended=()=>{window.console.log("视频结束播放"),u.value.replay?(d.value.play(),m=!0):(f=!0,Qa(e.originData.id,"isEnded",!0)),Ns.emit(ka,e.id)},d.value.ontimeupdate=()=>{m&&(d.value.currentTime=u.value.startTime,m=!1),!m&&!v.value&&d.value.currentTime>u.value.startTime&&(v.value=!0)},d.value.onerror=()=>{window.console.log("视频发生异常"),requestAnimationFrame(()=>{d.value.load(),d.value.play()})})},S={play:()=>{d.value.paused&&((d.value.currentTime<u.value.startTime||f)&&(d.value.currentTime=u.value.startTime),d.value.play(),Ja(e.originData.id,!1))},pause:()=>{d.value.paused||(d.value.pause(),Ja(e.originData.id,!0))}},I=async()=>{const e=i["b"].state.publicConfig.va&&i["b"].state.publicConfig.va.host;if(!u.value.vaUid||!e)return u.value.videoPath;let t=u.value.videoPath;const o=await id({uid:u.value.vaUid}).catch(e=>{window.console.log(e)});if(o&&1===o.resCode){var n;const e=(null===(n=o.resData)||void 0===n?void 0:n.row)||{};t=e.fileUrl}return t},k=async()=>{c();const{myVideo:o}=t.value.refs;if(o&&u.value.videoPath){g=!1,o.src=await I(),o.load(),d.value=o,u.value.startTime&&!s.value&&(m=!0),u.value.startTime>0&&(v.value=!1);const t=e.originData.isSelectorHot?"selector_hotspot":e.mediaType,n=e.originData.isEventSelector||e.isEventSelector;Ka({pid:e.originData.pid||e.originData.id,id:e.originData.id,type:t+"_video",instance:d.value,isPauseMedia:e.originData.content.isPauseMedia,isEventSelector:n}),u.value.autoplay&&(o.play(),Ja(e.originData.id,!1,{isShow:!0})),b||(x(),b=!0)}},O=()=>{d.value&&(g=!0,d.value.pause(),d.value.currentTime=0,Ja(e.originData.id,!0,{isHide:!0}),er(e.originData.id),h.value=!1,p.value=!0)};return Object(n["watch"])(()=>r.value,e=>{e?k():O()}),{isShowVideoBtn:p,videoStatus:h,processData:u,isReadyStartTime:v,onTogglePlayHandle:w,playcb:S.play}}function Ik({processData:e,curInstance:t,isShowed:o}){const s=async()=>{const{myVideo:o}=t.value.refs;if(!o||!e.value.vaEnable)return;const n=i["b"].state.publicConfig.va||{},s=n.host;if(!s)return;const a=s+"/ctool/ms/allProcessedData.do",r=s+"/ctool/ms/webClientLog.do",c=s+"/ctool/ms/videoPlayData.do",l=await nd();if(!l||1!==l.resCode)return;const d=new window.VirtualAdsHandler;d.setRequestHeader("cus-auth",l.resData.token),d.setAllProcessDataUrl(a),d.setLogInfoUrl(r),d.setMonitorUrl(c),d.setDisableCache(!0),d.prepare("test client id",Number(n.pId),e.value.vaUid,e.value.videoName,o,o.parentNode,e=>{},e=>{},()=>{},()=>{},e=>{}),window.console.log("实例化虚拟广告组件")};Object(n["watch"])(()=>o.value,e=>{e&&s()})}o("7b9b");const kk=Tr()(vk,[["render",mk],["__scopeId","data-v-f5c706ce"]]);var Ok=kk;const jk=["data-width","data-height","data-mode"],Ck=["src"],Ek=["innerHTML"];function Tk(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"img-txt__space",style:Object(n["normalizeStyle"])({maxWidth:i.wrapStyle.screenWidth+"px",maxHeight:i.wrapStyle.screenHeight+"px",width:i.scaleInfo.wpwidth?i.scaleInfo.wpwidth+"px":"auto",height:i.scaleInfo.wpheight?i.scaleInfo.wpheight+"px":"auto"})},[i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["img-txt__inner is--inner",[i.processData.imageTxtMode?"vertical":"horizon "]]),ref:"txtImgInner",style:Object(n["normalizeStyle"])({opacity:i.wrapStyle.opacity,transform:"scale("+i.scaleInfo.scale+")",transformOrigin:i.scaleInfo.origin}),"data-width":i.wrapStyle.sourceWidth,"data-height":i.wrapStyle.sourceHeight,"data-mode":i.processData.imageTxtMode},[Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["sp_img",{sbs:1===i.processData.imageType}]),style:Object(n["normalizeStyle"])({width:i.wrapStyle.sourceWidth+"px",height:i.wrapStyle.sourceHeight+"px"})},[Object(n["createElementVNode"])("img",{src:i.processData.imagePath,alt:""},null,8,Ck)],6),Object(n["createElementVNode"])("div",{class:"sp_text",style:Object(n["normalizeStyle"])({width:i.wrapStyle.sourceWidth+"px"})},[i.processData.title?(Object(n["openBlock"])(),Object(n["createElementBlock"])("p",{key:0,style:Object(n["normalizeStyle"])([i.processData.txtStyle]),innerHTML:i.processData.title},null,12,Ek)):Object(n["createCommentVNode"])("",!0)],4)],14,jk)],4)),[[n["vShow"],i.props.show]])}var Pk={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},id:{type:Number},type:{type:Number},show:{type:Boolean,default:!1}},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isShowed:i,updateContentShowStatus:s}=_k({props:e},{emit:t}),{isShowCloseIcon:a,closeIcon:r,onHideHandle:c}=Ak({props:e},{emit:t}),{wrapStyle:l}=Mk({props:e}),{scaleInfo:d,resetScale:u}=Hk({isShowed:i,curInstance:o}),{processData:p}=zk({props:e,isShowed:i},{updateContentShowStatus:s});return Lk({resetScale:u}),{props:e,isShowCloseIcon:a,closeIcon:r,onHideHandle:c,wrapStyle:l,scaleInfo:d,processData:p}}};function _k({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1,s.value=!1}),Object(n["watch"])(()=>e.show,e=>{i.value=e,e||(s.value=!1)});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&t("show"),s.value=e};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function Ak({props:e},{emit:t}){const o=Object(n["computed"])(()=>e.isClose),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=()=>{t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function Mk({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n;return t.value?{screenWidth:.9*window.innerWidth,screenHeight:.9*window.innerHeight,sourceWidth:e.originData.content.showSize.x,sourceHeight:e.originData.content.showSize.y,opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}:{}});return{wrapStyle:o}}function Hk({isShowed:e,curInstance:t}){const o=Object(n["reactive"])({scale:1,origin:"center",wpwidth:0,wpheight:0}),i=e=>{const t=!Number(e.getAttribute("data-mode")),n=Number(e.getAttribute("data-width"))*(t?2:1),i=e.parentNode,s=Math.max(e.scrollHeight/i.offsetHeight,1),a=Math.max(n/i.offsetWidth,1);if(a<=1&&s<=1)return;let r=1;r=a>=s?i.offsetWidth/n:i.offsetHeight/e.scrollHeight,o.scale=r,a>=s?o.wpheight=e.scrollHeight*r:o.wpwidth=n*r,o.origin="left"},s=()=>{const{txtImgInner:e}=t.value.refs;e&&i(e)},a=()=>{o.scale=1,o.origin="center",o.wpwidth=0,o.wpheight=0};return Object(n["watch"])(()=>e.value,e=>{e?Object(n["nextTick"])(s):a()}),{scaleInfo:o,resetScale:a}}function zk({props:e,isShowed:t},{updateContentShowStatus:o}){const i=Object(n["reactive"])({title:"",imagePath:"",imageType:0,imageTxtMode:0,txtStyle:null}),s=e=>{if(!e)return{};const t=e.fontSize,o=e.wordSpace/t*18,n=e.rowSpace+t;let i="";e.fontColor&&(i=dn(e.fontColor,1));const s={font:{family:e.fontFamily,size:t,color:i,lineheight:n,wordspace:o,bolid:e.bolid,italic:e.italic,underline:e.underline,align:e.textAlignment},rect:e.showSize,effect:e.texteffect};return cn(s)};return Object(n["watch"])(()=>t.value,t=>{if(t){const t=e.originData.content||{};i.title=t.title,i.imagePath=t.imagePath,i.imageType=t.imageType,i.imageTxtMode=t.imageTxtMode,i.txtStyle=s(e.originData.content),o(!0)}}),{processData:i}}function Lk({resetScale:e}){Object(n["onBeforeUnmount"])(()=>{e()})}o("0a1e");const Dk=Tr()(Pk,[["render",Tk],["__scopeId","data-v-e171da54"]]);var Bk=Dk;const Nk=e=>(Object(n["pushScopeId"])("data-v-33bad5f8"),e=e(),Object(n["popScopeId"])(),e),Vk=["src"],Rk={key:1,class:"error__tips"},Fk=Nk(()=>Object(n["createElementVNode"])("span",{class:"tip__icon"},null,-1)),Gk={class:"tip__text"},Wk=["src"];function $k(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return i.props.show?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"webview__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.wrapStyle.height+"px"})},[i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"webview__inner",style:Object(n["normalizeStyle"])({opacity:i.wrapStyle.opacity})},[i.isMatchHttpProtocol?(Object(n["openBlock"])(),Object(n["createElementBlock"])("iframe",{key:0,src:i.processData.path,frameborder:"0",allow:"microphone *; camera *; autoplay; fullscreen",onLoad:t[1]||(t[1]=(...e)=>i.hideLoading&&i.hideLoading(...e))},null,40,Vk)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Rk,[Fk,Object(n["createElementVNode"])("span",Gk,Object(n["toDisplayString"])(e.$t("public.protocol")),1)]))],4),[[n["vShow"],!i.isLoading]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"cover",style:Object(n["normalizeStyle"])({opacity:i.wrapStyle.opacity})},[Object(n["createElementVNode"])("img",{class:"poster",src:i.processData.poster,alt:""},null,8,Wk)],4),[[n["vShow"],i.isLoading&&i.processData.poster]]),Object(n["withDirectives"])(Object(n["createVNode"])(r,null,null,512),[[n["vShow"],i.isLoading]])],4)):Object(n["createCommentVNode"])("",!0)}var Uk={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},id:{type:Number},type:{type:Number},show:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const{isShowed:o,updateContentShowStatus:n}=Xk({props:e},{emit:t}),{isShowCloseIcon:i,closeIcon:s,onHideHandle:a}=Yk({props:e},{emit:t}),{wrapStyle:r}=Zk({props:e}),{isLoading:c,showLoading:l,hideLoading:d}=Kk({isShowed:o},{updateContentShowStatus:n}),{processData:u,isMatchHttpProtocol:p}=qk({props:e,isShowed:o},{showLoading:l,hideLoading:d});return{props:e,isShowCloseIcon:i,closeIcon:s,onHideHandle:a,wrapStyle:r,processData:u,isLoading:c,hideLoading:d,isMatchHttpProtocol:p}}};function Xk({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1}),Object(n["watch"])(()=>e.show,e=>{e&&(s.value=!1),i.value=e});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&(t("show"),s.value=!0)};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function Yk({props:e},{emit:t}){const o=Object(n["computed"])(()=>{const t=e.originData?e.originData.disappearMode:0;return e.isClose&&3!==t}),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=()=>{t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function Zk({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n;if(!t.value)return{};const s=Lf(t.value.showSize,!1),a=Po(i["b"].state.proInfo.version,"6.0.1");return a||(s.w=.9*window.innerWidth,s.h=.9*window.innerHeight),{width:s.w,height:s.h,scale:Math.min(s.w/200,1),opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}});return{wrapStyle:o}}function qk({props:e,isShowed:t},{showLoading:o,hideLoading:i}){const s=Object(n["reactive"])({path:"",poster:""}),a=Object(n["computed"])(()=>{let e=!0;return/https/.test(location.protocol)&&(e=new RegExp(location.protocol,"g").test(s.path)),e});return Object(n["watch"])(()=>t.value,t=>{if(t){o();const t=e.originData.content;let n="";10===e.originData.type?n=t.path:(n=t.livePath,s.poster=t.livePoster,Ka({id:e.originData.id,type:"hotspot_video",instance:null,isPauseMedia:t.isPauseMedia})),i(),s.path=n}else Ja(e.originData.id,!0),s.path="",s.poster=""}),{processData:s,isMatchHttpProtocol:a}}function Kk({isShowed:e},{updateContentShowStatus:t}){const o=Object(n["ref"])(!0),i=()=>{o.value=!0},s=()=>{o.value=!1,t(!0)};return Object(n["watch"])(()=>e.value,e=>{e||s()}),{isLoading:o,showLoading:i,hideLoading:s}}o("911a");const Jk=Tr()(Uk,[["render",$k],["__scopeId","data-v-33bad5f8"]]);var Qk=Jk;const eO={class:"model__space"},tO={class:"model-inner is--inner",ref:"canvaswrap"},oO={class:"model-canvas",ref:"model"};function nO(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",eO,[i.isShowCloseIcon?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")",left:i.closeBtnPos.left-18+"px",top:i.closeBtnPos.top-18+"px"}),onClick:t[0]||(t[0]=e=>i.onHideHandle(!1))},null,4)),[[n["vShow"],!i.isLoading]]):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",tO,[Object(n["createElementVNode"])("canvas",oO,null,512)],512),Object(n["withDirectives"])(Object(n["createVNode"])(r,null,null,512),[[n["vShow"],i.isLoading]])],512)),[[n["vShow"],i.props.show]])}const iO=()=>{const e=Object(n["ref"])([{path:a()+"cdn/three.js",loaded:!1},{path:a()+"cdn/mtlloader.js",loaded:!1},{path:a()+"cdn/objloader.js",loaded:!1},{path:a()+"cdn/tgaloader.js",loaded:!1},{path:a()+"cdn/fbxloader.js",loaded:!1},{path:a()+"cdn/inflate.min.js",loaded:!1},{path:a()+"cdn/orbitcontrols.js",loaded:!1}]),t=Object(n["ref"])(!1),o=Object(n["ref"])(!1),s=Object(n["computed"])(()=>e.value.every(e=>e.loaded));return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e||(o.value=!1)}),{isLoadedThreeJs:t,isCompletePlugin:o,isLoadedComplete:s,modelScriptPaths:e}},{isLoadedThreeJs:sO,isCompletePlugin:aO,modelScriptPaths:rO,isLoadedComplete:cO}=iO();function lO(){const e=Object(n["ref"])(!1),t=["cdn/MTLLoader.js","cdn/OBJLoader.js","cdn/TGALoader.js","cdn/FBXLoader.js","cdn/inflate.min.js","cdn/OrbitControls.js"];window.THREE||t.unshift("cdn/three.js");const o=()=>{if(e.value)return;const n=t.shift();if(!n)return void(e.value=!0);const i=document.createElement("script");i.src=a()+n,document.body.appendChild(i),i.onload=()=>{o()}};return{isPassThreePlugin:e,loadThreeScript:o}}function dO(e,t){if(/.obj$/i.test(t))return e.clone();if(/.fbx$/i.test(t)){const t=uO(e);return t.animations=e.animations,t}}function uO(e){const t=new Map,o=new Map,n=e.clone();return pO(e,n,(e,n)=>{t.set(n,e),o.set(e,n)}),n.traverse(e=>{if(!e.isSkinnedMesh)return;const n=e,i=t.get(e),s=i.skeleton.bones;n.skeleton=i.skeleton.clone(),n.bindMatrix.copy(i.bindMatrix),n.skeleton.bones=s.map(e=>o.get(e)),n.bind(n.skeleton,n.bindMatrix)}),n}function pO(e,t,o){o(e,t);for(let n=0;n<e.children.length;n++)pO(e.children[n],t.children[n],o)}const{isPassThreePlugin:hO,loadThreeScript:fO}=lO(),mO=(e,t)=>{vO(t)};function vO(e){e&&(e.traverse(e=>{e instanceof window.THREE.Mesh&&bO(e),e instanceof window.THREE.Group&&yO(e),e instanceof window.THREE.Object3D&&yO(e),e instanceof window.THREE.SkinnedMesh&&yO(e)}),e.children&&e.children.length&&e.children.forEach(t=>{t.visible=!1,e.remove(t)}),e=null)}function bO(e){var t,o,n;null!==(t=e.geometry)&&void 0!==t&&t.dispose&&e.geometry.dispose(),e.material&&gO(e.material),null!==(o=e.skeleton)&&void 0!==o&&null!==(n=o.boneTexture)&&void 0!==n&&n.dispose&&e.skeleton.boneTexture.dispose()}function gO(e){const t=e=>{var t;null!==e&&void 0!==e&&e.dispose&&e.dispose(),null!==e&&void 0!==e&&null!==(t=e.map)&&void 0!==t&&t.dispose&&e.map.dispose()};e instanceof Array?e.map(e=>{t(e)}):t(e)}function yO(e){e.remove(e)}function wO(e){if(!e)return;window.THREE.Cache.clear(),e.dispose(),e.forceContextLoss(),e.content=null;const t=e.domElement.getContext("webgl");t&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").loseContext(),e=null}var xO={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},closeAnyWhere:{type:Boolean,default:!0},show:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isShowCloseIcon:i,closeIcon:s,onHideHandle:a}=SO({props:e},{emit:t}),{isPass:r}=IO({props:e}),{isLoading:c,closeBtnPos:l}=kO({props:e,curInstance:o,isPass:r},{onHideHandle:a,emit:t});return{props:e,isShowCloseIcon:i,closeIcon:s,onHideHandle:a,isLoading:c,closeBtnPos:l}}};function SO({props:e},{emit:t}){const o=Object(n["computed"])(()=>e.isClose),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=o=>{o&&!e.closeAnyWhere||t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function IO({props:e}){const t=Object(n["ref"])(!1);return Object(n["watch"])(()=>e.show,e=>{e&&(fO(),hO.value&&(t.value=!0))}),Object(n["watch"])(()=>hO.value,e=>{e&&(t.value=!0)}),{isPass:t}}function kO({props:e,curInstance:t,isPass:o},{onHideHandle:s,emit:a}){const r=Object(n["ref"])(!1),c=Object(n["computed"])(()=>{var t;return(null===(t=e.originData)||void 0===t?void 0:t.content)||{}});let l=null,d=null;const u=Object(n["reactive"])({left:0,top:0}),p={canvas:null,renderer:null,camera:null,raycaster:null,scene:null,groupInstance:null,mouse:null,container:{width:0,height:0,offsetX:0,offsetY:0},path:{public:"",geo:"",mtl:""},basic:{isclone:!1,alpha:1},renderTimer:0,rotateTimer:0,mixers:[]},h={initWebGlRender(){p.renderer||(p.renderer=new window.THREE.WebGLRenderer({canvas:p.canvas,antialias:!0,alpha:!0}),p.renderer&&(p.renderer.setPixelRatio(window.devicePixelRatio),p.renderer.setSize(p.container.width,p.container.height)))},initCamera(){p.camera=new window.THREE.PerspectiveCamera(45,p.container.width/p.container.height,1,1e4),p.camera.position.z=0},initScene(){p.scene=new window.THREE.Scene},initVector2(){p.mouse=new window.THREE.Vector2},initRaycaster(){p.raycaster=new window.THREE.Raycaster},initLight(){const e=new window.THREE.AmbientLight(16777215,1.2),t=new window.THREE.PointLight(16777215,.1),o=new window.THREE.DirectionalLight(16777215,.1);p.scene&&p.camera&&(p.scene.add(e),p.camera.add(t),p.scene.add(o),p.scene.add(p.camera))},initAnimate(){this.renderTime(),p.renderTimer=window.setTimeout(this.initAnimate.bind(this),1e3/30)},renderTime(){p.mixers.length&&m.updateAnimation(),p.camera.lookAt(p.scene.position),p.renderer.render(p.scene,p.camera)},clearRender(){requestAnimationFrame(()=>{clearTimeout(p.renderTimer),cancelAnimationFrame(p.renderTimer)})},resumeRender(){var e;p.renderer&&p.scene&&(c.value.isAutoRotation||null!==(e=c.value.animation)&&void 0!==e&&e.type&&p.mixers.length?h.initAnimate():h.renderTime())},init(){this.initCamera(),this.initScene(),this.initVector2(),this.initRaycaster(),this.initLight(),this.initWebGlRender(),this.renderTime()}},f={initWrapWH(){var e;const t=null===(e=p.canvas)||void 0===e?void 0:e.parentElement;t&&(p.container.width=t.clientWidth||0,p.container.height=t.clientHeight||0,p.container.offsetX=t.getBoundingClientRect().left,p.container.offsetY=t.getBoundingClientRect().top)},initPath(){const t=c.value.modelPath.split("/");p.path.geo=t.pop(),p.path.public=t.join("/")+"/",p.path.mtl=c.value.modelMtlPath.split("/").pop(),p.basic.alpha=e.originData.opacity}},m={loadobj(){p.path.mtl?(new window.THREE.MTLLoader).setPath(p.path.public).load(p.path.mtl,e=>{e.preload(),(new window.THREE.OBJLoader).setMaterials(e).setPath(p.path.public).load(p.path.geo,e=>{d=e,this.updateConfig()})}):(new window.THREE.OBJLoader).setPath(p.path.public).load(p.path.geo,e=>{d=e,this.updateConfig()})},loadfbx(){const e=new window.THREE.FBXLoader;e.load(p.path.public+"/"+p.path.geo,e=>{d=e,this.updateConfig()})},load(){const e=p.path.public+p.path.geo,t=(window.modelCaches||[]).findIndex(t=>t.key===e&&!!t.model)>=0;if(t){const t=window.modelCaches.find(t=>t.key===e);t&&t.model&&(d=dO(t.model,p.path.geo),this.updateConfig())}else/\.obj$/i.test(p.path.geo)?this.loadobj():/\.fbx/i.test(p.path.geo)&&this.loadfbx()},addModelToCaches(){window.modelCaches||(window.modelCaches=[]);const e=p.path.public+p.path.geo,t=window.modelCaches.find(t=>t.key===e);t?t.model||(t.model=dO(d,p.path.geo)):window.modelCaches.push({key:e,model:dO(d,p.path.geo)})},updateConfig(){/\.fbx/i.test(p.path.geo)&&c.value.animation.type&&this.initSkeletonAnimation(),this.addModelToCaches(),d.updateMatrixWorld(),this.repairModel(),this.initModelScale();const e=new window.THREE.Group;e.add(d),p.scene.add(e),h.renderTime(),requestAnimationFrame(()=>{this.setModelScale(),this.updateModelCenterPos(),p.groupInstance=e,setTimeout(()=>{this.showModel()},50)})},showModel(){r.value=!1,d.visible=!0,this.autoRotate(),this.playSkeAnimation(),h.resumeRender(),a("show")},repairModel(){d.traverse(e=>{e.material&&p.basic.isclone&&(e.material.length?e.material=e.material.map(e=>e.clone()):e.material=e.material.clone()),e.material&&e.material.transparent&&(e.material.alphaMap=null,e.material.alphaTest=.15,e.material.depthTest=!0,e.material.side=window.THREE.DoubleSide),e.material&&(e.material.length?e.material.forEach((function(e){e.transparent=!0,e.opacity=p.basic.alpha})):(e.material.transparent=!0,e.material.opacity=p.basic.alpha))})},initModelScale(){d.visible=!1,l||(l=new window.THREE.Box3);const e=l.setFromObject(d),t=e.getSize();if(p.camera){const e=Math.min(t.x,t.y,t.z);p.camera.position.z=Math.ceil(e+1)}const o=Math.pow(t.x,2),n=Math.pow(t.y,2),i=Math.pow(t.z,2),s=1/(Math.sqrt(o+n+i)/(p.camera.position.z/1.25));d.scale.set(s,s,s)},setModelScale(){const e=d.scale.x-.01;d.scale.set(e,e,e),this.calcBoxVertixPos()},updateModelCenterPos(){const e=(new window.THREE.Box3).setFromObject(d),t=e.getCenter(new window.THREE.Vector3),o=d.position.x-t.x,n=d.position.y-t.y,i=d.position.z-t.z;c.value.rotateOriginType||(d.position.x=o,d.position.y=n,d.position.z=i)},caleCorrectScale(e=20){const t=l.setFromObject(d),o=t.getSize(),n=new window.THREE.Vector3(o.x/2,o.y/2,o.z/2),i=n.project(p.camera),s=Math.abs(i.x)-Math.abs(i.y)>0,a=s?Math.abs(i.x-1)<=.01:Math.abs(i.y-1)<=.01;if(a||e<0)return;let r=d.scale.x;s?i.x>1?r*=.9:i.x<1&&(r*=1.1):i.y>1?r*=.9:i.y<1&&(r*=1.1),d.scale.set(r,r,r),e--,this.caleCorrectScale(e)},calcBoxVertixPos(){const e=(new window.THREE.Box3).setFromObject(d);if(!e)return;const t=e.getSize(new window.THREE.Vector3(0,0,0)),o=new window.THREE.Vector3(t.x/2,t.y/2,t.z/2),n=p.container.width/2,i=p.container.height/2,s=o.project(p.camera),a=Math.round(n*s.x+n),r=Math.round(-i*s.y+i),c=p.container.offsetX+p.container.width-18,l=p.container.offsetY+p.container.height-18;u.left=Math.min(a,c),u.top=Math.min(r,l)},getGroupModel(e){let t=e.parent;while(t&&t.parent&&"Scene"!==t.parent.type)t=t.parent;return t},autoRotate(){if(!c.value||!c.value.isAutoRotation||!p.groupInstance)return;const e=c.value.rotationAnimationType?.02:-.02;p.groupInstance.rotateY(e),p.rotateTimer=requestAnimationFrame(this.autoRotate.bind(this))},stopRotate(){cancelAnimationFrame(p.rotateTimer)},initSkeletonAnimation(){const e=d.animations&&d.animations[0];if(e){const t=new window.THREE.AnimationMixer(d),o=t.clipAction(e);c.value.animation.loop||(o.setLoop(window.THREE.LoopRepeat,1),o.clampWhenFinished=!0),c.value.animation.reverse&&(o.timeScale=-1),c.value.isAutoRotation||c.value.animation.loop||t.addEventListener("finished",h.clearRender,!1),p.mixers.push({el:t,action:o,clock:new window.THREE.Clock,speed:c.value.animation.speed||1})}},playSkeAnimation(){if(!c.value||!c.value.animation||!c.value.animation.type)return;const e=p.mixers[0];e&&(e.action.paused=!1,e.action.play())},pauseSkeAnimation(){const e=p.mixers[0];e&&(e.action.paused=!0)},updateAnimation(){p.mixers.map((function(e){e.el&&e.el.update(e.clock.getDelta()*e.speed)}))}},v={down(t){var o;t.clientX?(p.mouse.x=(t.clientX-p.container.offsetX)/p.container.width*2-1,p.mouse.y=-(t.clientY-p.container.offsetY)/p.container.height*2+1):(p.mouse.x=(t.touches[0].pageX-p.container.offsetX)/p.container.width*2-1,p.mouse.y=-(t.touches[0].pageY-p.container.offsetY)/p.container.height*2+1),p.raycaster.setFromCamera(p.mouse,p.camera);const n=p.raycaster.intersectObjects(p.scene.children,!0);let i=!1;for(let e=0,s=n.length;e<s;e++){const t=n[e],o=m.getGroupModel(t.object);if(o){i=!0;break}}i?null!==(o=c.value)&&void 0!==o&&o.openInModelViewer&&Ns.emit(Sa,e.originData):s(!0)},resize(){f.initWrapWH(),p.renderer.setSize(p.container.width,p.container.height),p.camera.aspect=p.container.width/p.container.height,p.camera.updateProjectionMatrix(),m.calcBoxVertixPos(),h.renderTime()},bind(){var e;window.addEventListener("resize",this.resize,!1),null===(e=p.canvas)||void 0===e||e.addEventListener("mousedown",this.down,!1)},unbind(){var e;window.removeEventListener("resize",this.resize,!1),null===(e=p.canvas)||void 0===e||e.removeEventListener("mousedown",this.down,!1)}},b={init(){this.terminate(),v.unbind(),p.mixers.length&&(m.pauseSkeAnimation(),this.removeEvent(),p.mixers=[]),cancelAnimationFrame(p.rotateTimer),cancelAnimationFrame(p.renderTimer),clearTimeout(p.renderTimer),mO(p.renderer,p.scene),vO(d),vO(p.groupInstance),p.scene=null,p.camera=null,p.raycaster=null,p.groupInstance=null,p.mouse=null,l=null,d=null},removeEvent(){p.mixers.map((function(e){e.el&&e.el.removeEventListener("finished",h.clearRender,!1)}))},terminate(){if(window.myKrp.workers){for(let e=0,t=window.myKrp.workers.length;e<t;e++){let t=window.myKrp.workers[e];t.worker&&(t.worker.terminate(),t.worker=null)}window.myKrp.workers=[],window.myKrp.workers.length=0}}},g=()=>{const{model:e}=t.value.refs;e&&(p.canvas=e,f.initWrapWH(),f.initPath(),h.init(),m.load()),v.bind()};return Object(n["watch"])(()=>o.value&&e.show,e=>{e?(r.value=!0,Object(n["nextTick"])(g)):b.init()}),Object(n["watch"])(()=>i["b"].state.pageStatus.newpage,e=>{e?(m.stopRotate(),m.pauseSkeAnimation(),h.clearRender()):(m.autoRotate(),m.playSkeAnimation(),h.resumeRender())}),{isLoading:r,closeBtnPos:u}}o("f8a3");const OO=Tr()(xO,[["render",nO],["__scopeId","data-v-12a408f4"]]);var jO=OO;function CO(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("l-model-view"),c=Object(n["resolveComponent"])("l-ring"),l=Object(n["resolveComponent"])("popup");return Object(n["openBlock"])(),Object(n["createBlock"])(l,{value:i.isShowLayer,index:1,onHide:i.hideViewer,padding:"0px","bg-color":"#222",maskClosable:!1},{content:Object(n["withCtx"])(()=>[Object(n["createVNode"])(r,{"origin-data":i.componentData,show:9===i.ctype,onHide:i.hideViewer},null,8,["origin-data","show","onHide"]),Object(n["createVNode"])(c,{"origin-data":i.componentData,show:20===i.ctype,onHide:i.hideViewer,onShow:i.onShowedContent},null,8,["origin-data","show","onHide","onShow"])]),_:1},8,["value","onHide"])}const EO=e=>(Object(n["pushScopeId"])("data-v-0812e43a"),e=e(),Object(n["popScopeId"])(),e),TO={class:"model__space"},PO={class:"model-inner is--inner",ref:"canvaswrap"},_O={class:"model-canvas",ref:"model"},AO={key:0,class:"control-wrap"},MO={class:"progress-wrap",ref:"progress"},HO=EO(()=>Object(n["createElementVNode"])("div",{class:"progress-handle"},null,-1)),zO=EO(()=>Object(n["createElementVNode"])("div",{class:"progress-line"},null,-1)),LO=EO(()=>Object(n["createElementVNode"])("div",{class:"progress-buffer"},null,-1)),DO=[HO,zO,LO];function BO(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",TO,[Object(n["createElementVNode"])("div",{class:"back-wrap",onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},Object(n["toDisplayString"])(e.$t("public.back")),1),Object(n["createElementVNode"])("div",PO,[Object(n["createElementVNode"])("canvas",_O,null,512)],512),i.isMobileMode?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",AO,[Object(n["createElementVNode"])("div",MO,DO,512)])),Object(n["withDirectives"])(Object(n["createVNode"])(r,null,null,512),[[n["vShow"],i.isLoading]])],512)),[[n["vShow"],i.props.show]])}var NO={props:{originData:{type:Object},show:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isMobileMode:i}=VO(),s=()=>{requestAnimationFrame(()=>{t("hide")})},{isLoading:a}=RO({props:e,curInstance:o,isMobileMode:i});return{props:e,isMobileMode:i,isLoading:a,onHideHandle:s}}};function VO(){const e=Object(n["computed"])(()=>i["b"].state.device.mobile);return{isMobileMode:e}}function RO({props:e,curInstance:t,isMobileMode:o}){const s=Object(n["ref"])(!1);let a=null,r=null;const c=Object(n["computed"])(()=>{var t;return(null===(t=e.originData)||void 0===t?void 0:t.content)||{}}),l=Object(n["computed"])(()=>c.value.isAutoRotation||c.value.animation.type&&d.mixers.length),d={canvas:null,renderer:null,camera:null,raycaster:null,scene:null,controls:null,groupInstance:null,mouse:null,mySlider:null,clickTimer:0,container:{width:0,height:0,offsetX:0,offsetY:0},path:{public:"",geo:"",mtl:""},basic:{isclone:!1,alpha:1},renderTimer:0,rotateTimer:0,mixers:[]},u={initWebGlRender(){d.renderer||(d.renderer=new window.THREE.WebGLRenderer({canvas:d.canvas,antialias:!0,alpha:!0}),d.renderer&&(d.renderer.setPixelRatio(window.devicePixelRatio),d.renderer.setSize(d.container.width,d.container.height)))},initCamera(){d.camera=new window.THREE.PerspectiveCamera(45,d.container.width/d.container.height,1,1e4),d.camera.position.z=0},initScene(){d.scene=new window.THREE.Scene;const e=c.value.modelViewerBgColor||{},t=e.x||e.y||e.z||e.w;t&&!c.value.modelViewerBgImagePath&&(d.scene.background=new window.THREE.Color(`rgb(${e.x}, ${e.y}, ${e.z})`))},initVector2(){d.mouse=new window.THREE.Vector2},initRaycaster(){d.raycaster=new window.THREE.Raycaster},initLight(){const e=new window.THREE.AmbientLight(16777215,1.2),t=new window.THREE.PointLight(16777215,.1),o=new window.THREE.DirectionalLight(16777215,.1);d.scene&&d.camera&&(d.scene.add(e),d.camera.add(t),d.scene.add(o),d.scene.add(d.camera))},initControls(){d.controls=new window.THREE.OrbitControls(d.camera,d.renderer.domElement),d.controls.enableDamping=!0,d.controls.dampingFactor=.25,d.controls.enableZoom=!0,d.controls.enablePan=!1,d.controls.minDistance=2.5,d.controls.maxDistance=5},initAnimate(){this.renderTime(),d.renderTimer=window.setTimeout(this.initAnimate.bind(this),1e3/30)},renderTime(){d.mixers.length&&h.updateAnimation(),d.camera.lookAt(d.scene.position),d.renderer.render(d.scene,d.camera)},clearRender(){requestAnimationFrame(()=>{cancelAnimationFrame(d.renderTimer),clearTimeout(d.renderTimer)})},init(){this.initCamera(),this.initScene(),this.initVector2(),this.initRaycaster(),this.initLight(),this.initWebGlRender(),this.initControls(),this.renderTime()}},p={initWrapWH(){var e;const t=null===(e=d.canvas)||void 0===e?void 0:e.parentElement;t&&(d.container.width=t.clientWidth||0,d.container.height=t.clientHeight||0,d.container.offsetX=t.getBoundingClientRect().left,d.container.offsetY=t.getBoundingClientRect().top)},initPath(){const e=c.value.modelPath.split("/");d.path.geo=e.pop(),d.path.public=e.join("/")+"/",d.path.mtl=c.value.modelMtlPath.split("/").pop()},initModelControl(){const{progress:e}=t.value.refs;e&&(d.mySlider=new tb(e,{diffNum:-8,change(e){f.changeCameraDistance(e)}}))}},h={loadobj(){d.path.mtl?(new window.THREE.MTLLoader).setPath(d.path.public).load(d.path.mtl,e=>{e.preload(),(new window.THREE.OBJLoader).setMaterials(e).setPath(d.path.public).load(d.path.geo,e=>{r=e,this.updateConfig()})}):(new window.THREE.OBJLoader).setPath(d.path.public).load(d.path.geo,e=>{r=e,this.updateConfig()})},loadfbx(){const e=new window.THREE.FBXLoader;e.load(d.path.public+"/"+d.path.geo,e=>{r=e,this.updateConfig()})},load(){const e=d.path.public+d.path.geo,t=(window.modelCaches||[]).findIndex(t=>t.key===e&&!!t.model)>=0;if(t){const t=window.modelCaches.find(t=>t.key===e);t&&t.model&&(d.basic.isclone=!0,r=dO(t.model,d.path.geo),this.updateConfig())}else d.basic.isclone=!1,/\.obj$/i.test(d.path.geo)?this.loadobj():/\.fbx/i.test(d.path.geo)&&this.loadfbx()},updateConfig(){/\.fbx/i.test(d.path.geo)&&c.value.animation.type&&this.initSkeletonAnimation(),r.updateMatrixWorld(),this.repairModel(),this.initModelScale();const e=new window.THREE.Group;e.add(r),d.scene.add(e),u.renderTime(),requestAnimationFrame(()=>{this.setModelScale(),this.updateModelCenterPos(),d.groupInstance=e,setTimeout(()=>{this.showModel()},50)})},showModel(){s.value=!1,r.visible=!0,u.renderTime(),c.value.isAutoRotation&&d.groupInstance&&this.autoRotate(),c.value.animation.type&&this.playSkeAnimation(),l.value?u.initAnimate():u.renderTime()},repairModel(){window.console.log("是否为克隆模型",d.basic.isclone),r.traverse(e=>{e.material&&d.basic.isclone&&(e.material.length?e.material=e.material.map(e=>e.clone()):e.material=e.material.clone()),e.material&&e.material.transparent&&(e.material.alphaMap=null,e.material.alphaTest=.15,e.material.depthTest=!0,e.material.side=window.THREE.DoubleSide),e.material&&(e.material.length?e.material.forEach((function(e){e.transparent=!0,e.opacity=d.basic.alpha})):(e.material.transparent=!0,e.material.opacity=d.basic.alpha))})},initModelScale(){r.visible=!1,a||(a=new window.THREE.Box3);const e=a.setFromObject(r),t=e.getSize(new window.THREE.Vector3);if(d.camera){const e=Math.min(t.x,t.y,t.z);d.camera.position.z=2.5*Math.ceil(e+1),d.controls.minDistance=d.camera.position.z/2.5,d.controls.maxDistance=d.camera.position.z}const o=Math.pow(t.x,2),n=Math.pow(t.y,2),i=Math.pow(t.z,2),s=1/(Math.sqrt(o+n+i)/(d.camera.position.z/1.25));r.scale.set(s,s,s)},setModelScale(){this.caleCorrectScale();const e=(r.scale.x-.01)/2.5;r.scale.set(e,e,e)},updateModelCenterPos(){const e=(new window.THREE.Box3).setFromObject(r),t=e.getCenter(new window.THREE.Vector3),o=r.position.x-t.x,n=r.position.y-t.y,i=r.position.z-t.z;c.value.rotateOriginType||(r.position.x=o,r.position.y=n,r.position.z=i)},caleCorrectScale(e=20){const t=a.setFromObject(r),o=t.getSize(new window.THREE.Vector3),n=new window.THREE.Vector3(o.x/2,o.y/2,o.z/2),i=n.project(d.camera),s=Math.abs(i.x)-Math.abs(i.y)>0,c=s?Math.abs(i.x-1)<=.01:Math.abs(i.y-1)<=.01;if(c||e<0)return;let l=r.scale.x;s?i.x>1?l*=.9:i.x<1&&(l*=1.1):i.y>1?l*=.9:i.y<1&&(l*=1.1),r.scale.set(l,l,l),e--,this.caleCorrectScale(e)},getGroupModel(e){let t=e.parent;while(t&&t.parent&&"Scene"!==t.parent.type)t=t.parent;return t},autoRotate(){const e=c.value.rotationAnimationType?.02:-.02;d.groupInstance&&d.groupInstance.rotateY(e),d.rotateTimer=requestAnimationFrame(this.autoRotate.bind(this))},initSkeletonAnimation(){const e=r.animations&&r.animations[0];if(e){const t=new window.THREE.AnimationMixer(r),o=t.clipAction(e);c.value.animation.loop||(o.setLoop(window.THREE.LoopRepeat,1),o.clampWhenFinished=!0),c.value.animation.reverse&&(o.timeScale=-1),d.mixers.push({el:t,action:o,clock:new window.THREE.Clock,speed:c.value.animation.speed||1})}},playSkeAnimation(){const e=d.mixers[0];e&&e.action.play()},pauseSkeAnimation(){const e=d.mixers[0];e&&(e.action.paused=!0)},updateAnimation(){d.mixers.map((function(e){e.el&&e.el.update(e.clock.getDelta()*e.speed)}))}},f={clickHandle(){c.value.isAutoRotation&&(cancelAnimationFrame(d.rotateTimer),clearTimeout(d.clickTimer),d.clickTimer=window.setTimeout(()=>{h.autoRotate()},2e3))},updateSlider(){const e=this.getDistanceByPoint(d.camera.position),t=d.controls.maxDistance-d.controls.minDistance,o=(d.controls.maxDistance-e)/t;d.mySlider&&d.mySlider.update(100*o),l.value||u.renderTime()},getDistanceByPoint(e){const t=Math.pow(e.x-0,2),o=Math.pow(e.y-0,2),n=Math.pow(e.z-0,2);return Math.sqrt(t+o+n)},changeCameraDistance(e){if(!d.camera)return;const t=d.camera.position.x,o=d.camera.position.y,n=d.camera.position.z,i=this.getDistanceByPoint(d.camera.position),s=d.controls.maxDistance-(d.controls.maxDistance-d.controls.minDistance)*e,a=t*s/i,r=o*s/i,c=n*s/i;d.camera.position.x=a,d.camera.position.y=r,d.camera.position.z=c,l.value||u.renderTime()},resize(){p.initWrapWH(),d.renderer.setSize(d.container.width,d.container.height),d.camera.aspect=d.container.width/d.container.height,d.camera.updateProjectionMatrix(),u.renderTime(),m.renderer&&m.renderer.setSize(d.container.width,d.container.height),m&&(m.camera.aspect=d.container.width/d.container.height,m.camera.updateProjectionMatrix())},bind(){var e,t,n;(window.addEventListener("resize",this.resize,!1),o.value)?null===(t=d.canvas)||void 0===t||t.addEventListener("touchend",this.clickHandle,!1):null===(n=d.canvas)||void 0===n||n.addEventListener("click",this.clickHandle,!1);null===(e=d.controls)||void 0===e||e.addEventListener("change",this.updateSlider.bind(this),!1)},unbind(){var e,t,n;(window.removeEventListener("resize",this.resize,!1),o.value)?null===(t=d.canvas)||void 0===t||t.removeEventListener("touchend",this.clickHandle,!1):null===(n=d.canvas)||void 0===n||n.removeEventListener("click",this.clickHandle,!1);null===(e=d.controls)||void 0===e||e.removeEventListener("change",this.updateSlider.bind(this),!1)}},m={renderer:null,scene:null,camera:null,timer:0,initRender(){this.renderer=new window.THREE.WebGLRenderer({alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(d.container.width,d.container.height),this.renderer.domElement.className="skybg";const{canvaswrap:e}=t.value.refs;e&&e.appendChild(this.renderer.domElement)},initScene(){this.scene=new window.THREE.Scene},initCamera(){const e=i["b"].state.sceneInfo.fov||75;this.camera=new window.THREE.PerspectiveCamera(e,window.innerWidth/window.innerHeight,.1,2e3);const t=0,o=0,n=18,s=window.THREE.Math.degToRad(90-t),a=window.THREE.Math.degToRad(-1*o+180),r=new window.THREE.Vector3;r.x=-1*n*Math.sin(s)*Math.cos(a),r.y=n*Math.cos(s),r.z=n*Math.sin(s)*Math.sin(a),this.camera.lookAt(r)},initSphere(){const e=new window.THREE.SphereGeometry(18,32,16),t=(new window.THREE.TextureLoader).load(c.value.modelViewerBgImagePath);t.minFilter=window.THREE.LinearFilter,t.magFilter=window.THREE.LinearFilter;const o=new window.THREE.MeshBasicMaterial({map:t,side:window.THREE.DoubleSide}),n=new window.THREE.Mesh(e,o);n.scale.set(1,1,-1),this.scene.add(n)},updateRender(){this.renderer.render(this.scene,this.camera),this.timer=requestAnimationFrame(this.updateRender.bind(this))},destroy(e=!1){if(cancelAnimationFrame(this.timer),vO(this.scene),this.camera=null,e&&this.renderer){const{canvaswrap:e}=t.value.refs;e&&e.removeChild(this.renderer.domElement),wO(this.renderer),this.renderer=null}},init(){this.renderer||this.initRender(),this.initScene(),this.initCamera(),this.initSphere(),this.updateRender()}},v={init(){this.terminate(),f.unbind(),d.mixers.length&&(h.pauseSkeAnimation(),this.removeEvent(),d.mixers=[]),cancelAnimationFrame(d.rotateTimer),cancelAnimationFrame(d.renderTimer),clearTimeout(d.renderTimer),mO(d.renderer,d.scene),vO(r),vO(d.groupInstance),d.scene=null,d.camera=null,d.raycaster=null,d.groupInstance=null,d.mouse=null,d.controls.dispose(),d.controls=null,d.mySlider=null,a=null,r=null},removeEvent(){d.mixers.map((function(e){e.el&&e.el.removeEventListener("finished",u.clearRender,!1)}))},terminate(){if(window.myKrp.workers){for(let e=0,t=window.myKrp.workers.length;e<t;e++){let t=window.myKrp.workers[e];t.worker&&(t.worker.terminate(),t.worker=null)}window.myKrp.workers=[],window.myKrp.workers.length=0}}},b=()=>{const{model:e}=t.value.refs;e&&(d.canvas=e,p.initWrapWH(),p.initPath(),p.initModelControl(),u.init(),h.load()),c.value.modelViewerBgImagePath?m.init():m.destroy(!0),f.bind()};return Object(n["watch"])(()=>e.show,e=>{e?(s.value=!0,Object(n["nextTick"])(b),i["b"].commit(jo["j"],{key:"newpage",value:!0})):(v.init(),m.destroy(),i["b"].commit(jo["j"],{key:"newpage",value:!1}))}),{isLoading:s}}o("8f6e");const FO=Tr()(NO,[["render",BO],["__scopeId","data-v-0812e43a"]]);var GO=FO;const WO={class:"ring__space"};function $O(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",WO,[i.props.isClose&&i.props.fullscreen?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"back-wrap",onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},Object(n["toDisplayString"])(e.$t("public.back")),1)):Object(n["createCommentVNode"])("",!0),i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:1,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[1]||(t[1]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:"ring-inner",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.wrapStyle.height+"px"})},[Object(n["createElementVNode"])("canvas",{ref:"myRing",style:Object(n["normalizeStyle"])({opacity:i.wrapStyle.opacity})},null,4)],4),Object(n["withDirectives"])(Object(n["createVNode"])(r,{scale:i.wrapStyle.scale},null,8,["scale"]),[[n["vShow"],i.isShowLoading]])],512)),[[n["vShow"],i.props.show]])}var UO={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},id:{type:Number},type:{type:Number},show:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!0},isCom:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isShowed:i,updateContentShowStatus:s}=XO({props:e},{emit:t}),{isShowCloseIcon:a,closeIcon:r,onHideHandle:c}=YO({props:e},{emit:t}),{wrapStyle:l}=ZO({props:e}),{isShowLoading:d,showLoading:u,hideLoading:p}=qO({isShowed:i},{updateContentShowStatus:s}),{destroyHandle:h}=KO({props:e,curInstance:o,wrapStyle:l,isShowed:i},{showLoading:u,hideLoading:p});return JO({destroyHandle:h}),{props:e,isShowCloseIcon:a,closeIcon:r,onHideHandle:c,wrapStyle:l,isShowLoading:d}}};function XO({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1}),Object(n["watch"])(()=>e.show,e=>{e&&(s.value=!1),i.value=e});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&(t("show"),s.value=!0)};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function YO({props:e},{emit:t}){const o=Object(n["computed"])(()=>e.isClose&&!e.fullscreen),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=()=>{t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function ZO({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n;if(!t.value)return{};const i=Lf(t.value.showSize,e.isCom);return{width:i.w,height:i.h,scale:Math.min(i.w/200,1),opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}});return{wrapStyle:o}}function qO({isShowed:e},{updateContentShowStatus:t}){const o=Object(n["ref"])(!1),i=()=>{o.value=!0},s=()=>{o.value=!1,t(!0)};return Object(n["watch"])(()=>e.value,e=>{e||s()}),{isShowLoading:o,showLoading:i,hideLoading:s}}function KO({props:e,curInstance:t,wrapStyle:o,isShowed:i},{showLoading:s,hideLoading:a}){const r=Object(n["computed"])(()=>{var t;return(null===(t=e.originData)||void 0===t?void 0:t.content)||{}}),c={canvas:null,ctx:null,ratio:window.devicePixelRatio||1,index:0,caches:[],autoTimer:0,delayTimer:0,naturalW:0,naturalH:0,showSize:{x:0,y:0}},l={initCanvas(){c.canvas&&(c.canvas.style.width=o.value.width+"px",c.canvas.style.height=o.value.height+"px",c.canvas.width=o.value.width*c.ratio,c.canvas.height=o.value.height*c.ratio,c.ctx=c.canvas.getContext("2d"))}},d={load(e,t,o){const n=new Image;n.onload=()=>{c.naturalW||(c.naturalW=n.naturalWidth),c.naturalH||(c.naturalH=n.naturalHeight),c.caches.push({index:t,el:n}),o&&o()},n.src=e},loadAll(e){const t=r.value.paths.length;r.value.paths.forEach((o,n)=>{this.load(o,n,()=>{c.caches.length>=t&&(this.updateShowSize(),e())})})},updateShowSize(){const e=Df({x:c.naturalW,y:c.naturalH},{x:o.value.width,y:o.value.height});c.showSize.x=e.x||o.value.width,c.showSize.y=e.y||o.value.height},draw(){const e=c.caches.find(e=>e.index===c.index);if(!e||!e.el||!c.ctx)return;const t=(o.value.width-c.showSize.x)/2*c.ratio,n=(o.value.height-c.showSize.y)/2*c.ratio;c.ctx.clearRect(0,0,c.showSize.x,c.showSize.y),c.ctx.drawImage(e.el,t,n,c.showSize.x*c.ratio,c.showSize.y*c.ratio)},auto(){this.draw(),c.index===r.value.paths.length?c.index=0:c.index++,clearTimeout(c.autoTimer),c.autoTimer=window.setTimeout(()=>{this.auto()},1e3/r.value.playSpeed)},stop(){clearTimeout(c.autoTimer)},resume(){clearTimeout(c.delayTimer),c.delayTimer=window.setTimeout(()=>{this.auto()},2e3)},initHammer(e){const t=r.value.paths.length,o=Math.floor(360/t);let n=0,i=0;const s=new window.Hammer(e);s.get("pan").set({direction:window.Hammer.DIRECTION_HORIZONTAL}),s.on("press panstart",()=>{this.stop(),n=c.index*o}),s.on("pressup",()=>{r.value.isAutoPlay&&this.resume()}),s.on("panmove",e=>{const s=e.deltaX+n;let a=Math.floor(s/o)%t;a<0&&(a+=t),i=s,c.index=a,this.draw()}),s.on("panend",()=>{n=i,r.value.isAutoPlay&&this.resume()})}},u=()=>{var e;d.stop(),c.caches.forEach(e=>{e.el=null}),c.caches=[],null===(e=c.ctx)||void 0===e||e.clearRect(0,0,r.value.wrapWidth,r.value.wrapHeight),c.index=0,c.delayTimer=0,c.canvas=null,c.ctx=null},p=()=>{if(!r.value.paths||!r.value.paths.length)return;const{myRing:e}=t.value.refs;e&&(c.canvas=e,d.initHammer(e)),l.initCanvas(),d.loadAll(()=>{r.value.isAutoPlay?d.auto():d.draw(),a()})};return Object(n["watch"])(()=>i.value,e=>{e?(s(),Object(n["nextTick"])(p)):u()}),{destroyHandle:u}}function JO({destroyHandle:e}){Object(n["onBeforeUnmount"])(()=>{e()})}o("ff17");const QO=Tr()(UO,[["render",$O],["__scopeId","data-v-030b74c5"]]);var ej=QO,tj={components:{Popup:Pw,LModelView:GO,LRing:ej},setup(e,{emit:t}){const{isShowLayer:o,showLayer:n,hideLayer:i}=oj(),{cid:s,ctype:a,componentData:r,destroyCmData:c}=nj({isShowLayer:o},{showLayer:n}),l=()=>{20===a.value&&t("hide",s.value),c(),i()},d=()=>{s.value&&t("show",s.value)};return Ns.on(Rs,()=>{l()}),{isShowLayer:o,cid:s,ctype:a,componentData:r,hideViewer:l,onShowedContent:d}}};function oj(){const e=Object(n["ref"])(!1),t=()=>{e.value=!0},o=()=>{e.value=!1};return{isShowLayer:e,showLayer:t,hideLayer:o}}function nj({isShowLayer:e},{showLayer:t}){const o=Object(n["ref"])(0),i=Object(n["ref"])(0),s=Object(n["ref"])(null),a=e=>{o.value=e.id,i.value=e.type,s.value=e},r=()=>{o.value=0,i.value=0,s.value=null,Ns.emit(Ia,!1)};return Ns.on(Sa,n=>{e.value&&o.value!==n.id&&r(),a(n),t(),Ns.emit(Ia,!0)}),{cid:o,ctype:i,componentData:s,destroyCmData:r}}const ij=Tr()(tj,[["render",CO]]);var sj=ij;function aj(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("loading");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"video__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.wrapStyle.height+"px"})},[i.isShowCloseIcon?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:"icon-close",style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.closeIcon+")"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,4)):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",{class:"video__inner",style:Object(n["normalizeStyle"])(`opacity: ${i.wrapStyle.opacity};`)},[Object(n["createElementVNode"])("canvas",{ref:"myCanvas",onClick:t[1]||(t[1]=(...e)=>i.onTogglePlayHandle&&i.onTogglePlayHandle(...e)),class:"is--inner"},null,512),Object(n["createVNode"])(n["Transition"],{name:"fadeInScale",onClick:Object(n["withModifiers"])(i.onTogglePlayHandle,["stop"])},{default:Object(n["withCtx"])(()=>[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["btn__toggle is--inner",[i.videoStatus?"is--pause":"is--play"]]),style:Object(n["normalizeStyle"])({transform:`scale(${i.wrapStyle.scale})`})},null,6),[[n["vShow"],i.isShowVideoBtn]])]),_:1},8,["onClick"])],4),Object(n["withDirectives"])(Object(n["createVNode"])(r,{scale:i.wrapStyle.scale},null,8,["scale"]),[[n["vShow"],i.isShowLoading||!i.isReadyStartTime&&i.videoStatus]])],4)),[[n["vShow"],i.props.show]])}function rj(e,t,o){const n=e.createShader(t);e.shaderSource(n,o),e.compileShader(n);const i=e.getShaderParameter(n,e.COMPILE_STATUS);if(i)return n;e.deleteShader(n)}function cj(e,t,o){const n=e.createProgram();e.attachShader(n,t),e.attachShader(n,o),e.linkProgram(n);const i=e.getProgramParameter(n,e.LINK_STATUS);if(i)return n;e.deleteProgram(n)}class lj{constructor(){this.elements=[1,0,0,0,1,0,0,0,1]}identity(){return this.elements[0]=1,this.elements[1]=0,this.elements[2]=0,this.elements[3]=0,this.elements[4]=1,this.elements[5]=0,this.elements[6]=0,this.elements[7]=0,this.elements[8]=1,this}set(e,t,o,n,i,s,a,r,c){return this.elements=[e,t,o,n,i,s,a,r,c],this}makeTranslate(e,t){return this.elements=[1,0,0,0,1,0,e,t,1],this}makeScale(e,t){return this.elements=[e,0,0,0,t,0,0,0,1],this}makeRotation(e){const t=Math.PI/180,o=Math.cos(e*t),n=Math.sin(e*t);return this.elements=[o,n,0,-1*n,o,0,0,0,1],this}multiply(e){return this.multiplyMatrices(this,e)}multiplyMatrices(e,t){const o=e.elements,n=t.elements,i=o[0],s=o[1],a=o[2],r=o[3],c=o[4],l=o[5],d=o[6],u=o[7],p=o[8],h=n[0],f=n[1],m=n[2],v=n[3],b=n[4],g=n[5],y=n[6],w=n[7],x=n[8];return this.elements[0]=i*h+r*f+d*m,this.elements[1]=s*h+c*f+u*m,this.elements[2]=a*h+l*f+p*m,this.elements[3]=i*v+r*b+d*g,this.elements[4]=s*v+c*b+u*g,this.elements[5]=a*v+l*b+p*g,this.elements[6]=i*y+r*w+d*x,this.elements[7]=s*y+c*w+u*x,this.elements[8]=a*y+l*w+p*x,this}}var dj={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},id:{type:Number},type:{type:Number},show:{type:Boolean},mediaType:{type:String,default:"hotspot"},isCom:{type:Boolean,default:!1},isEventSelector:{type:Boolean,default:!1}},components:{Loading:MI},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isIOSMode:i,isX5Mode:s}=uj(),{isShowed:a,updateContentShowStatus:r}=pj({props:e},{emit:t}),{isShowCloseIcon:c,closeIcon:l,onHideHandle:d}=hj({props:e},{emit:t}),{wrapStyle:u}=fj({props:e}),{isShowLoading:p,showLoading:h,hideLoading:f}=mj({props:e},{updateContentShowStatus:r}),{startDrawVideoFrame:m,stopDrawVideoFrame:v}=bj({props:e,curInstance:o,wrapStyle:u,isShowed:a},{showLoading:h,hideLoading:f}),{isShowVideoBtn:b,videoStatus:g,processData:y,isReadyStartTime:w,onTogglePlayHandle:x}=vj({props:e,wrapStyle:u,isX5Mode:s,isIOSMode:i,isShowed:a},{showLoading:h,hideLoading:f,startDrawVideoFrame:m,stopDrawVideoFrame:v});return{props:e,wrapStyle:u,isShowCloseIcon:c,closeIcon:l,isShowLoading:p,processData:y,isShowVideoBtn:b,videoStatus:g,isReadyStartTime:w,onTogglePlayHandle:x,onHideHandle:d}}};function uj(){const e=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),t=Object(n["computed"])(()=>i["b"].state.device.qq),o=Object(n["computed"])(()=>i["b"].state.device.iphone);return{wxShareData:e,isIOSMode:o,isX5Mode:t}}function pj({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1}),Object(n["watch"])(()=>e.show,e=>{e&&(s.value=!1),i.value=e});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&(t("show"),s.value=!0)};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function hj({props:e},{emit:t}){const o=Object(n["computed"])(()=>e.isClose),s=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.weChatShare||{};return e.iconClose||""}),a=()=>{t("hide")};return{isShowCloseIcon:o,closeIcon:s,onHideHandle:a}}function fj({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n;if(!t.value)return{};const i=Lf(t.value.showSize,e.isCom);return{width:i.w,height:i.h,scale:Math.min(i.w/200,1),opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}});return{wrapStyle:o}}function mj({props:e},{updateContentShowStatus:t}){const o=Object(n["ref"])(!1),i=()=>{o.value=!0},s=()=>{o.value=!1,t(!0)};return Object(n["watch"])(()=>e.show,e=>{e||s()}),{isShowLoading:o,showLoading:i,hideLoading:s}}function vj({props:e,wrapStyle:t,isX5Mode:o,isIOSMode:s,isShowed:a},{showLoading:r,hideLoading:c,startDrawVideoFrame:l,stopDrawVideoFrame:d}){const u=Object(n["ref"])(null),p=Object(n["computed"])(()=>{var t;return(null===(t=e.originData)||void 0===t?void 0:t.content)||{}}),h=Object(n["ref"])(!0),f=Object(n["ref"])(!1);let m=!1,v=!1;const b=Object(n["ref"])(!0);let g=!1,y=!1;const w=(e,o)=>{const n=t.value.width,s=t.value.height,a=n/e,r=s/o;let c=0,l=0;a<r?(c=n,l=o*c/e):(l=s,c=e*l/o);const d=Po(i["b"].state.proInfo.version,"6.0.1");d&&(c=n,l=s),t.value.width=c,t.value.height=l},x=()=>{u.value&&(u.value.paused?I.play():I.pause())},S=()=>{u.value&&(s.value?u.value.ondurationchange=()=>{y||(c(),w(u.value.videoWidth,u.value.videoHeight),p.value.autoplay&&(u.value.play(),Ja(e.originData.id,!1)))}:u.value.oncanplay=()=>{y||(c(),w(u.value.videoWidth,u.value.videoHeight),p.value.autoplay&&u.value.play())},u.value.onplay=()=>{f.value=!0,h.value=!1,m=!1,l(u.value)},u.value.onpause=()=>{f.value=!1,h.value=!0,window.console.log("视频暂停了"),d()},u.value.onended=()=>{p.value.replay?(u.value.play(),v=!0):(m=!0,Qa(e.originData.id,"isEnded",!0)),Ns.emit(ka,e.id)},u.value.ontimeupdate=()=>{v&&(u.value.currentTime=p.value.startTime,v=!1),!v&&!b.value&&u.value.currentTime>p.value.startTime&&(b.value=!0)},u.value.onerror=()=>{requestAnimationFrame(()=>{u.value.load(),u.value.play()})})},I={play:()=>{u.value.paused&&((u.value.currentTime<p.value.startTime||m)&&(u.value.currentTime=p.value.startTime),u.value.play(),Ja(e.originData.id,!1))},pause:()=>{u.value.paused||(u.value.pause(),Ja(e.originData.id,!0))}},k=()=>{if(r(),p.value.videoPath){u.value||(u.value=document.createElement("video"),u.value.setAttribute("playsinline","true"),u.value.setAttribute("webkit-playsinline","true"),u.value.setAttribute("x5-video-player-type","h5")),y=!1,u.value.src=p.value.videoPath||"",u.value.volume=p.value.volume,u.value.load(),p.value.startTime&&!o.value&&(v=!0),p.value.startTime>0&&(b.value=!1);const t=e.originData.isSelectorHot?"selector_hotspot":e.mediaType,n=e.originData.isEventSelector||e.isEventSelector;Ka({pid:e.originData.pid||e.originData.id,id:e.originData.id,type:t+"_video",instance:u.value,isPauseMedia:e.originData.content.isPauseMedia,isEventSelector:n}),p.value.autoplay&&(u.value.play(),Ja(e.originData.id,!1,{isShow:!0})),g||(S(),g=!0)}},O=()=>{u.value&&(y=!0,u.value.pause(),u.value.currentTime=0,Ja(e.originData.id,!0,{isHide:!0}),er(e.originData.id),f.value=!1,h.value=!0)};return Object(n["watch"])(()=>a.value,e=>{e?k():O()}),{isShowVideoBtn:h,videoStatus:f,processData:p,isReadyStartTime:b,onTogglePlayHandle:x,playcb:I.play}}function bj({props:e,curInstance:t,wrapStyle:o,isShowed:i},{showLoading:s,hideLoading:a}){let r=null,c=null;function l(){const{myCanvas:e}=t.value.refs;e&&(e.style.width=o.value.width+"px",e.style.height=o.value.height+"px",e.width=o.value.width*window.devicePixelRatio,e.height=o.value.height*window.devicePixelRatio,r||(r=e.getContext("webgl2")))}const d={color:[],threshold:0,smoothing:0};function u(){var t,o;const n=null===(t=e.originData)||void 0===t?void 0:t.content.alphaColor;d.color=[n.x/255,n.y/255,n.z/255,n.w/255],d.threshold=null===(o=e.originData)||void 0===o?void 0:o.content.threshold,d.smoothing=0}function p(){if(!r||c)return;const e="\n      attribute vec2 a_position;\n      attribute vec2 a_texcoord;\n      uniform mat3 u_matrix;\n      varying vec2 v_texcoord;\n      void main () {\n        gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n        // 传递纹理坐标到片段着色器\n        v_texcoord = a_texcoord;\n      }\n    ",t="\n      precision mediump float;\n      varying vec2 v_texcoord;\n      uniform sampler2D u_texture;\n      uniform vec4 CullColor;\n      uniform float ThresholdSensitivity;\n      uniform float Smoothing;\n\n      const float u_clipBlack = 0.0;\n      const float u_clipWhite = 1.0;\n\n      float rgb2cb(float r, float g, float b){ return 0.5 + -0.168736*r - 0.331264*g + 0.5*b; }\n      float rgb2cr(float r, float g, float b){ return 0.5 + 0.5*r - 0.418688*g - 0.081312*b; }\n      float smoothclip(float low, float high, float x){ if (x <= low){ return 0.0; } if(x >= high){ return 1.0; } return (x-low)/(high-low); }\n\n      vec4 getGreenScene(vec4 colora, float Cb_key,float Cr_key, float tola,float tolb, float clipBlack, float clipWhite)\n      {\n        float cb = rgb2cb(colora.r,colora.g,colora.b);\n        float cr = rgb2cr(colora.r,colora.g,colora.b);\n        float alpha = distance(vec2(cb, cr), vec2(Cb_key, Cr_key));\n        alpha = smoothclip(tola,tolb,alpha);\n        float r = max(colora.r - (1.0-alpha)*CullColor.r, 0.0);\n        float g = max(colora.g - (1.0-alpha)*CullColor.g, 0.0);\n        float b = max(colora.b - (1.0-alpha)*CullColor.b, 0.0);\n        if(alpha < clipBlack){ alpha = r = g = b = 0.0; }\n        if(alpha > clipWhite){ alpha = 1.0; }\n        if(clipWhite < 1.0){ alpha = alpha/max(clipWhite, 0.9); }\n        return vec4(r,g,b, alpha);\n      }\n\n      void main () {\n        gl_FragColor = vec4(texture2D(u_texture, v_texcoord).rgb, 1);\n        float tola = 0.0;\n        if (ThresholdSensitivity == 0.05) {\n          tola = ThresholdSensitivity * 0.8;\n        } else if (ThresholdSensitivity == 0.1) {\n          tola = ThresholdSensitivity * 0.486;\n        } else if (ThresholdSensitivity <= 0.2 && ThresholdSensitivity > 0.1) {\n          tola = ThresholdSensitivity * 0.365;\n        } else if (ThresholdSensitivity > 0.2) {\n          tola = ThresholdSensitivity * 0.303;\n        }\n        float tolb = Smoothing;\n        float cb_key = rgb2cb(CullColor.r, CullColor.g, CullColor.b);\n        float cr_key = rgb2cr(CullColor.r, CullColor.g, CullColor.b);\n        gl_FragColor = getGreenScene(gl_FragColor, cb_key, cr_key, tola, tolb, u_clipBlack, u_clipWhite);\n      }\n    ";function o(e){e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,e.canvas.width,0,0,e.canvas.height,0,e.canvas.height,e.canvas.width,0,e.canvas.width,e.canvas.height]),e.STATIC_DRAW)}function n(e){e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW)}function i(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}const s=rj(r,r.VERTEX_SHADER,e),a=rj(r,r.FRAGMENT_SHADER,t),l=cj(r,s,a),u=r.getAttribLocation(l,"a_position"),p=r.getAttribLocation(l,"a_texcoord"),h=r.getUniformLocation(l,"u_matrix"),f=r.getUniformLocation(l,"u_texture"),m=r.getUniformLocation(l,"CullColor"),v=r.getUniformLocation(l,"ThresholdSensitivity"),b=r.getUniformLocation(l,"Smoothing"),g=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,g),o(r);const y=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,y),n(r),i(r),r.enable(r.BLEND),r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA),c=e=>{if(!r)return;r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e),r.viewport(0,0,r.canvas.width,r.canvas.height),r.clear(r.COLOR_BUFFER_BIT),r.useProgram(l),r.enableVertexAttribArray(u),r.bindBuffer(r.ARRAY_BUFFER,g),r.vertexAttribPointer(u,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(p),r.bindBuffer(r.ARRAY_BUFFER,y),r.vertexAttribPointer(p,2,r.FLOAT,!1,0,0),r.uniform4fv(m,d.color),r.uniform1f(v,d.threshold),r.uniform1f(b,d.smoothing);const t=(new lj).set(2/r.canvas.width,0,0,0,-2/r.canvas.height,0,-1,1,1),o=new lj;o.multiply(t),r.uniformMatrix3fv(h,!1,o.elements),r.uniform1i(f,0),r.drawArrays(r.TRIANGLES,0,6)}}function h(){var t;const o=new Image;s(),o.onload=()=>{c&&c(o),a()},o.src=(null===(t=e.originData)||void 0===t?void 0:t.content.videoPoster)||""}let f=0;const m=e=>{e&&e.currentTime>0&&c&&c(e),f=requestAnimationFrame(()=>{m(e)})},v=()=>{cancelAnimationFrame(f)};return Object(n["watch"])(()=>i.value,e=>{e&&(u(),l(),p(),h())}),{startDrawVideoFrame:m,stopDrawVideoFrame:v}}o("120d");const gj=Tr()(dj,[["render",aj],["__scopeId","data-v-2762a864"]]);var yj=gj,wj={components:{Popup:Pw,LText:kI,LImg:XI,LImgs:pk,LVideo:Ok,LTextImg:Bk,LWebview:Qk,LModel:jO,LViewer:sj,LCutOutVideo:yj},setup(){const{isShowPopup:e,originalData:t,hotspotType:o,isCloseAnyWhere:n,onHideHandle:i,onShowHandle:s,onCloseHandle:a}=xj();return{isShowPopup:e,isCloseAnyWhere:n,originalData:t,hotspotType:o,onHideHandle:i,onShowHandle:s,onCloseHandle:a}}};function xj(){const e=Object(n["ref"])({}),t=Object(n["ref"])(!1),o=Object(n["ref"])(!1),i=Object(n["computed"])(()=>{var t;return null===(t=e.value.closeAnyWhere)||void 0===t||t}),s=Object(n["ref"])(0),a=Object(n["ref"])(0),r=n=>{t.value=!1,o.value=!1,a.value=0;const i=n||s.value;Ns.emit(ya,{status:!1,id:i}),52===e.value.type&&Ns.emit(Ta,i)},c=e=>{const t=e||s.value;Ns.emit(ya,{status:!0,id:t})},l=e=>{Ns.emit(ya,{status:!1,id:e})},d=e=>{const t=10===e.type&&1===e.content.type;return[5,20].indexOf(e.type)<0||t};return Ns.on(ba,n=>{var i;if(10===n.type&&0===(null===(i=n.content)||void 0===i?void 0:i.type))return void Ho(n.content.path);const c=d(n);c&&t.value&&s.value!==n.id&&r(s.value),o.value=!o.value,[5,20].indexOf(n.type)<0&&(s.value=n.id,a.value=n.type,e.value=n,t.value=!t.value),20===n.type?Ns.emit(Sa,n):5!==n.type&&52!==n.type||Ns.emit(Ea,n)}),Ns.on(ga,(e=0)=>{let t=!0;e&&e!==s.value&&(t=!1),t&&r(e)}),Ns.on(Rs,()=>{r()}),{isShowPopup:t,originalData:e,hotspotType:a,isCloseAnyWhere:i,onHideHandle:r,onShowHandle:c,onCloseHandle:l}}o("e945");const Sj=Tr()(wj,[["render",pI],["__scopeId","data-v-4bbf3e80"]]);var Ij=Sj;const kj=["onClick"];function Oj(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("selector-com"),c=Object(n["resolveComponent"])("loading"),l=Object(n["resolveComponent"])("popup");return Object(n["openBlock"])(),Object(n["createBlock"])(l,{value:i.isShowPopup,index:-1,onClose:t[1]||(t[1]=e=>i.onHideHandle()),"mask-closable":i.closeAnyWhere&&i.isShowClose},{content:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(i.processData,e=>Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"selector__space",key:e.id},[Object(n["createElementVNode"])("div",{class:"selector-inner is--inner",style:Object(n["normalizeStyle"])({width:(null===e||void 0===e?void 0:e.wrapWidth)+"px",height:(null===e||void 0===e?void 0:e.wrapHeight)+"px"})},[Object(n["createElementVNode"])("div",{class:"bg_image",style:Object(n["normalizeStyle"])({backgroundColor:null!==e&&void 0!==e&&e.bgImage?"transparent":null===e||void 0===e?void 0:e.bgColor,backgroundImage:null!==e&&void 0!==e&&e.bgImage?"url("+(null===e||void 0===e?void 0:e.bgImage)+")":"none",opacity:null===e||void 0===e?void 0:e.opacity}),onClick:t=>i.reportSelectorClick(e)},null,12,kj),i.isShowClose?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:Object(n["normalizeClass"])(["icon-close",{normal:i.wxShareData.defClose}]),style:Object(n["normalizeStyle"])({backgroundImage:"url("+i.wxShareData.iconClose+")",right:-(null===e||void 0===e?void 0:e.closeSize)/2+"px",top:-(null===e||void 0===e?void 0:e.closeSize)/2+"px",width:(null===e||void 0===e?void 0:e.closeSize)+"px",height:(null===e||void 0===e?void 0:e.closeSize)+"px"}),onClick:t[0]||(t[0]=(...e)=>i.onHideHandle&&i.onHideHandle(...e))},null,6)):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(r,{componentsData:null===e||void 0===e?void 0:e.components,isShow:i.isShowPopup,scale:null===e||void 0===e?void 0:e.scale,isEventSelector:!i.isShowClose},null,8,["componentsData","isShow","scale","isEventSelector"])],4),Object(n["withDirectives"])(Object(n["createVNode"])(c,null,null,512),[[n["vShow"],i.isLoading]])])),[[n["vShow"],e.id===i.selectorId]])),128))]),_:1},8,["value","mask-closable"])}const jj=["onClick"],Cj={key:1,class:"poster"},Ej={key:1,class:"poster"},Tj={key:1,class:"poster"},Pj={key:1,class:"poster"},_j={key:7,class:"mask"};function Aj(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("l-text"),c=Object(n["resolveComponent"])("l-btn"),l=Object(n["resolveComponent"])("l-img"),d=Object(n["resolveComponent"])("l-imgs"),u=Object(n["resolveComponent"])("l-video"),p=Object(n["resolveComponent"])("l-ring");return Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(i.processData,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:Object(n["normalizeClass"])(["cm-item",{"is--mask":e.data.hotspot||e.data.jumpSceneId}]),key:e.data.id,style:Object(n["normalizeStyle"])(e.css),onClick:t=>i.componentClickHandle(e.data)},[[0,1,2,3].indexOf(e.data.type)>=0&&e.data.isShow?(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:0,show:i.props.isShow,"origin-data":e.data,"is-close":!1,id:e.data.id,type:e.data.type,"is-com":!0},null,8,["show","origin-data","id","type"])):Object(n["createCommentVNode"])("",!0),[5,6].indexOf(e.data.type)>=0&&e.data.isShow?(Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:1,show:i.props.isShow,"origin-data":e.data,id:e.data.id,type:e.data.type,"is-com":!0},null,8,["show","origin-data","id","type"])):Object(n["createCommentVNode"])("",!0),7===e.data.type&&e.data.isShow?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:2,class:"is--sand",style:Object(n["normalizeStyle"])({width:e.data.content.showSize.x+"px",height:e.data.content.showSize.y+"px"})},null,4)):Object(n["createCommentVNode"])("",!0),[4,9].indexOf(e.data.type)>=0&&e.data.isShow?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:3},[e.data.content.imagePath?(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:0,"origin-data":e.data,"is-close":!1,"keep-static":4===e.data.type&&i.isOver590,id:e.data.id,type:e.data.type,show:i.props.isShow,"is-com":!0},null,8,["origin-data","keep-static","id","type","show"])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Cj))],64)):Object(n["createCommentVNode"])("",!0),8===e.data.type&&e.data.isShow?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:4},[e.data.content.imagePaths.length?(Object(n["openBlock"])(),Object(n["createBlock"])(d,{key:0,"origin-data":e.data,"is-close":!1,"keep-static":4===e.data.type,id:e.data.id,type:e.data.type,show:i.props.isShow,"is-com":!0},null,8,["origin-data","keep-static","id","type","show"])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Ej))],64)):Object(n["createCommentVNode"])("",!0),10===e.data.type&&e.data.isShow?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:5},[e.data.content.videoPath?(Object(n["openBlock"])(),Object(n["createBlock"])(u,{key:0,show:i.props.isShow,"origin-data":e.data,"is-close":!1,id:e.data.id,type:e.data.type,"media-type":"selector","is-com":!0,"is-event-selector":i.props.isEventSelector},null,8,["show","origin-data","id","type","is-event-selector"])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Tj))],64)):Object(n["createCommentVNode"])("",!0),12===e.data.type&&e.data.isShow?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:6},[e.data.content.paths.length?(Object(n["openBlock"])(),Object(n["createBlock"])(p,{key:0,show:i.props.isShow,"origin-data":e.data,"is-close":!1,id:e.data.id,type:e.data.type,"is-com":!0},null,8,["show","origin-data","id","type"])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",Pj))],64)):Object(n["createCommentVNode"])("",!0),e.data.hotspot?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",_j)):Object(n["createCommentVNode"])("",!0)],14,jj))),128)}const Mj=["innerHTML"];function Hj(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"btn__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.wrapStyle.height+"px",background:i.wrapStyle.bgColor,borderRadius:6===i.wrapStyle.type?"50%":i.wrapStyle.radius+"px",opacity:i.wrapStyle.opacity})},[Object(n["createElementVNode"])("span",{style:Object(n["normalizeStyle"])(i.titleStyle),innerHTML:i.title},null,12,Mj)],4)),[[n["vShow"],i.props.show]])}var zj={props:{originData:{type:Object},show:{type:Boolean,default:!1},isCom:{type:Boolean,default:!1}},setup(e){const{title:t}=Lj({props:e}),{wrapStyle:o}=Dj({props:e}),{titleStyle:n}=Bj({props:e});return{props:e,title:t,wrapStyle:o,titleStyle:n}}};function Lj({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>t.value?pn(t.value.title):"");return{title:o}}function Dj({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n,i;if(!t.value)return{};const s=Lf(t.value.showSize,e.isCom);let a="";return t.value.bgcolor&&(a=dn(t.value.bgcolor,t.value.bgalpha)),{width:s.w,height:s.h,scale:Math.min(s.w/200,1),bgColor:a,type:null===(o=e.originData)||void 0===o?void 0:o.type,radius:t.value.radius,opacity:null!==(n=null===(i=e.originData)||void 0===i?void 0:i.opacity)&&void 0!==n?n:1}});return{wrapStyle:o}}function Bj({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{if(!t.value)return{};const e=t.value.fontSize,o=t.value.rowSpace+e;let n="";t.value.fontColor&&(n=dn(t.value.fontColor,1));const i={font:{family:t.value.fontFamily,size:e,color:n,lineheight:o,wordspace:0,bolid:t.value.bolid,italic:t.value.italic,underline:t.value.underline,align:t.value.textAlignment},rect:t.value.showSize,effect:t.value.texteffect};return cn(i)});return{titleStyle:o}}o("45b5");const Nj=Tr()(zj,[["render",Hj],["__scopeId","data-v-6566c260"]]);var Vj=Nj,Rj={props:{componentsData:{type:Array,default(){return[]}},isShow:{type:Boolean,default:!1},scale:{type:Number,default:1},selectorType:{type:String,default:"selector"},isEventSelector:{type:Boolean,default:!1}},components:{LText:kI,LImg:XI,LImgs:pk,LVideo:Ok,LRing:ej,LBtn:Vj},setup(e){const{processData:t}=Fj(e),{reportComponentClick:o}=Yj(),{componentClickHandle:n}=Xj(e,{reportComponentClick:o}),s=Po(i["b"].state.proInfo.version,"5.9.0");return{props:e,processData:t,componentClickHandle:n,isOver590:s}}};function Fj(e){const t=Object(n["ref"])([]),o=()=>{e.componentsData.forEach(o=>{const n={css:Gj(o,e.scale),data:Wj(o)};t.value.push(n)})};return Object(n["onMounted"])(()=>{o()}),Object(n["onBeforeUnmount"])(()=>{t.value=[]}),Object(n["watch"])(()=>e.isShow,e=>{e?o():t.value=[]}),{processData:t}}function Gj(e,t){const o=e.size.x,n=e.size.y;return{left:e.position.x*t-o*(1-t)/2+"px",top:e.position.y*t-n*(1-t)/2+"px",width:o+"px",height:n+"px",transform:`scale(${t}) rotate(${e.rotateAngle||0}deg)`}}function Wj(e){const t={pid:e.pid,id:e.id,type:e.type,opacity:e.opacity,hotspot:e.hotspot,isShow:e.isShow,jumpSceneId:e.jumpSceneId,jumpSceneStartTime:e.jumpSceneStartTime,statisticsProperity:e.statisticsProperity};let o=null;const n={x:e.size.x,y:e.size.y};switch(e.type){case 0:case 1:case 2:case 3:o=$j(e);break;case 5:case 6:o={radius:e.radius,...$j(e)};break;case 12:o=Uj(e);break;default:break}return t.content={showSize:n,...e.content,...o},t}function $j(e){const t=e.content;return{bgalpha:t.bgcolor.w/255,bolid:t.bold}}function Uj(e){const t=e.content;return{paths:t.imagePaths||[],isAutoPlay:t.autoplay||!1,playSpeed:1e3/t.interval}}function Xj(e,{reportComponentClick:t}){const o=o=>{t({sid:o.pid,cdata:o,type:3}),(o.hotspot||o.jumpSceneId)&&(o.jumpSceneId?(Ns.emit(ja),Ns.emit(Fs,{sceneId:o.jumpSceneId,startTime:o.jumpSceneStartTime})):o.hotspot&&Ns.emit(ba,{pid:o.pid,...o.hotspot,isSelectorHot:"selector"===e.selectorType,isGlobalSelectorHot:"global_selector"===e.selectorType,isEventSelector:e.isEventSelector}))};return{componentClickHandle:o}}function Yj(){const e=({sid:e,cdata:t,type:o})=>{bc.emit("action",{key:"component",data:{pid:e,id:t.id,type:o,statisticsProperity:t.statisticsProperity}})};return{reportComponentClick:e}}o("872c");const Zj=Tr()(Rj,[["render",Aj],["__scopeId","data-v-7fc5a6fa"]]);var qj=Zj,Kj={components:{Popup:Pw,Loading:MI,SelectorCom:qj},setup(){const{wxShareData:e}=eC(),{playAudio:t,pauseAudio:o}=Qj(),{originalData:n,processData:i,isShowPopup:s,isShowClose:a,selectorId:r,closeAnyWhere:c,onHideHandle:l}=Jj({playAudio:t,pauseAudio:o}),{isLoading:d}=nC(s),{reportSelectorClick:u}=iC();return{wxShareData:e,originalData:n,isLoading:d,processData:i,closeAnyWhere:c,isShowPopup:s,isShowClose:a,selectorId:r,onHideHandle:l,reportSelectorClick:u}}};function Jj({playAudio:e,pauseAudio:t}){const o=Object(n["ref"])(null),s=Object(n["ref"])([]),a=Object(n["ref"])(!1),r=Object(n["ref"])(!1),c=Object(n["computed"])(()=>{var e;const t=null===(e=o.value)||void 0===e?void 0:e.closeAnyWhere;return void 0==t||t}),l=Object(n["computed"])(()=>{var e,t;return(null===(e=o.value)||void 0===e||null===(t=e.content)||void 0===t?void 0:t.nextSceneId)||0}),d=()=>{o.value&&h(o.value.id||0,!1),a.value=!1,u(),t(l.value),er("s"+l.value)},u=()=>{const e=s.value.find(e=>e.id===l.value),t=(null===e||void 0===e?void 0:e.components)||[];t.forEach(e=>{e.hotspot&&5===e.hotspot.type&&Ns.emit(Ta,e.hotspot.id)})};Ns.on(Oa,({data:e})=>{var t;(o.value=e,a.value=!0,o.value)&&(h(o.value.id||0,!0),r.value=null===(t=e.exclose)||void 0===t||t)}),Ns.on(ja,()=>{d()});const p=e=>{const t=s.value.some(t=>t.id===e.id);t||s.value.push(oC(e))};Object(n["watch"])(()=>a.value,t=>{if(t){const t=i["b"].state.skyBoxSceneGroup.sceneList.find(e=>e.id===l.value);p(t),e(t,r)}else o.value=null});const h=(e,t)=>{Ns.emit(ya,{status:t,id:e})};return{originalData:o,processData:s,isShowPopup:a,isShowClose:r,selectorId:l,closeAnyWhere:c,onHideHandle:d}}function Qj(){const e=Object(n["ref"])(null),t=(t,o)=>{t.bgAudio.fileUrl&&(e.value=document.createElement("audio"),e.value.src=t.bgAudio.fileUrl,e.value.volume=t.bgAudio.volume,t.bgAudio.loopTime<=0&&(e.value.loop=!0),e.value.onended=()=>{Qa("s"+t.id,"isEnded",!0)},e.value.play(),Ka({pid:t.id,id:"s"+t.id,type:"selector_bg_audio",instance:e.value,isPauseMedia:t.bgAudio.isPauseMedia,isEventSelector:!o.value}),Ja("s"+t.id,!1))},o=t=>{e.value&&(e.value.pause(),Ja("s"+t,!0))};return{playAudio:t,pauseAudio:o}}function eC(){const e=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{});return{wxShareData:e}}function tC(e){const t=.9*window.innerWidth,o=.9*window.innerHeight;let n=e.x,i=e.y;const s=Math.max(e.y/o,1),a=Math.max(e.x/t,1);let r=1;return(a>1||s>1)&&(a>=s?(n=t,i=t*e.y/e.x,r=t/e.x):(n=o*e.x/e.y,i=o,r=o/e.y)),{w:n,h:i,scale:r}}function oC(e){if(!e)return{};const t={x:e.skin.showSize.x,y:e.skin.showSize.y},o=tC(t);return{id:e.id,wrapWidth:o.w,wrapHeight:o.h,scale:o.scale,closeSize:36,bgColor:dn(e.skin.backColor,1),bgImage:e.skin.backImg,opacity:e.skin.opacity/100,components:e.components,statisticsProperity:e.statisticsProperity}}function nC(e){const t=Object(n["ref"])(!0);return Object(n["watch"])(()=>e.value,e=>{e&&(t.value=!1)}),{isLoading:t}}function iC(){const e=e=>{bc.emit("action",{key:"parentComponent",data:{id:e.id,statisticsProperity:e.statisticsProperity}})};return{reportSelectorClick:e}}o("527e");const sC=Tr()(Kj,[["render",Oj],["__scopeId","data-v-21372ed8"]]);var aC=sC;const rC={key:0,class:"selector__control"},cC=["onClick"],lC=["onClick"],dC=["onClick"],uC=["onClick"];function pC(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("flat-hotspot"),c=Object(n["resolveComponent"])("flat-selector");return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.hotspotList,e=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"item__hotspot-wrap",key:e.id,style:Object(n["normalizeStyle"])([e.hotspotstyle])},[Object(n["createVNode"])(r,{"origin-data":e.hotspotdata,"is-close":1===e.align,rendered:e.rendered,show:e.show},null,8,["origin-data","is-close","rendered","show"])],4))),128)),(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.selectorList,t=>{var o;return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:t.id,class:"item__selector-wrap",style:Object(n["normalizeStyle"])([t.selectorstyle])},[Object(n["createVNode"])(c,{style:Object(n["normalizeStyle"])({opacity:t.isexpand?(null===(o=t._selectorstyle)||void 0===o?void 0:o.opacity)||1:""}),"origin-data":t.selectordata,"is-show":t.isShow,scale:.5625},null,8,["style","origin-data","is-show"]),t.isexpand?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[(Object(n["openBlock"])(),Object(n["createBlock"])(n["Teleport"],{to:"body"},[Object(n["createElementVNode"])("div",{class:"global__mask",onClick:o=>e.onRevertHandle(t.id)},null,8,dC)])),Object(n["createElementVNode"])("div",{class:Object(n["normalizeClass"])(["icon__close",{normal:e.wxShareData.defClose}]),onClick:o=>e.onRevertHandle(t.id),style:Object(n["normalizeStyle"])({backgroundImage:"url("+e.wxShareData.iconClose+")",transform:"scale("+1/t._escale+")"})},null,14,uC)],64)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",rC,[Object(n["createElementVNode"])("div",{class:"btn__large",onClick:o=>e.onLargeHandle(t.id)},[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(e.$t("selectorTips.maximize")),1)],8,cC),Object(n["createElementVNode"])("div",{class:"btn__close",onClick:o=>e.onCloseHandle(t.id)},[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(e.$t("selectorTips.close")),1)],8,lC)]))],4)),[[n["vShow"],t.isShow]])}),128))],512)),[[n["vShow"],!e.pure]])}const hC={key:0,class:"flat-hotspot"};function fC(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("l-text"),c=Object(n["resolveComponent"])("l-img"),l=Object(n["resolveComponent"])("l-imgs"),d=Object(n["resolveComponent"])("l-video"),u=Object(n["resolveComponent"])("l-text-img"),p=Object(n["resolveComponent"])("l-ring"),h=Object(n["resolveComponent"])("LCutOutVideo"),f=Object(n["resolveComponent"])("l-webview");return i.props.rendered?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",hC,[2===i.hotspotType?(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:0,"origin-data":i.processData,show:2===i.hotspotType&&i.isShowHotspot,"is-close":i.props.isClose,onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0),[3,50].indexOf(i.hotspotType)>=0?(Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:1,"origin-data":i.processData,show:[3,50].indexOf(i.hotspotType)>=0&&i.isShowHotspot,"is-close":i.props.isClose,onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0),7===i.hotspotType?(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:2,"origin-data":i.processData,show:7===i.hotspotType&&i.isShowHotspot,"is-close":i.props.isClose,onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0),4===i.hotspotType?(Object(n["openBlock"])(),Object(n["createBlock"])(d,{key:3,"origin-data":i.processData,show:4===i.hotspotType&&i.isShowHotspot,"is-close":i.props.isClose,"media-type":"hotspot",onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0),8===i.hotspotType?(Object(n["openBlock"])(),Object(n["createBlock"])(u,{key:4,"origin-data":i.processData,show:8===i.hotspotType&&i.isShowHotspot,"is-close":i.props.isClose,onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0),20===i.hotspotType?(Object(n["openBlock"])(),Object(n["createBlock"])(p,{key:5,"origin-data":i.processData,show:20===i.hotspotType&&i.isShowHotspot,fullscreen:!1,"is-close":i.props.isClose,onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0),54===i.hotspotType?(Object(n["openBlock"])(),Object(n["createBlock"])(h,{key:6,"origin-data":i.processData,show:54===i.hotspotType&&i.isShowHotspot,"is-close":i.props.isClose,"media-type":"hotspot",onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0),10===i.hotspotType?(Object(n["openBlock"])(),Object(n["createBlock"])(f,{key:7,"origin-data":i.processData,show:10===i.hotspotType&&i.isShowHotspot,"is-close":i.props.isClose,onHide:i.onHideHandle},null,8,["origin-data","show","is-close","onHide"])):Object(n["createCommentVNode"])("",!0)],512)),[[n["vShow"],i.props.show]]):Object(n["createCommentVNode"])("",!0)}var mC={props:{originData:{type:Object},isClose:{type:Boolean,default:!0},rendered:{type:Boolean,default:!1},show:{type:Boolean,default:!1}},components:{LImg:XI,LImgs:pk,LVideo:Ok,LText:kI,LTextImg:Bk,LRing:ej,LCutOutVideo:yj,LWebview:Qk},setup(e){const{isShowHotspot:t,processData:o,hotspotType:i,mountedRender:s,destroyRender:a}=bC(e),{visible:r}=vC(e);Object(n["watch"])(()=>r.value,e=>{e?Object(n["nextTick"])(()=>{s()}):a()});const c=()=>{Ns.emit("show::flat-hotspot",{hotspotdata:e.originData,status:-1})};return{props:e,processData:o,hotspotType:i,isShowHotspot:t,onHideHandle:c}}};function vC(e){const t=Object(n["ref"])(!1);return Object(n["watch"])(()=>e.show,e=>{t.value=e}),Object(n["onMounted"])(()=>{e.show&&(t.value=!0)}),{visible:t}}function bC(e){const t=Object(n["ref"])(null),o=Object(n["ref"])(0),i=Object(n["ref"])(0),s=Object(n["ref"])(!1),a=()=>{const n=e.originData||{};n.type&&(o.value=n.id,i.value=n.type,t.value=n,s.value=!0)},r=()=>{s.value=!1};return{processData:t,hotspotId:o,hotspotType:i,isShowHotspot:s,mountedRender:a,destroyRender:r}}const gC=Tr()(mC,[["render",fC]]);var yC=gC;const wC={key:0,class:"flat-selector"};function xC(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("selector-com");return e.processData?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",wC,[Object(n["createElementVNode"])("div",{class:"selector__space",style:Object(n["normalizeStyle"])([e.processData.style])},null,4),Object(n["createVNode"])(r,{componentsData:e.processData.components,isShow:e.processData.components.length>0&&e.props.isShow,scale:e.processData.scalesize,selectorType:"global_selector"},null,8,["componentsData","isShow","scale"]),e.processData.isStandTableMode?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"selector__sand",style:Object(n["normalizeStyle"])([e.sandPos,{transform:e.sandhlookat}])},null,4)),[[n["vShow"],e.isShowStandTable]]):Object(n["createCommentVNode"])("",!0)])):Object(n["createCommentVNode"])("",!0)}var SC=Object(n["defineComponent"])({props:{originData:{type:Object},isShow:{type:Boolean},scale:{type:Number}},components:{SelectorCom:qj},setup(e){const{processData:t,isRenderComplete:o}=IC(e);kC(e,o);const{sandPos:n,sandhlookat:i,isShowStandTable:s}=OC({props:e,isRenderComplete:o},t);return{props:e,isRenderComplete:o,processData:t,sandPos:n,sandhlookat:i,isShowStandTable:s}}});function IC(e){const t=Object(n["ref"])(!1),o=Object(n["ref"])(null),s=e=>{const t=e.showSize.x,o=e.showSize.y,n=Po(i["b"].state.proInfo.version,"6.1.0");if(n)return{width:t,height:o,scale:1};const s=Math.floor(2*document.documentElement.clientWidth/3),a=Math.floor(2*document.documentElement.clientHeight/3);let r=0,c=0,l=1;return a>=s?t>=o?(r=Math.min(s,t),c=Math.floor(r*o/t),l=r/t):(c=Math.min(s,o),r=Math.floor(c*t/o),l=c/o):t>=o?(r=Math.min(a,t),c=Math.floor(r*o/t),l=r/t):(c=Math.min(a,o),r=Math.floor(c*t/o),l=c/o),{width:r,height:c,scale:l}},a=()=>{const{width:t,height:n,scale:i}=s(e.originData.skin);o.value={style:{width:t+"px",height:n+"px",backgroundColor:e.originData.skin.backImg?"transparent":dn(e.originData.skin.backColor,1),backgroundImage:e.originData.skin.backImg?"url("+e.originData.skin.backImg+")":"none",opacity:e.originData.skin.opacity/100},scalesize:i,isStandTableMode:e.originData.standTable,components:e.originData.components}},r=()=>{e.originData&&(a(),t.value=!0)};return Object(n["watch"])(()=>e.isShow&&!t.value,e=>{e&&r()}),Object(n["onMounted"])(()=>{r()}),{processData:o,isRenderComplete:t}}function kC(e,t){Object(n["watch"])(()=>e.isShow&&t.value,t=>{var o;const n=(null===(o=e.originData)||void 0===o?void 0:o.id)||0;n&&Ns.emit("toggle:selector",{sid:n,status:t})})}function OC({props:e,isRenderComplete:t},o){const s=Object(n["ref"])(0),a=Object(n["computed"])(()=>{const e=i["b"].state.sceneInfo.is2dRender,t=e?89.99:(i["b"].state.sceneInfo.sandTableDirectionAngle||0)+89.99+s.value;return"rotate("+t+"deg) translateZ(0)"}),r=Object(n["reactive"])({left:"0px",top:"0px",width:"0px",height:"0px"}),c=Object(n["ref"])(!1);let l=!1;const d=()=>{if(l)return;window.myKrp||(window.myKrp={});const e=()=>{c.value&&(s.value=i["b"].state.krp.get("view.hlookat"))};i["b"].state.krp.set("events[skin_events].onviewchanged",e),l=!0},u=()=>{e.originData&&e.originData.components.forEach(e=>{e.jumpSceneId===i["b"].state.sceneInfo.id&&(c.value=!1,r.left=e.position.x*o.value.scalesize+"px",r.top=e.position.y*o.value.scalesize+"px",r.width=e.size.x*o.value.scalesize+"px",r.height=e.size.y*o.value.scalesize+"px",s.value=i["b"].state.krp.get("view.hlookat"),c.value=!0)})},p=Object(n["computed"])(()=>e.isShow&&t.value&&i["b"].state.lifecycle.isLoadedScene&&i["b"].state.sceneInfo.id);return Object(n["watch"])(()=>p.value,e=>{e&&o.value.isStandTableMode?(d(),u()):c.value=!1}),{sandPos:r,sandhlookat:a,isShowStandTable:c}}o("dea8");const jC=Tr()(SC,[["render",xC],["__scopeId","data-v-4b33e6d4"]]);var CC=jC,EC=Object(n["defineComponent"])({components:{FlatHotspot:yC,FlatSelector:CC},setup(){const{pure:e}=Wy(),{hotspotList:t}=TC(),{selectorList:o,onLargeHandle:s,onCloseHandle:a,onRevertHandle:r}=PC(),c=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{});return{hotspotList:t,selectorList:o,onLargeHandle:s,onCloseHandle:a,onRevertHandle:r,wxShareData:c,pure:e}}});function TC(){const e=Object(n["ref"])([]),t=t=>e.value.find(e=>e.id===t),o=({hotspotdata:o,styledata:n,displayAlign:i})=>{const s=t(o.id);if(s&&s.rendered)s.show=!0,(n.drag.x||n.drag.y)&&(s.hotspotstyle=_C(n),s.hotspotdata=o);else{const t=_C(n);1===i&&(o.opacity=t.opacity,t.opacity=1),e.value.push({id:o.id,type:o.type,hotspotdata:o,hotspotstyle:t,align:i,rendered:!0,show:!0})}Ns.emit("toggle::icon-status",{id:o.id,status:!0}),[4,5,54].indexOf(o.type)>=0&&Ns.emit(ya,{id:o.id,status:!0})},i=e=>{const o=t(e);o&&o.show&&(o.show=!1,Ns.emit("toggle::icon-status",{id:e,status:!1}),[4,5,54].indexOf(o.type)>=0&&Ns.emit(ya,{id:e,status:!1}))},s=({hotspotdata:e,styledata:n,displayAlign:s})=>{const a=t(e.id);a&&a.show?i(e.id):o({hotspotdata:e,styledata:n,displayAlign:s})};return Ns.on("show::flat-hotspot",({hotspotdata:e,styledata:t,displayAlign:n,status:a})=>{1===a?o({hotspotdata:e,styledata:t,displayAlign:n}):-1===a?i(e.id):s({hotspotdata:e,styledata:t,displayAlign:n})}),Ns.on("hide::flat-hotspot",e=>{i(e)}),{hotspotList:e}}function PC(){const e=Object(n["ref"])([]),t=t=>e.value.find(e=>e.id===t),o={position:{x:.5,y:.5},offset:{x:0,y:0},rotation:0,scale:1,opacity:1,origin:"center center"},i=({selectordata:t,styledata:o})=>{0===o.offset.x&&(o.offset.x=-1*t.skin.showSize.x/2*o.scale),0===o.offset.y&&(o.offset.y=-1*t.skin.showSize.y/2*o.scale);const n=_C(o);e.value.push({id:t.id,selectordata:t,selectorstyle:n})},s=t=>{const o=e.value.find(e=>e.id===t);o&&(o.isShow=!0,o.selectordata.isDrawerSelector&&l(t))},a=t=>{const o=e.value.find(e=>e.id===t);o&&(o.isShow=!1,Ns.emit("hotspot-selector::hide",{hotspotId:t}),r(o.selectordata))},r=e=>{const t=(null===e||void 0===e?void 0:e.components)||[];t.forEach(e=>{e.hotspot&&5===e.hotspot.type&&Ns.emit(Ta,e.hotspot.id)})},c=t=>{const o=e.value.find(e=>e.id===t);o&&(o.isShow=!o.isShow)},l=t=>{const n=e.value.find(e=>e.id===t);if(n){n._selectorstyle=n.selectorstyle;const e=n.selectordata.skin.showSize,t=AC({x:e.x*o.scale,y:e.y*o.scale}),i={...o,zIndex:12};i.scale=t,n.selectorstyle=_C(i,!0),n._escale=t,n.isexpand=!0}},d=e=>{a(e)},u=t=>{const o=e.value.find(e=>e.id===t);if(o&&o.isexpand){if(o.selectordata.isDrawerSelector)return d(t),void(o.isexpand=!1);o.selectorstyle={...o._selectorstyle,zIndex:11},o._selectorstyle=null,o._escale=1,o.isexpand=!1}};return Ns.on("show::flat-selector",({selectordata:e,styledata:o,status:n})=>{const a=t(e.id);a||i({selectordata:e,styledata:o}),3===n?c(e.id):s(e.id)}),Ns.on("hide::flat-selector",({sid:e})=>{u(e)}),{selectorList:e,onLargeHandle:l,onCloseHandle:d,onRevertHandle:u}}function _C(e,t=!1){const o=()=>{let o="-50%",n="-50%";const i=e.offset.xf||"left",s=e.offset.yf||"top";return e.offset.x&&(o=e.offset.x+"px"),e.offset.y&&(n=e.offset.y+"px"),"-50%"!==o||t||(o=-50*e.scale+"%"),"-50%"!==n||t||(n=-50*e.scale+"%"),e.drag&&e.drag.x&&(o=`calc(${o} + ${e.drag.x}px)`),e.drag&&e.drag.y&&(n=`calc(${n} + ${e.drag.y}px)`),{[i]:100*e.position.x+"%",[s]:100*e.position.y+"%",opacity:e.opacity,transform:`rotate(${-1*e.rotation}deg) translate3d(${o}, ${n}, 0) scale(${e.scale})`,transformOrigin:e.origin||"center",zIndex:e.zIndex||11}};return o()}function AC(e){const t=.9*window.innerWidth,o=.9*window.innerHeight,n=Math.max(e.y/o,1),i=Math.max(e.x/t,1);let s=1;return(i>1||n>1)&&(s=i>=n?t/e.x:o/e.y),s}o("ccaa");const MC=Tr()(EC,[["render",pC],["__scopeId","data-v-319f67ca"]]);var HC=MC;function zC(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("parts"),c=Object(n["resolveComponent"])("global-selector");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[Object(n["createVNode"])(r,{pure:e.pure},null,8,["pure"]),Object(n["createVNode"])(c)],64)}const LC={key:0,class:"global__parts"};function DC(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("Text"),c=Object(n["resolveComponent"])("Number"),l=Object(n["resolveComponent"])("CutOutVideo"),d=Object(n["resolveComponent"])("Image"),u=Object(n["resolveComponent"])("webview");return e.globalParts.length?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",LC,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.globalParts,t=>Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"gl-part-item",key:t.id,style:Object(n["normalizeStyle"])([e.partWrapStyle(t.id)])},[2===t.type?(Object(n["openBlock"])(),Object(n["createBlock"])(r,{key:0,"origin-data":t,show:e.getShowStatus(t.id)},null,8,["origin-data","show"])):Object(n["createCommentVNode"])("",!0),53===t.type?(Object(n["openBlock"])(),Object(n["createBlock"])(c,{key:1,"origin-data":t,show:e.getShowStatus(t.id)},null,8,["origin-data","show"])):Object(n["createCommentVNode"])("",!0),51===t.type?(Object(n["openBlock"])(),Object(n["createBlock"])(l,{key:2,"origin-data":t,show:e.getShowStatus(t.id)},null,8,["origin-data","show"])):Object(n["createCommentVNode"])("",!0),3===t.type?(Object(n["openBlock"])(),Object(n["createBlock"])(d,{key:3,"origin-data":t,show:e.getShowStatus(t.id)},null,8,["origin-data","show"])):Object(n["createCommentVNode"])("",!0),56===t.type?(Object(n["openBlock"])(),Object(n["createBlock"])(u,{key:4,"origin-data":t,show:e.getShowStatus(t.id)},null,8,["origin-data","show"])):Object(n["createCommentVNode"])("",!0)],4)),[[n["vShow"],e.getShowStatus(t.id)]])),128))])):Object(n["createCommentVNode"])("",!0)}const BC={class:"flatComponent__text"};function NC(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("Text",!0);return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",BC,[Object(n["createVNode"])(r,{"origin-data":e.props.originData,show:e.props.show},null,8,["origin-data","show"])])}const VC=["effect"],RC=["innerHTML"];function FC(e,t,o,i,s,a){return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"textComponent__space",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:-2===i.titleEffect?i.wrapStyle.height+"px":"auto",overflow:i.titleEffect<=0?"hidden":"initial"})},[Object(n["createElementVNode"])("div",{class:"txt__inner",style:Object(n["normalizeStyle"])({width:i.wrapStyle.width+"px",height:i.titleEffect>0?i.wrapStyle.height+"px":"auto",backgroundColor:i.wrapStyle.bgColor,opacity:i.wrapStyle.opacity,textAlign:i.wrapStyle.align}),effect:i.titleEffect},[Object(n["createElementVNode"])("p",{style:Object(n["normalizeStyle"])(i.titleStyle),innerHTML:i.title,ref:"myText"},null,12,RC)],12,VC)],4)),[[n["vShow"],i.props.show]])}function GC(e,t=!1){const o=.9*window.innerWidth,n=.9*window.innerHeight;let i=e.x,s=e.y;const a=Math.max(e.y/n,1),r=Math.max(e.x/o,1);return t||(r>1||a>1)&&(r>=a?(i=o,s=o*e.y/e.x):(i=n*e.x/e.y,s=n)),{w:i,h:s}}var WC={props:{originData:{type:Object},id:{type:Number},show:{type:Boolean,default:!1},isCom:{type:Boolean,default:!1}},setup(e,{emit:t}){const o=Object(n["ref"])(Object(n["getCurrentInstance"])()),{isShowed:i}=$C({props:e},{emit:t}),{wrapStyle:s}=UC({props:e}),{titleStyle:a,title:r}=XC({props:e}),{titleEffect:c}=YC({props:e});return ZC({props:e,curInstance:o,titleEffect:c,wrapStyle:s,isShowed:i}),{props:e,title:r,wrapStyle:s,titleStyle:a,titleEffect:c}}};function $C({props:e},{emit:t}){const o=Object(n["ref"])(!1),i=Object(n["ref"])(!1);Object(n["onMounted"])(()=>{o.value=!0,e.show&&(i.value=!0)}),Object(n["onBeforeUnmount"])(()=>{o.value=!1,i.value=!1,s.value=!1}),Object(n["watch"])(()=>e.show,e=>{i.value=e,e?a(!0):s.value=!1});const s=Object(n["ref"])(!1),a=e=>{e&&!s.value&&t("show"),s.value=e};return{isRendered:o,isShowed:i,updateContentShowStatus:a}}function UC({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{var o,n,i;if(!t.value)return{};const s=GC(t.value.showSize,e.isCom);let a="";return t.value.bgcolor&&(a=dn(t.value.bgcolor,t.value.bgalpha)),{width:s.w,height:s.h,scale:Math.min(s.w/200,1),bgColor:a,opacity:null!==(o=null===(n=e.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1,align:null===(i=e.originData)||void 0===i?void 0:i.content.textAlignment}});return{wrapStyle:o}}function XC({props:e}){const t=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),o=Object(n["computed"])(()=>{if(!t.value)return"";let e=xn(t.value.title);return 1===t.value.texteffect&&(e=e.replace(/<br>/g,"&nbsp;")),e}),i=Object(n["computed"])(()=>{if(!t.value)return{};const o=t.value.fontSize;let n=t.value.wordSpace/o*18;e.isCom&&(n=t.value.wordSpace/o*4.5);const i=t.value.rowSpace+1.125*o;let s="";t.value.fontColor&&(s=dn(t.value.fontColor,1));const a={font:{family:t.value.fontFamily,size:o,color:s,lineheight:i,wordspace:n,bolid:t.value.bolid,italic:t.value.italic,underline:t.value.underline,align:t.value.textAlignment},rect:t.value.showSize,effect:t.value.texteffect};return cn(a)});return{titleStyle:i,title:o}}function YC({props:e}){const t=Object(n["computed"])(()=>{var t;const o=(null===(t=e.originData)||void 0===t?void 0:t.content)||{};return o.texteffect||-1});return{titleEffect:t}}function ZC({props:e,curInstance:t,titleEffect:o,wrapStyle:i,isShowed:s}){let a=null,r=null,c=null;const l=()=>{if(1===o.value){const{start:e,reset:t}=hd({txtDom:c,width:i.value.width});a=e,r=t}else if(2===o.value){const t=e.originData.content.rowSpace||0,{start:o,reset:n}=fd({txtDom:c,height:i.value.height,lineHeight:t});a=o,r=n}a&&a()},d=()=>{c&&(r&&r(),c=null,a=null)};Object(n["watch"])(()=>s.value,e=>{e&&o.value?Object(n["nextTick"])(()=>{const{myText:e}=t.value.refs;c=e,c&&l()}):d()})}o("f8d7");const qC=Tr()(WC,[["render",FC],["__scopeId","data-v-20ba114a"]]);var KC=qC,JC=Object(n["defineComponent"])({props:{show:{type:Boolean,default:!1},originData:{type:Object,require:!0}},components:{Text:KC},setup(e){return{props:e}}});const QC=Tr()(JC,[["render",NC]]);var eE=QC;const tE={class:"flatComponent__number"},oE=["src"];function nE(e,t,o,i,s,a){return Object(n["openBlock"])(),Object(n["createElementBlock"])("div",tE,[Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"number__space",style:Object(n["normalizeStyle"])(i.wrapStyle)},[Object(n["createElementVNode"])("div",{class:"bg-inner",ref:"bgInner",style:Object(n["normalizeStyle"])(i.bgStyle)},[!i.isFramesImg&&i.content.imagePath?(Object(n["openBlock"])(),Object(n["createElementBlock"])("img",{key:0,class:"bg_img is--inner",src:i.content.imagePath},null,8,oE)):Object(n["createCommentVNode"])("",!0)],4),Object(n["createElementVNode"])("div",{class:"number_inner",style:Object(n["normalizeStyle"])(i.contentStyle)},Object(n["toDisplayString"])(i.numberValue),5)],4),[[n["vShow"],i.props.show]])])}var iE={components:{},props:{show:{type:Boolean,default:!1},originData:{type:Object,require:!0}},setup(e){const t=Object(n["ref"])(Object(n["getCurrentInstance"])()),{numberValue:o,content:i,wrapStyle:s,bgStyle:a,contentStyle:r}=sE(e),{isFramesImg:c}=aE({props:e,curInstance:t});return{props:e,numberValue:o,content:i,wrapStyle:s,bgStyle:a,contentStyle:r,isFramesImg:c}}};function sE(e){const t=Object(n["ref"])(0),o=(o,n)=>{if(e.originData.id===o){const e=n>=0?Iu(n):null;let o=(null===e||void 0===e?void 0:e.value)||0;"boolean"===typeof o&&(o=Number(o)),t.value=Number(o.toFixed(2))}};Ns.on(Ga,({id:e,vid:t})=>{o(e,t)});const i=Object(n["computed"])(()=>{var t;return null===(t=e.originData)||void 0===t?void 0:t.content}),s=Object(n["computed"])(()=>({width:i.value.showSize.x+"px",height:i.value.showSize.y+"px"})),a=Object(n["computed"])(()=>({backgroundColor:i.value.imagePath?"transparent":dn(i.value.backgroundColor,i.value.backgroundAlpha)})),r=Object(n["computed"])(()=>{const e=i.value.showSize.x,t=i.value.showSize.y,o=Math.min(Math.ceil(e/10),t/1.2);return{fontSize:o+"px",color:dn(i.value.fontColor,1),fontFamily:i.value.fontFamily}});return{numberValue:t,content:i,wrapStyle:s,bgStyle:a,contentStyle:r}}function aE({props:e,curInstance:t}){const o=Object(n["ref"])(!1);let i=!1,s=null;const a=()=>{const n=e.originData.content.gifInfo;o.value=!(!n||!n.imgPath),o.value&&(s||(s=new zI(n,{rect:{x:e.originData.content.showSize.x,y:e.originData.content.showSize.y},loopTime:e.originData.content.loopTime,autoplay:!0})),i?(s.reset(),s.play()):s.load(e=>{const{bgInner:n}=t.value.refs;n&&o.value&&(e.className="is--inner",n.appendChild(e),i=!0)}))},r=()=>{const{bgInner:e}=t.value.refs;if(e){const t=e.querySelector("canvas");t&&e.removeChild(t)}s&&s.destroy(),s=null,o.value=!1,i=!1};return Object(n["watch"])(()=>e.show,e=>{e?a():r()}),Object(n["onBeforeUnmount"])(()=>{r()}),{isFramesImg:o,destroyCanvas:r}}o("025f");const rE=Tr()(iE,[["render",nE],["__scopeId","data-v-070208ea"]]);var cE=rE;const lE={class:"cutVideoComponent__space"};var dE=Object(n["defineComponent"])({__name:"CutVideo",props:{originData:{type:Object},show:{type:Boolean,default:!1},wrap:{type:Object}},setup(e){const t=e,o=Object(n["ref"])(null),i=Object(n["reactive"])({paused:!0});function s(){var e,n,s,r;let c=!1;const l=document.createElement("video");l.setAttribute("playsinline","true"),l.setAttribute("webkit-playsinline","true"),l.setAttribute("x5-video-player-type","h5"),l.autoplay=null===(e=t.originData)||void 0===e?void 0:e.content.autoplay,l.src=(null===(n=t.originData)||void 0===n?void 0:n.content.videoPath)||"",l.poster=(null===(s=t.originData)||void 0===s?void 0:s.content.videoPoster)||"",l.volume=null===(r=t.originData)||void 0===r?void 0:r.content.volume,l.onplay=()=>{i.paused=!1,v()},l.onpause=()=>{i.paused=!0,b()},l.ontimeupdate=()=>{var e,o;!c&&null!==(e=t.originData)&&void 0!==e&&e.content.startTime&&(l.currentTime=null===(o=t.originData)||void 0===o?void 0:o.content.startTime,c=!0)},l.onended=()=>{var e;c=!1,null!==(e=t.originData)&&void 0!==e&&e.content.replay&&a()},o.value=l}const a=()=>{o.value&&o.value.play()},r=()=>{o.value&&o.value.pause()},c=Object(n["ref"])();function l(){var e,o;const n=(null===(e=t.wrap)||void 0===e?void 0:e.width)||0,i=(null===(o=t.wrap)||void 0===o?void 0:o.height)||0;c.value.style.width=n+"px",c.value.style.height=i+"px",c.value.width=n*window.devicePixelRatio,c.value.height=i*window.devicePixelRatio}let d=null,u=null;function p(){var e;const o=c.value.getContext("webgl");if(!o)return;d=o;const n="\n  attribute vec2 a_position;\n  attribute vec2 a_texcoord;\n  uniform mat3 u_matrix;\n  varying vec2 v_texcoord;\n  void main () {\n    gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\n    v_texcoord = a_texcoord;\n  }\n",i="\n  precision mediump float;\n  varying vec2 v_texcoord;\n  uniform sampler2D u_texture;\n  uniform vec4 CullColor;\n  uniform float ThresholdSensitivity;\n  uniform float Smoothing;\n\n  const float u_clipBlack = 0.0;\n  const float u_clipWhite = 1.0;\n\n  float rgb2cb(float r, float g, float b){ return 0.5 + -0.168736*r - 0.331264*g + 0.5*b; }\n  float rgb2cr(float r, float g, float b){ return 0.5 + 0.5*r - 0.418688*g - 0.081312*b; }\n  float smoothclip(float low, float high, float x){ if (x <= low){ return 0.0; } if(x >= high){ return 1.0; } return (x-low)/(high-low); }\n\n  vec4 getGreenScene(vec4 colora, float Cb_key,float Cr_key, float tola,float tolb, float clipBlack, float clipWhite)\n  {\n    float cb = rgb2cb(colora.r,colora.g,colora.b);\n    float cr = rgb2cr(colora.r,colora.g,colora.b);\n    float alpha = distance(vec2(cb, cr), vec2(Cb_key, Cr_key));\n    alpha = smoothclip(tola,tolb,alpha);\n    float r = max(colora.r - (1.0-alpha)*CullColor.r, 0.0);\n    float g = max(colora.g - (1.0-alpha)*CullColor.g, 0.0);\n    float b = max(colora.b - (1.0-alpha)*CullColor.b, 0.0);\n    if(alpha < clipBlack){ alpha = r = g = b = 0.0; }\n    if(alpha > clipWhite){ alpha = 1.0; }\n    if(clipWhite < 1.0){ alpha = alpha/max(clipWhite, 0.9); }\n    return vec4(r,g,b, alpha);\n  }\n\n  void main () {\n    gl_FragColor = vec4(texture2D(u_texture, v_texcoord).rgb, 1);\n    float tola = 0.0;\n    if (ThresholdSensitivity == 0.05) {\n      tola = ThresholdSensitivity * 0.8;\n    } else if (ThresholdSensitivity == 0.1) {\n      tola = ThresholdSensitivity * 0.486;\n    } else if (ThresholdSensitivity <= 0.2 && ThresholdSensitivity > 0.1) {\n      tola = ThresholdSensitivity * 0.365;\n    } else if (ThresholdSensitivity > 0.2) {\n      tola = ThresholdSensitivity * 0.303;\n    }\n    float tolb = Smoothing;\n    float cb_key = rgb2cb(CullColor.r, CullColor.g, CullColor.b);\n    float cr_key = rgb2cr(CullColor.r, CullColor.g, CullColor.b);\n    gl_FragColor = getGreenScene(gl_FragColor, cb_key, cr_key, tola, tolb, u_clipBlack, u_clipWhite);\n  }\n\n";function s(e){e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,c.value.width,0,0,c.value.height,0,c.value.height,c.value.width,0,c.value.width,c.value.height]),e.STATIC_DRAW)}function a(e){e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW)}function r(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST)}const l=rj(o,o.VERTEX_SHADER,n),p=rj(o,o.FRAGMENT_SHADER,i),h=cj(o,l,p),f=o.getAttribLocation(h,"a_position"),m=o.getAttribLocation(h,"a_texcoord"),v=o.getUniformLocation(h,"u_matrix"),b=o.getUniformLocation(h,"u_texture"),g=o.getUniformLocation(h,"CullColor"),y=o.getUniformLocation(h,"ThresholdSensitivity"),w=o.getUniformLocation(h,"Smoothing"),x=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,x),s(o);const S=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,S),a(o),r(o),o.enable(o.BLEND),o.blendFunc(o.SRC_ALPHA,o.ONE_MINUS_SRC_ALPHA);const I=null===(e=t.originData)||void 0===e?void 0:e.content.alphaColor,k=[I.x/255,I.y/255,I.z/255,I.w/255],O=()=>{var e;o.viewport(0,0,o.canvas.width,o.canvas.height),o.clear(o.COLOR_BUFFER_BIT),o.useProgram(h),o.enableVertexAttribArray(f),o.bindBuffer(o.ARRAY_BUFFER,x),o.vertexAttribPointer(f,2,o.FLOAT,!1,0,0),o.enableVertexAttribArray(m),o.bindBuffer(o.ARRAY_BUFFER,S),o.vertexAttribPointer(m,2,o.FLOAT,!1,0,0),o.uniform4fv(g,k),o.uniform1f(y,null===(e=t.originData)||void 0===e?void 0:e.content.threshold),o.uniform1f(w,0);const n=(new lj).set(2/o.canvas.width,0,0,0,-2/o.canvas.height,0,-1,1,1),i=new lj;i.multiply(n),o.uniformMatrix3fv(v,!1,i.elements),o.uniform1i(b,0),o.drawArrays(o.TRIANGLES,0,6)};u=(e,t)=>{e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),O()}}const h=Object(n["ref"])(!1);function f(){var e;const o=new Image;h.value=!1,o.onload=()=>{d&&(u&&u(d,o),h.value=!0)},o.src=(null===(e=t.originData)||void 0===e?void 0:e.content.videoPoster)||""}let m=0;const v=()=>{var e;o.value&&(null===(e=o.value)||void 0===e?void 0:e.currentTime)>0&&u&&u(d,o.value),m=requestAnimationFrame(v)},b=()=>{cancelAnimationFrame(m)};return Object(n["watch"])(()=>t.show,e=>{e&&(l(),p(),f(),s())}),(e,o)=>{var s;return Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",lE,[Object(n["createElementVNode"])("canvas",{ref_key:"myCanvas",ref:c,onClick:r},null,512),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",{class:"btn__toggle",style:Object(n["normalizeStyle"])({transform:`scale(${null===(s=t.wrap)||void 0===s?void 0:s.scale})`}),onClick:a},null,4),[[n["vShow"],h.value&&i.paused]])],512)),[[n["vShow"],t.show]])}}});o("20a4");const uE=Tr()(dE,[["__scopeId","data-v-5910e7e8"]]);var pE=uE,hE=Object(n["defineComponent"])({__name:"CutOutVideo",props:{show:{type:Boolean,default:!1},originData:{type:Object,require:!0}},setup(e){const t=e;function o(){const e=Object(n["computed"])(()=>{var e;return(null===(e=t.originData)||void 0===e?void 0:e.content)||{}}),o=Object(n["computed"])(()=>{var o,n;if(!e.value)return{};const i=GC(e.value.showSize);return{width:i.w%2===0?i.w:i.w-1,height:i.h%2===0?i.h:i.h-1,scale:Math.min(i.w/200,1),opacity:null!==(o=null===(n=t.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}}),i=Object(n["computed"])(()=>({width:o.value.width+"px",height:o.value.height+"px",transform:`scale(${o.value.scale})`,opacity:o.value.opacity}));return{wrapJson:o,wrapStyle:i}}const{wrapStyle:i,wrapJson:s}=o();return(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"flatComponent__cutVideo",style:Object(n["normalizeStyle"])(Object(n["unref"])(i))},[Object(n["createVNode"])(pE,{"origin-data":t.originData,wrap:Object(n["unref"])(s),show:t.show},null,8,["origin-data","wrap","show"])],4))}});const fE=hE;var mE=fE;function vE(e){let t="-50%",o="-50%";e.offset.x&&(t=e.offset.x+"px"),e.offset.y&&(o=e.offset.y+"px");const n=((e.position.x+1)/2*100).toFixed(2),i=((e.position.y+1)/2*100).toFixed(2);return{position:"absolute",left:n+"%",top:i+"%",opacity:e.opacity,transform:`translate3d(${t}, ${o}, 0) rotate(${e.rotate.rz}deg) scale(${e.scale})`,transformOrigin:e.origin||"center",zIndex:e.zIndex||11}}function bE(e,t){let o=0,n=0,i=0,s=Date.now();const a=()=>{o=window.requestAnimationFrame(a),n=Date.now(),i=n-s,i>t&&(s=n-i%t,e&&e())},r=()=>{a()},c=()=>{cancelAnimationFrame(o)};return{start:r,stop:c}}const gE={class:"imageComponent__space"};var yE=Object(n["defineComponent"])({__name:"Image",props:{originData:{type:Object},show:{type:Boolean,default:!1},wrap:{type:Object}},setup(e){const t=e,o=Object(n["computed"])(()=>{var e;return(null===(e=t.originData)||void 0===e?void 0:e.content)||{}}),i=Object(n["ref"])();function s(){var e,o;const n=(null===(e=t.wrap)||void 0===e?void 0:e.width)||0,s=(null===(o=t.wrap)||void 0===o?void 0:o.height)||0;i.value.style.width=n+"px",i.value.style.height=s+"px",i.value.width=n*window.devicePixelRatio,i.value.height=s*window.devicePixelRatio}let a=null,r=null;function c(){i.value&&(a=i.value.getContext("2d"))}function l(){var e;null!==(e=o.value.gifInfo)&&void 0!==e&&e.imgPath?d():u()}function d(){const e=o.value.gifInfo||{};if(e.imgPath){const t=new Image;t.onload=()=>{const n=e.imgHeight/e.gifHeight,s=e.imgWidth/e.gifWidth,a=Math.max(e.delayTime,40),c=e.frameNum;let l=0,d=0;const u=1===o.value.imageType?2:1,h=()=>{const a=Math.floor(d/n),r=d%s;p(t,r*e.gifWidth,a*e.gifHeight,e.gifWidth/u,e.gifHeight,i.value.width,i.value.height);const h=d===c-1;h?(l++,o.value.loopTime>0&&l>=o.value.loopTime?f.stop():d=0):d++},f=bE(h,a);f.start(),r=f.stop},t.src=e.imgPath}}function u(){const e=o.value.imagePath||"";if(e){const t=new Image;t.onload=()=>{const e=1===o.value.imageType?2:1;p(t,0,0,t.naturalWidth/e,t.naturalHeight,i.value.width,i.value.height)},t.src=e}}function p(e,t,o,n,s,r,c){a&&(a.clearRect(0,0,i.value.width,i.value.height),a.drawImage(e,t,o,n,s,0,0,r,c))}function h(){r&&r(),a&&i.value&&a.clearRect(0,0,i.value.width,i.value.height)}return Object(n["watch"])(()=>t.show,e=>{e?(s(),c(),l()):h()}),(e,o)=>Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",gE,[Object(n["createElementVNode"])("canvas",{ref_key:"myCanvas",ref:i},null,512)],512)),[[n["vShow"],t.show]])}});o("68c2");const wE=Tr()(yE,[["__scopeId","data-v-9e655ea0"]]);var xE=wE,SE=Object(n["defineComponent"])({__name:"Image",props:{show:{type:Boolean,default:!1},originData:{type:Object,require:!0}},setup(e){const t=e;function o(){const e=Object(n["computed"])(()=>{var e;return(null===(e=t.originData)||void 0===e?void 0:e.content)||{}}),o=Object(n["computed"])(()=>{var o,n;if(!e.value)return{};const i=GC(e.value.showSize);return{width:i.w,height:i.h,scale:Math.min(i.w/200,1),opacity:null!==(o=null===(n=t.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}}),i=Object(n["computed"])(()=>({width:o.value.width+"px",height:o.value.height+"px",transform:`scale(${o.value.scale})`,opacity:o.value.opacity}));return{wrapJson:o,wrapStyle:i}}const{wrapStyle:i,wrapJson:s}=o();return(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"flatComponent__image",style:Object(n["normalizeStyle"])(Object(n["unref"])(i))},[Object(n["createVNode"])(xE,{"origin-data":t.originData,wrap:Object(n["unref"])(s),show:t.show},null,8,["origin-data","wrap","show"])],4))}});const IE=SE;var kE=IE;const OE=e=>(Object(n["pushScopeId"])("data-v-34091977"),e=e(),Object(n["popScopeId"])(),e),jE={class:"webview__space"},CE=["src"],EE={key:1,class:"error__tips"},TE=OE(()=>Object(n["createElementVNode"])("span",{class:"tip__icon"},null,-1)),PE={class:"tip__text"};var _E=Object(n["defineComponent"])({__name:"Webview",props:{originData:{type:Object},show:{type:Boolean,default:!1},wrap:{type:Object}},setup(e){const t=e,o=Object(n["computed"])(()=>{var e;return(null===t||void 0===t||null===(e=t.originData)||void 0===e?void 0:e.content)||{}}),i=Object(n["computed"])(()=>{let e=!0;return/https/.test(location.protocol)&&(e=new RegExp(location.protocol,"g").test(o.value.path)),e});return(e,s)=>Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",jE,[Object(n["createElementVNode"])("div",{class:"webview__inner",style:Object(n["normalizeStyle"])({opacity:t.wrap.opacity})},[i.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])("iframe",{key:0,src:o.value.path,frameborder:"0",allow:"microphone *; camera *; autoplay; fullscreen"},null,8,CE)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",EE,[TE,Object(n["createElementVNode"])("span",PE,Object(n["toDisplayString"])(e.$t("public.protocol")),1)]))],4)],512)),[[n["vShow"],t.show]])}});o("c6b5");const AE=Tr()(_E,[["__scopeId","data-v-34091977"]]);var ME=AE,HE=Object(n["defineComponent"])({__name:"Webview",props:{show:{type:Boolean,default:!1},originData:{type:Object,require:!0}},setup(e){const t=e;function o(){const e=Object(n["computed"])(()=>{var e;return(null===(e=t.originData)||void 0===e?void 0:e.content)||{}}),o=Object(n["computed"])(()=>{var o,n;if(!e.value)return{};const i=GC(e.value.showSize);return{width:i.w,height:i.h,scale:Math.min(i.w/200,1),opacity:null!==(o=null===(n=t.originData)||void 0===n?void 0:n.opacity)&&void 0!==o?o:1}}),i=Object(n["computed"])(()=>({width:o.value.width+"px",height:o.value.height+"px",transform:`scale(${o.value.scale})`,opacity:o.value.opacity}));return{wrapJson:o,wrapStyle:i}}const{wrapStyle:i,wrapJson:s}=o();return(e,o)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"flatComponent__image",style:Object(n["normalizeStyle"])(Object(n["unref"])(i))},[Object(n["createVNode"])(ME,{"origin-data":t.originData,wrap:Object(n["unref"])(s),show:t.show},null,8,["origin-data","wrap","show"])],4))}});const zE=HE;var LE=zE,DE=Object(n["defineComponent"])({components:{Webview:LE,Number:cE,Text:eE,CutOutVideo:mE,Image:kE},props:{pure:{type:Boolean,default:!1}},setup(e){const t=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.globalParts||[]),o=Object(n["computed"])(()=>e.pure),{getShowStatus:s,setShowStatus:a}=BE({globalParts:t,isPureMode:o}),r=e=>{const t=c(e);return t?vE({position:t.position,offset:{x:0,y:0},rotate:t.rotate,scale:t.scale}):""},c=e=>t.value.find(t=>t.id===e),l=e=>{const t=c(e);t&&a(e,!0)},d=e=>{const t=c(e);t&&a(e,!1)},u=e=>{s(e)?d(e):l(e)},p=(e,t)=>{switch(t){case 1:l(e);break;case 2:d(e);break;case 3:default:u(e);break}};return Ns.on(Fa,({partId:e,parentId:t,pointIndex:o,status:n})=>{e<=0||(0===o?p(e,n):3===o&&-1!==n&&Ns.emit(Ga,{id:e,vid:t}))}),{globalParts:t,getShowStatus:s,partWrapStyle:r}}});function BE({globalParts:e,isPureMode:t}){const o=Object(n["ref"])(new Map),i=()=>{e.value.forEach(e=>{o.value.set(e.id,e.isShow)})},s=()=>{o.value.clear()},a=e=>o.value.get(e),r=(e,t)=>{o.value.set(e,t)};return Object(n["watch"])(()=>e.value.length&&!t.value,e=>{e?i():s()}),{getShowStatus:a,setShowStatus:r}}const NE=Tr()(DE,[["render",DC]]);var VE=NE;const RE={key:0,class:"globalSelector__inner is--inner"};function FE(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("basic-selector"),c=Object(n["resolveComponent"])("popup");return Object(n["openBlock"])(),Object(n["createBlock"])(c,{value:e.isShowPopup,onClose:e.onHideHandle},{content:Object(n["withCtx"])(()=>[e.activeSelectorData?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",RE,[Object(n["createVNode"])(r,{"origin-data":e.activeSelectorData,"is-show":e.isShowPopup,scale:.5625},null,8,["origin-data","is-show"]),Object(n["createElementVNode"])("div",{class:"icon__close",onClick:t[0]||(t[0]=(...t)=>e.onHideHandle&&e.onHideHandle(...t)),style:Object(n["normalizeStyle"])({backgroundImage:"url("+e.wxShareData.iconClose+")",transform:"scale(1)"})},null,4)])):Object(n["createCommentVNode"])("",!0)]),_:1},8,["value","onClose"])}const GE={key:0,class:"flat-selector"};function WE(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("selector-com");return e.processData?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",GE,[Object(n["createElementVNode"])("div",{class:"selector__space",style:Object(n["normalizeStyle"])([e.processData.style])},null,4),Object(n["createVNode"])(r,{componentsData:e.processData.components,isShow:e.processData.components.length>0&&e.props.isShow,scale:e.processData.scalesize,selectorType:"global_selector"},null,8,["componentsData","isShow","scale"]),e.processData.isStandTableMode?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:0,class:"selector__sand",style:Object(n["normalizeStyle"])([e.sandPos,{transform:e.sandhlookat}])},null,4)),[[n["vShow"],e.isShowStandTable]]):Object(n["createCommentVNode"])("",!0)])):Object(n["createCommentVNode"])("",!0)}var $E=Object(n["defineComponent"])({props:{originData:{type:Object},isShow:{type:Boolean},scale:{type:Number}},components:{SelectorCom:qj},setup(e){const{processData:t,isRenderComplete:o}=UE(e);XE(e,o);const{sandPos:n,sandhlookat:i,isShowStandTable:s}=YE({props:e,isRenderComplete:o},t);return{props:e,isRenderComplete:o,processData:t,sandPos:n,sandhlookat:i,isShowStandTable:s}}});function UE(e){const t=Object(n["ref"])(!1),o=Object(n["ref"])(null),s=e=>{const t=e.showSize.x,o=e.showSize.y,n=Po(i["b"].state.proInfo.version,"6.1.0");if(n)return{width:t,height:o,scale:1};const s=Math.floor(2*document.documentElement.clientWidth/3),a=Math.floor(2*document.documentElement.clientHeight/3);let r=0,c=0,l=1;return a>=s?t>=o?(r=Math.min(s,t),c=Math.floor(r*o/t),l=r/t):(c=Math.min(s,o),r=Math.floor(c*t/o),l=c/o):t>=o?(r=Math.min(a,t),c=Math.floor(r*o/t),l=r/t):(c=Math.min(a,o),r=Math.floor(c*t/o),l=c/o),{width:r,height:c,scale:l}},a=()=>{const{width:t,height:n,scale:i}=s(e.originData.skin);o.value={style:{width:t+"px",height:n+"px",backgroundColor:e.originData.skin.backImg?"transparent":dn(e.originData.skin.backColor,1),backgroundImage:e.originData.skin.backImg?"url("+e.originData.skin.backImg+")":"none",opacity:e.originData.skin.opacity/100},scalesize:i,isStandTableMode:e.originData.standTable,components:e.originData.components}},r=()=>{e.originData&&(a(),t.value=!0)},c=()=>{var e;const t=(null===(e=o.value)||void 0===e?void 0:e.components)||[];t.forEach(e=>{e.hotspot&&5===e.hotspot.type&&Ns.emit(Ta,e.hotspot.id)})};return Object(n["watch"])(()=>e.isShow&&!t.value,e=>{e&&r()}),Object(n["watch"])(()=>e.isShow,e=>{e||c()}),Object(n["onMounted"])(()=>{r()}),{processData:o,isRenderComplete:t}}function XE(e,t){Object(n["watch"])(()=>e.isShow&&t.value,t=>{var o;const n=(null===(o=e.originData)||void 0===o?void 0:o.id)||0;n&&Ns.emit("toggle:selector",{sid:n,status:t})})}function YE({props:e,isRenderComplete:t},o){const s=Object(n["ref"])(0),a=Object(n["computed"])(()=>{const e=i["b"].state.sceneInfo.is2dRender,t=e?89.99:(i["b"].state.sceneInfo.sandTableDirectionAngle||0)+89.99+s.value;return"rotate("+t+"deg) translateZ(0)"}),r=Object(n["reactive"])({left:"0px",top:"0px",width:"0px",height:"0px"}),c=Object(n["ref"])(!1);let l=!1;const d=()=>{if(l)return;window.myKrp||(window.myKrp={});const e=()=>{c.value&&(s.value=i["b"].state.krp.get("view.hlookat"))};i["b"].state.krp.set("events[skin_events].onviewchanged",e),l=!0},u=()=>{e.originData&&e.originData.components.forEach(e=>{e.jumpSceneId===i["b"].state.sceneInfo.id&&(c.value=!1,r.left=e.position.x*o.value.scalesize+"px",r.top=e.position.y*o.value.scalesize+"px",r.width=e.size.x*o.value.scalesize+"px",r.height=e.size.y*o.value.scalesize+"px",s.value=i["b"].state.krp.get("view.hlookat"),c.value=!0)})},p=Object(n["computed"])(()=>e.isShow&&t.value&&i["b"].state.lifecycle.isLoadedScene&&i["b"].state.sceneInfo.id);return Object(n["watch"])(()=>p.value,e=>{e&&o.value.isStandTableMode?(d(),u()):c.value=!1}),{sandPos:r,sandhlookat:a,isShowStandTable:c}}o("2971");const ZE=Tr()($E,[["render",WE],["__scopeId","data-v-5f34df27"]]);var qE=ZE,KE=Object(n["defineComponent"])({components:{Popup:Pw,BasicSelector:qE},setup(){const e=Object(n["ref"])(!1),t=()=>{e.value=!0},o=()=>{e.value=!1,requestAnimationFrame(r)},s=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.weChatShare||{}),a=Object(n["ref"])(null),r=()=>{a.value=null};return Ns.on("watch-selector-show",e=>{a.value=e,t()}),{isShowPopup:e,onHideHandle:o,wxShareData:s,activeSelectorData:a}}});o("104f");const JE=Tr()(KE,[["render",FE]]);var QE=JE,eT=Object(n["defineComponent"])({name:"index",props:{pure:Boolean},components:{parts:VE,GlobalSelector:QE}});const tT=Tr()(eT,[["render",zC]]);var oT=tT;const nT={key:0,class:"template__concise"},iT={class:"concise__control"},sT={class:"control__basic"},aT={class:"control__scene-wrap"},rT={class:"scene__order"},cT={class:"control__cruise-wrap"},lT={class:"control__firstIcons"},dT=["onClick"],uT={key:0,class:"text"},pT={key:1,class:"text"},hT={class:"concise__video"},fT={class:"time"},mT={class:"progress-wrap",ref:"progress"},vT=Object(n["createElementVNode"])("div",{class:"progress-inner"},null,-1),bT=Object(n["createElementVNode"])("span",{class:"progress-handle"},null,-1),gT={class:"total"},yT={class:"concise__section2"},wT={class:"concise__secondIcons"},xT=["onClick"],ST={key:0,class:"text"},IT={key:1,class:"text"},kT={class:"concise__sceneList"};function OT(e,t,o,i,s,a){const r=Object(n["resolveComponent"])("v-marquee"),c=Object(n["resolveComponent"])("SceneList");return e.isConciseModel?Object(n["withDirectives"])((Object(n["openBlock"])(),Object(n["createElementBlock"])("div",nT,[Object(n["createElementVNode"])("div",iT,[Object(n["createElementVNode"])("div",sT,[Object(n["createElementVNode"])("div",aT,[Object(n["createElementVNode"])("span",{class:"scene__icon",style:Object(n["normalizeStyle"])({backgroundImage:`url(${e.isShowSimpleMode?e.sceneIcon.switchPath:e.sceneIcon.path})`}),onClick:t[0]||(t[0]=(...t)=>e.onToggleSimpleModeHandle&&e.onToggleSimpleModeHandle(...t))},null,4),Object(n["createElementVNode"])("span",rT,Object(n["toDisplayString"])(e.sceneIndex+1)+"/"+Object(n["toDisplayString"])(e.sceneCount),1)]),Object(n["createElementVNode"])("div",cT,[Object(n["createElementVNode"])("span",{class:"cruise__icon icon-prev",onClick:t[1]||(t[1]=(...t)=>e.onPrevSceneHandle&&e.onPrevSceneHandle(...t))}),e.isEnableCruising?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",{key:0,class:Object(n["normalizeClass"])(["cruise__icon icon-toggle",{active:e.isPlayingCruising}]),onClick:t[2]||(t[2]=(...t)=>e.onToggleCruisingHandle&&e.onToggleCruisingHandle(...t))},null,2)):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(r,{"custom-class":"cruise__name-wrap","custom-child-class":"name__text","is-splice":!1,"is-show":!e.props.pure,text:e.sceneName,active:e.isEnableNameScroll},null,8,["is-show","text","active"]),Object(n["createElementVNode"])("span",{class:"cruise__icon icon-next",onClick:t[3]||(t[3]=(...t)=>e.onNextSceneHandle&&e.onNextSceneHandle(...t))})])]),Object(n["createElementVNode"])("div",lT,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.firstIcons,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"icon__item",key:t.id},[Object(n["createElementVNode"])("span",{class:"icon",style:Object(n["normalizeStyle"])({backgroundImage:`url(${e.isActiveIcon(t.type)?t.switchPath:t.path})`}),onClick:o=>e.onToggleIconHandle(t)},null,12,dT),8===t.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",uT,Object(n["toDisplayString"])(e.likeNum),1)):Object(n["createCommentVNode"])("",!0),9===t.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",pT,Object(n["toDisplayString"])(e.viewNum),1)):Object(n["createCommentVNode"])("",!0)]))),128))])]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",hT,[Object(n["createElementVNode"])("span",fT,Object(n["toDisplayString"])(e.vTime),1),Object(n["createElementVNode"])("span",{class:Object(n["normalizeClass"])(["btn__toggle",[e.vPaused?"play":"pause"]]),onClick:t[4]||(t[4]=(...t)=>e.onToggleVideoHandle&&e.onToggleVideoHandle(...t))},null,2),Object(n["createElementVNode"])("div",mT,[Object(n["createElementVNode"])("div",{class:"progress-line",style:Object(n["normalizeStyle"])({width:e.vPercent})},null,4),vT,bT],512),Object(n["createElementVNode"])("span",gT,Object(n["toDisplayString"])(e.vDuration),1)],512),[[n["vShow"],e.isShowVideoProgress]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",yT,[Object(n["createElementVNode"])("div",wT,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.secondIcons,t=>(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{class:"icon__item",key:t.id},[Object(n["createElementVNode"])("span",{class:"icon",style:Object(n["normalizeStyle"])({backgroundImage:`url(${e.isActiveIcon(t.type)?t.switchPath:t.path})`}),onClick:o=>e.onToggleIconHandle(t)},null,12,xT),8===t.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",ST,Object(n["toDisplayString"])(e.likeNum),1)):Object(n["createCommentVNode"])("",!0),9===t.type?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",IT,Object(n["toDisplayString"])(e.viewNum),1)):Object(n["createCommentVNode"])("",!0)]))),128))]),Object(n["createElementVNode"])("span",{class:"icon icon-close",title:"隐藏场景列表",onClick:t[5]||(t[5]=(...t)=>e.onHideSimpleModeHandle&&e.onHideSimpleModeHandle(...t))})],512),[[n["vShow"],!e.isShowSimpleMode]]),Object(n["withDirectives"])(Object(n["createElementVNode"])("div",kT,[Object(n["createVNode"])(c,{pure:e.props.pure},null,8,["pure"])],512),[[n["vShow"],!e.isShowSimpleMode]])],512)),[[n["vShow"],!e.props.pure]]):Object(n["createCommentVNode"])("",!0)}var jT=Object(n["defineComponent"])({components:{"v-marquee":oS,SceneList:US},props:{pure:Boolean},setup(e){const t=Object(n["ref"])(Object(n["getCurrentInstance"])()),o=Object(n["computed"])(()=>{const e=i["b"].state.skyBoxSceneGroup.uiIcons||[],t=e.find(e=>{var t;return 1===(null===(t=e.iconInfo)||void 0===t?void 0:t.type)});return{id:null===t||void 0===t?void 0:t.iconInfo.id,type:null===t||void 0===t?void 0:t.iconInfo.type,path:null===t||void 0===t?void 0:t.iconInfo.iconPath,switchPath:null===t||void 0===t?void 0:t.iconInfo.iconPathSwitch}}),s=Object(n["computed"])(()=>{var e;return 2===(null===(e=i["b"].state.skyBoxSceneGroup.templateInfo)||void 0===e?void 0:e.type)}),{firstIcons:a,secondIcons:r}=CT(),{sceneName:c,isEnableNameScroll:l}=ET(),{onToggleIconHandle:d}=TT(),{isActiveIcon:u}=PT(),{onToggleCruisingHandle:p}=_T(),{sceneIndex:h,sceneCount:f,onPrevSceneHandle:m,onNextSceneHandle:v}=AT(),{isShowSimpleMode:b,onHideSimpleModeHandle:g,onToggleSimpleModeHandle:y}=MT(),{vTime:w,vDuration:x,vPercent:S,vPaused:I,isShowVideoProgress:k,onToggleVideoHandle:O,onSetVideoTimeHandle:j}=HT();zT({currentInstance:t},j);const{likeNum:C,viewNum:E}=LT();return{props:e,isConciseModel:s,sceneIcon:o,firstIcons:a,secondIcons:r,sceneName:c,isEnableNameScroll:l,isEnableCruising:JS,isPlayingCruising:QS,onToggleIconHandle:d,onToggleCruisingHandle:p,sceneIndex:h,sceneCount:f,onPrevSceneHandle:m,onNextSceneHandle:v,isShowSimpleMode:b,onHideSimpleModeHandle:g,onToggleSimpleModeHandle:y,vTime:w,vDuration:x,vPercent:S,vPaused:I,isShowVideoProgress:k,onToggleVideoHandle:O,onSetVideoTimeHandle:j,isActiveIcon:u,likeNum:C,viewNum:E}}});function CT(){const e=Object(n["computed"])(()=>i["b"].state.skyBoxSceneGroup.templateInfo||{}),t=Object(n["computed"])(()=>{const t=i["b"].state.skyBoxSceneGroup.uiIcons||[],o=e.value.firstLevelIds||[],n=[];return o.forEach(e=>{const o=t.find(t=>{var o;return(null===(o=t.iconInfo)||void 0===o?void 0:o.id)===e});o&&n.push({id:o.iconInfo.id,type:o.iconInfo.type,active:!1,path:o.iconInfo.iconPath,switchPath:o.iconInfo.iconPathSwitch,content:o.hotpot||o.selector||null})}),n}),o=Object(n["computed"])(()=>{const t=i["b"].state.skyBoxSceneGroup.uiIcons||[],o=e.value.secondLevelIds||[],n=[];return o.forEach(e=>{const o=t.find(t=>{var o;return(null===(o=t.iconInfo)||void 0===o?void 0:o.id)===e});o&&n.push({id:o.iconInfo.id,type:o.iconInfo.type,active:!1,path:o.iconInfo.iconPath,switchPath:o.iconInfo.iconPathSwitch,content:o.hotpot||o.selector||null})}),n});return{firstIcons:t,secondIcons:o}}function ET(){const e=Object(n["computed"])(()=>i["b"].state.sceneInfo.title||""),t=Object(n["ref"])(!1);return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e?requestAnimationFrame(()=>{t.value=!0}):t.value=!1}),{sceneName:e,isEnableNameScroll:t}}function TT(){const e=()=>{const e=i["b"].state.viewedIds[i["b"].state.viewedIds.length-2];if(e){const t=i["b"].state.viewedIds.slice(0,Math.max(i["b"].state.viewedIds.length-2,0));i["b"].commit(jo["z"],t),Ns.emit(Fs,{sceneId:e})}};let t=!1;const o=()=>{t=!t,Ns.emit(ca,t)},n=e=>{10===e.type&&0===e.content.type?Ho(e.content.path):6===e.type?Ns.emit(Fs,{sceneId:e.content.nextSceneId,startTime:e.content.startTime,switchEffect:e.content.switchIndex}):Ns.emit(ba,e)},s=e=>{Ns.emit("watch-selector-show",e)},a=t=>{switch(t.type){case 2:Ns.emit(ea);break;case 3:Ns.emit(oa);break;case 4:Ns.emit(na);break;case 5:Ns.emit(ta);break;case 6:Ns.emit(ia);break;case 7:Ns.emit(sa);break;case 8:Ns.emit(aa);break;case 10:o();break;case 11:Ns.emit(fa);break;case 12:Ns.emit(ma);break;case 20:n(t.content);break;case 21:s(t.content);break;case 23:e();break;default:break}};return{onToggleIconHandle:a}}function PT(){const e=Object(n["ref"])(new Map),t=(t,o)=>{e.value.set(t,o)},o=t=>!!e.value.get(t);return Object(n["watch"])(()=>i["b"].state.baseIconStatus.promusic_paused,e=>{t(2,!e)}),Object(n["watch"])(()=>i["b"].state.baseIconStatus.scenemusic_paused,e=>{t(5,!e)}),Object(n["watch"])(()=>i["b"].state.baseIconStatus.dolike,e=>{t(8,e)}),Object(n["watch"])(()=>i["b"].state.baseIconStatus.gyro,e=>{t(7,e)}),{isActiveIcon:o}}function _T(){const e=()=>{eI()};return{onToggleCruisingHandle:e}}function AT(){const e=Object(n["computed"])(()=>{let e=[];const t=i["b"].state.skyBoxSceneGroup.sceneGroups||[];return t&&t.length&&t.forEach(t=>{e=e.concat(t.sceneIds)}),e}),t=Object(n["computed"])(()=>e.value.length||0),o=Object(n["computed"])(()=>e.value.findIndex(e=>e===i["b"].state.sceneInfo.id)),s=()=>{let n=o.value-1;n<0&&(n=t.value-1),r(e.value[n])},a=()=>{let n=o.value+1;n>=t.value&&(n=0),r(e.value[n])},r=e=>{e&&Ns.emit(Fs,{sceneId:e})};return{sceneIndex:o,sceneCount:t,onPrevSceneHandle:s,onNextSceneHandle:a}}function MT(){const e=Object(n["ref"])(!1),t=()=>{e.value=!0,Ns.emit(Qs,!1)},o=()=>{e.value=!e.value,Ns.emit(Qs)};return{isShowSimpleMode:e,onHideSimpleModeHandle:t,onToggleSimpleModeHandle:o}}function HT(){const e=Object(n["computed"])(()=>1===i["b"].state.sceneInfo.type&&i["b"].state.sceneInfo.enableProgress),t=Object(n["computed"])(()=>i["b"].state.scenevideo.toggle||!1),o=Object(n["computed"])(()=>Hp(i["b"].state.scenevideo.time||0)),s=Object(n["computed"])(()=>Hp(i["b"].state.scenevideo.total||0)),a=Object(n["computed"])(()=>((i["b"].state.scenevideo.time||0)/(i["b"].state.scenevideo.total||1)*100).toFixed(1)+"%"),r=()=>{Ns.emit($a)},c=e=>{Ns.emit(Ua,e)};return{vTime:o,vDuration:s,vPercent:a,vPaused:t,isShowVideoProgress:e,onToggleVideoHandle:r,onSetVideoTimeHandle:c}}function zT({currentInstance:e},t){let o=!1,s=null;const a=()=>{const{progress:n}=e.value.refs;n&&!s&&(s=new tb(n,{diffNum:0,change(e){t(e*i["b"].state.scenevideo.total)},down(){o=!0},up(){o=!1}}))},r=()=>{s&&s.change(100*Math.min(i["b"].state.scenevideo.time/i["b"].state.scenevideo.total,1))};Object(n["watch"])(()=>i["b"].state.scenevideo.total,e=>{e&&a()}),Object(n["watch"])(()=>i["b"].state.scenevideo.time,()=>{o||r()})}function LT(){const e=Object(n["computed"])(()=>i["b"].state.statistics||{}),t=Object(n["computed"])(()=>e.value.likeNum),o=Object(n["computed"])(()=>e.value.pv||0);return{likeNum:t,viewNum:o}}o("8801");const DT=Tr()(jT,[["render",OT]]);var BT=DT,NT=Object(n["defineComponent"])({components:{Theme:_g,Airpose:Zg,Notice:Qg,Talk:Dy,FlatIcons:fw,Contact:Hw,Share:Fw,Intro:sx,Subtitle:Tx,ProDetail:Rx,Scenelist:US,Layer:Ij,Selector:aC,FlatComponent:HC,FlatMode:oT,ConciseTemplate:BT},setup(){const{pure:e}=Wy();qS(),tI(),nI(),cI(),dI();const t=Object(n["computed"])(()=>{var e;return 2===(null===(e=i["b"].state.skyBoxSceneGroup.templateInfo)||void 0===e?void 0:e.type)});return{pure:e,isConciseModel:t}}});const VT=Tr()(NT,[["render",Ob]]);var RT=VT;class FT{constructor(e){this.options=e||{},this.instance=null,this.paused=!0,window.Howl&&(this.instance=new window.Howl({html:this.options.html,src:[this.options.path],volume:this.options.volume,loop:this.options.loop}),this.instance.on("play",()=>{this.paused=!1,this.options.onplay&&this.options.onplay()}),this.instance.on("pause",()=>{this.paused=!0,this.options.onpause&&this.options.onpause()}),this.instance.on("end",()=>{this.options.oncomplete&&this.options.oncomplete(),this.options.loop||(this.pause(),this.options.onend&&this.options.onend())}))}play(){this.instance&&this.instance.play()}pause(){this.instance&&this.instance.pause()}stop(){this.instance&&(this.instance.pause(),this.instance.stop())}destroy(){this.instance&&(this.instance.unload(),this.instance._src="")}}var GT=FT;function WT(){const e=[],{onOpenAudioHotMessage:t,onCloseAudioHotMessage:o}=$T(),s=t=>{const n=t.content;if(!n||!n.audioPath||!window.Howl)return;let i=e.find(e=>e.id===t.id);if(!i){var s;const a=new GT({html:null===(s=t.html)||void 0===s||s,path:n.audioPath,volume:n.volume,loop:n.replay,onpause:()=>{Ja(t.id,!0)},oncomplete:()=>{Ns.emit(ka,t.id)},onend:()=>{Qa(t.id,"isEnded",!0),o(t.id,t.type)}});i={id:t.id,type:t.type,instance:a},e.push(i);const r=t.isSelectorHot?"selector_hotspot":"hotspot";Ka({pid:t.pid||t.id,id:t.id,type:r+"_audio",instance:a,isPauseMedia:n.isPauseMedia,isEventSelector:t.isEventSelector||!1})}return i},a=e=>{const o=s(e);o&&o.instance&&(o.instance.paused?(o.instance.play(),Ja(e.id,!1),t(e.id,e.type)):r(e.id))};Ns.on(Ea,e=>{a(e)});const r=t=>{const n=e.find(e=>e.id===t);n&&n.instance&&(n.instance.stop(),er(t),o(t,n.type))};Ns.on(Ta,e=>{r(e)});const c=t=>{const o=e.find(e=>e.id===t);if(o){o.instance&&(o.instance.destroy(),o.instance=null);for(let o=0;o<e.length;o++)t===e[o].id&&e.splice(o,1)}},l=()=>{i["b"].state.sceneInfo.hotspots.forEach(e=>{e.id&&c(e.id)}),i["b"].state.skyBoxSceneGroup.sceneList.forEach(e=>{e.components&&e.components.length>0&&e.components.forEach(e=>{e.hotspot&&[5,52].includes(e.hotspot.type)&&c(e.hotspot.id)})})};Ns.on(Rs,()=>{l()}),Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e&&UT(s)})}function $T(){const e=(e,t)=>{5===t&&Ns.emit(ya,{id:e,status:!0})},t=(e,t)=>{5===t&&Ns.emit(ya,{id:e,status:!1})};return{onOpenAudioHotMessage:e,onCloseAudioHotMessage:t}}function UT(e){const t=i["b"].state.sceneInfo,o=t.triggers.filter(e=>2===e.type);if(!o.length)return;const n=t.logicItems.concat(t.operationItems,t.randomItems,t.variItems),s=t.hotspots.filter(e=>5===e.type||52===e.type),a=s.map(e=>e.id),r=[],c=e=>{const t=n.find(t=>t.instanceId===e),o=a.includes(e);t&&!o?t.lines.forEach(e=>{c(e.targetId)}):r.includes(e)||r.push(e)};o.forEach(e=>{e.relations&&e.relations.forEach(e=>{c(e.targetId)})}),t.hotspots.forEach(t=>{r.includes(t.id)&&e&&e(Object.assign({},t,{html:!1}))})}var XT=WT;function YT(){const{initProAudio:e}=ZT(),{updateAudioInstance:t,startUpdateTime:o,stopUpdateTime:s}=JT(),{initSceneAudio:a,destroySceneAudio:r}=qT({updateAudioInstance:t,startUpdateTime:o,stopUpdateTime:s});KT(),XT();const c=Object(n["computed"])(()=>i["b"].state.lifecycle.isLoadedScene&&i["b"].state.lifecycle.isLoadedAnimation);Object(n["watch"])(()=>c.value,t=>{t?(e(),a()):r()})}function ZT(){const e=Object(n["ref"])([]);let t="",o=!1,s=!1;const a=()=>{const o=e.value.find(e=>e.key===t);o&&o.instance&&!o.status.playing&&(window.console.log("播放",11),o.instance.play())},r=()=>{const o=e.value.find(e=>e.key===t);o&&o.instance&&o.status.playing&&o.instance.pause()},c=()=>{var n;const i=null===(n=e.value.find(e=>e.key===t))||void 0===n?void 0:n.instance;i&&(o=!0,h.value?r():a())},l=t=>{e.value.forEach(e=>{e.key!==t&&e.instance.pause()})},{cacheAudioList:d}=eP({playAudio:a}),u=()=>{const e=i["b"].state.skyBoxSceneGroup.globalMusics||[];let t=null;const o=Po(i["b"].state.proInfo.version,"5.8.0");if(o)t=e.find(e=>e.applySceneIds.includes(i["b"].state.sceneInfo.id));else{const o=Number(i["b"].state.sceneInfo.type)+""+Number(i["b"].state.sceneInfo.is2dRender);t=e.find(e=>e.applyRange.includes(o))}return t},p=()=>{const o=u();if(QT("promusic_visible",!(!o||!o.path)),!o||!o.path||!window.Howl)return void r();l(o.path),t!==o.path&&(t=o.path);const n=e.value.find(e=>e.key===o.path);if(!n){var i;let t=null===(i=d.find(e=>e.key===o.path))||void 0===i?void 0:i.instance;t?(t._src=o.path,t._loop=o.loop,t._volume=o.volume):t=new window.Howl({html5:!0,src:[o.path],loop:o.loop,volume:o.volume});const n=o.applySceneIds.join();Ka({id:"g_audio_"+n,type:"global_audio",instance:t,isPauseMedia:!1}),e.value.push({id:n,key:o.path,instance:t,status:{playing:!1,ended:!1}}),m(o.path)}const c=e.value.find(e=>e.key===o.path);!s&&c&&c.instance["_src"]&&!c.status.ended&&a()},h=Object(n["computed"])(()=>e.value.some(e=>e.status.playing)),f=(e,t)=>{o&&(s=t,o=!1),e.status.playing=!t,QT("promusic_paused",!h.value),Ja("g_audio_"+e.id,t)},m=t=>{const o=e.value.find(e=>e.key===t);o&&o.instance&&(o.instance.on("play",()=>{f(o,!1)}),o.instance.on("pause",()=>{f(o,!0)}),o.instance.on("end",()=>{o.instance._loop||(f(o,!0),o.status.ended=!0,Qa("g_audio_"+o.id,"isEnded",!0))}))};return Ns.on(ea,c),{initProAudio:p}}function qT({updateAudioInstance:e,startUpdateTime:t,stopUpdateTime:o}){let n=null,s=!1,a=!1,r=!1,c=!1;const l=()=>i["b"].state.sceneInfo.music,d=()=>{const e=l();QT("scenemusic_visible",!(!e||!e.path)),e&&e.path&&window.Howl&&(n?(window.console.log("场景音乐变更了",666666),n.unload(),v(),n._src=e.path,n._loop=e.loop,n._volume=e.volume,n.load()):(window.console.log("场景音乐初始化",555555),n=new window.Howl({html5:!0,src:[e.path],loop:e.loop,volume:e.volume}),b(),Ka({id:"s_audio",type:"scene_audio",instance:n,isPauseMedia:!1})),!n._src||a||c||p())},u=()=>{n&&(n.unload(),n._src="")},p=()=>{n&&n.play()},h=()=>{n&&n.pause()},f=()=>{n&&(s=!0,r?h():p())},m=e=>{s&&(a=e,s=!1),r=!e,QT("scenemusic_paused",e),Ja("s_audio",e)},v=()=>{c=!1,r=!1,i["b"].commit(jo["s"],{key:"ended",value:!1})},b=()=>{n&&(e(n),n.on("play",()=>{m(!1),t()}),n.on("pause",()=>{m(!0),o()}),n.on("end",()=>{n._loop||(m(!0),c=!0,Qa("s_audio","isEnded",!0),o(),i["b"].commit(jo["s"],{key:"ended",value:!0}))}),n.on("playerror",()=>{n.once("unlock",()=>{p()})}))};return Ns.on(ta,f),{initSceneAudio:d,destroySceneAudio:u}}function KT(){let e=null,t=-1;const o=(t,o)=>{window.Howl&&(e?e._src!==t?(window.console.log("更新音效实例"),e.unload(),e._src=t,e.load()):e.stop():(window.console.log("初始化音效实例"),e=new window.Howl({html5:!0,src:[t]}),r(),Ka({id:"e_audio",type:"effect_audio",instance:e,isPauseMedia:!1})),e._src&&a(o))},n=(e,o)=>!(1===e&&!o&&2===t)&&(t=e,!0),i=()=>{e&&e.play()},s=()=>{e&&e.stop()},a=o=>{e&&(o?i():2===t||o||s())},r=()=>{e&&(e.on("play",()=>{Ja("e_audio",!1)}),e.on("pause",()=>{Ja("e_audio",!0)}),e.on("end",()=>{Qa("e_audio","isEnded",!0)}))};Ns.on(xa,({path:e,status:t,mode:i})=>{e&&n(i,t)&&o(e,t)})}function JT(){const e=Object(n["computed"])(()=>{const e=i["b"].state.sceneInfo.subtitle;return e.path&&1===e.follow});let t=0;const o=()=>{a&&(a.playing()&&c(a.seek()),t=requestAnimationFrame(o))},s=()=>{cancelAnimationFrame(t)};let a=null;const r=e=>{a=e},c=t=>{e.value&&i["b"].commit(jo["s"],{key:"time",value:t})};return{updateAudioInstance:r,startUpdateTime:o,stopUpdateTime:s}}function QT(e,t){i["b"].commit(jo["a"],{key:e,value:t})}function eP({playAudio:e}){const t=[],o=()=>{const e=i["b"].state.skyBoxSceneGroup.sceneList.map(e=>e.id),o=i["b"].state.skyBoxSceneGroup.globalMusics.filter(t=>t.applySceneIds.some(t=>e.includes(t)));o.forEach(e=>{const o=t.find(t=>t.key===e.path);if(!o){const o=new window.Howl({html5:!0,src:[e.path],loop:e.loop,volume:e.volume});t.push({id:e.id,key:e.path,instance:o})}})},s=Object(To["d"])()?"touchstart":"mousedown",a=()=>{o(),e(),window.removeEventListener(s,a,!1)};let r=!1;const c=()=>{r=!0,window.addEventListener(s,a,!1)};return Object(n["watch"])(()=>i["b"].state.lifecycle.isLoadedScene,e=>{e&&!r&&c()}),{cacheAudioList:t}}function tP(){const e=Object(n["ref"])(0),t=()=>{const e=i["b"].state.sceneInfo.effect;if(0===e.type)return;const t={url:"%$prevPath%/plugins/snow.js",blendmode:"normal",mode:"image",imageurl:"",imagescale:1,flakes:1e3,color:"0xffffff",floor:"0.3",speed:5,spreading:"4.0",shake:"4.0",speedvariance:"2.0",wind:"0.0",winddir:"0.0",rainwidth:"0.5",rainalpha:"0.5",invert:"false"},n={};switch(e.type){case 2:n.imageurl="%$prevPath%/skin/assets/rain.png",n.flakes=1e3*(e.size+1),n.wind=2,n.shake=1,n.speed=[9,12,15][e.size],n.speedvariance=1,n.spreading=2,n.rainwidth=[.4,.8,1.2][e.size];break;case 3:n.imageurl="%$prevPath%/skin/assets/snow.png",n.flakes=1500*(e.size+1),n.speed=[2,5,10][e.size],n.wind=-1,i["b"].state.device.mobile&&(n.rainwidth=[.5,.8,1][e.size],n.shake=1,n.speedvariance=1,n.spreading=2);break;case 4:t.imageurl=e.iconPath,t.imagescale=[.3,.4,.8][e.size];break;case 5:n.imageurl="%$prevPath%/skin/assets/redpacket.png";break;case 6:n.imageurl="%$prevPath%/skin/assets/gold.png";break;case 7:n.imageurl="%$prevPath%/skin/assets/love.png";break}if([4,5,6,7].indexOf(e.type)>=0&&(n.flakes=[200,300,600][e.size],n.shake=1,n.speed=[1.2,2,3][e.size],n.imagescale=[.5,.8,1][e.size],n.speedvariance=2,n.spreading=1.5),1!==e.type){const e=Object.assign(t,n);o(e)}else s(e.sunPos)},o=e=>{const t=i["b"].state.krp;let o=t.get("plugin[snow]");o||(t.call("addplugin(snow)"),o=t.get("plugin[snow]")),o&&(o.url=e.url,o.blendmode=e.blendmode,o.mode=e.mode,o.imageurl=e.imageurl,o.imagescale=e.imagescale,o.flakes=e.flakes,o.color=e.color,o.floor=e.floor,o.speed=e.speed,o.spreading=e.spreading,o.shake=e.shake,o.speedvariance=e.speedvariance,o.wind=e.wind,o.winddir=e.winddir,o.rainwidth=e.rainwidth,o.rainalpha=e.rainalpha,o.invert=e.invert)},s=({ath:e,atv:t})=>{const o=i["b"].state.krp,n=o.get("lensflares[0].item[0]");n&&(n.scene=o.get("xml.scene"),n.ath=e,n.atv=t,o.call("load_flare_content()"))},a=Object(n["computed"])(()=>{const e=i["b"].state.lifecycle.isLoadedScene,t=i["b"].state.lifecycle.isLoadedAnimation;return e&&t});Object(n["watch"])(()=>a.value,o=>{const n=i["b"].state.sceneInfo;o&&e.value!==n.id?(e.value=n.id,n.isHiddenSetting||3===n.type||t()):e.value=0})}function oP(){nP(),sP(),rP(),cP()}function nP(){const e=e=>i["b"].state.sceneInfo.operationItems.find(t=>t.itemId===e);function t(t,o,n=!1){const i=e(t),s=n?{isUserVar:!1,value:o}:Iu(i.variableIdFirstSourse),a=Iu(i.variableIdSecondSourse);iP(i.variableIdResult,s,a,i.operationType)}Ns.on(Ma,({operId:e,value:o,type:n,status:i})=>{-1!==i&&t(e,o,"input"===n)})}function iP(e,t,o,n){switch(n){case 1:ku(e,t,o);break;case 2:Ou(e,t,o);break;case 3:ju(e,t,o);break;case 4:Cu(e,t,o);break;case 5:Eu(e,t);break;case 6:Tu(e,t);break;default:break}}function sP(){const e=e=>i["b"].state.sceneInfo.logicItems.find(t=>t.itemId===e);function t(t,o,n=!1){const i=e(t),s=n?{isUserVar:!1,value:o}:Iu(i.variableIdFirst),a=Iu(i.variableIdSecond),r=aP(s,a,i.operationType);qp(t,r),i.lines.forEach(e=>{e.parentType="logic",e.parentId=t,e.parentResult=r})}Ns.on(Ha,({logicId:e,value:o,type:n,status:i})=>{-1!==i&&t(e,o,"input"===n)})}function aP(e,t,o){var n,i;let s=!1;const a=Number(null!==(n=e.value)&&void 0!==n?n:0),r=Number(null!==(i=t.value)&&void 0!==i?i:0);switch(o){case 1:s=a>r;break;case 2:s=a<r;break;case 3:s=a>=r;break;case 4:s=a<=r;break;case 5:s=a===r;break;case 6:s=a!==r;break;default:break}return s}function rP(){const e=e=>i["b"].state.sceneInfo.randomItems.find(t=>t.instanceId===e),t=t=>{const o=e(t),n=parseFloat(Math.random().toFixed(2));xu(o.variableIdRandom,n),o.lines.forEach(e=>{e.parentId=t})};Ns.on(za,({randId:e,status:o})=>{-1!==o&&t(e)})}function cP(){const e=e=>i["b"].state.sceneInfo.variItems.find(t=>t.instanceId===e),t=(t,o,n=!0)=>{const i=e(t),s=Iu(i.variableId);n?(3===s.type&&void 0!==o&&xu(i.variableId,Number(o)),i.lines.forEach(e=>{e.parentResult=o||0})):void 0!==o&&xu(i.variableId,Number(o)),i.lines.forEach(e=>{e.parentType="var",e.parentId=i.variableId})};Ns.on(La,({varId:e,value:o,type:n,status:i})=>{-1!==i&&t(e,o,"logic"===n)})}var lP=oP;const dP=e=>(Object(n["pushScopeId"])("data-v-2ae49ac6"),e=e(),Object(n["popScopeId"])(),e),uP={key:0,class:"cmp__start"},pP=dP(()=>Object(n["createElementVNode"])("span",{class:"start__logo"},null,-1)),hP=[pP];var fP=Object(n["defineComponent"])({__name:"preview",setup(e){const t=Object(n["ref"])(0),o=e=>{t.value=e,1===t.value&&(YT(),tP(),lP())};return(e,i)=>(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[t.value?Object(n["createCommentVNode"])("",!0):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",uP,hP)),Object(n["createVNode"])(tc,{onPass:o}),1===t.value?(Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],{key:1},[Object(n["createVNode"])(Ac),Object(n["createVNode"])(Mv),Object(n["createVNode"])(kb),Object(n["createVNode"])(RT)],64)):Object(n["createCommentVNode"])("",!0)],64))}});o("a4ac");const mP=Tr()(fP,[["__scopeId","data-v-2ae49ac6"]]);t["default"]=mP},a93e:function(e,t,o){e.exports=o.p+"img/webview_control.6fec51e1.png"},aa63:function(e,t,o){const n=o("7bf0"),i=o("7a43"),s=o("7ba0"),a=o("577e"),r=o("d6c0"),c=o("924f"),l=o("7903"),d=o("34fc"),u=o("8d23"),p=o("c8aa"),h=o("9582"),f=o("bbf0"),m=o("befa");function v(e,t){const o=e.size,n=c.getPositions(t);for(let i=0;i<n.length;i++){const t=n[i][0],s=n[i][1];for(let n=-1;n<=7;n++)if(!(t+n<=-1||o<=t+n))for(let i=-1;i<=7;i++)s+i<=-1||o<=s+i||(n>=0&&n<=6&&(0===i||6===i)||i>=0&&i<=6&&(0===n||6===n)||n>=2&&n<=4&&i>=2&&i<=4?e.set(t+n,s+i,!0,!0):e.set(t+n,s+i,!1,!0))}}function b(e){const t=e.size;for(let o=8;o<t-8;o++){const t=o%2===0;e.set(o,6,t,!0),e.set(6,o,t,!0)}}function g(e,t){const o=r.getPositions(t);for(let n=0;n<o.length;n++){const t=o[n][0],i=o[n][1];for(let o=-2;o<=2;o++)for(let n=-2;n<=2;n++)-2===o||2===o||-2===n||2===n||0===o&&0===n?e.set(t+o,i+n,!0,!0):e.set(t+o,i+n,!1,!0)}}function y(e,t){const o=e.size,n=p.getEncodedBits(t);let i,s,a;for(let r=0;r<18;r++)i=Math.floor(r/3),s=r%3+o-8-3,a=1===(n>>r&1),e.set(i,s,a,!0),e.set(s,i,a,!0)}function w(e,t,o){const n=e.size,i=h.getEncodedBits(t,o);let s,a;for(s=0;s<15;s++)a=1===(i>>s&1),s<6?e.set(s,8,a,!0):s<8?e.set(s+1,8,a,!0):e.set(n-15+s,8,a,!0),s<8?e.set(8,n-s-1,a,!0):s<9?e.set(8,15-s-1+1,a,!0):e.set(8,15-s-1,a,!0);e.set(n-8,8,1,!0)}function x(e,t){const o=e.size;let n=-1,i=o-1,s=7,a=0;for(let r=o-1;r>0;r-=2){6===r&&r--;while(1){for(let o=0;o<2;o++)if(!e.isReserved(i,r-o)){let n=!1;a<t.length&&(n=1===(t[a]>>>s&1)),e.set(i,r-o,n),s--,-1===s&&(a++,s=7)}if(i+=n,i<0||o<=i){i-=n,n=-n;break}}}}function S(e,t,o){const i=new s;o.forEach((function(t){i.put(t.mode.bit,4),i.put(t.getLength(),f.getCharCountIndicator(t.mode,e)),t.write(i)}));const a=n.getSymbolTotalCodewords(e),r=d.getTotalCodewordsCount(e,t),c=8*(a-r);i.getLengthInBits()+4<=c&&i.put(0,4);while(i.getLengthInBits()%8!==0)i.putBit(0);const l=(c-i.getLengthInBits())/8;for(let n=0;n<l;n++)i.put(n%2?17:236,8);return I(i,e,t)}function I(e,t,o){const i=n.getSymbolTotalCodewords(t),s=d.getTotalCodewordsCount(t,o),a=i-s,r=d.getBlocksCount(t,o),c=i%r,l=r-c,p=Math.floor(i/r),h=Math.floor(a/r),f=h+1,m=p-h,v=new u(m);let b=0;const g=new Array(r),y=new Array(r);let w=0;const x=new Uint8Array(e.buffer);for(let n=0;n<r;n++){const e=n<l?h:f;g[n]=x.slice(b,b+e),y[n]=v.encode(g[n]),b+=e,w=Math.max(w,e)}const S=new Uint8Array(i);let I,k,O=0;for(I=0;I<w;I++)for(k=0;k<r;k++)I<g[k].length&&(S[O++]=g[k][I]);for(I=0;I<m;I++)for(k=0;k<r;k++)S[O++]=y[k][I];return S}function k(e,t,o,i){let s;if(Array.isArray(e))s=m.fromArray(e);else{if("string"!==typeof e)throw new Error("Invalid data");{let n=t;if(!n){const t=m.rawSplit(e);n=p.getBestVersionForData(t,o)}s=m.fromString(e,n||40)}}const r=p.getBestVersionForData(s,o);if(!r)throw new Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<r)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+r+".\n")}else t=r;const c=S(t,o,s),d=n.getSymbolSize(t),u=new a(d);return v(u,t),b(u),g(u,t),w(u,o,0),t>=7&&y(u,t),x(u,c),isNaN(i)&&(i=l.getBestMask(u,w.bind(null,u,o))),l.applyMask(i,u),w(u,o,i),{modules:u,version:t,errorCorrectionLevel:o,maskPattern:i,segments:s}}t.create=function(e,t){if("undefined"===typeof e||""===e)throw new Error("No input text");let o,s,a=i.M;return"undefined"!==typeof t&&(a=i.from(t.errorCorrectionLevel,i.M),o=p.from(t.version),s=l.from(t.maskPattern),t.toSJISFunc&&n.setToSJISFunction(t.toSJISFunc)),k(e,o,a,s)}},ab36:function(e,t,o){var n=o("861d"),i=o("9112");e.exports=function(e,t){n(t)&&"cause"in t&&i(e,"cause",t.cause)}},ad0b:function(e,t,o){e.exports=o.p+"img/d2.afc0bbcd.png"},ad44:function(e,t,o){"use strict";o("0d6e")},aeb0:function(e,t,o){var n=o("9bf2").f;e.exports=function(e,t,o){o in e||n(e,o,{configurable:!0,get:function(){return t[o]},set:function(e){t[o]=e}})}},aed9:function(e,t,o){var n=o("83ab"),i=o("d039");e.exports=n&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},b167:function(e,t,o){e.exports=o.p+"img/logo.799a5d16.png"},b1b8:function(e,t,o){"use strict";o("55a0")},b203:function(e,t,o){},b42e:function(e,t){var o=Math.ceil,n=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?n:o)(t)}},b572:function(e,t,o){},b622:function(e,t,o){var n=o("da84"),i=o("5692"),s=o("1a2d"),a=o("90e3"),r=o("04f8"),c=o("fdbf"),l=n.Symbol,d=i("wks"),u=c?l["for"]||l:l&&l.withoutSetter||a;e.exports=function(e){return s(d,e)||(d[e]=r&&s(l,e)?l[e]:u("Symbol."+e)),d[e]}},b652:function(e,t,o){"use strict";o("4189")},b768:function(e,t,o){"use strict";o("01ac")},b77e:function(e,t,o){},b7d2:function(e,t,o){},b980:function(e,t,o){var n=o("d039"),i=o("5c6c");e.exports=!n((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},ba50:function(e,t,o){"use strict";o("b572")},bb0b:function(e,t,o){e.exports=o.p+"img/d1.a91a6783.png"},bbf0:function(e,t,o){const n=o("27a3"),i=o("0425");function s(e){if("string"!==typeof e)throw new Error("Param is not a string");const o=e.toLowerCase();switch(o){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+e)}}t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!n.isValid(t))throw new Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return i.testNumeric(e)?t.NUMERIC:i.testAlphanumeric(e)?t.ALPHANUMERIC:i.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,o){if(t.isValid(e))return e;try{return s(e)}catch(n){return o}}},bcbf:function(e,t,o){var n=o("f5df");e.exports=function(e){var t=n(e);return"BigInt64Array"==t||"BigUint64Array"==t}},bea4:function(e,t,o){},befa:function(e,t,o){const n=o("bbf0"),i=o("dd7e"),s=o("9d94"),a=o("0196"),r=o("2f3a"),c=o("0425"),l=o("7bf0"),d=o("10b0");function u(e){return unescape(encodeURIComponent(e)).length}function p(e,t,o){const n=[];let i;while(null!==(i=e.exec(o)))n.push({data:i[0],index:i.index,mode:t,length:i[0].length});return n}function h(e){const t=p(c.NUMERIC,n.NUMERIC,e),o=p(c.ALPHANUMERIC,n.ALPHANUMERIC,e);let i,s;l.isKanjiModeEnabled()?(i=p(c.BYTE,n.BYTE,e),s=p(c.KANJI,n.KANJI,e)):(i=p(c.BYTE_KANJI,n.BYTE,e),s=[]);const a=t.concat(o,i,s);return a.sort((function(e,t){return e.index-t.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function f(e,t){switch(t){case n.NUMERIC:return i.getBitsLength(e);case n.ALPHANUMERIC:return s.getBitsLength(e);case n.KANJI:return r.getBitsLength(e);case n.BYTE:return a.getBitsLength(e)}}function m(e){return e.reduce((function(e,t){const o=e.length-1>=0?e[e.length-1]:null;return o&&o.mode===t.mode?(e[e.length-1].data+=t.data,e):(e.push(t),e)}),[])}function v(e){const t=[];for(let o=0;o<e.length;o++){const i=e[o];switch(i.mode){case n.NUMERIC:t.push([i,{data:i.data,mode:n.ALPHANUMERIC,length:i.length},{data:i.data,mode:n.BYTE,length:i.length}]);break;case n.ALPHANUMERIC:t.push([i,{data:i.data,mode:n.BYTE,length:i.length}]);break;case n.KANJI:t.push([i,{data:i.data,mode:n.BYTE,length:u(i.data)}]);break;case n.BYTE:t.push([{data:i.data,mode:n.BYTE,length:u(i.data)}])}}return t}function b(e,t){const o={},i={start:{}};let s=["start"];for(let a=0;a<e.length;a++){const r=e[a],c=[];for(let e=0;e<r.length;e++){const l=r[e],d=""+a+e;c.push(d),o[d]={node:l,lastCount:0},i[d]={};for(let e=0;e<s.length;e++){const a=s[e];o[a]&&o[a].node.mode===l.mode?(i[a][d]=f(o[a].lastCount+l.length,l.mode)-f(o[a].lastCount,l.mode),o[a].lastCount+=l.length):(o[a]&&(o[a].lastCount=l.length),i[a][d]=f(l.length,l.mode)+4+n.getCharCountIndicator(l.mode,t))}}s=c}for(let n=0;n<s.length;n++)i[s[n]].end=0;return{map:i,table:o}}function g(e,t){let o;const c=n.getBestModeForData(e);if(o=n.from(t,c),o!==n.BYTE&&o.bit<c.bit)throw new Error('"'+e+'" cannot be encoded with mode '+n.toString(o)+".\n Suggested mode is: "+n.toString(c));switch(o!==n.KANJI||l.isKanjiModeEnabled()||(o=n.BYTE),o){case n.NUMERIC:return new i(e);case n.ALPHANUMERIC:return new s(e);case n.KANJI:return new r(e);case n.BYTE:return new a(e)}}t.fromArray=function(e){return e.reduce((function(e,t){return"string"===typeof t?e.push(g(t,null)):t.data&&e.push(g(t.data,t.mode)),e}),[])},t.fromString=function(e,o){const n=h(e,l.isKanjiModeEnabled()),i=v(n),s=b(i,o),a=d.find_path(s.map,"start","end"),r=[];for(let t=1;t<a.length-1;t++)r.push(s.table[a[t]].node);return t.fromArray(m(r))},t.rawSplit=function(e){return t.fromArray(h(e,l.isKanjiModeEnabled()))}},bf0b:function(e,t,o){"use strict";o("fa05")},c04e:function(e,t,o){var n=o("c65b"),i=o("861d"),s=o("d9b5"),a=o("dc4a"),r=o("485a"),c=o("b622"),l=TypeError,d=c("toPrimitive");e.exports=function(e,t){if(!i(e)||s(e))return e;var o,c=a(e,d);if(c){if(void 0===t&&(t="default"),o=n(c,e,t),!i(o)||s(o))return o;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),r(e,t)}},c07f:function(e,t,o){},c354:function(e,t,o){"use strict";o("7418")},c423:function(e,t,o){e.exports=o.p+"img/d1_en.99051e49.png"},c430:function(e,t){e.exports=!1},c61e:function(e,t,o){e.exports=o.p+"img/icon-video_center.b3ac5c1c.png"},c65b:function(e,t,o){var n=o("40d5"),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},c6b5:function(e,t,o){"use strict";o("d72f")},c6b6:function(e,t,o){var n=o("e330"),i=n({}.toString),s=n("".slice);e.exports=function(e){return s(i(e),8,-1)}},c6cd:function(e,t,o){var n=o("da84"),i=o("6374"),s="__core-js_shared__",a=n[s]||i(s,{});e.exports=a},c6e3:function(e,t,o){o("4ea1")},c75c:function(e,t,o){e.exports=o.p+"img/r_7.175aff5f.png"},c8aa:function(e,t,o){const n=o("7bf0"),i=o("34fc"),s=o("7a43"),a=o("bbf0"),r=o("27a3"),c=7973,l=n.getBCHDigit(c);function d(e,o,n){for(let i=1;i<=40;i++)if(o<=t.getCapacity(i,n,e))return i}function u(e,t){return a.getCharCountIndicator(e,t)+4}function p(e,t){let o=0;return e.forEach((function(e){const n=u(e.mode,t);o+=n+e.getBitsLength()})),o}function h(e,o){for(let n=1;n<=40;n++){const i=p(e,n);if(i<=t.getCapacity(n,o,a.MIXED))return n}}t.from=function(e,t){return r.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,o){if(!r.isValid(e))throw new Error("Invalid QR Code version");"undefined"===typeof o&&(o=a.BYTE);const s=n.getSymbolTotalCodewords(e),c=i.getTotalCodewordsCount(e,t),l=8*(s-c);if(o===a.MIXED)return l;const d=l-u(o,e);switch(o){case a.NUMERIC:return Math.floor(d/10*3);case a.ALPHANUMERIC:return Math.floor(d/11*2);case a.KANJI:return Math.floor(d/13);case a.BYTE:default:return Math.floor(d/8)}},t.getBestVersionForData=function(e,t){let o;const n=s.from(t,s.M);if(Array.isArray(e)){if(e.length>1)return h(e,n);if(0===e.length)return 1;o=e[0]}else o=e;return d(o.mode,o.getLength(),n)},t.getEncodedBits=function(e){if(!r.isValid(e)||e<7)throw new Error("Invalid QR Code version");let t=e<<12;while(n.getBCHDigit(t)-l>=0)t^=c<<n.getBCHDigit(t)-l;return e<<12|t}},c965:function(e,t,o){},ca07:function(e,t,o){},ca84:function(e,t,o){var n=o("e330"),i=o("1a2d"),s=o("fc6a"),a=o("4d64").indexOf,r=o("d012"),c=n([].push);e.exports=function(e,t){var o,n=s(e),l=0,d=[];for(o in n)!i(r,o)&&i(n,o)&&c(d,o);while(t.length>l)i(n,o=t[l++])&&(~a(d,o)||c(d,o));return d}},cb2d:function(e,t,o){var n=o("1626"),i=o("9bf2"),s=o("13d2"),a=o("6374");e.exports=function(e,t,o,r){r||(r={});var c=r.enumerable,l=void 0!==r.name?r.name:t;if(n(o)&&s(o,l,r),r.global)c?e[t]=o:a(t,o);else{try{r.unsafe?e[t]&&(c=!0):delete e[t]}catch(d){}c?e[t]=o:i.f(e,t,{value:o,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e}},cc12:function(e,t,o){var n=o("da84"),i=o("861d"),s=n.document,a=i(s)&&i(s.createElement);e.exports=function(e){return a?s.createElement(e):{}}},ccaa:function(e,t,o){"use strict";o("b7d2")},cdce:function(e,t,o){var n=o("da84"),i=o("1626"),s=n.WeakMap;e.exports=i(s)&&/native code/.test(String(s))},d012:function(e,t){e.exports={}},d039:function(e,t){e.exports=function(e){try{return!!e()}catch(t){return!0}}},d055:function(e,t,o){const n=o("67dd"),i=o("aa63"),s=o("4146"),a=o("4006");function r(e,t,o,s,a){const r=[].slice.call(arguments,1),c=r.length,l="function"===typeof r[c-1];if(!l&&!n())throw new Error("Callback required as last argument");if(!l){if(c<1)throw new Error("Too few arguments provided");return 1===c?(o=t,t=s=void 0):2!==c||t.getContext||(s=o,o=t,t=void 0),new Promise((function(n,a){try{const a=i.create(o,s);n(e(a,t,s))}catch(r){a(r)}}))}if(c<2)throw new Error("Too few arguments provided");2===c?(a=o,o=t,t=s=void 0):3===c&&(t.getContext&&"undefined"===typeof a?(a=s,s=void 0):(a=s,s=o,o=t,t=void 0));try{const n=i.create(o,s);a(null,e(n,t,s))}catch(d){a(d)}}t.create=i.create,t.toCanvas=r.bind(null,s.render),t.toDataURL=r.bind(null,s.renderToDataURL),t.toString=r.bind(null,(function(e,t,o){return a.render(e,o)}))},d066:function(e,t,o){var n=o("da84"),i=o("1626"),s=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(n[e]):n[e]&&n[e][t]}},d1e7:function(e,t,o){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,s=i&&!n.call({1:2},1);t.f=s?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},d2bb:function(e,t,o){var n=o("7282"),i=o("825a"),s=o("3bbe");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,o={};try{e=n(Object.prototype,"__proto__","set"),e(o,[]),t=o instanceof Array}catch(a){}return function(o,n){return i(o),s(n),t?e(o,n):o.__proto__=n,o}}():void 0)},d32e:function(e,t,o){e.exports=o.p+"img/transparent.492e6eaa.png"},d382:function(e,t,o){"use strict";o("2acc")},d429:function(e,t,o){var n=o("07fa"),i=o("5926"),s=RangeError;e.exports=function(e,t,o,a){var r=n(e),c=i(o),l=c<0?r+c:c;if(l>=r||l<0)throw s("Incorrect index");for(var d=new t(r),u=0;u<r;u++)d[u]=u===l?a:e[u];return d}},d44e:function(e,t,o){var n=o("9bf2").f,i=o("1a2d"),s=o("b622"),a=s("toStringTag");e.exports=function(e,t,o){e&&!o&&(e=e.prototype),e&&!i(e,a)&&n(e,a,{configurable:!0,value:t})}},d636:function(e,t,o){e.exports=o.p+"img/r_1.98943756.png"},d6c0:function(e,t,o){const n=o("7bf0").getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];const t=Math.floor(e/7)+2,o=n(e),i=145===o?26:2*Math.ceil((o-13)/(2*t-2)),s=[o-7];for(let n=1;n<t-1;n++)s[n]=s[n-1]-i;return s.push(6),s.reverse()},t.getPositions=function(e){const o=[],n=t.getRowColCoords(e),i=n.length;for(let t=0;t<i;t++)for(let e=0;e<i;e++)0===t&&0===e||0===t&&e===i-1||t===i-1&&0===e||o.push([n[t],n[e]]);return o}},d72f:function(e,t,o){},d8d3:function(e,t,o){e.exports=o.p+"img/r_6.e24b2f1b.png"},d994:function(e,t,o){},d9b5:function(e,t,o){var n=o("d066"),i=o("1626"),s=o("3a9b"),a=o("fdbf"),r=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&s(t.prototype,r(e))}},d9e2:function(e,t,o){var n=o("23e7"),i=o("da84"),s=o("2ba4"),a=o("e5cb"),r="WebAssembly",c=i[r],l=7!==Error("e",{cause:7}).cause,d=function(e,t){var o={};o[e]=a(e,t,l),n({global:!0,constructor:!0,arity:1,forced:l},o)},u=function(e,t){if(c&&c[e]){var o={};o[e]=a(r+"."+e,t,l),n({target:r,stat:!0,constructor:!0,arity:1,forced:l},o)}};d("Error",(function(e){return function(t){return s(e,this,arguments)}})),d("EvalError",(function(e){return function(t){return s(e,this,arguments)}})),d("RangeError",(function(e){return function(t){return s(e,this,arguments)}})),d("ReferenceError",(function(e){return function(t){return s(e,this,arguments)}})),d("SyntaxError",(function(e){return function(t){return s(e,this,arguments)}})),d("TypeError",(function(e){return function(t){return s(e,this,arguments)}})),d("URIError",(function(e){return function(t){return s(e,this,arguments)}})),u("CompileError",(function(e){return function(t){return s(e,this,arguments)}})),u("LinkError",(function(e){return function(t){return s(e,this,arguments)}})),u("RuntimeError",(function(e){return function(t){return s(e,this,arguments)}}))},da5f:function(e,t,o){"use strict";o("66a0")},da84:function(e,t,o){(function(t){var o=function(e){return e&&e.Math==Math&&e};e.exports=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof t&&t)||function(){return this}()||this||Function("return this")()}).call(this,o("c8ba"))},dc4a:function(e,t,o){var n=o("59ed"),i=o("7234");e.exports=function(e,t){var o=e[t];return i(o)?void 0:n(o)}},dd7e:function(e,t,o){const n=o("bbf0");function i(e){this.mode=n.NUMERIC,this.data=e.toString()}i.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let t,o,n;for(t=0;t+3<=this.data.length;t+=3)o=this.data.substr(t,3),n=parseInt(o,10),e.put(n,10);const i=this.data.length-t;i>0&&(o=this.data.substr(t),n=parseInt(o,10),e.put(n,3*i+1))},e.exports=i},de5d:function(e,t,o){"use strict";o("6887")},dea8:function(e,t,o){"use strict";o("0e4f")},df7e:function(e,t,o){var n=o("07fa");e.exports=function(e,t){for(var o=n(e),i=new t(o),s=0;s<o;s++)i[s]=e[o-s-1];return i}},dfb9:function(e,t,o){var n=o("07fa");e.exports=function(e,t){var o=0,i=n(t),s=new e(i);while(i>o)s[o]=t[o++];return s}},e163:function(e,t,o){var n=o("1a2d"),i=o("1626"),s=o("7b0b"),a=o("f772"),r=o("e177"),c=a("IE_PROTO"),l=Object,d=l.prototype;e.exports=r?l.getPrototypeOf:function(e){var t=s(e);if(n(t,c))return t[c];var o=t.constructor;return i(o)&&t instanceof o?o.prototype:t instanceof l?d:null}},e177:function(e,t,o){var n=o("d039");e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},e24d:function(e,t,o){e.exports=o.p+"img/404.b10eb3f2.png"},e330:function(e,t,o){var n=o("40d5"),i=Function.prototype,s=i.call,a=n&&i.bind.bind(s,s);e.exports=n?a:function(e){return function(){return s.apply(e,arguments)}}},e391:function(e,t,o){var n=o("577ed");e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:n(e)}},e56e:function(e,t,o){"use strict";o("a507")},e5cb:function(e,t,o){"use strict";var n=o("d066"),i=o("1a2d"),s=o("9112"),a=o("3a9b"),r=o("d2bb"),c=o("e893"),l=o("aeb0"),d=o("7156"),u=o("e391"),p=o("ab36"),h=o("6f19"),f=o("83ab"),m=o("c430");e.exports=function(e,t,o,v){var b="stackTraceLimit",g=v?2:1,y=e.split("."),w=y[y.length-1],x=n.apply(null,y);if(x){var S=x.prototype;if(!m&&i(S,"cause")&&delete S.cause,!o)return x;var I=n("Error"),k=t((function(e,t){var o=u(v?t:e,void 0),n=v?new x(e):new x;return void 0!==o&&s(n,"message",o),h(n,k,n.stack,2),this&&a(S,this)&&d(n,this,k),arguments.length>g&&p(n,arguments[g]),n}));if(k.prototype=S,"Error"!==w?r?r(k,I):c(k,I,{name:!0}):f&&b in x&&(l(k,x,b),l(k,x,"prepareStackTrace")),c(k,x),!m)try{S.name!==w&&s(S,"name",w),S.constructor=k}catch(O){}return k}}},e627:function(e,t,o){},e893:function(e,t,o){var n=o("1a2d"),i=o("56ef"),s=o("06cf"),a=o("9bf2");e.exports=function(e,t,o){for(var r=i(t),c=a.f,l=s.f,d=0;d<r.length;d++){var u=r[d];n(e,u)||o&&n(o,u)||c(e,u,l(t,u))}}},e8b5:function(e,t,o){var n=o("c6b6");e.exports=Array.isArray||function(e){return"Array"==n(e)}},e8f8:function(e,t,o){e.exports=o.p+"img/poster_local.ac9da8c5.jpeg"},e945:function(e,t,o){"use strict";o("703f")},ea5e:function(e,t,o){"use strict";o("078f")},eb85:function(e,t,o){e.exports=o.p+"img/r_4.1.9858c1af.png"},ebb5:function(e,t,o){"use strict";var n,i,s,a=o("4b11"),r=o("83ab"),c=o("da84"),l=o("1626"),d=o("861d"),u=o("1a2d"),p=o("f5df"),h=o("0d51"),f=o("9112"),m=o("cb2d"),v=o("edd0"),b=o("3a9b"),g=o("e163"),y=o("d2bb"),w=o("b622"),x=o("90e3"),S=o("69f3"),I=S.enforce,k=S.get,O=c.Int8Array,j=O&&O.prototype,C=c.Uint8ClampedArray,E=C&&C.prototype,T=O&&g(O),P=j&&g(j),_=Object.prototype,A=c.TypeError,M=w("toStringTag"),H=x("TYPED_ARRAY_TAG"),z="TypedArrayConstructor",L=a&&!!y&&"Opera"!==p(c.opera),D=!1,B={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},N={BigInt64Array:8,BigUint64Array:8},V=function(e){if(!d(e))return!1;var t=p(e);return"DataView"===t||u(B,t)||u(N,t)},R=function(e){var t=g(e);if(d(t)){var o=k(t);return o&&u(o,z)?o[z]:R(t)}},F=function(e){if(!d(e))return!1;var t=p(e);return u(B,t)||u(N,t)},G=function(e){if(F(e))return e;throw A("Target is not a typed array")},W=function(e){if(l(e)&&(!y||b(T,e)))return e;throw A(h(e)+" is not a typed array constructor")},$=function(e,t,o,n){if(r){if(o)for(var i in B){var s=c[i];if(s&&u(s.prototype,e))try{delete s.prototype[e]}catch(a){try{s.prototype[e]=t}catch(l){}}}P[e]&&!o||m(P,e,o?t:L&&j[e]||t,n)}},U=function(e,t,o){var n,i;if(r){if(y){if(o)for(n in B)if(i=c[n],i&&u(i,e))try{delete i[e]}catch(s){}if(T[e]&&!o)return;try{return m(T,e,o?t:L&&T[e]||t)}catch(s){}}for(n in B)i=c[n],!i||i[e]&&!o||m(i,e,t)}};for(n in B)i=c[n],s=i&&i.prototype,s?I(s)[z]=i:L=!1;for(n in N)i=c[n],s=i&&i.prototype,s&&(I(s)[z]=i);if((!L||!l(T)||T===Function.prototype)&&(T=function(){throw A("Incorrect invocation")},L))for(n in B)c[n]&&y(c[n],T);if((!L||!P||P===_)&&(P=T.prototype,L))for(n in B)c[n]&&y(c[n].prototype,P);if(L&&g(E)!==P&&y(E,P),r&&!u(P,M))for(n in D=!0,v(P,M,{configurable:!0,get:function(){return d(this)?this[H]:void 0}}),B)c[n]&&f(c[n],H,n);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:L,TYPED_ARRAY_TAG:D&&H,aTypedArray:G,aTypedArrayConstructor:W,exportTypedArrayMethod:$,exportTypedArrayStaticMethod:U,getTypedArrayConstructor:R,isView:V,isTypedArray:F,TypedArray:T,TypedArrayPrototype:P}},edd0:function(e,t,o){var n=o("13d2"),i=o("9bf2");e.exports=function(e,t,o){return o.get&&n(o.get,t,{getter:!0}),o.set&&n(o.set,t,{setter:!0}),i.f(e,t,o)}},f42f:function(e,t,o){"use strict";o("52ff")},f495:function(e,t,o){var n=o("c04e"),i=TypeError;e.exports=function(e){var t=n(e,"number");if("number"==typeof t)throw i("Can't convert number to bigint");return BigInt(t)}},f5df:function(e,t,o){var n=o("00ee"),i=o("1626"),s=o("c6b6"),a=o("b622"),r=a("toStringTag"),c=Object,l="Arguments"==s(function(){return arguments}()),d=function(e,t){try{return e[t]}catch(o){}};e.exports=n?s:function(e){var t,o,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(o=d(t=c(e),r))?o:l?s(t):"Object"==(n=s(t))&&i(t.callee)?"Arguments":n}},f772:function(e,t,o){var n=o("5692"),i=o("90e3"),s=n("keys");e.exports=function(e){return s[e]||(s[e]=i(e))}},f8a3:function(e,t,o){"use strict";o("b203")},f8c9:function(e,t,o){var n=o("23e7"),i=o("da84"),s=o("d44e");n({global:!0},{Reflect:{}}),s(i.Reflect,"Reflect",!0)},f8cd:function(e,t,o){var n=o("5926"),i=RangeError;e.exports=function(e){var t=n(e);if(t<0)throw i("The argument can't be less than 0");return t}},f8d7:function(e,t,o){"use strict";o("5917")},fa05:function(e,t,o){},fb40:function(e,t,o){},fc6a:function(e,t,o){var n=o("44ad"),i=o("1d80");e.exports=function(e){return n(i(e))}},fd92:function(e,t,o){},fdbf:function(e,t,o){var n=o("04f8");e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},fdfd:function(e,t,o){},fefc:function(e,t,o){e.exports=o.p+"img/r_8.41873b8c.png"},ff17:function(e,t,o){"use strict";o("fd92")}}]);